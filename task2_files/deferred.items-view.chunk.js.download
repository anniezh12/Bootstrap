(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.items-view"],Array(895).concat([function(e,t,n){"use strict";n.r(t);var r=n(2344);n.d(t,"spItemCreateFolderOperationHandler",function(){return r.t});n.d(t,"getCreateFolderUrl",function(){return r.e});var i=n(2434);n.d(t,"spItemCreateDocumentOperationHandler",function(){return i.n});n.d(t,"getRedirectUrlFromResponse",function(){return i.t});n.d(t,"getCreateDocumentUrl",function(){return i.e});var s=n(2343);n.d(t,"spItemUploadItemsOperationHandler",function(){return s.e})}],Array(171),[function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(5),i=n(435),s=new r.e("spSharedByMePage",{itemSet:Object(r.o)(i.t),after:Object(r.s)()})}],Array(117),[function(e,t,n){"use strict";n.r(t);n.d(t,"getNeedsAttentionView",function(){return h});var r=n(0),i=n(388),s=n(491),o=n(24),u=n(290),a=n(99),f=n(4),l=n(3),c=n(110);function h(e,t,n){var h=l.U.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),p=n(Object(a.e)({list:f.ye},h)),d=p&&p.list&&p.list.templateType&&Object(o.s)(p.list.templateType),v=d?"LinkTitle":"LinkFilename",m={},g=[];if(e)for(var y=0,b=e;y<b.length;y++){var w=b[y];if(w.contentTypeId&&w.requiredFields&&w.requiredLookups){for(var E={fieldName:"ContentTypeId",operator:"Eq",values:[w.contentTypeId]},S=s.e(E),x=[],T=w.requiredFields.split(","),N=w.requiredLookups.split(","),C=0;C<T.length;C++){var k=T[C],L="True"===N[C];void 0===m[k]&&(m[k]=L);var A={fieldName:k,lookupId:!!L||void 0,operator:"Eq",values:[""]};x.push(A)}var O=s.t(x,"Or");if(O){var M=s.t([S,O],"And");g.push(M)}}}0===g.length&&g.push(s.e({fieldName:"FileLeafRef",operator:"Eq",values:[""]}));var _=Object.keys(m),D=_.map(function(e){return m[e]}),P=Object(r.__spreadArrays)(["DocIcon",v,"Editor","Modified"],_,["FileDirRef"]),H=Object(r.__spreadArrays)([void 0,void 0,void 0,void 0],D,[void 0]),B=!!p&&!!p.list&&!!p.list.templateType&&p.list.templateType===o.n.webPageLibrary,j=new i.e("<View Scope='Recursive'/>");B&&c.e.isFeatureEnabled({ODB:1743})?j.title=u.e.PagesThatNeedAttention:j.title=d?u.e.ItemsThatNeedAttention:u.e.FilesThatNeedAttention;j.isReadOnly=!0;j.replaceFields(P,H);j.updateSort({fieldName:"ID",isAscending:!0});j.updateRowLimit({rowLimit:30,isPerPage:!0});var F=s.t(g,"Or");j.addFilters([F]);return j}},function(e,t,n){"use strict";n.r(t);n.d(t,"getListRootFolder",function(){return o});var r=n(0),i=n(247),s=n(3164);function o(e){var t=this,n=e.webAbsoluteUrl,o=e.listFullUrl,u=e.qosName;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=Object(s.e)({webAbsoluteUrl:n,listFullUrl:o}).segment("RootFolder");return[4,e(Object(i.r)({url:t.toString(),method:"GET",webAbsoluteUrl:n,listFullUrl:o,qosName:"rootFolder."+u,noRedirect:!0}))];case 1:return[2,r.sent()]}})})}}},function(e,t,n){"use strict";n.r(t);n.d(t,"fileHandlerGetItemsOperationHandler",function(){return E});n.d(t,"filehandlerPerExtensionGetItemsOperationHandler",function(){return S});n.d(t,"fetchFileHandlerData",function(){return x});n.d(t,"getFileHandlerCacheKey",function(){return T});n.d(t,"cacheFileHandlerData",function(){return N});n.d(t,"resolveFileHandlers",function(){return C});n.d(t,"addFileHandlerActionsToCache",function(){return k});var r=n(0),i=n(19),s=n(56),o=n(1538),u=n(7),a=n(13),f=n(90),l=n(2876),c=n(2006),h=n(1418),p=n(2007),d=n(398),v=n(361),m=n(173),g=n(54),y=n(275),b=n(342),w=n(30),E=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=d.t.deserialize(n),s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o;return Object(r.__generator)(this,function(r){t=e(Object(b.e)({name:"getFileHandlersOperation"}));o={endpoint:s};return[2,e(x(i)).then(function(r){if(r){N({driveAppsKey:i,data:r});e(C(r,n));o.fileHandlerRequestEndpoint=r.signature.endpoint;o.accessTokenObtained=!0;e(t({resultType:w.e.Success,extraData:o}))}}).catch(function(n){f.e.logError(n);e(t({resultType:w.e.Failure,extraData:o}));throw n})]})})}}),S=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=d.e.deserialize(n).endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:t=d.t.serialize({endpoint:i});return[4,e(Object(o.demandItems)(function(e){return e.demandItemFacet(v.t,t)}))];case 1:n.sent();return[2]}})})}});function x(e){var t=e.endpoint,n=e.driveId;return function(e){var r,i=e(Object(g.e)({getUserOneDriveEndpoint:m.s,useOneDriveEndpoint:m.g})),s=i.getUserOneDriveEndpoint,o=i.useOneDriveEndpoint,u=Object(c.n)({endpoint:t,driveId:n}),a=new l.e({},{dataRequestor:e(h.e).dataRequestor}),f=Promise.resolve(t);if(s&&o){var d=new y.e(t).authority;f=e(s.getUserOneDriveEndpoint(d))}return f.then(function(t){r=t;u=Object(c.n)({endpoint:r});return e(Object(p.e)(r,u))}).then(function(e){return a.getFileHandlerData({accessToken:e,endpoint:r,includePromotedApp:!0,driveId:n}).then(function(e){if(e){return{data:e,lastModified:Date.now(),signature:{endpoint:r,includePromotedApp:!0,driveId:n}}}})})}}function T(e){var t=e.endpoint,n=e.driveId;return"fileHandlerCache_"+JSON.stringify({endpoint:t,driveId:n})}function N(e){if("localStorage"in window)try{var t=T(e.driveAppsKey);localStorage.setItem(t,JSON.stringify(e.data))}catch(e){}}function C(e,t){var n=e.data,i=n.actions,o=n.preferences,u=n.version,a=e.signature,f=d.t.deserialize(t);return function(n){var l,c=new s.e,h=k(c,i),p=(function(e,t){for(var n,i=new s.e,o=0,u=Object.keys(e);o<u.length;o++){var a=u[o],f=e[a],l={};l.open=L(i,f.open,"open",a);l.preview=L(i,f.preview,"preview",a);for(var c=(f.open||[]).concat(f.preview||[]),h=void 0,p=0;p<c.length;p++){var m=c[p],g=m.handler,y=m&&A(m.icon)||g&&A(g.fileTypeIcon),b=g.fileTypeDisplayName||g.displayName;if(y){h={displayName:b,url:y};break}}var w=d.e.serialize({endpoint:t,extension:a}),E=Object(r.__assign)(Object(r.__assign)({},v.t.pack(l)),v.i.pack(h));i.resolveItems({items:(n={},n[w]=E,n)})}return{preferencesItemResolver:i}})(o,f.endpoint).preferencesItemResolver;c.merge(p);c.resolveItems({items:(l={},l[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.t.pack(h)),v.a.pack(u)),v.u.pack({data:e.data,signature:a})),l)});n(c.execute())}}function k(e,t){var n={};["custom","create","open","preview"].forEach(function(r){var i=L(e,t[r],r);n[r]=i});return n}function L(e,t,n,i){var s,o=[];t.forEach(function(t){var n,i=t.handler,s=d.i.serialize({id:i.id,appId:i.appId}),a=d.n.serialize({handlerId:i.id,appId:i.appId,id:t.id||0}),f={displayName:i.actionMenuDisplayName,url:A(i.appIcon)},l={displayName:i.fileTypeDisplayName||i.displayName,url:A(t.icon||i.fileTypeIcon)},c=Object(r.__assign)(Object(r.__assign)({},u.f.pack(i.actionMenuDisplayName||i.displayName)),v.n.pack(f)),h=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.f.pack(t.displayName||i.displayName)),u.L.pack(t.url)),v.e.pack(t.availableOn)),v.o.pack(s)),v.i.pack(l)),v.r.pack(i.appId)),void 0!==i.isPromoted?Object(r.__assign)({},v.s.pack(i.isPromoted)):{});e.resolveItems({items:(n={},n[s]=c,n[a]=h,n)});-1===o.indexOf(a)&&o.push(a)});var f=d.r.serialize({type:n,extension:i}),l=Object(r.__assign)({},a.e.pack(0===o.length?void 0:{itemKeys:o}));e.resolveItems({items:(s={},s[f]=l,s)});return f}function A(e){var t=window.devicePixelRatio||1;return e&&(e.svg||t>=1.75&&e.png2x||t>=1.25&&e.png1_5x||e.png1x)}},,,,,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1),s=n(9),o=n(1231),u=n(2909),a=n(2085),f=n(2134),l=n(21),c=n(281),h=n(3258),p=n(798),d=n(11),v=n(81),m=new d.e("dragLayerPreviewControl",{dragLayerPreviewRenderer:Object(v.e)()}),g=n(229),y=function(e){var t=e.draggedItem,n=t.dragSourceKey,r=t.itemKeys,s=void 0===r?[]:r,o=s[0]||n,u=s.length>0?s.length:n?1:0,a="",f=null;if(u<1)return null;a=Object(l.format)(Object(l.getLocalizedCountValue)(h.e.dragMoveItemsPreviewText,h.e.dragMoveItemsPreviewTextIntervals,u)||"",u);f=1===u?i.createElement(p.t,{itemKey:o,size:20,className:"dragPreviewIcon_a4b566e9"}):i.createElement(p.e,{type:c.e.genericFile,size:20,className:"dragPreviewIcon_a4b566e9"});return a?i.createElement("div",{className:"dragPreviewRoot_a4b566e9"},f||null,i.createElement("span",{className:"dragPreviewText_a4b566e9"},a)):null},b=i.memo(function(e){var t=e.draggedItem,n=i.useCallback(function(e){var n=e.itemCache;if(!t)return null;var r=t.dragSourceKey,s=t.itemKeys,o=s||[r],u=n.demandItemFacet(m,r),a=m.evaluate(u)(n,{itemKeys:o,dragLayerPreviewRenderer:y}).dragLayerPreviewRenderer;return i.createElement(a,{draggedItem:t})},[t?t.dragSourceKey:void 0]);return i.createElement(g.e,null,n)}),w=n(3259);n.d(t,"DropTargetHook",function(){return E});n.d(t,"DragSourceHook",function(){return S});n.d(t,"DragDropHook",function(){return x});var E=Object(s.t)()(function(e){e.itemCacheDispatch;var t=Object(r.__rest)(e,["itemCacheDispatch"]);return i.createElement(u.e,null,i.createElement(a.e,Object(r.__assign)({},t)))});var S=Object(s.t)()(function(e){e.itemCacheDispatch;var t=Object(r.__rest)(e,["itemCacheDispatch"]),n=t.dragSourceKey,s=t.type;return i.createElement(u.e,null,i.createElement(f.t,Object(r.__assign)({},t)),e.showDefaultDragPreview?null:i.createElement(f.e,{dragSourceKey:n,type:s},i.createElement(b,null)))}),x=i.memo(function(e){var t=e.dragDropKey,n=e.dragType;return i.createElement(u.e,null,i.createElement(w.e,Object(r.__assign)({},e)),e.showDefaultDragPreview?null:i.createElement(f.e,{dragSourceKey:t,type:n,as:T,getItemStyles:N},i.createElement(b,null)))}),T=i.forwardRef(function(e,t){return i.createElement(o.e,null,i.createElement("div",{className:e.className,ref:t},e.children))});function N(e,t,n,r,i){if(!(e&&t&&n&&r))return{display:"none"};var s={top:0,left:0};if(null!==i){var o=i.getBoundingClientRect();if(o){s.top=o.top;s.left=o.left}}var u=t||{x:0,y:0},a=u.x,f=u.y,l="translate("+a+"px, "+(f-=s.top)+"px)";return{transform:l,WebkitTransform:l}}}],Array(225),[function(e,t,n){"use strict";var r=n(0),i=n(102),s=n(1994),o=n(2007),u=n(442),a=n(354),f=n(430),l=n(54),c=new(n(2).e)("graphDataRequestorConfiguration"),h=n(173),p=n(17),d=n(2825);n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});n.d(t,"n",function(){return g});n.d(t,"r",function(){return y});n.d(t,"i",function(){return b});n.d(t,"s",function(){return w});var v=Object(i.e)(function(e){var t=e(a.e),n=e(Object(l.e)({graphDataRequestorConfiguration:c,graphTokenProvider:d.e})),r=n.graphDataRequestorConfiguration,i=n.graphTokenProvider,o=r&&r.alwaysSendContentType;return{dataRequestor:new s.e({alwaysSendContentType:o},{apiEvent:f.e.withManager(t),sessionManagementProvider:i,isOffline:function(){return new p.n(function(t,n){try{var r=e(Object(u.n)()),i=void 0!==window.navigator.onLine&&!window.navigator.onLine;t(r||i)}catch(e){n(e)}})}}),hasTokenProvider:!!i&&!!i.getSessionToken}});function m(e,t){return"&orderby=folder,"+e+" "+(t?"asc":"desc")}function g(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,u=e.body,a=e.qosName,f=e.endpoint,c=e.headers,p=e.timeout,d=e.expectedErrors,m=e.driveUrl,g=e.parseResponse;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,y,b,w,E,S;return Object(r.__generator)(this,function(x){switch(x.label){case 0:t=e(v),i=t.dataRequestor,y=t.hasTokenProvider;b=void 0!==typeof u?JSON.stringify(u):void 0;return y?[3,2]:[4,e(Object(o.e)(f,m))];case 1:E=x.sent();return[3,3];case 2:E=void 0;x.label=3;case 3:w=E;S=e(Object(l.e)({clientName:h.e})).clientName;return[4,i.send({path:n,endpoint:f,driveUrl:m,requestType:s,apiName:a,accessToken:w,useAuthorizationHeaders:!0,postData:b,headers:S?Object(r.__assign)({"X-ClientService-ClientTag":S},c||{}):c,expectedErrors:d,timeout:p,parseResponse:g})];case 4:return[2,x.sent()]}})})}}function y(e){var t=this,n=e.url,i=e.method,s=void 0===i?"GET":i,o=e.body,a=e.qosName,f=e.timeout,l=e.endpoint,c=e.headers,h=e.expectedErrors,p=e.driveUrl,d=e.parseResponse;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,v,m,y,b,w,E;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=void 0!==typeof o?JSON.stringify(o):"";i=(function(e,t,n){var r=void 0!==n?n:"";return e+"__"+t+"__"+r})(n,s,t);v=e(Object(u.n)());m=void 0!==window.navigator.onLine&&!window.navigator.onLine;y=v||m;return[4,e(Object(u.t)(i))];case 1:b=r.sent();if(y&&b)return[2,b];w=g({url:n,method:s,body:o,qosName:a,endpoint:l,headers:c,expectedErrors:h,timeout:f,driveUrl:p,parseResponse:d});if(!b)return[3,2];e(w).then(function(t){e(Object(u.r)(i,t))});return[2,b];case 2:return[4,e(w)];case 3:E=r.sent();return[4,e(Object(u.r)(i,E))];case 4:r.sent();return[2,E]}})})}}function b(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){return[2,!!(t=n(Object(l.e)({isODCEndpoint:h.f})).isODCEndpoint)&&t(e)]})})}}function w(e,t){return function(n){var r=n(Object(l.e)({supportsRandomAccess:h.v})).supportsRandomAccess;return!!r&&r(e,t)}}}],Array(119),[function(e,t,n){"use strict";n.r(t);n.d(t,"demandItems",function(){return u});var r=n(0),i=n(2791),s=n(306),o=6e4;function u(e,t){var n=this;void 0===t&&(t={});var a=t.cancelToken,f=t.flushOperationQueue,l=t.timeout,c=void 0===l?o:l;return function(t){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,o,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:o={operation:u};l=Object(s.e)(c,a);r.label=1;case 1:r.trys.push([1,,3,4]);return[4,t(Object(i.e)(e,function(e){n={result:e}},{cancelToken:l.token,flushOperationQueue:f,owner:o}))];case 2:r.sent();return[3,4];case 3:l.dispose();return[7];case 4:if(!n)throw new Error("No result.");return[2,n.result]}})})}}}],Array(19),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("saveViewCore"),o=Object(i.i)({operationTypeFacet:s})}],Array(187),[function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(5),i=n(144),s=n(942),o=new r.e("driveItemSet",{driveItemKey:Object(r.o)(i.e),sortBy:Object(r.s)(),isAscending:Object(r.n)(),extFilters:Object(r.t)(Object(r.s)()),filters:Object(r.t)(Object(r.o)(s.e)),groupBy:Object(r.s)()})}],Array(94),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("refreshItemsInSet"),o=Object(i.i)({operationTypeFacet:s})}],Array(14),[function(e,t,n){"use strict";var r=n(0),i=n(174),s=n(7),o=n(13),u=n(144),a=n(1746),f=n(2505),l=n(2),c=new l.e("driveItemResponse"),h=n(579),p=n(2507),d=n(2008),v=n(131),m=n(58),g=n(2177),y=new l.e("vault"),b=n(821),w=new l.e("officeApp"),E=n(1289),S=function(e){for(var t=e.replace(".",""),n=0,r=Object.keys(E.e);n<r.length;n++){var i=r[n];if(E.e.hasOwnProperty(i)){if(E.e[i].indexOf(t)>-1)return i}}},x=n(2508),T=n(2509),N=n(2342),C=n(2826),k=n(2506);n.d(t,"e",function(){return L});n.d(t,"t",function(){return A});function L(e){var t,n=e.driveItemKey,l=e.driveItem,E=e.endpoint,L=e.parentFolderItemKey,O=e.shouldReturnShareFacets,M=void 0===O||O,_=l.file,D=l.fileSystemInfo,P=l.name,H=l.parentReference,B=l.remoteItem,j=l.root,F=l.size,I=l.thumbnails,q=l.image,R=l.video,U=l.eTag,z=l.specialFolder,W=l.lastModifiedDateTime,X=void 0===W?D&&D.lastModifiedDateTime||B&&B.lastModifiedDateTime:W,V=H&&H.driveId,$=H&&H.driveType||B&&B.parentReference&&B.parentReference.driveType,J="personal"===$,K=D&&D.lastAccessedDateTime||B&&B.fileSystemInfo&&B.fileSystemInfo.lastAccessedDateTime,Q=l.package||B&&B.package,G=I||B&&B.thumbnails,Y=q||B&&B.image,Z=R||B&&B.video,ee=l.shared||B&&B.shared,te={itemId:l.id,driveId:V,endpoint:E},ne=D&&D.systemPath,re=n||B&&B.parentReference&&{itemId:B.id,driveId:B.parentReference.driveId,endpoint:E}||te,ie=n||B&&B.parentReference&&{driveId:B.parentReference.driveId,endpoint:E},se=l.webDavUrl||B&&B.webDavUrl;t="business"!==$&&"documentLibrary"!==$&&"personal"!==$||!j?P||B&&B.name||"":d.e.files;var oe=l.folder||B&&B.folder,ue=F||B&&B.size,ae=oe&&oe.childCount,fe=A(t,!!oe),le=fe.extension&&S(fe.extension),ce=l.sharepointIds||B&&B.sharepointIds,he=G&&Object(C.t)(G)?G.length>0&&G[0]:G,pe=l.localItem,de=!oe&&(l.webUrl||B&&B.webUrl);return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},u.e.pack(re)),s.f.pack(t)),void 0!==ue?s.p.pack(ue):{}),D||l.folder||_||B&&B.folder?Object(r.__assign)({},s.d.pack(oe?{}:void 0)):{}),de?s.L.pack(de):{}),b.n.pack(ne)),se?s.i.pack(se):{}),s.u.pack(X?new Date(X).getTime():void 0)),K?Object(r.__assign)({},s.s.pack(new Date(K).getTime())):{}),i.n.pack(Q&&"oneNote"===Q.type?{}:void 0)),f.e.pack(G)),k.e.pack(!0)),ie?N.e.pack(ie):{}),he?v.p.pack({width:he.large.width,height:he.large.height,url:he.large.url}):{}),c.pack(l)),U?s.l.pack(U):{}),Y&&Y.width&&Y.height?v.u.pack({width:Y.width,height:Y.height}):{}),Y&&!Z?v.h.pack({}):{}),Z?v.v.pack({}):{}),o.t.pack({itemKey:a.e.serialize({driveItemKey:re,sortBy:"",isAscending:!0})})),s.n.pack({itemKey:h.e.serialize({driveItemKey:re})})),s.A.pack(L?{itemKey:L}:void 0)),!J&&se?Object(r.__assign)({},s.O.pack((function(e){var t=e.split("/");return t.length>2?decodeURI(t[t.length-2]):void 0})(se))):{}),g.e.pack($)),J?Object(r.__assign)({},y.pack(l.vault)):{}),s.h.pack(fe)),M?Object(r.__assign)(Object(r.__assign)({},s.E.pack(!!ee)),p.e.pack(ee)):{}),pe?b.e.pack(pe):{}),"number"==typeof ae?m.e.pack(ae):{}),b.t.pack(_&&_.mimeType)),le?w.pack(le):{}),ce?x.e.pack(ce):{}),z?T.e.pack(z.name):{})}function A(e,t){var n=e.lastIndexOf(".");return t||n<0?{name:e,extension:""}:{name:e.substring(0,n),extension:e.substring(n)}}},,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r=n(2),i=new r.e("entryBatch"),s=new r.e("sourceFile")}],Array(70),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(1),i=n(3749),s=n(2792),o=n(3522),u=n(1132),a=n(797),f=n(1814),l=n(1157),c=function(e){var t=e.onConfirm,n=e.onCancel,c=e.defaultToYes,h=void 0!==c&&c,p=e.yesText,d=void 0===p?l.e.yes:p,v=e.noText,m=void 0===v?l.e.no:v,g=h?u.e:a.e,y=h?a.e:u.e;return r.createElement(i.e,{dialogContentProps:{type:s.e.close},onDismiss:n,hidden:!1,title:e.title,maxWidth:e.maxWidth},r.createElement(f.e,null,e.prompt),r.createElement(o.e,null,r.createElement(g,{"data-automationid":"confirmbutton",onClick:t},d),r.createElement(y,{"data-automationid":"cancelbutton",onClick:n,componentRef:function(e){e&&e.focus()}},m)))}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(11),i=n(81),s=new r.e("folderCoverSignalControl"),o=new r.e("itemTileControl",{tileAs:Object(i.e)()})}],Array(60),[function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"i",function(){return i});n.d(t,"r",function(){return s});n.d(t,"e",function(){return o});n.d(t,"n",function(){return u});function r(e){var t=e.itemId,n=void 0===t?"":t;return u(e)+"/items/"+encodeURIComponent(n)}function i(e){var t=e.name;return u(e)+"/special/"+encodeURIComponent(t)}function s(e){return e.endpoint+"/shares/u!"+e.shareId+"/driveItem"}function o(e){return u(e)+"/commands"}function u(e){var t=e.endpoint,n=e.driveId;return"me"===n?t+"/me/drive":t+"/"+(n?"drives/"+encodeURIComponent(n):"drive")}},function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(949),s=n(54),o=n(342),u=n(30),a=n(107),f=n(2825);function l(e,t,n){var l=this;return function(c){return Object(r.__awaiter)(l,void 0,void 0,function(){var l,h,p,d,v,m,g,y,b,w,E,S,x=this;return Object(r.__generator)(this,function(T){switch(T.label){case 0:l=c(Object(s.e)({graphDataSourceConfiguration:i.e,graphTokenProviderConfiguration:f.e})),h=l.graphDataSourceConfiguration,p=l.graphTokenProviderConfiguration;d=h&&h.ensureAuthToken;v=n&&h&&h.ensureAuthTokenWithAction;m=p&&p.getSessionToken;if(!(y=m?function(){return Object(r.__awaiter)(x,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,m({endpoint:t,driveUrl:n,path:n||t})];case 1:return[2,e.sent().accessToken]}})})}:v?function(){return Object(r.__awaiter)(x,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,c(v(e,t,n))];case 1:return[2,r.sent()]}})})}:d?function(){return Object(r.__awaiter)(x,void 0,void 0,function(){return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,d(e,t)];case 1:return[2,n.sent()]}})})}:void 0))return[3,4];b=c(Object(o.e)({name:"graphDataSource.getAuthToken"}));T.label=1;case 1:T.trys.push([1,3,,4]);return[4,y()];case 2:g=T.sent();c(b({resultType:u.e.Success}));return[3,4];case 3:w=T.sent();E=u.e.Failure;S=void 0;if(w instanceof a.e){w.isExpected&&(E=u.e.ExpectedFailure);S=w.code}else S=w instanceof Error?w.name+"("+w.message+")":"UnknownAuthError";c(b({resultType:E,resultCode:S,error:w&&JSON.stringify(w)}));throw w;case 4:return[2,g]}})})}}function c(e,t){var n=this;return function(i){return Object(r.__awaiter)(n,void 0,void 0,function(){var n,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,i(l(["Files.ReadWrite.All"],e,t))];case 1:(n=r.sent())&&(s={accessToken:n});return[2,s]}})})}}}],Array(64),[function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(5),i=new r.e("uploadProgress",{sourceEntryKey:Object(r.s)()});function s(e){return i.serialize({sourceEntryKey:e})}},,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("userByEmail",{email:Object(r.s)(),endpoint:Object(r.s)()})}],Array(74),[function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(1),i=n(3749),s=n(3522),o=n(1132),u=n(1814),a=function(e){var t=e.title,n=e.prompt,a=e.cancelText,f=e.onCancel;return r.createElement(i.e,{onDismiss:f,hidden:!1,title:t,maxWidth:e.maxWidth},r.createElement(u.e,null,n),r.createElement(s.e,null,r.createElement(o.e,{onClick:f,componentRef:function(e){e&&e.focus()}},a)))}}],Array(22),[function(e,t,n){"use strict";n.d(t,"t",function(){return h});n.d(t,"r",function(){return p});n.d(t,"n",function(){return d});n.d(t,"e",function(){return m});var r=n(0),i=n(247),s=n(54),o=n(3164),u=n(342),a=n(30),f=n(4),l=n(442),c=n(107);n(2500);function h(e){return function(t){var n=t(Object(s.e)({spHomeDataSourceConfiguration:f.ht})).spHomeDataSourceConfiguration,r=n&&n.contextAcquiresAuthToken;return t(Object(i.r)({webAbsoluteUrl:e.tenantRootUrl,listFullUrl:e.tenantRootUrl,method:"GET",url:v(e),qosName:"getSPHomeContext",parseResponse:function(e){var t=JSON.parse(e).d;return{payloadHeader:t.Payload,resource:t.Urls&&t.Urls.results&&t.Urls.results.length>0&&t.Urls.results[0]||"",accessToken:t.Token&&t.Token.access_token||""}},noRedirect:!0,skipAuth:r,crossSiteCollectionCall:r,needsRequestDigest:!r,ignoreDiskCacheWhenOnline:!0}))}}function p(e,t,n){var i=this;void 0===n&&(n=8);return function(o){return Object(r.__awaiter)(i,void 0,void 0,function(){var i,u,a,l,c,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=o(Object(s.e)({spFrequentSitesConfiguration:f.lt,enableFilesWeightedFrequentSitesConfiguration:f.x})),u=i.spFrequentSitesConfiguration,a=i.enableFilesWeightedFrequentSitesConfiguration;return u&&u.getExternalData?[4,u.getExternalData()]:[3,2];case 1:if(l=r.sent())return[2,l];r.label=2;case 2:return!t&&u&&u.getCacheContext?[4,u.getCacheContext()]:[3,4];case 3:(c=r.sent())&&(t=JSON.stringify(c));r.label=4;case 4:return[4,o(h({tenantRootUrl:e}))];case 5:p=r.sent();return[2,o(m({path:"api/v1/sites/feed?acronyms=true&start=0&count="+n,method:"GET",qosName:"getSPHomeFrequentSites",context:p,clientType:a?"ODBWeb":void 0,cacheContext:t}))]}})})}}function d(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(t=n(Object(s.e)({spFollowedSitesConfiguration:f.ft})).spFollowedSitesConfiguration)&&t.getExternalData?[4,t.getExternalData()]:[3,2];case 1:if(i=r.sent())return[2,i];r.label=2;case 2:return[4,n(h({tenantRootUrl:e}))];case 3:o=r.sent();return[2,n(m({path:"api/v1/sites/followed?acronyms=true&fillsitedata=true&mostRecentFirst=true&start=0&count=36",method:"GET",qosName:"getSPHomeFollowedSites",context:o}))]}})})}}function v(e){var t=e.tenantRootUrl;return Object(o.n)({webAbsoluteUrl:t}).segment("sphomeservice").segment("context").oDataParameter("$expand","Token,Payload").toString()}function m(e){var t=this,n=e.method,s=e.path,o=e.context,f=e.qosName,h=e.clientType,p=e.contentType,d=void 0===p?"application/json;odata=verbose":p,v=e.body,m=e.cacheContext,g=f?"getData."+f:"getData";return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,p,y,b,w,E,S,x,T=this;return Object(r.__generator)(this,function(N){switch(N.label){case 0:t=new Headers;return(p=o.accessToken)?[3,2]:[4,e(Object(i.e)({url:o.resource}))];case 1:p=N.sent();N.label=2;case 2:(f=p)&&t.set("Authorization","Bearer "+f);o.payloadHeader&&t.set("SPHome-ApiContext",o.payloadHeader);m&&t.set("SPHome-CacheContext",m);t.set("SPHome-ClientType",h||"ODSPDocLibsWeb");t.set("Content-Type",d);y={headers:t,credentials:"omit",method:n,mode:"cors",cache:"default",body:v};b=e(Object(u.e)({name:g}));w=o.resource+"/"+s+"__"+n;return[4,e(Object(l.t)(w))];case 3:E=N.sent();S=fetch(o.resource+"/"+s,y).then(function(t){return Object(r.__awaiter)(T,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!t.ok)return[3,2];e(b({resultType:a.e.Success}));return 204===t.status?[2,{}]:[4,t.json()];case 1:n=r.sent();e(Object(l.r)(w,n));return[2,n];case 2:throw new c.e({code:""+t.status,message:t.statusText})}})})}).catch(function(t){e(b({resultType:a.e.Failure,resultCode:t instanceof c.e?t.code:t.name,error:t&&JSON.stringify(t)}));throw t});return(x=E)?[3,5]:[4,S];case 4:x=N.sent();N.label=5;case 5:return[2,x]}})})}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("driveType")},function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(5),i=n(144),s=new r.e("searchItemSet",{driveItemKey:Object(r.o)(i.e),searchTerm:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return d});n.d(t,"t",function(){return v});n.d(t,"i",function(){return m});n.d(t,"r",function(){return g});n.d(t,"n",function(){return y});var r,i=n(4),s=n(7),o=n(51),u=n(838),a=n(2180),f=n(3),l=n(2838),c=n(954),h=n(860),p="0x0101009D1CB255DA76424F860D91F20E6C4118";(function(e){e[e.publish=0]="publish";e[e.schedule=1]="schedule"})(r||(r={}));function d(e,t){var n,r,a;if(!t)return!1;var c=e.demandItem({firstItemKey:f.D,permissions:i.Fe,checkoutInfo:s.y,needsPublishing:i.Ae},t),p=c.firstItemKey,d=c.permissions,v=c.checkoutInfo,m=c.needsPublishing;if(!p)return!1;var y=e.demandItemFacet(i.ye,f.U.serialize({webAbsoluteUrl:p.webAbsoluteUrl,listFullUrl:p.listFullUrl}));return Boolean(m&&o.e.hasItemPermission({permissions:d},o.e.editListItems)&&(null===(n=y)||void 0===n?void 0:n.enableMinorVersions)&&(null===(r=y)||void 0===r?void 0:r.isDocumentLibrary)&&!(null===(a=v)||void 0===a?void 0:a.byOther)&&!h.e(e,t)&&!(function(e,t){var n=t.itemKey,r=t.listFacets,s=e.demandItem({moderationStatusType:i.Ce},n).moderationStatusType;if(r&&r.isModerated)return"number"==typeof s&&s!==u.e.draft&&s!==u.e.denied&&s!==u.e.pending;var o=g(e,n);return 0===o.minor&&0!==o.major})(e,{itemKey:t,listFacets:y})&&!l.t(e,{itemKey:t,includeOneNote:!0}))}function v(e){return e?""+512*(Math.floor(Number(e)/512)+1):""}function m(e){return!!e&&0===e.indexOf(p)}function g(e,t){var n=e.demandItem({uiVersion:i.Mt},t).uiVersion;return Object(c.t)(n)}function y(e,t){var n,r=e.demandItem({firstItemKey:f.D,moderationStatusType:i.Ce},t),s=r.firstItemKey,o=r.moderationStatusType;return s?(null===(n=e.demandItemFacet(i.ye,f.U.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl})))||void 0===n?void 0:n.isModerated)?o===u.e.pending?a.e.CancelApproval:a.e.SubmitForApproval:h.t(e,t)?a.e.SchedulePublish:0===g(e,t).major?a.e.Publish:a.e.Republish:a.e.Publish}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.Publish=0]="Publish";e[e.Republish=1]="Republish";e[e.PostNews=2]="PostNews";e[e.UpdateNews=3]="UpdateNews";e[e.SubmitForApproval=4]="SubmitForApproval";e[e.CancelApproval=5]="CancelApproval";e[e.SchedulePublish=6]="SchedulePublish"})(r||(r={}))},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(3),s=n(4),o=n(1538),u=n(25);function a(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=n(Object(u.e)(function(t){return t.demandItemFacet(i.D,e)}));return[4,n(Object(o.demandItems)(function(t){return t.demandItem({listItemId:s.we},e)}))];case 1:a=r.sent().listItemId;if(!t)throw new Error("Cannot get spItemKeyFacet for itemKey: "+e);if(!(f=a||t.itemId))throw new Error("Cannot find itemId for itemKey: "+e);return[2,{key:t,itemId:f}]}})})}}}],Array(90),[function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(2),o=n(712),u=n(94),a=n(2525),f=n(9),l=n(28),c=n(16),h=n(46),p=n(840),d=n(156),v=n(2298),m=n(7),g=n(99),y=n(564),b=n(2849),w=n(62),E=new d.e("newDocument"),S=Object(y.e)()(v.e),x=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onItemOpened=function(){n.setState({fileCreated:!1,isItemOpened:!0})};n.state={newDocumentKey:E.serializeNext()};return n}t.prototype.render=function(){var e=this,t=this.state,n=t.newDocumentKey,s=t.fileCreated,o=t.isItemOpened,u=this.props,a=u.itemCacheDispatch,f=u.itemKey,c=u.parentFolderDriveItemUrl,h=u.action,d=Object(r.__rest)(u,["itemCacheDispatch","itemKey","parentFolderDriveItemUrl","action"]),v=h.availableOn,y=v&&v.file&&v.file.extensions&&v.file.extensions[0]&&v.file.extensions[0].replace(".",""),b=!!y&&!!h.handler,E=void 0;if(b&&y){var x=!h.handler.isPromoted;x&&!c||(E=function(){return Object(r.__awaiter)(e,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,a(Object(p.e)({items:(e={},e[f]={newDocumentKey:n,extension:y},e)}))];case 1:t.sent();x&&c&&a((i={newDocumentKey:n,parentFolderDriveItemUrl:c},function(e){var t,n=i.newDocumentKey,s=i.parentFolderDriveItemUrl,o=e(Object(g.e)({fileName:m.f},n));if(!o||!o.fileName)throw"FileHandler create action: fail to get file name of the new document";var u=s+":/"+o.fileName+":";e(Object(w.e)({items:(t={},t[n]=Object(r.__assign)({},m.B.pack(u)),t)}))}));this.setState({fileCreated:!0,isItemOpened:!1});return[2]}var i})})})}return s?o?null:i.createElement(S,Object(r.__assign)({},d,{onComplete:this._onItemOpened,isAvailable:!0,itemKeys:[n],action:h})):i.createElement(l.e,Object(r.__assign)({},d,{isAvailable:b,onExecute:E}))};return t})(i.Component),T=Object(c.i)()(Object(f.t)(function(e,t){var n=t.itemKey,i=t.action,s=e.demandItemFacet(b.e,n),o=b.e.evaluate(s)(e,{itemKey:n}).driveItemFullUrl,u=i.handler,a=u.appId,f=u.isPromoted?"PromotedFileHandlerCreate":"FileHandlerCreate",l={appId:a};return Object(r.__assign)(Object(r.__assign)({},Object(h.e)(e,{itemKey:n,engagement:{name:f,isIntentional:!0,extraData:l}})),{parentFolderDriveItemUrl:o||""})})(x));var N=Object(c.s)()(Object(f.t)(function(e,t){var n=t.itemKeys,i=t.action,s=i.availableOn,o=s.allowMultiSelect,u=void 0!==o&&o,a=n.length,f=u&&a>0||1===a;f&&(f=n.every(function(t){var n=e.demandItem({fileName:m.h,isFolder:m.d},t),r=n&&n.fileName,i=r&&r.extension||"",o=n&&n.isFolder||!1;return Object(v.t)(s,i,Boolean(o))}));var l=i.handler,c=l.appId,p=l.isPromoted?"PromotedFileHandlerCustom":"FileHandlerCustom",d={appId:c};return Object(r.__assign)({isAvailable:f},Object(h.e)(e,{itemKey:n[0],engagement:{name:p,isIntentional:!0,extraData:d}}))})(v.e)),C=n(3215),k=n(21),L=n(13),A=n(66),O=n(361),M="fileHandlerCommandIcon_62de156c",_=n(971),D=n(2520);n.d(t,"e",function(){return I});n.d(t,"t",function(){return q});var P=new s.e("fileHandlerOpenCommand").id,H=new s.e("fileHandlerCreateCommand").id,B=new s.e("fileHandlerCustomCommand").id,j=new s.e("fileHandlerAppCommand").id,F=new s.e("fileHandlerActionsCommand").id,I=function(e,t){var n=t.itemKey,r=t.collapseCustomCommands,i=e.demandItem({actions:O.t,version:O.a},n),s=i.actions,o=i.version;if(o&&4===o&&s){var u=function(t){var n=s&&s[t],r=e.demandItemFacet(L.e,n);return r&&r.itemKeys||[]};return{new:U(e,{actionKeys:u("create"),type:"create"})||[],open:U(e,{actionKeys:u("open"),type:"open"})||[],custom:U(e,{actionKeys:u("custom"),type:"custom",collapseCustomCommands:r})||[]}}},q=function(e,t,n){var r=n?t:e,i=n?e:t,s=r,o={};r.forEach(function(e){o[e.key]=!0});i.forEach(function(e){o[e.key]||s.push(e)});return s};function R(e,t){var n,r,s,f,l,c=t.itemKey,h=t.type,p=t.CustomAction,d=void 0,v=void 0;if("app"===h){d=c;if(!(D=c&&e.demandItem({displayName:m.f,appIcon:O.n},c)))return;s=j+"-"+c;f="itemsScopefileHandlerAppCommand";n=D.displayName;D.appIcon&&D.appIcon.url&&(r={iconType:o.e.Image,className:M,imageProps:{src:D.appIcon&&D.appIcon.url||"",title:D.displayName||"",imageFit:u.t.contain,className:M}})}else{var g=e.demandItem({displayName:m.f,handlerKey:O.o,availableOn:O.e,icon:O.i,isPromoted:O.s},c),y=g.displayName,b=g.handlerKey,w=g.availableOn,E=g.icon;v=g.isPromoted;var S=b&&e.demandItemFacet(O.n,b),x="open"===h&&S||E;x&&x.url&&(r={iconType:o.e.Image,className:M,imageProps:{src:x&&x.url,title:x&&x.displayName,imageFit:u.t.contain,className:M}});var L=Object(_.e)(e,{itemKey:c});n=y;switch(h){case"open":if(!n&&b){var D;n=(D=c&&e.demandItem({displayName:m.f},b))&&D.displayName&&k.format(C.e.openWithCommand,D.displayName)}s=P;f="itemsScopefileHandlerOpenCommand";l=p?i.createElement(p,{action:L}):i.createElement(a.e,{action:L});break;case"create":n||(n=E&&E.displayName||w&&w.file&&w.file.extensions&&k.format(C.e.createFileWithExtension,w.file.extensions[0])||"");s=H;f="itemsScopefileHandlerCreateCommand";l=i.createElement(A.e,null,i.createElement(T,{action:L}));break;case"custom":s=B;f="itemsScopefileHandlerCustomCommand";y&&(f=y.toLowerCase().replace(/\s+(.)/g,function(e,t){return t.toUpperCase()})+"Command");l=p?i.createElement(p,{action:L}):i.createElement(N,{action:L})}s+="-"+c;d=b}if(s&&n)return{key:s,automationId:f,name:n,iconProps:r,action:l,handlerKey:d,isPromoted:v,fileHandlerType:h}}function U(e,t){var n=t.actionKeys,i=t.type,s=t.collapseCustomCommands,o=void 0===s||s,u=[];if("open"===i){var f=e.demandItemFacet(D.n,n[0]),l=D.n.evaluate(f)(e,{openActionAs:a.e}).openActionAs;n.forEach(function(t){var n=R(e,{itemKey:t,type:i,CustomAction:l});n&&u.push(n)})}else if("create"===i)n.forEach(function(t){var n=R(e,{itemKey:t,type:i});n&&u.push(n)});else if("custom"===i){f=e.demandItemFacet(D.t,n[0]);var c=D.t.evaluate(f)(e,{customActionAs:N}).customActionAs,h=(function(e,t){var n=t.actionKeys,i=t.collapseCustomCommands,s=t.CustomAction,o=void 0,u=[],a={},f=function(t){return R(e,{itemKey:t,type:"custom",CustomAction:s})},l=function(t,n){var r=R(e,{itemKey:t,type:"app"});r&&n&&n.length>0&&(r.subMenuProps={items:n});return r};if(i){for(var c=0,h=n;c<h.length;c++){var p=h[c],d=f(p);if(d){var v=d.handlerKey||"";if(o){if(!o.subMenuProps){var m=Object(r.__assign)({},o),g=Object.keys(a)[0];if(E=l(g)){o=E;if(v===g){E.subMenuProps={items:[m,d]};continue}}}var y=Object.keys(a).length;if(void 0!==a[v]){var b=o.subMenuProps;if(1===y)b&&b.items.push(d);else{var w=a[v];if(b){var E;(E=b.items[w]).subMenuProps&&E.subMenuProps.items.push(d)}}}else{var S=l(v,[d]);if(!S)continue;if(1===y){var x=Object(r.__assign)({},o);o={key:""+F,automationId:"itemsScopefileHandlerActionsCommand",name:C.e.fileHandlerRootActionsMenu,iconProps:{iconName:"SetAction",ariaLabel:C.e.fileHandlerRootActionsMenuAriaLabel,className:M},subMenuProps:{items:[x,S]}};a[v]=1}else{o.subMenuProps&&o.subMenuProps.items.push(S);a[v]=y}}}else{o=d;a[v]=0}}}o&&(u=[o])}else for(var T=0,N=function(e){var t=f(e);if(!t)return"continue";var n=t.handlerKey||"",i=l(n,[t]),s=!1;if(i){Object.keys(a).forEach(function(e){if(n===e){s=!0;var i=u[a[e]];i.subMenuProps&&(i.subMenuProps={items:Object(r.__spreadArrays)(i.subMenuProps.items,[t])})}});if(!s){a[n]=T;T++;u.push(i)}}else{a[n]=T;T++;u.push(t)}},k=0,L=n;k<L.length;k++){p=L[k];N(p)}return u})(e,{actionKeys:n,collapseCustomCommands:o,CustomAction:c});h&&u.push.apply(u,h)}return u}}],Array(25),[function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(9),o=n(16),u=n(28),a=n(3749),f=n(3522),l=n(1132),c=n(3797),h=n(919),p=n(2520),d=n(99),v=n(7),m=n(2858),g=n(1418),y=n(2007);function b(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.appId,i=e.itemKeys,s=e.getPreAuthUrl,o=e.driveUrl;if(!s)return[2,i.map(function(e){return n(Object(d.e)({vroomUrl:v.B},e)).vroomUrl||""})];u=i.map(function(e){return n(Object(d.e)({fullUrl:v.i},e)).fullUrl||""});return[4,n(Object(y.e)(o,o))];case 1:a=r.sent();return[2,new m.e({},{dataRequestor:n(g.e).dataRequestor}).getPreAuthUrls({appId:t,items:u,accessToken:a,driveUrl:o})]}})})}}var w=n(177),E=n(3216),S=n(144),x=n(2006),T=n(20);n.d(t,"e",function(){return C});n.d(t,"t",function(){return k});var N=Object(s.i)(function(e,t){var n,s=t.itemKeys,o=t.action,d=t.isAvailable,v=t.itemKey,m=o.handler,g=m.appId,y=m.isPromoted,N="",C=v||(1===s.length?s[0]:""),k=e.demandItem({controlHandler:p.e,driveItemKey:S.e},C),L=k.controlHandler,A=k.driveItemKey;(N=A&&Object(x.n)(A)||"").indexOf("/v2.1")>-1&&(N=N.replace("/v2.1","/v2.0"));var O=p.e.evaluate(L)(e,{itemKey:C}).sharedPostData;n=O;var M=e.dispatch;if(!(d&&o.url&&n&&N))return null;var _=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e,t,i;return Object(r.__generator)(this,function(u){switch(u.label){case 0:e=window.open("","_blank");return[4,M(b({appId:g,itemKeys:s,getPreAuthUrl:!y,driveUrl:N})).catch(function(){})];case 1:if((t=u.sent())&&t.length>0&&e&&e.document){e.opener=null;i=JSON.stringify(t||[]);Object(h.e)({url:o.url,postdata:Object(r.__assign)(Object(r.__assign)({},n),{appId:g,items:i}),document:e.document})}else e&&e.close();return[2]}})})},D=y?Object(T.o)(function(e){var t=e.resolve,n=e.reject,s=function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){n(new w.e);return[2]})})};return i.createElement(a.e,{dialogContentProps:{title:E.e.consentDialogTitle,onDismiss:s},hidden:!1},i.createElement("p",null,E.e.consentDialogMessage),i.createElement(f.e,null,i.createElement(l.e,{onClick:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:t();return[4,_()];case 1:e.sent();return[2]}})})}},E.e.consentDialogContinueButton),i.createElement(c.e,{onClick:s},E.e.consentDialogCancelButton)))}):_;return i.createElement(u.e,Object(r.__assign)({isAvailable:d,onExecute:D},t))}),C=Object(o.e)()(N);function k(e,t,n){var r=e.file,i=e.folder,s=e.file&&e.file.extensions||void 0;return!0===n?!!i:!(!r||!t)&&(!s||-1!==s.indexOf(t.toLowerCase())||-1!==s.indexOf("*")||-1!==s.indexOf(".*"))}}],Array(17),[function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});n.d(t,"e",function(){return f});var r=n(0),i=n(2),s=n(327),o=n(111),u=new i.e("moveCopyItems"),a=new o.e("moveCopyItems"),f=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}return t})(s.e)},function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(11),i=new r.e("progressListGroupControl",{}),s=new r.e("progressListControl",{groupControlHandler:Object(r.n)(i)})}],Array(22),[function(e,t,n){"use strict";n.d(t,"t",function(){return s});var r=n(2),i=n(64),s=new r.e("pinSite"),o=Object(i.i)({operationTypeFacet:s});t.e=o},function(e,t,n){"use strict";n.d(t,"n",function(){return r});n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});var r="root",i="/drive/root:",s=30},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("thumbnailToken",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0})})},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(3),s=n(2498),o=n(19),u=n(99),a=n(1868),f=n(2),l=n(69),c=n(13),h=n(56),p=n(2835),d=n(275),v=n(54),m=n(4),g=Object(o.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,o=e.options.sourceEntries,g=i.D.deserialize(n),y=g.webAbsoluteUrl,b=g.listFullUrl,w=Object.keys(o)[0],E=o[w].progressItemKey;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,S,x,T,N,C,k,L,A,O;return Object(r.__generator)(this,function(M){switch(M.label){case 0:t=o(Object(u.e)({sourceFile:a.t},w)).sourceFile;S=o(Object(v.e)({listItemUploader:m.Ee})).listItemUploader,x=void 0===S?s.e:S;return[4,o(x(e))];case 1:T=M.sent().itemKey;N=new h.e;E&&t&&N.resolveItems({items:(L={},L[E]=Object(r.__assign)(Object(r.__assign)({},l.s.pack({itemKey:T})),Object(f.r)({progressSize:l.v},{progressSize:{current:t.size}})),L)});N.invalidateItems({items:(A={},A[n]=[c.t],A)});if(g.listFullUrl){C=new d.e(g.listFullUrl+"/Forms").path;if(g.rootFolder&&(g.rootFolder+"/").slice(0,C.length+1)===C+"/"){k=i.U.serialize({webAbsoluteUrl:y,listFullUrl:b});o(Object(p.e)({items:(O={},O[k]={childItemKey:T},O)}))}}o(N.execute());return[2]}})})}})},function(e,t,n){"use strict";n.d(t,"t",function(){return N});n.d(t,"e",function(){return C});var r=n(0),i=n(275),s=n(3),o=n(4),u=n(247),a=n(277),f=n(327),l=n(99),c=n(62),h=n(172),p=n(19),d=n(69),v=n(13),m=n(7),g=n(3164),y=n(230),b=n(31),w=-2147023080,E=-2130575282,S="-2130575257",x="-2130575245",T="-2130247139",N=Object(p.i)({mergeForSameItemKey:!1,maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,p=e.options.folders;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,g,y,w,E,N,L,A,O,M,_;return Object(r.__generator)(this,function(D){switch(D.label){case 0:t=Object.keys(p)[0];g=s.D.deserialize(n);y=g.rootFolder||new i.e(g.listFullUrl).path;w=s.U.serialize({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl});E=e(Object(l.e)({list:o.ye},w));N=C({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl,parentFolderPath:y,isDocLib:!!E&&!!E.list&&E.list.isDocumentLibrary,folderName:t});return[4,e(Object(u.t)({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl,url:N,method:"POST",qosName:"createFolder",telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var i=t.code,s=i&&(i.indexOf(S)>-1||i.indexOf(x)>-1||i.indexOf(T)>-1)?b.t.expectedFailure:b.t.failure;return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultType:s})}}return{eventData:n}}})).catch(function(e){if(e instanceof a.e&&e.message&&y){var t=y;"/"===t[0]&&(t=t.substr(1));"/"!==t[t.length-1]&&(t+="/");e.message=e.message.replace(t,"")}throw new f.e({innerError:e,facets:k(e)})})];case 1:D.sent();if(L=p[t].progressItemKey){A=y+"/"+t;O=s.D.serialize({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:g.listFullUrl,rootFolder:A});e(Object(c.e)({items:(M={},M[L]=Object(r.__assign)({},d.s.pack({itemKey:O})),M[O]=Object(r.__assign)(Object(r.__assign)({},o.Q.pack(A)),m.A.pack({itemKey:n})),M)}))}e(Object(h.t)({items:(_={},_[n]=[v.t],_)}));return[2]}})})}});function C(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.parentFolderPath,i=e.isDocLib,s=void 0===i||i,o=e.folderName,u=Object(g.r)({webAbsoluteUrl:t,listOrItemFullUrl:n}),a=o?o.trim():"";return(u=s?(u=u.segment("folders")).methodWithAliases("AddUsingPath",{DecodedUrl:r+"/"+a,overwrite:!1}).oDataParameter("$Expand","ListItemAllFields/PermMask"):u.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:r}).methodWithAliases("AddSubFolderUsingPath",{DecodedUrl:a||"Folder"+(Math.floor(100*Math.random())+1)})).toString()}function k(e){if(e instanceof a.e){switch((function(e){var t=e.errorData.code;return(void 0===t?"":t).split(",").map(function(e){return Number(e)})[0]})(e)){case w:case E:return y.p.pack({})}}}},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r,i=n(21),s=n(3211);(function(e){e[e.InvalidStart=0]="InvalidStart";e[e.InvalidEnd=1]="InvalidEnd";e[e.InvalidCharacters=2]="InvalidCharacters";e[e.Empty=3]="Empty"})(r||(r={}));function o(e){return function(t){return(function(e,t){switch(e){case r.InvalidCharacters:return i.format(s.e.invalidNameError,t.invalidCharacters);case r.InvalidStart:return i.format(s.e.invalidNameStartError,t.cannotStartWith);case r.InvalidEnd:return i.format(s.e.invalidNameEndError,t.cannotEndWith);case r.Empty:return s.e.emptyNameError;case void 0:return}})((function(e,t){var n=e.trim();return 0===n.length?r.Empty:t.invalidCharactersRegex.test(n)?r.InvalidCharacters:t.cannotStartWithRegex&&t.cannotStartWithRegex.test(n)?r.InvalidStart:t.cannotEndWithRegex&&t.cannotEndWithRegex.test(n)?r.InvalidEnd:void 0})(t,e),e)}}var u=o({invalidCharactersRegex:/["\*:<>\?\/\\\|]/,invalidCharacters:'" * : < > ? / \\ |'}),a=o({invalidCharactersRegex:/["\*:<>\?\/\\\|#%]/,invalidCharacters:'" * : < > ? / \\ # %|'})},function(e,t,n){"use strict";n.d(t,"n",function(){return s});n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=n(2),i=n(111),s=new r.e("removeItemsFromSharedList"),o=new i.e("removeItemsFromSharedList"),u=Object(i.s)({operationTypeFacet:s,progressKeyFacet:o})},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1),s=n(2),o=n(344),u=n(859),a={key:new s.e("openInOfficeOnline").id,automationId:"openInOfficeOnlineCommand",action:i.createElement(u.t,null),facets:Object(r.__assign)({},o.e.pack(!0))}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(1),s=n(2),o=n(344),u=n(842),a={key:new s.e("openInOfficeClient").id,automationId:"openInOfficeClientCommand",action:i.createElement(u.n,null),facets:Object(r.__assign)({},o.e.pack(!0))}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return g});n.d(t,"t",function(){return y});var r=n(0),i=n(1),s=n(16),o=n(28),u=n(62),a=n(13),f=n(3),l=n(4),c=n(388),h=n(20),p=n(346),d=n(172),v=n(46),m=n(9),g=Object(m.i)(function(e,t){var n=t.itemKey,s=t.itemSetKey,m=t.viewId,g=t.currentDerivedView,y=e.demandItemFacet(f.D,n);if(!y)return null;var b=y.webAbsoluteUrl,w=y.listFullUrl,E=e.demandItemFacet(f.S,s),S=f.S.serialize({webAbsoluteUrl:b,listFullUrl:w,rootFolder:E&&E.rootFolder||"",viewKey:{viewId:m}}),x=g&&f.oe.serialize({viewId:g.id}),T=e.isItemFacetResolved(l.Je,x)?e.demandItemFacet(l.Je,x):void 0,N=Object(v.e)(e,{itemKey:n,engagement:{name:"SwitchView",isIntentional:!0}}),C=e.dispatch,k=Object(h.i)(e,i.createElement(p.e,{itemKey:S}));return i.createElement(h.n,{action:k},function(e){var t=e.isAvailable,s=e.execute;return i.createElement(o.e,Object(r.__assign)({isAvailable:t,isToggled:g?m===g.id:""===m,onExecute:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i,o;return Object(r.__generator)(this,function(f){switch(f.label){case 0:C(Object(u.e)({items:Object(r.__assign)(Object(r.__assign)({},x?(t={},t[x]=Object(r.__assign)(Object(r.__assign)({},l.Ke.pack(!1)),T&&g&&g.isDirty()?Object(r.__assign)({},l.p.pack(new c.e(T))):{}),t):{}),n?(i={},i[S]=Object(r.__assign)({},a.i.pack({itemKey:n})),i):{})}));x&&g&&g.isDirty()&&C(Object(d.t)({items:(o={},o[x]=[l.Je,l.p],o)}));return[4,s(e)];case 1:f.sent();return[2]}})})}},N))})}),y=Object(s.e)()(g)}],Array(75),[function(e,t,n){"use strict";var r=n(1),i=n(290),s=n(2),o=n(571),u=n(391),a=n(27),f=n(0),l=n(16),c=n(9),h=n(28),p=n(3),d=n(4),v=n(24),m=n(886),g=n(483),y=n(51),b=n(46),w=n(50),E=function(){return Object(f.__awaiter)(void 0,void 0,void 0,function(){return Object(f.__generator)(this,function(e){return[2]})})},S=Object(l.s)()(Object(l.r)()(Object(c.t)(function(e,t){var n=t.itemKey,r=t.isEditForm,i=!1,s=E;if(Object(w.e)(e,{enableEditOrViewItemCommandConfiguration:d.S}).enableEditOrViewItemCommandConfiguration){var o=e.demandItem({key:p.D,itemId:d.we,contentTypeId:d.c,permissions:d.Fe},n),u=o.key,a=o.itemId,l=o.contentTypeId,c=o.permissions;if(u&&a&&(!r||c&&y.t.hasItemPermission({permissions:c},y.t.editListItems))){var h=u&&e.demandItemFacet(d.Et,p.Z.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl}));if(h&&!h.isAnonymousGuestUser){var S=e.demandItem({list:d.ye,listFormUrls:d.be},p.U.serialize({webAbsoluteUrl:u.webAbsoluteUrl,listFullUrl:u.listFullUrl})),x=S.list,T=S.listFormUrls,N=T?r?T.editFormUrl:T.displayFormUrl:void 0;if(x&&T&&x.templateType&&x.templateType!==v.n.mySiteDocumentLibrary&&N){var C=Object(m.e)(N,u.rootFolder||new g.e(u.listFullUrl).path,a,l);i=!0;s=function(){return Object(f.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(f.__generator)(this,function(t){(e=window.open(C,"_blank"))&&e.focus();return[2]})})}}}}}return Object(f.__assign)({isAvailable:i,onExecute:s},Object(b.e)(e,{itemKey:n,engagement:{name:r?"OpenItemEditForm":"OpenItemDisplayForm",isIntentional:!0}}))})(h.e))),x=n(2853),T=n(500),N=n(884),C=n(507);n.d(t,"t",function(){return k});n.d(t,"e",function(){return A});var k={key:new s.e("ViewItem").id,name:a.e.Open,action:r.createElement(S,null)},L={key:new s.e("EditItem").id,name:i.e.Edit,action:r.createElement(x.e,null),iconProps:{iconName:"Edit"}};function A(e){return[N.e,Object(C.e)(e),L,u.n,u.t,o.e,T.e]}},function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(3141),o=n(2),u=n(344),a=n(799),f=n(16),l=n(28),c=n(593),h=n(9),p=n(4),d=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.canOpenInOffice?i.createElement(l.e,null):i.createElement(c.t,null)};return t})(i.PureComponent);var v=Object(h.t)(function(e,t){var n=t.itemKey;return{canOpenInOffice:!!e.demandItem({appMap:p.Pe},n).appMap}})(d),m=Object(f.s)()(Object(f.r)()(v)),g=n(2348),y=n(2347);n.d(t,"t",function(){return b});n.d(t,"e",function(){return w});var b={key:a.e.key,automationId:a.e.automationId,name:a.e.name,subMenuProps:{items:[y.e,g.e],contextualMenuItemAs:s.t},facets:Object(r.__assign)({},u.e.pack(!0))},w={key:new o.e("fallbackOpen").id,automationId:"fallbackOpen",name:a.e.name,action:i.createElement(m,null),facets:Object(r.__assign)({},u.e.pack(!0))}},,,,,function(e,t,n){"use strict";var r=n(0),i=n(247),s=n(123),o=n(275),u=n(2431),a=n(296),f=n(19),l=n(62),c=n(7),h=n(172),p=n(13),d=n(174),v=n(119),m=n(4),g=n(295),y=n(2459),b=n(3164),w=n(2293),E=n(143),S=n(99),x=n(22),T=n(3),N=n(64),C=n(2836),k=Object(N.i)({operationTypeFacet:C.e}),L=n(59),A=n(25);n.d(t,"n",function(){return D});n.d(t,"t",function(){return P});n.d(t,"e",function(){return H});var O={ODB:1561},M={ODB:1234},_=!1,D=Object(f.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,u=e.options,f=u.documentType,N=u.fileName,C=u.newDocumentKey,D=u.templateItemKey,j=u.targetWindow;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue,ae,fe,le,ce,he,pe;return Object(r.__generator)(this,function(de){switch(de.label){case 0:t=T.D.deserialize(n);u=t.rootFolder||new o.e(t.listFullUrl).path;F=new s.t({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}});I=F.getUrlParts({path:u});q=new E.e(null);R=e(Object(S.e)({createDocumentFormDigest:m.tt,spCookieDomainConfiguration:m.et},x.n)),U=R.createDocumentFormDigest,z=R.spCookieDomainConfiguration;W=!z||new o.e(z).authority!==new o.e(t.webAbsoluteUrl).authority;_=e(Object(A.e)(function(e){return Object(L.e)(e,{feature:M})}));if(D||!U||W||!(f===a.e.Word||f===a.e.PowerPoint||f===a.e.Bohemia||f===a.e.Prague||f===a.e.Visio&&_))return[3,5];"_layouts/15";X=f===a.e.Prague?"prague":"doc";V=t.webAbsoluteUrl+"/_layouts/15/"+X+".aspx";if(!e(Object(A.e)(function(e){return Object(L.e)(e,{feature:O})})))return[3,2];$=e(Object(S.e)({folderUniqueId:m._t},n)).folderUniqueId;return[4,w.e(f,V,t.webAbsoluteUrl,q,j,N,I,void 0,$)];case 1:de.sent();return[3,4];case 2:return[4,w.e(f,V,t.webAbsoluteUrl,q,j,N,I)];case 3:de.sent();de.label=4;case 4:e(Object(h.t)({items:(le={},le[n]=[p.t],le)}));return[3,11];case 5:J="";K=void 0;if(Q=e(Object(A.e)(function(e){return e.demandItemFacet(T.V,D)})))if((G=e(Object(S.e)({documentTemplate:m.Oe},D)).documentTemplate)&&G.url){K=G;J=G.url}else J=Q.templateUrl;Y=H({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:I.listRelativeItemUrl||"",docType:f,docName:N,templateUrl:J});return[4,e(Object(i.t)({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:Y,method:"POST",parseResponse:function(e){return e},qosName:"createDocument",noRedirect:!0}))];case 6:Z=de.sent();ee=P({responseText:Z,documentType:f,fileName:N}),te=ee.redirectUrl;if(!(ne=ee.originalEditLink))return[3,10];re=v.e(v.t(ne.toLowerCase()));ie=re.sourcedoc;se=ie&&Object(g.normalizeLower)(ie);oe=Object(y.t)(f);if(!(ue=K)||!ue.url)return[3,9];ae=(function(e){var t=e.listFullUrl,n=e.uniqueId,r=e.webAbsoluteUrl;return Object(b.e)({webAbsoluteUrl:r,listFullUrl:t}).methodWithAliases("GetItemByUniqueId",{uniqueId:n}).toString()})({listFullUrl:t.listFullUrl,webAbsoluteUrl:t.webAbsoluteUrl,uniqueId:se});return[4,e(Object(i.t)({listFullUrl:t.listFullUrl,webAbsoluteUrl:t.webAbsoluteUrl,url:ae,method:"POST",parseResponse:B,qosName:"getItemByUniqueId",noRedirect:!0}))];case 7:return(fe=de.sent())?[4,e(k({items:(ce={},ce[T.D.serialize({itemId:fe,listFullUrl:t.listFullUrl,webAbsoluteUrl:t.webAbsoluteUrl})]={formValues:[{FieldName:"ContentTypeId",FieldValue:ue.contentTypeId||""}],qosName:"updateTemplateDocContentType"},ce)}))]:[3,9];case 8:de.sent();de.label=9;case 9:e(Object(l.e)({items:(he={},he[C]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},te?c.L.pack(te):{}),c.h.pack({name:N||"",extension:oe})),se?m._t.pack(se):{}),d.n.pack(f===a.e.OneNote?{}:void 0)),p.i.pack({itemKey:n})),he)}));de.label=10;case 10:e(Object(h.t)({items:(pe={},pe[n]=[p.t],pe)}));de.label=11;case 11:return[2]}})})}});function P(e){var t=e.responseText,n=e.documentType,r=e.fileName,i="",s="";if(null!=t){var o=JSON.parse(t);if(null!==o&&null!==o.d&&null!==o.d.CreateDocumentAndGetEditLink){s=o.d.CreateDocumentAndGetEditLink;i=Object(u.t)(s,n,r||"",!1)}else try{s=(new DOMParser).parseFromString(t,"text/xml").getElementsByTagName("d:CreateDocumentAndGetEditLink")[0].textContent||"";i=Object(u.t)(s,n,r||"",!1)}catch(e){}}return{originalEditLink:s,redirectUrl:i}}function H(e){var t=a.e.Visio,n=e.webAbsoluteUrl,r=e.listFullUrl,i=e.parentFolderPath,s=e.templateUrl,o=e.docName,u=e.docType;if(null!==u&&u>=a.e.Word&&u<=t&&u!==a.e.Text){if(u!==a.e.OneNote||o){if(o){o+=Object(y.t)(u)}}else o="Notebook"+Math.floor(100*Math.random())+1;o||(o="");u===a.e.ExcelForm&&(u=a.e.ExcelSurvey);return Object(b.e)({webAbsoluteUrl:n,listFullUrl:r}).methodWithAliases("CreateDocumentAndGetEditLink",{fileName:o,folderPath:i,documentTemplateType:u,templateUrl:s||""}).toString()}throw new Error("document type is not valid, here are the valid type: 1 - Word, 2 - Excel,\n    3 - PowerPoint, 4 - OneNote, 5 - Excel Survey, 7 - ExcelForm, 8 - Visio")}function B(e){if(e)try{var t=JSON.parse(e);if(t&&t.d&&t.d.Id)return t.d.Id}catch(e){}return""}},,,function(e,t,n){"use strict";var r=n(137),i=n(1),s=n(984),o=n(7),u=n(20),a=n(557),f=n(275),l=n(9);var c=n(202),h=n(47),p=n(614),d=n(612),v=n(602),m=n(603),g=n(601);n.d(t,"e",function(){return y});var y=Object(p.e)({key:c.r,name:r.e.Name,fieldName:"",isCollapsible:!1,minWidth:445,maxWidth:445,sortProps:h.r},[d.e,g.e,function(e,t){var n=t.itemKey,r=t.renderer,c=e.demandItemFacet(o.A,n),h=c&&e.demandItemFacet(o.L,c.itemKey)||"",p=h?(function(e){for(var t=[],n=new f.e(e),r=0,i=n.segments.slice(1);r<i.length;r++){var s=i[r];try{t.push(decodeURIComponent(s))}catch(e){t.push(s)}}return t})(h):[],d=c&&h?Object(l.s)(e,i.createElement(a.e,{itemKey:c.itemKey})):null;return{renderer:function(e,t,n){var o=r?r(e,t,n):null;return i.createElement(i.Fragment,null,o?i.createElement(i.Fragment,{key:"content"},o):null,d?i.createElement(u.n,{key:"path",action:d},function(e){var t=e.execute,n=e.isAvailable?function(e){t({event:e}).catch(function(){});e.preventDefault();e.stopPropagation()}:void 0;return i.createElement(s.e,{displayPathSegments:p,parentLink:h,onClick:n})}):null)}}},v.e,m.e])}],Array(21),[function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});var r=n(296);function i(e){switch(e){case r.e.Word:return".docx";case r.e.Excel:case r.e.ExcelSurvey:case r.e.ExcelForm:return".xlsx";case r.e.PowerPoint:return".pptx";case r.e.OneNote:return"";case r.e.Text:return".txt";case r.e.Visio:return".vsdx";case r.e.Bohemia:return".b";case r.e.Prague:return".prague"}}function s(e,t){var n="";switch(e){case r.e.Word:n=t.CreateWord;break;case r.e.Excel:n=t.CreateExcel;break;case r.e.PowerPoint:n=t.CreatePowerPoint;break;case r.e.OneNote:n=t.CreateOneNote;break;case r.e.ExcelSurvey:n=t.CreateExcelSurvey;break;case r.e.Text:n=t.CreateText;break;case r.e.ExcelForm:n=t.CreateFormForExcel;break;case r.e.Visio:n=t.CreateVisio;break;case r.e.Bohemia:n=t.CreateBohemia;break;case r.e.Prague:n=t.CreatePrague}return n}},function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(1),i=n(988),s=n(140),o=n(86),u=0;function a(e){var t=e.isDefault,n=void 0!==t&&t,o=r.useState(""+ ++u)[0],a=r.useContext(i.e),l=r.useRef(),c=l.current||n&&a.keyboardManager||(l.current=new i.t({isDefault:!1,id:o,parent:a.keyboardManager})),h=f(c),p=h.isActive,d=h.isChildActive;r.useEffect(function(){return function(){if(!n){c.setIsActive(!1);c.dispose()}}},[]);var v=r.useMemo(function(){return{keyboardManager:c}},[c]);return r.createElement("div",{"data-keyboard-zone-id":o},r.createElement(i.e.Provider,{value:v},Object(s.t)(e.children,{isActive:p,isChildActive:d})))}function f(e){var t=r.useState(function(){return e.getIsActive()}),n=t[0],i=t[1],s=r.useState(function(){return e.hasActiveChildren()}),u=s[0],a=s[1];r.useEffect(function(){var t=new o.e(null);t.on(e,"change",function(){i(e.getIsActive());a(e.hasActiveChildren())});return function(){t.dispose()}},[]);return{isActive:n,isChildActive:u}}}],Array(27),[function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(102),i=Object(r.e)(function(e){return{}})},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=n(111),s=new r.e("assignItemToGroup"),o=new i.e("assignToGroup")},,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return N});var r=n(0),i=n(3),s=n(3520),o=n(247),u=n(4),a=n(182),f=n(817),l=n(99),c=n(1868),h=n(62),p=n(2),d=n(69),v=n(3164),m=n(25),g=n(17),y=n(177),b=n(230),w=n(2821),E=n(1679),S=n(1498),x=n(7),T=n(24);function N(e){var t=this,n=e.itemKey,S=e.options.sourceEntries,N=i.D.deserialize(n),k=N.webAbsoluteUrl,L=N.listFullUrl,A=Object.keys(S)[0],O=S[A],M=O.progressItemKey,_=O.conflictResolution;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,S,O,D,P,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee;return Object(r.__generator)(this,function(te){switch(te.label){case 0:t=e(Object(o.n)({webAbsoluteUrl:k,listFullUrl:L})),S=t.dataRequestor,O=t.hasDigest;if(!t.hasTokenProvider)return[3,1];P=void 0;return[3,3];case 1:return[4,e(Object(o.e)({url:k||L,disallowCookies:!O}))];case 2:P=te.sent();te.label=3;case 3:D=P;H=e(Object(l.e)({sourceFile:c.t},A)).sourceFile;B=e(Object(l.e)({folderPath:u.Q},n)).folderPath,j=void 0===B?N.rootFolder:B;if(!H)throw new Error("No source file for upload.");if(!j)throw new Error("No path information for target folder.");F=Object(v.r)({webAbsoluteUrl:k,listOrItemFullUrl:L});I=new a.e(void 0);q=I.debounce(function(t){var n;M&&e(Object(h.e)({items:(n={},n[M]=Object(p.r)({progressSize:d.v},{progressSize:{current:t}}),n)}))},300,{leading:!1});R=e(Object(m.e)(function(e){return e.demandItemFacet(u.ye,i.U.serialize({webAbsoluteUrl:k,listFullUrl:L}))}));U=R&&R.contentTypesEnabled&&R.templateType!==T.t.mySiteDocumentLibrary;(z=new s.e({authToken:D,dataRequestor:S,parentItemKey:"",targetItemKey:"",fileUpload:H,iconName:"",serverRelativeItemUrl:j,webApiUrl:F,onProgress:q,expandAllItemFields:U})).nameConflictBehavior="replace"===_?1:0;M&&e(Object(h.e)({items:(Z={},Z[M]=Object(r.__assign)({},d.v.pack({total:H.size,current:0})),Z)}));W=z.start();X=e(Object(m.e)(function(e){return e.demandItemFacet(d.i,M)}));V=X?X.token.subscribe(function(){z.abort()}):void 0;te.label=4;case 4:te.trys.push([4,6,7,8]);return[4,W];case 5:te.sent();return[3,8];case 6:$=te.sent();z.abort();if(g.n.isCanceled($))throw new y.e;if($ instanceof E.e)throw new f.e({facets:C($),innerError:$});if(Object(w.t)($))throw new f.e({facets:Object(r.__assign)(Object(r.__assign)({},"-2130575257"===$.code?Object(r.__assign)({},b.n.pack({supportsRename:!1})):Object(r.__assign)({},b.d.pack({}))),u.it.pack($)),message:Object(w.e)($)});throw $;case 7:V&&V();z.dispose();return[7];case 8:J=z.item;K=J.properties;Q=K&&K.ID||J.id;G=K&&K.uniqueId;Y=i.D.serialize({webAbsoluteUrl:k,listFullUrl:L,itemId:Q});e(Object(h.e)({items:(ee={},ee[Y]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},x.f.pack(J.displayName)),G?u._t.pack(G):{}),x.A.pack({itemKey:n})),ee)}));return[2,{itemKey:Y}]}})})}}function C(e){switch(e.errorType){case S.e.conflict:return Object(r.__assign)({},b.n.pack({supportsRename:!1}));case S.e.accessDenied:return Object(r.__assign)({},b.e.pack({}));case S.e.disconnected:return Object(r.__assign)({},b.h.pack({}));case S.e.emptyFileOrFolder:case S.e.emptyFileOrFolderForDocLib:return Object(r.__assign)({},b.r.pack({}));case S.e.folderUploadNotSupported:return Object(r.__assign)({},b.o.pack({}));case S.e.invalidName:return Object(r.__assign)({},b.a.pack({}));case S.e.lockMismatch:return Object(r.__assign)({},b.l.pack({}));case S.e.malwareDetected:return Object(r.__assign)({},b.c.pack({}));case S.e.overQuota:return Object(r.__assign)({},b.p.pack({}));case S.e.targetFolderMissing:return Object(r.__assign)({},b.v.pack({}));case S.e.throttled:return Object(r.__assign)({},b.m.pack({}));case S.e.versionMismatch:return Object(r.__assign)({},b.g.pack({}))}return Object(r.__assign)({},b.d.pack({}))}},function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointItemByFullUrlAddon",function(){return C});var r=n(0),i=n(19),s=n(64),o=n(56),u=n(275),a=n(35),f=n(444),l=n(983),c=n(15),h=n(3),p=n(62),d=n(146),v=n(779),m=n(4),g=n(7),y=n(13),b=n(252),w=n(217),E=n(485),S=n(99),x=n(238),T=n(299),N=n(255),C=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(p.t)({keyFacet:h.M,facets:[h.D,g.f,g.h,m._t,g.d,m.Q,y.t,m.Te,x.e,x.t,m.Fe,g.i]}));e(Object(s.o)(h.M,d.e)(Object(i.i)({maxParallelOperationCount:8})(k)));return[2]})})}});function k(e){var t=this,n=e.itemKey,i=h.M.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,p,d,g,x,C,k,L,A,O,M,_,D,P,H,B,j,F,I;return Object(r.__generator)(this,function(q){switch(q.label){case 0:t=new o.e;s=!1;p=new u.e(i.itemFullUrl);d=e((function(e,t,n){return function(r){var i,s,o=e.itemFullUrl,a=new u.e(o);s=c.e.isActivated("ca2adcfe-ec7f-4e6b-a8ca-7023c151d026","1/8/2020","Adding more fields to GetListDataAsStream")?["File_x0020_Type","FileRef","FileLeafRef"]:["File_x0020_Type","FileRef","FileLeafRef","_ip_UnifiedCompliancePolicyUIAction","_ComplianceFlags","CheckoutUser","CheckedOutUserId","Created_x0020_Date.ifnew"];i=[a.path];var f=r(Object(S.e)({contentTypeId:m.c},h.M.serialize(e)));if(t&&t.length>0&&f&&f.contentTypeId)for(var l=0,p=t;l<p.length;l++){var d=p[l];if(d.contentTypeId===f.contentTypeId&&d.Fields)for(var v=0,g=d.Fields.split(",");v<g.length;v++){var y=g[v];"Modified_x0020_By"===y?s.push("Editor"):"Created_x0020_By"===y?s.push("Author"):s.push(y)}}var b=Object(E.r)({itemRefs:i,recurseInFolders:!0,pageSize:1,fieldNames:s});return{webAbsoluteUrl:"",listFullUrl:o,currentPageContext:void 0,qosName:n,viewXml:b,rootFolder:void 0,postDataContext:{needUpdatePageContext:!0,needsSchema:!0}}}})(i,void 0,"getSPItemByFullUrl"));return[4,e(Object(b.e)(d))];case 1:g=q.sent();x=g.WebUrl||v.i(decodeURIComponent(g.HttpRoot||""))||p.authority;C=""+new u.e(x).authority+(g.ListUrl||decodeURIComponent(g.listUrlDir||""));k={webAbsoluteUrl:x,listFullUrl:C,rootFolder:""};L=e(Object(w.t)({serverData:g,itemSetKey:k,currentPageContext:d.currentPageContext,contentTypes:void 0,isItemSetRequest:s})),A=L.itemResolver,O=L.childKeys,M=L.pageContext;_=O[0];D=h.S.serialize(k);_&&t.mapKeys({mappings:(F={},F[_]=h.M.serialize(i),F)});if(M){P=h.Z.serialize({webAbsoluteUrl:x,listFullUrl:C});e(Object(S.e)({pageContext:m.Et},P)).pageContext||e(Object(f.e)({itemKey:P,options:{pageContext:M}}))}t.merge(A);if(h.D.matches(_)){H=h.D.deserialize(_);(B=Object(T.t)(H))&&t.merge(e(Object(T.e)({parentKey:B,serverData:g})).itemResolver)}j=h.U.serialize({webAbsoluteUrl:x,listFullUrl:C});t.resolveItems({items:(I={},I[h.D.serialize(k)]=Object(r.__assign)({},y.t.pack({itemKey:D})),I[n]=Object(r.__assign)({},a.i.pack(h.D)),I[j]=Object(r.__assign)({},Object(l.e)(g,M)),I)});e(t.execute());e(Object(N.e)({itemSetKey:D,serverData:g,isItemSetRequest:s}));return[2]}})})}}},function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});var r=50,i=8,s=2},,,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("commands",{endpoint:Object(r.s)(),driveId:Object(r.s)({shouldNormalizeToEmpty:!0})})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"i",function(){return a});n.d(t,"s",function(){return f});n.d(t,"o",function(){return l});n.d(t,"u",function(){return c});n.d(t,"a",function(){return h});n.d(t,"f",function(){return p});var r=n(2),i=new r.e("addToOneDrive"),s=new r.e("createFolder"),o=new r.e("createLink"),u=new r.e("delete"),a=new r.e("download"),f=new r.e("invite"),l=new r.e("move"),c=new r.e("officeLens"),h=new r.e("rename"),p=new r.e("upload")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphThumbnailSet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("hasThumbnailAuthTokenFacet")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("shared")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharepointIds")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("specialFolder")},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(5),i=new r.e("topCollaboratorSetKeyFacet",{endpoint:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=n(111),s=new r.e("removeFromOneDrive"),o=new i.e("removeFromOneDrive");Object(i.s)({operationTypeFacet:s,progressKeyFacet:o})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(111),s=new r.e("updateCheckoutState"),o=new i.e("checkout");Object(i.s)({operationTypeFacet:s,progressKeyFacet:o})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(111),s=new r.e("updatePublishState"),o=new i.e("publish")},function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});n.d(t,"n",function(){return f});var r=n(2),i=n(64),s=n(111),o=n(5),u=new r.e("editPinnedItem"),a=new o.e("editPinnedItemProgressItem",{itemKey:Object(o.s)(),editType:Object(o.i)()}),f=new s.e("editPinnedItemProgress",function(e,t){var n=Object.keys(t.itemEditTypeMap)[0],r=t.itemEditTypeMap[n].editType;return a.serialize({itemKey:n,editType:r})});Object(i.i)({operationTypeFacet:u})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("bulkUpdateListItems"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("modifyView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(247),i=n(3164),s=n(24),o=n(388);function u(e){return function(t){return t(Object(r.r)({webAbsoluteUrl:e.webAbsoluteUrl,listFullUrl:e.listFullUrl,method:"GET",url:l(e),qosName:"getViewData",additionalHeaders:e.preferredLanguage?{"Accept-Language":e.preferredLanguage}:{},parseResponse:function(t){return JSON.parse(t).d.results.map(function(t){return{serverView:t,view:a(t,!1,e.listTemplate)}})},noRedirect:!0}))}}function a(e,t,n){if(e.ViewType&&e.Id){var r=o.e.isAppView(e),i=e.Hidden&&!r,u=n===s.t.pictureLibrary&&"2"===e.BaseViewId&&window.location.pathname.toLowerCase()!==e.ServerRelativeUrl.toLowerCase();if(t||!i&&!u){var a=new o.e(e);if(a.viewType)return a}}}var f=["BaseViewId","DefaultView","EditorModified","Hidden","Id","ListViewXml","PersonalView","RowLimit","Scope","ServerRelativeUrl","TabularView","Title","ViewType","VisualizationInfo","CustomFormatter"].join(",");function l(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,s=Object(i.e)({webAbsoluteUrl:t,listFullUrl:n});return(s=r?s.method("Views",r):s.segment("Views")).oDataParameter("$select",f).toString()}},function(e,t,n){"use strict";n.d(t,"t",function(){return o});n.d(t,"e",function(){return u});var r,i=n(2),s=n(64);(function(e){e[e.previewColumnFormatter=0]="previewColumnFormatter";e[e.saveColumnFormatter=1]="saveColumnFormatter";e[e.previewViewFormatter=2]="previewViewFormatter";e[e.saveViewFormatter=3]="saveViewFormatter"})(r||(r={}));var o=new i.e("updateFormatter"),u=Object(s.i)({operationTypeFacet:o})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("modifyFieldProperties"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"t",function(){return s});n.d(t,"n",function(){return o});var r=n(11),i=new r.e("fileHandlerActionControl"),s=new r.e("fileHandlerCustomActionControl"),o=new r.e("fileHandlerOpenActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});function r(e){for(var t=e,n="",r=0,i=void 0,s=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.charAt(0|s)||(o="=",s%1);n+=o.charAt(63&r>>8-s%1*8)){if((i=t.charCodeAt(s+=.75))>255)throw new Error("Unable to obtain default share URL: btoa failed");r=r<<8|i}return n}},function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"e",function(){return h});n.d(t,"r",function(){return p});n.d(t,"n",function(){return v});n.d(t,"i",function(){return m});var r=n(1),i=n(2852),s=n(2523),o=n(2),u=n(290),a=n(2855),f=n(2853),l=new o.e("moreCommands").id,c={key:new o.e("CheckOutItem").id,automationId:"checkOutItemCommand",name:s.e.CheckOut,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"checkOut"})},h={key:new o.e("CheckInItem").id,automationId:"checkInItemCommand",name:s.e.CheckIn,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"checkIn"})},p={key:new o.e("UndoCheckOutItem").id,automationId:"undoCheckoutItemCommand",name:s.e.UndoCheckOut,iconProps:{iconName:"ArrowDownRight8"},action:r.createElement(i.e,{checkInOutType:"undoCheckOut"})},d={key:new o.e("ViewDocumentProperties").id,name:u.e.ViewProperties,action:r.createElement(f.e,{interactiveSave:!0})},v={key:l,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:[d,c,h,p]}};function m(e){var t=e.listFacets,n=Object(a.e)({listFacets:t}),r=!!t&&!t.isDocumentLibrary;return{key:l,automationId:"moreCommands",name:"",iconProps:{iconName:"More"},subMenuProps:{items:r?[n]:[d,c,h,p,n]}}}},,function(e,t,n){"use strict";n.d(t,"e",function(){return A});var r=n(0),i=n(1),s=n(9),o=n(28),u=n(84),a=n(16),f=n(177),l=n(3),c=n(4),h=n(46),p=n(2515),d=n(2838),v=n(51),m=n(838),g=n(50),y=n(59),b=n(48),w=n(24),E=n(593),S=n(7),x=n(20),T=n(126),N={ODB:1499},C=Object(T.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("dotdot_components_approverejectdialog_approverejectdialog")]).then(n.bind(null,3527))];case 1:return[2,e.sent().ApproveRejectDialog]}})})}),k=Object(s.i)(function(e,t){var n=t.onContinue,s=t.onCancel,o=t.resolve,u=t.reject,a=Object(r.__rest)(t,["onContinue","onCancel","resolve","reject"]);return i.createElement(C,Object(r.__assign)({},a,{onContinue:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return n?[4,n(e)]:[3,2];case 1:t.sent();t.label=2;case 2:o();return[2]}})})},onCancel:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return s?[4,s()]:[3,2];case 1:e.sent();e.label=2;case 2:u(new f.e);return[2]}})})}}))}),L=Object(s.i)(function(e,t){var n=t.itemKeys,s=Object(u.e)(e);if(!s)return null;var a=e.demandItem({setKey:l.S},s).setKey;if(!a||!n||!n.length)return null;var f=Object(g.e)(e,{enbableApproveRejectConfiguration:c.w}).enbableApproveRejectConfiguration,T=Object(b.e)(e,n[0]);if(!f||!Object(y.e)(e,{feature:N,pageContext:T}))return null;var C=!0,L=e.demandItemFacet(c.ye,l.U.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}));if(L&&L.templateType===w.n.webPageLibrary&&n.length>1)return null;for(var A,O,M=!0,_=!0,D=!1,P={},H=0,B=n;H<B.length;H++){var j=B[H];if(!d.e(e,{itemKey:j,listFacets:L}))return null;var F=e.demandItem({permissions:c.Fe,moderationStatusType:c.Ce,moderationComments:c.Ne},j),I=F.permissions,q=F.moderationStatusType,R=F.moderationComments;if(L&&!L.isDocumentLibrary&&!v.t.hasItemPermission({permissions:I},v.t.layoutsPage))return null;if(void 0!==q){var U=P[m.e[q]];P[m.e[q]]=U?U+1:1}void 0===A?A=R:A!==R&&(M=!1);void 0===O?O=q:O!==q&&(_=!1);q===m.e.draft&&(D=!0);if(!(C=d.t(e,{itemKey:j,includeOneNote:!0})||q===m.e.pending||!!L&&!L.enableMinorVersions))return null}if(L&&L.templateType===w.n.webPageLibrary){if(C){return(j=t.itemKeys?t.itemKeys[0]:void 0)?i.createElement(E.e,{itemKey:t.itemKeys?t.itemKeys[0]:"",engagement:{name:"ApproveReject",isIntentional:!0}}):null}return null}var z,W=_&&O===m.e.draft&&!!L&&!!L.enableMinorVersions,X=D,V=e.dispatch,$=function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(r){t=[{FieldName:"_ModerationStatus",FieldValue:e.status.toString()}];void 0!==e.comment&&t.push({FieldName:"_ModerationComments",FieldValue:e.comment});return[2,V(Object(p.e)({items:(i={},i[s]={itemKeys:n,formValues:t,qosName:"BulkApproveReject"},i)}))]})})},J=n.length,K=J>1?"BulkApproveReject":"ApproveReject";1===J&&(z=e.demandItemFacet(S.f,n[0]));var Q=Object(x.o)(function(e){return i.createElement(k,Object(r.__assign)({},e,{onContinue:$,hideApproveRejectOptions:W,showDraftOption:X,initialComment:M?A:void 0,initialStatus:_?O:void 0,itemCount:n.length,itemName:z,initialStatusMapForBulkEdit:P}))});return i.createElement(o.e,Object(r.__assign)({isAvailable:C,onExecute:Q},Object(h.e)(e,{itemKey:n[0],engagement:{name:K,isIntentional:!0}})))}),A=Object(a.s)()(L)},function(e,t,n){"use strict";n.d(t,"t",function(){return f});n.d(t,"e",function(){return l});var r=n(0),i=n(9),s=n(2298),o=n(16),u=n(7),a=n(46),f=Object(i.t)(function(e,t){var n=t.itemKey,i=t.action,o=!1;if(n){var f=e.demandItem({fileName:u.h,isFolder:u.d},n),l=f&&f.fileName,c=l&&l.extension||"",h=f&&f.isFolder||!1;o=Object(s.t)(i.availableOn,c,Boolean(h))}var p=i.handler,d=p.appId,v=p.isPromoted?"PromotedFileHandlerOpen":"FileHandlerOpen",m={appId:d};return Object(r.__assign)({isAvailable:o,itemKeys:n?[n]:[]},Object(a.e)(e,{itemKey:n,engagement:{name:v,isIntentional:!0,extraData:m}}))})(s.e),l=Object(o.s)()(Object(o.r)()(f))}],Array(212),[function(e,t,n){"use strict";var r=n(1),i=n(0),s=n(3),o=n(16),u=n(84),a=n(9),f=n(13),l=n(970),c=n(7),h=n(4),p=n(51),d=n(46),v=n(126),m=n(61),g=n(20),y=n(28),b=Object(a.t)()(Object(v.e)(function(){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("dot_editpinneditemexecutor")]).then(n.bind(null,3821))];case 1:return[2,e.sent().EditPinnedItemExecutor]}})})})),w=Object(a.i)(function(e,t){var n=t.itemKey,o=t.editType,a=Object(m.e)(e).itemsScopeItemKey,v=(function(e,t){var n=Object(u.e)(e),r=e.demandItemFacet(s.ne,n);if(r)return s.ne.serialize(r);return})(e),w=e.demandItem({isMalwareDetected:c.N,permissions:h.Fe},n),E=w.isMalwareDetected,S=w.permissions,x=!E&&!!n&&Object(l.e)(e,t)&&!!v&&!!S&&p.e.hasItemPermission({permissions:S},p.e.manageLists)&&(function(e,t){var n=t.pinnedItemSetKey,r=t.editType,i=e.demandItemFacet(f.e,n),s=i?i.itemKeys:[],o=s.indexOf(t.itemKey),u=o>-1?0!==r:0===r;u&&(2===r?u=0!==o:3===r&&(u=o!==s.length-1));return u})(e,{itemKey:t.itemKey,pinnedItemSetKey:v,editType:o}),T=a?Object(g.o)(function(e){return r.createElement(b,Object(i.__assign)({},e,t,{itemsScopeItemKey:a,pinnedItemSetKey:v}))}):void 0;return r.createElement(y.e,Object(i.__assign)({isAvailable:x,onExecute:T},Object(d.e)(e,{itemKey:n,engagement:{name:"EditPinnedItem",isIntentional:!0}})))}),E=Object(o.s)()(Object(o.r)()(w));var S=n(495),x=n(2526),T=n(2),N=Object(T.n)("pinItem"),C=Object(T.n)("moveLeftPinnedItem"),k=Object(T.n)("moveRightPinnedItem"),L=Object(T.n)("removePinnedItem"),A=Object(T.n)("editPinnedItem");n.d(t,"t",function(){return O});n.d(t,"e",function(){return P});var O={key:N,automationId:"pinItemCommand",name:x.e.pinToTop,iconProps:{iconName:"Pin"},action:r.createElement(E,{editType:0})},M={key:C,automationId:"moveLeftPinnedItemCommand",name:x.e.moveLeftPinnedItem,iconProps:{iconName:S.e.isRightToLeft?"Forward":"Back"},action:r.createElement(E,{editType:2})},_={key:k,automationId:"moveRightPinnedItemCommand",name:x.e.moveRightPinnedItem,iconProps:{iconName:S.e.isRightToLeft?"Back":"Forward"},action:r.createElement(E,{editType:3})},D={key:L,automationId:"removePinnedItemCommand",name:x.e.unpinFromTop,iconProps:{iconName:"UnPin"},action:r.createElement(E,{editType:1})},P={key:A,automationId:"editPinnedItemCommand",name:x.e.editPin,iconProps:{iconName:"Pinned"},subMenuProps:{items:[M,_,D]}}},,,,,,,,,,,function(e,t,n){"use strict";var r,i=n(64),s=n(111),o=n(0),u=n(21),a=n(3198),f=n(2493),l=n(19),c=n(12),h=n(486),p=n(273),d=n(13),v=n(69),m=n(7),g=((r={})[v.r.started]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupStartedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[v.r.completed]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupCompletedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[v.r.failed]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupFailedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r[v.r.canceled]=function(e,t){return Object(u.format)(Object(u.getLocalizedCountValue)(a.e.assignToGroupFailedItemsTitle,a.e.assignToGroupTitleIntervals,e)||"",e,t)},r),y=Object(l.t)(function(){return function(e){e(Object(c.r)(f.t,h.e)(Object(c.t)()(w)));e(Object(c.r)(f.t,p.n)(Object(c.t)()(b)))}});function b(){return function(e){return function(e,t){return{reportMode:p.e.pin}}}}function w(){return function(e){return E}}function E(e,t){var n=t.itemKey,r=Object(s.i)(e,t),i=r.phase,u=r.count,a=g,l=e.demandItemFacet(d.e,n),c=l&&l.itemKeys,h="",p="";if(c&&c.length>0){var v=e.demandItemFacet(f.e,c[0]),y=v&&v.groupKey;y&&(h=e.demandItemFacet(m.f,y)||"");p=a[i](u,h)}else{var b=e.demandItemFacet(f.t,n);if(b){var w=b.taskKey,E=w&&e.demandItemFacet(m.f,w);E&&(p=E)}}return Object(o.__assign)({},p&&"item"!==t.format?{title:p}:{})}n.d(t,"e",function(){return S});n.d(t,"t",function(){return x});var S=Object(i.i)({operationTypeFacet:f.e}),x=Object(s.s)({operationTypeFacet:f.e,progressKeyFacet:f.t,initializeBatch:function(){return y}})},function(e,t,n){"use strict";var r=n(1),i=n(229),s=n(20),o=n(1239),u=n(557),a=n(7),f=n(251),l=n(393),c=n(510);n.d(t,"e",function(){return h});var h=function(e){var t=e.itemKey;return r.createElement(i.e,null,function(n){var i,h=n.itemCache;if(e.children)i=e.children;else{var p=h.demandItemFacet(a.f,t);i=p}var d=Object(f.e)(h),v=(function(e,t){var n=Object(l.e)(e,{itemKey:t.itemKey1}),r=Object(l.e)(e,{itemKey:t.itemKey2});return Object(c.e)(e,{itemKey:n})===Object(c.e)(e,{itemKey:r})})(h,{itemKey1:t,itemKey2:d})?null:r.createElement(u.e,{itemKey:t});return r.createElement(s.n,{action:v},function(e){var t=e.isAvailable,n=e.execute,s=t?function(){n().catch(function(){})}:void 0;return s?r.createElement(o.e,{onClick:s},i):r.createElement("span",null,i)})})}},,,,,,,function(e,t,n){"use strict";var r,i,s=n(0),o=n(3),u=n(3164);(function(e){e[e.pin=0]="pin";e[e.unpin=1]="unpin";e[e.movePrevious=2]="movePrevious";e[e.moveNext=3]="moveNext"})(r||(r={}));(function(e){e[e.success=0]="success";e[e.folderDoesNotExist=1]="folderDoesNotExist";e[e.itemDoesNotExist=2]="itemDoesNotExist";e[e.tooManyItems=3]="tooManyItems";e[e.itemNotInSpotlight=4]="itemNotInSpotlight";e[e.invalidArgument=5]="invalidArgument";e[e.serverError=6]="serverError";e[e.invalidServerJSON=7]="invalidServerJSON";e[e.unknownServerResult=8]="unknownServerResult"})(i||(i={}));var a=n(247),f=n(275),l=n(624),c=n(19),h=n(13),p=n(62),d=n(4),v=n(25),m=n(2181),g=n(36),y=n(172),b=n(7);n.d(t,"t",function(){return w});n.d(t,"e",function(){return E});n.d(t,"n",function(){return S});var w=3,E=(function(e){Object(s.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this,r=t.resultType,i=void 0===r?8:r;n.resultType=i;return n}return t})(l.e),S=Object(c.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.itemEditTypeMap;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r,i,l,c,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I;return Object(s.__generator)(this,function(q){switch(q.label){case 0:r=Object.keys(n)[0];i=n[r].editType;return[4,e(Object(m.e)(r))];case 1:l=q.sent(),c=l.key,S=l.itemId;x=e(Object(v.e)(function(e){return e.demandItem({deserializedPinnedItemSetKey:o.ne,pinnedItems:h.e},t)})),T=x.deserializedPinnedItemSetKey,N=x.pinnedItems;T||(T=o.ne.deserialize(t));if(!c||!T||!S)throw new E({resultType:5});if(!(c&&T&&S))return[3,3];C="";"";T.viewKey&&(C=T.viewKey.viewId);k=T.parentItemKey.rootFolder||new f.e(T.parentItemKey.listFullUrl).path;L=void 0;(A=N&&N.itemKeys||[])&&(O=A.indexOf(r))>-1&&(2===i&&O>=2?L=A[O-2]:3===i&&O<A.length-1&&(L=A[O+1]));M=void 0;L&&(M=e(Object(v.e)(function(e){return e.demandItemFacet(d.we,L)})));_={webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,itemId:S,editType:i,viewId:C,rootFolder:k,afterItemId:M};t&&(D=(function(e,t,n,r){var i=r.editType,s=[];(0===i||void 0===n&&1!==i)&&s.push(e);for(var o=0,u=t;o<u.length;o++){var a=u[o];a!==e&&s.push(a);a===n&&s.push(e)}return s})(r,A,L,_)).length<=w&&e(Object(p.e)({items:Object(s.__assign)((F={},F[t]=Object(s.__assign)({},h.e.pack({itemKeys:D})),F),Object(g.e)(D,function(){return Object(s.__assign)({},Object(y.e)().forFacet(b.a).thenInvalidate(t,h.e).pack())}))}));return(P=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.viewId,i=e.editType,s=e.itemId,o=e.afterItemId,a=e.rootFolder,f=Object(u.e)({webAbsoluteUrl:t,listFullUrl:n});r&&(f=f.methodWithAliases("GetView",{viewGuid:r}));if(1!==i){var l=o?parseInt(o,10):-1;isNaN(l)&&(l=-1);f=f.methodWithAliases("AddToSpotlight",{itemId:s,folderPath:a||"",afterItemId:l})}else f=f.methodWithAliases("RemoveFromSpotlight",{itemId:s,folderPath:a||""});return f.toString()})(_))?[4,e(Object(a.t)({webAbsoluteUrl:c.webAbsoluteUrl,listFullUrl:c.listFullUrl,url:P,method:"POST",additionalHeaders:void 0,qosName:"editPinnedItem",noRedirect:!0}))]:[3,3];case 2:H=q.sent();if(0!==(B=(function(e){try{if(e.d){var t=e.d.Order?e.d.Order.results:void 0;return{resultType:e.d.ResultCode,order:t}}return{resultType:8,order:void 0}}catch(e){return{resultType:7,order:void 0}}})(H)).resultType){j=(function(e,t){var n=[];if(e.order)for(var r=0,i=e.order;r<i.length;r++){var u=i[r];n.push(o.D.serialize(Object(s.__assign)(Object(s.__assign)({},t),{itemId:u.toString()})))}return n})(B,c);e(Object(p.e)({items:Object(s.__assign)((I={},I[t]=Object(s.__assign)({},h.e.pack({itemKeys:j})),I),Object(g.e)(j,function(){return Object(s.__assign)({},Object(y.e)().forFacet(b.a).thenInvalidate(t,h.e).pack())}))}));throw new E({resultType:B.resultType})}q.label=3;case 3:return[2]}})})}})}],Array(33),[function(e,t,n){"use strict";n.d(t,"e",function(){return c});var r=n(0),i=n(60),s=n(317),o=n(25),u=n(404),a=n(11),f=n(177),l=n(300);function c(e,t,n){var h=this;void 0===n&&(n={});var p=n.cancelToken,d=n.flushOperationQueue,v=n.owner;return function(n,m){return Object(r.__awaiter)(h,void 0,void 0,function(){var h,g,y,b,w;return Object(r.__generator)(this,function(E){switch(E.label){case 0:h=n(s.t);g=n(l.e);y={selector:e,operation:c,owner:v};E.label=1;case 1:E.trys.push([1,,6,7]);b=function(){var s,l,c,v,b,w;return Object(r.__generator)(this,function(r){switch(r.label){case 0:s=h.evaluate({selector:e,controlHandlers:a.t,owner:y,state:m()}),l=s.result,c=s.demands,v=s.dependencies;return(b=t(l))?[4,b]:[3,2];case 1:r.sent();r.label=2;case 2:w={items:c,flushOperationQueue:d};g.recordLastAccesses(v,Date.now());if(!n(Object(o.e)(function(e){return Object(u.t)(e,w)})))return[2,{value:void 0}];g.registerDemands(y,v);p&&p.throwIfCanceled();return[4,Object(f.r)(n(Object(i.t)(w)),p)];case 3:r.sent();return[2]}})};E.label=2;case 2:return[5,b()];case 3:if("object"==typeof(w=E.sent()))return[2,w.value];E.label=4;case 4:return[3,2];case 5:return[3,7];case 6:g.removeDemands(y);return[7];case 7:return[2]}})})}}},,,,,,,,,,,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(11).e)("itemAutoRefreshControl")},,function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(68),s=n(13),o=n(3),u=n(61),a=n(350),f=n(33);var l=Object(i.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("dot_sortactionexecutor").then(n.bind(null,3292))];case 1:return[2,e.sent().SortActionExecutor]}})})},function(e,t){var n=t.sortFieldKey,i=t.itemSetKey,s=t.isAscending,l=e.demandItemFacet(o.S,i);if(!l)return!1;var c=Object(u.e)(e).itemsScopeItemKey;if(!c)return!1;var h=o.S.serialize(Object(r.__assign)(Object(r.__assign)({},l),{sortFieldKey:n,sortAscending:s})),p=e.demandItemFacet(a.e,h),d=a.e.evaluate(p)(e,{itemKey:h,itemsScopeItemKey:c,isAvailable:!0}),v=d.itemKey;if(!d.isAvailable)return!1;var m=e.demandItemFacet(f.n,c),g=m&&m.itemKey;return!!v&&v!==g},function(e,t){var n=t.sortFieldKey,r=t.itemSetKey,i=t.isAscending,u=e.demandItemFacet(o.S,r);if(!u)return!1;var a=e.demandItemFacet(s.o,r),f=a&&e.demandItemFacet(o.y,a.columnKey),l=f&&f.internalName||u.sortFieldKey,c=a?a.isAscending:u.sortAscending;return l===n&&c===i})}],Array(14),[function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});function r(e){return!!e&&("status"in e||!(!e.message||"object"!=typeof e.message))}function i(e){return e&&e.message&&("object"==typeof e.message?e.message.value:e.message.toString())||""}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("graphTokenProvider")},function(e,t,n){"use strict";n.d(t,"e",function(){return f});n.d(t,"t",function(){return c});var r=n(12),i=n(144),s=n(2505),o=n(2342),u=n(2827),a=n(2506),f=Object(r.t)()(function(){return function(e){return l}});function l(e,t){var n=t.itemKey,r=t.desiredSize,f=e.demandItemFacet(i.e,n),l=e.demandItemFacet(s.e,n),h=e.demandItemFacet(a.e,n),p=(function(e){return e&&c(e)?e[0]:e})(l);if(f&&p&&p.large){if(h)return{thumbnail:{url:d(p.large.url,r),width:0,height:0}};var v,m=e.demandItemFacet(o.e,n),g=m&&o.e.serialize(m);return{thumbnail:void 0!==(v=e.demandItemFacet(u.e,g))?{url:d(p.large.url,r,v),width:0,height:0}:void 0}}return{}}function c(e){return e&&"number"==typeof e.length}var h=/width=[0-9]*/,p=/height=[0-9]*/;function d(e,t,n){var r=""+(t.width||"");h.test(e)?e=e.replace(h,"width="+r):e+=(e.indexOf("?")>-1?"&":"?")+"width="+r;var i=""+(t.height||"");p.test(e)?e=e.replace(p,"height="+i):e+=(e.indexOf("?")>-1?"&":"?")+"height="+i;return e=n?e+="&access_token="+n:e}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("thumbnailAccessToken")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("sharedBy")},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r,i;(function(e){e[e.MalwareDetected=0]="MalwareDetected";e[e.ThisFileIsCheckedOut=1]="ThisFileIsCheckedOut";e[e.DLPBlocked=2]="DLPBlocked";e[e.MissingMetaData=3]="MissingMetaData";e[e.DLPWarning=4]="DLPWarning";e[e.AwaitingApproval=5]="AwaitingApproval";e[e.Trending=6]="Trending";e[e.New=7]="New";e[e.NeedsRepublishing=8]="NeedsRepublishing"})(r||(r={}));(function(e){e[e.Mail=0]="Mail";e[e.CalendarEvent=1]="CalendarEvent";e[e.Teams=2]="Teams"})(i||(i={}))},function(e,t,n){"use strict";n.d(t,"n",function(){return i});n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(5),i=new r.e("SharedByPersonKeyFacet",{displayName:Object(r.s)(),email:Object(r.s)()}),s=new r.e("dateSharedGroupKeyFacet",{relativeTime:Object(r.s)(),sharedDateTime:Object(r.s)()}),o=new r.e("relativeTimeGroupKeyFacet",{relativeTime:Object(r.s)()})},function(e,t,n){"use strict";n.d(t,"e",function(){return g});var r=n(0),i=n(19),s=n(56),o=n(574),u=n(2006),a=n(1418),f=n(2057),l=n(944),c=n(232),h=n(172),p=n(3125),d=n(2078),v=n(144),m=n(7),g=Object(i.n)({maxParallelOperationCount:1,maxItemCountPerBatch:20,areSameBatch:function(e,t){var n=o.e.deserialize(e.itemKey).driveItemKey,r=n.endpoint,i=n.driveId,s=o.e.deserialize(t.itemKey).driveItemKey,u=s.endpoint,a=s.driveId;return!!i&&!!a&&i===a&&r===u}})(function(e){var t=this,n=e.items;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,p,d,g,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X,V;return Object(r.__generator)(this,function($){switch($.label){case 0:t=Object.keys(n);i=t[0];p=o.e.deserialize(i);d=p.driveItemKey,g=d.endpoint,E=d.driveId;if(!g)throw new Error("No endpoint to determine activity items.");S=t.map(function(e){return o.e.deserialize(e).driveItemKey.itemId});x=Object(u.n)({endpoint:(J=g,J.replace("2.1","2.0")),driveId:E});T=x+"/ExtendedActivitiesForItems";N={driveItems:S,badgeOnly:!0};return[4,e(Object(a.n)({url:T,method:"POST",body:N,qosName:"ItemActivityFieldDataSource.extendedActivitiesForItems",endpoint:g}))];case 1:if((C=$.sent()).value){k=(function(e){for(var t={},n=0,r=e;n<r.length;n++){var i=r[n],s=i.driveItemId;if(s){(t[s]||(t[s]=[])).push(i)}}return t})(C.value);L=0;A=0;O=0;M=0;_=new s.e;for(D=0,P=t;D<P.length;D++){H=P[D];L++;B=o.e.deserialize(H);j=B.driveItemKey.itemId;F=j&&k[j];I=v.e.serialize(B.driveItemKey);q=void 0;if(F){R=new f.e;U=R.processResponse({item:{name:j||"",relativePath:"",absolutePath:"",isFolder:!1,graphItemUrl:T},response:{value:F,"@odata.nextLink":""}}).activities;z=y(U);if(W=b(U)){O++;A++;if(!z){M++;X=w(W,H).itemResolver;_.merge(X);q=W}}}_.resolveItems({items:(V={},V[H]=Object(r.__assign)({},l.e.pack(q)),V[I]=Object(r.__assign)({},Object(h.e)().forFacet(m.e).thenInvalidate(H,l.e).pack()),V)})}e(_.execute());e(Object(c.e)({name:"ItemActivityField.View",extraData:{activityFieldProcessedItemCount:L,activityFieldEligibleItemCount:A,activityFieldActiveItemCount:O,activityFieldBadgedItemCount:M,activityFieldBadgedPercent:L?Math.round(M/L*100):0},isIntentional:!1}))}return[2]}var J})})}});function y(e){var t=e[0];return!!t&&1===t.actors.length&&t.actors[0].self&&!t.type||!1}function b(e){var t=e[0],n={};if(t)for(var i=0,s=t.actors;i<s.length;i++){(l=s[i]).id&&(n[l.id]=!0)}for(var o=Object(r.__assign)(Object(r.__assign)({},t),{actors:Object(r.__spreadArrays)(t.actors||[])}),u=1;u<e.length;u++)for(var a=0,f=e[u].actors;a<f.length;a++){var l;if("string"==typeof(l=f[a]).id&&!n[l.id]){o.actors.push(l);n[l.id]=!0}}return o||t}function w(e,t){var n=new s.e,i=o.e.deserialize(t).driveItemKey,u=(function(e){var t=e.actors,n=e.action.mention&&e.action.mention.mentionees||[],i=e.action.share&&e.action.share.recipients||[],s=e.action.commentResponse&&e.action.commentResponse.commentAuthor,o=Object(r.__spreadArrays)(t,n,i);s&&o.push(s);return o})(e);if(u.length>0){var a=(function(e,t){for(var n=new s.e,r=0,i=e;r<i.length;r++){var o=E(i[r],t).itemResolver;n.merge(o)}return{itemResolver:n}})(u,i).itemResolver;n.merge(a)}return{itemResolver:n}}function E(e,t){var n=new s.e,r={itemKey:v.e.serialize(t),userKey:d.e.serialize({email:e.email||"",endpoint:t.endpoint}),user:{displayName:e.displayName,email:e.email}},i=Object(p.t)(r).itemResolver;n.merge(i);return{itemResolver:n}}},function(e,t,n){"use strict";n.d(t,"t",function(){return c});n.d(t,"e",function(){return h});var r=n(0),i=n(12),s=n(84),o=n(29),u=n(144),a=n(1746),f=n(13),l=n(62),c=Object(i.t)()(function(){return function(e){return function(e,t){var n=Object(s.e)(e),i=(function(e,t){var n=t.folderItemKey,i=t.currentItemSetKey;if(i&&n){var s=e.demandItemFacet(a.e,i),o=e.demandItemFacet(u.e,n);if(s&&o){var f=o.endpoint,l=o.driveId,c=o.itemId;return Object(r.__assign)(Object(r.__assign)({},s),{driveItemKey:{endpoint:f,driveId:l,itemId:c}})}}return})(e,{folderItemKey:t.itemKey,currentItemSetKey:n}),o=i&&h(e,{parentItemKey:u.e.serialize(i.driveItemKey),stageItem:t.stageItem});return Object(r.__assign)(Object(r.__assign)({},i?{itemKey:a.e.serialize(i)}:{}),o?{stageItem:o}:{})}}});function h(e,t){var n=this,i=t.parentItemKey,s=t.stageItem;if(i)return s?Object(o.t)(function(e){var t=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(r.__awaiter)(n,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(u){switch(u.label){case 0:e(Object(l.e)({items:(n={},n[o]=Object(r.__assign)({},f.i.pack({itemKey:i})),n)}));return[4,e(s({currentItemKey:o,itemsScopeItemKey:t}))];case 1:u.sent();return[2]}})})}}):void 0}},function(e,t,n){"use strict";n.d(t,"e",function(){return i});n(3);var r=n(275),i=function(e){return""+(""+new r.e(e).authority)+new r.e(e).segments.slice(0,-1).join("/")}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("saveUploadedTemplateToView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("updateItem")},,function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(4),i=n(7),s=n(51),o=n(174);function u(e,t){var n=t.itemKey,r=t.includeOneNote,s=e.demandItem({folder:i.d,oneNote:o.n},n),u=s.folder,a=s.oneNote;return r?!!u||!!a:!!u&&!a}function a(e,t){var n=t.itemKey,o=t.listFacets,u=!!o&&!!o.isModerated;if(u){var a=e.demandItem({permissions:r.Fe,checkoutInfo:i.y},n),f=a.permissions,l=a.checkoutInfo;u=!!(!l||!l.byOther&&!l.byYou)&&!!f&&s.e.hasItemPermission({permissions:f},s.e.editListItems)&&s.e.hasItemPermission({permissions:f},s.e.approveItems)}return u}},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("updateItemRating"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("updateItemLikes"),o=Object(i.i)({operationTypeFacet:s})},,,function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("createView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("createFreshView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("updateView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("modifyColumnAggregateType"),o=Object(i.i)({operationTypeFacet:s})},,function(e,t,n){"use strict";n.d(t,"e",function(){return i});n.d(t,"n",function(){return s});n.d(t,"t",function(){return o});var r=n(2),i=new r.e("enabledForMultipleItems"),s=new r.e("isEnabledFunction"),o=new r.e("iconUrl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(11).e)("getDriveItemFullUrlControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(11).e)("getDefaultShareLinkActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(11).e)("permissionInviteActionControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return b});var r=n(0),i=n(1),s=n(4),o=n(51),u=n(7),a=n(174),f=n(9),l=n(3),c=n(24),h=n(126),p=n(20),d=n(215),v=n(46),m=n(84),g=n(28),y=Object(h.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("dot_checkoutitemexecutor").then(n.bind(null,3528))];case 1:return[2,e.sent().CheckOutItemWizard]}})})}),b=Object(f.i)(function(e,t){var n=t.checkInOutType,f=Object(m.e)(e),h=Object(d.e)(e);if(!h.length)return null;var b=e.demandItem({firstItemKey:l.D},h[0]).firstItemKey;if(!b)return null;var w=b&&e.demandItemFacet(s.Et,l.Z.serialize({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl}));if(w&&(w.isAnonymousGuestUser||w.isEmailAuthenticationGuestUser))return null;for(var E=e.demandItemFacet(s.ye,l.U.serialize({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl})),S=!!E&&E.templateType===c.t.mySiteDocumentLibrary,x=!!E&&!!E.enableMinorVersions,T=!1,N=0,C=h;N<C.length;N++){var k=C[N],L=e.demandItemFacet(u.d,k),A=e.demandItemFacet(a.n,k);if(k&&!L&&!A){var O=e.demandItem({isCheckedOut:u.y,isBFile:s.ae},k),M=O.isCheckedOut,_=O.isBFile,D=e.demandItemFacet(s.Fe,k),P=o.e.hasItemPermission({permissions:D},o.e.editListItems),H=o.e.hasItemPermission({permissions:D},o.e.cancelCheckout);"checkOut"===n?T=!_&&!S&&!(M&&(M.byYou||M.byOther))&&P:"checkIn"!==n&&"undoCheckOut"!==n||!M||(T=P&&(!!M.byYou||H&&!!M.byOther))}if(!T)break}var B=h?Object(p.o)(function(e){return i.createElement(y,Object(r.__assign)({},e,{itemSetKey:f,itemKeys:h,checkInOutType:n,enableMinorVersions:x}))}):void 0;return i.createElement(g.e,Object(r.__assign)({isAvailable:T,onExecute:B},Object(v.e)(e,{itemKey:h[0],engagement:{name:n,isIntentional:!0,extraData:{isBulk:h.length>1}}})))})},function(e,t,n){"use strict";n.d(t,"e",function(){return w});var r=n(0),i=n(1),s=n(51),o=n(126),u=n(2854),a=n(59),f=n(9),l=n(20),c=n(215),h=n(4),p=n(48),d=n(46),v=n(28),m=n(3),g=n(24),y={ODB:1568},b=Object(o.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("dot_edititemwizard")]).then(n.bind(null,3302))];case 1:return[2,e.sent().EditItemWizard]}})})}),w=Object(f.i)(function(e,t){var n=Object(c.e)(e),o=1===n.length?n[0]:void 0,f=e.demandItemFacet(u.e,o),w=u.e.evaluate(f)(e,{itemKey:o}).getPropertiesForm,E=e.demandItemFacet(h.Fe,o),S=o&&Object(p.e)(e,o),x=e.demandItemFacet(m.D,o),T=x&&e.demandItemFacet(h.ye,m.U.serialize(x)),N=T&&T.templateType===g.t.mySiteDocumentLibrary,C=!!S&&Object(a.e)(e,{feature:y,pageContext:S})&&!!w&&!!E&&!N&&s.t.hasItemPermission({permissions:E},s.t.editListItems),k=o&&w?Object(l.o)(function(e){return i.createElement(b,Object(r.__assign)({},e,{itemKey:o,interactiveSave:t.interactiveSave,getPropertiesForm:w}))}):void 0;return i.createElement(v.e,Object(r.__assign)({isAvailable:C,onExecute:k},Object(d.e)(e,{itemKey:o,engagement:{name:"EditItem",isIntentional:!0}})))})},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(11).e)("itemPropertiesFormControl")},function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(1),i=n(2),s=n(290),o=n(2524),u=n(24),a=new i.e("ApproveReject").id;function f(e){var t=e.listFacets,n=t&&t.templateType===u.n.webPageLibrary&&t.isModerated?s.e.ReviewApprovals:s.e.ApproveReject;return{key:a,automationId:"approveRejectCommand",iconProps:{iconName:"DocumentApproval"},name:n,action:r.createElement(o.e,null)}}},function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(1),s=n(344),o=n(799),u=n(3141),a=n(2347),f=n(2348),l={key:o.e.key,automationId:o.e.automationId,subMenuProps:{items:[a.e,f.e]},onRender:function(e){return i.createElement(u.e,Object(r.__assign)({},e,{menuProps:e.subMenuProps}))},facets:Object(r.__assign)({},s.e.pack(!0))}},,,,function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(24),i=n(275),s=n(398),o=n(2272);function u(e,t){var n,u=t.pageContext,a=t.listFacets,f=t.isODB,l=t.key;if(u&&(a&&a.templateType===r.t.documentLibrary||f)){var c=new i.e(l.webAbsoluteUrl||l.listFullUrl).authority+"/_api/v2.0",h=s.t.serialize({endpoint:c});n=Object(o.e)(e,{itemKey:h})}return{fileHandlerCommands:n}}},function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(2).e)("editNewMenu").id},function(e,t,n){"use strict";n.d(t,"e",function(){return h});n.d(t,"t",function(){return p});var r=n(0),i=n(1),s=n(3),o=n(4),u=n(1289),a=n(62),f=n(19),l=n(370),c=n(296),h=Object(f.i)()(function(e){var t=this,n=e.itemKey,u=s.m.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(f){e(Object(a.e)({items:(t={},t[n]=Object(r.__assign)({},o.t.pack(function(){return i.createElement(l.e,{documentType:p(u.templateUrl),templateItemKey:s.V.serialize({listKey:u.listKey,templateUrl:u.templateUrl})})})),t)}));return[2]})})}});function p(e){var t=c.e.Word;if(e){var n=e.lastIndexOf(".");if(n){var r=e.substr(n+1).toLowerCase();switch(u.t[r]){case u.i:t=c.e.OneNote;break;case u.s:t=c.e.PowerPoint;break;case u.n:t=c.e.Excel;break;case u.o:t=c.e.Visio}}}return t}},function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(74),s=n(3104),o=n(199),u=n(3),a=n(48),f=n(889),l=n(4),c=n(24),h=n(3137),p=n(2860),d=new i.e("newCommands",function(e,t){var n=t.itemKey,i=e.demandItemFacet(u.U,n);if(i){var d=u.D.serialize(Object(r.__assign)(Object(r.__assign)({},i),{rootFolder:""})),v=e.demandItemFacet(u.D,d);if(v){var m=Object(a.e)(e,d),g=e.demandItemFacet(l.ye,n);if(m&&g){var y=g.templateType===c.t.mySiteDocumentLibrary,b=e.demandItemFacet(l.Me,n),w=Object(f.t)(e,d,v),E=Object(h.e)(e,{key:v,listFacets:g,listKey:i,pageContext:m}),S=E.contentTypes,x=E.contentTypeCommands,T=Object(p.e)(e,{isODB:y,key:v,listFacets:g,pageContext:m}).fileHandlerCommands,N=o.e;return Object(s.e)(e,{contentTypes:S,newCommandMenu:N,fileHandlerCommands:T,isCreateFolderAvailable:w,newDocumentTemplates:b,contentTypeCommands:x,listKey:i}).allCommands}}}})},function(e,t,n){"use strict";n.d(t,"t",function(){return s});n.d(t,"e",function(){return o});var r=n(2),i=n(64),s=new r.e("saveTemplatesToView"),o=Object(i.i)({operationTypeFacet:s})},function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(3);function i(e,t){var n=t.itemSetKey,i=e.demandItemFacet(r.S,n);return i&&i.viewKey&&r.oe.serialize(i.viewKey)}},,,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(11).e)("removeFromShardListActionControl")},,,function(e,t,n){"use strict";n.r(t);n.d(t,"QuickEditActionExecutor",function(){return S});var r=n(0),i=n(1),s=n(28),o=n(229),u=n(20),a=n(46),f=n(584),l=n(289),c=n(3),h=n(4),p=n(167),d=n(62),v=n(15),m=n(2473),g=n(48),y=n(59),b=v.e.isActivated("8755e60f-68f8-4103-aa9e-be030b248b24","11/12/2019","Use rum one logging in quick edit."),w={ODB:1877},E={ODB:1391},S=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props.itemKey;return i.createElement(o.e,null,function(n){var o=n.itemCache,v=n.dispatch,S=Object(a.e)(o,{itemKey:t,engagement:{name:"QuickEdit",isIntentional:!0}}),x=o.demandItem({deserizalizeKey:c.S},t).deserizalizeKey,T=x&&c.A.serialize({listKey:{webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl},viewKey:x.viewKey}),N=x&&x.viewKey&&c.oe.serialize(x.viewKey),C=Object(g.e)(o,t),k=Object(y.e)(o,{feature:w,pageContext:C}),L=Object(y.e)(o,{feature:E,pageContext:C}),A=k&&L;return i.createElement(u.n,{action:i.createElement(f.e,{layoutType:l.e})},function(t){var n=t.execute;return i.createElement(s.e,Object(r.__assign)({isAvailable:!0,onExecute:function(t){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:if(!b){m.t();m.e("quickEdit.layoutManager.start")}T&&v(Object(d.e)({items:Object(r.__assign)((e={},e[T]=Object(r.__assign)({},h.l.pack(new p.e)),e),A&&N?(i={},i[N]=Object(r.__assign)(Object(r.__assign)({},h.Ht.pack("GRID")),h.Ke.pack(!0)),i):{})}));return[4,n(t)];case 1:s.sent();b||m.e("quickEdit.layoutManager.end");return[2]}})})}},S))})})};return t})(i.PureComponent)},,,,function(e,t,n){"use strict";n.d(t,"n",function(){return u});n.d(t,"t",function(){return a});n.d(t,"e",function(){return f});var r=n(327),i=n(230),s=n(1418),o=n(1599);function u(e,t){var n=t+"/me/drive";return Object(s.n)({url:n,qosName:e,method:"GET",endpoint:t})}function a(e,t,n,r,i){var o=i.replace("v2.0","v2.1")+"/drives/"+t+"/root/children",u={name:e,remoteItem:{sharepointIds:{listId:n.listId,listItemUniqueId:n.listItemUniqueId,siteId:n.siteId,siteUrl:n.siteUrl,webId:n.webId}},"@microsoft.graph.conflictBehavior":"rename"};return Object(s.n)({url:o,qosName:r,method:"POST",body:u,endpoint:i})}function f(e){var t=Object(o.t)(e,function(e,t){switch(e){case"unauthenticated":case 401:return i.t.pack({});case"itemNotFound":case 404:return i.s.pack({});case"accessDenied":case 403:return i.e.pack({});default:return i.h.pack({})}});throw new r.e({innerError:e,facets:t})}},,function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(11).e)("saveViewActionControl")},,,function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"n",function(){return i});n.d(t,"r",function(){return s});n.d(t,"i",function(){return o});n.d(t,"s",function(){return u});n.d(t,"e",function(){return a});var r="socialBarList_0569e76e",i="socialBarPanel_0569e76e",s="socialBarPanelContent_0569e76e",o="socialBarPanelPersona_0569e76e",u="socialBarPanelPersonaDescription_0569e76e",a="analyticsStatsLink_0569e76e"}],Array(209),[function(e,t,n){"use strict";var r=n(0),i=n(19),s=n(64),o=n(62),u=n(146),a=n(3),f=n(7),l=n(13),c=n(4),h=n(2176),p=n(56);function d(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){switch(u.label){case 0:t=a.O.deserialize(e.itemKey).tenantRootUrl;i=new p.e;return[4,n(Object(h.t)({tenantRootUrl:t}))];case 1:s=u.sent();i.resolveItems({items:(o={},o[e.itemKey]=Object(r.__assign)(Object(r.__assign)({},c.dt.pack(s.resource)),c.pt.pack(s.payloadHeader)),o)});n(i.execute());return[2]}})})}}var v=n(58),m=n(2501),g=n(2823);function y(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,h;return Object(r.__generator)(this,function(d){t=a.d.deserialize(e.itemKey).tenantRootUrl;i=new p.e;s=a.L.serialize({tenantRootUrl:t});o=a.k.serialize({tenantRootUrl:t});u=[s,o];i.resolveItems({items:(h={},h[s]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.s.pack(!0)),f.f.pack(m.e.frequent)),c.je.pack({itemKey:e.itemKey})),h[o]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v.s.pack(!0)),f.f.pack(m.e.followed)),c.je.pack({itemKey:e.itemKey})),h[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.f.pack(g.e.SharedLibrariesHeader)),v.s.pack(!0)),l.e.pack({itemKeys:u})),h)});n(i.execute());return[2]})})}}var b=n(2500),w=n(172),E=n(54);function S(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,h,d,v;return Object(r.__generator)(this,function(g){switch(g.label){case 0:t=a.L.deserialize(e.itemKey).tenantRootUrl;i=new p.e;return[4,n(x(t))];case 1:s=g.sent();o=[];u=a.d.serialize({tenantRootUrl:t});h=void 0;d=void 0;s&&s.Items&&s.Items.forEach(function(t,n){var p,v=a.ue.serialize({webAbsoluteUrl:t.Url}),m=a.F.serialize({webAbsoluteUrl:t.Url}),g=t.ItemReference||{},y=g.SiteId,b=void 0===y?void 0:y,E=g.WebId,S=void 0===E?void 0:E,x=g.GroupId,T=void 0===x?void 0:x,N=a.c.serialize({rootItemKey:u,itemKey:v});h=s.Items[n-1]&&s.Items[n-1].PinOrder;d=s.Items[n+1]&&s.Items[n+1].PinOrder;i.resolveItems({items:(p={},p[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.f.pack(t.Title)),c.e.pack(t.Acronym)),c.i.pack(t.BannerColor)),c.s.pack(t.BannerImageUrl)),c.pe.pack(!0)),f.d.pack({})),c.Ge.pack(t.Weight)),a.ue.pack({webAbsoluteUrl:t.Url})),c.Qe.pack(b)),c.Bt.pack(S)),c.re.pack(T)),l.t.pack({itemKey:m})),p[N]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c.Ue.pack(h)),c.Ie.pack(t.PinOrder)),c.De.pack(d)),Object(w.e)().forFacet(c.Ie).thenInvalidate(e.itemKey,l.e).pack()),p[m]=Object(r.__assign)({},l.i.pack({itemKey:v})),p)});o.push(v)});i.resolveItems({items:(v={},v[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},f.f.pack(m.e.frequent)),l.e.pack({itemKeys:o})),c.je.pack({itemKey:u})),v)});n(i.execute());return[2]}})})}}function x(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=i(Object(E.e)({enableSitePinningConfiguration:c.U,enableSPHomeServiceConfiguration:c.I})),s=t.enableSitePinningConfiguration;return!1!==t.enableSPHomeServiceConfiguration?[3,3]:[4,n.e("dotdot_dotdot_datasource_getsphomedatafromsharepoint").then(n.bind(null,3295))];case 1:o=r.sent().getFrequentSitesData;return[4,i(o(e))];case 2:return[2,r.sent()];case 3:u=s?b.t:b.e;return[4,i(Object(h.r)(e,void 0,u))];case 4:return[2,r.sent()]}})})}}function T(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){t=a.ue.deserialize(e.itemKey).webAbsoluteUrl;i=new p.e;s=a.F.serialize({webAbsoluteUrl:t});i.resolveItems({items:(o={},o[e.itemKey]=Object(r.__assign)({},l.t.pack({itemKey:s})),o)});n(i.execute());return[2]})})}}var N=n(123),C=n(442),k=n(888),L=n(127),A=n(3164),O=n(247);function M(e){var t=e.webAbsoluteUrl,n=e.isMediaQuery;return function(e){var r=e(Object(E.e)({spHostPageWebAbsoluteUrl:c.vt,spSitesListsDataWebAbsoluteUrl:c.Lt})),i=r.spHostPageWebAbsoluteUrl,s=r.spSitesListsDataWebAbsoluteUrl,o=new L.e(t).authority,u=i||s,a=u&&new L.e(u).authority,f=n&&o===a,l=Object(A.n)({webAbsoluteUrl:a||o}).segment(f?"SP.Web.GetDocumentAndMediaLibaries":"SP.Web.GetDocumentLibraries").parameter("webFullUrl",t);return e(Object(O.r)({webAbsoluteUrl:a||o,method:"POST",url:l.toString(),qosName:f?"getDocumentAndMediaLibraries":"getDocumentLibraries",noRedirect:!0}))}}function _(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,c,h,d,v,m,g,y,b,E,S,x,T;return Object(r.__generator)(this,function(L){switch(L.label){case 0:t=a.F.deserialize(e.itemKey),i=t.webAbsoluteUrl,s=t.types;o=a.ue.serialize({webAbsoluteUrl:i});u=new p.e;return[4,n(M({webAbsoluteUrl:i,isMediaQuery:!!s&&s.indexOf("media")>-1}))];case 1:c=L.sent();h=[];for(d=0,v=c.d.GetDocumentLibraries.results;d<v.length;d++){m=v[d];g=new N.t({context:{webAbsoluteUrl:i}});y=g.getUrlParts({webUrl:i,listUrl:m.AbsoluteUrl,path:m.AbsoluteUrl});b={webAbsoluteUrl:i,listFullUrl:y.fullListUrl||"",rootFolder:""};E=a.D.serialize(b);S=a.S.serialize({webAbsoluteUrl:i,listFullUrl:y.fullListUrl||"",rootFolder:""});u.merge(n(Object(k.e)({itemKey:E,spItem:b})).itemResolver);u.resolveItems({items:(x={},x[E]=Object(r.__assign)({},f.f.pack(m.Title)),x[S]=Object(r.__assign)({},l.i.pack({itemKey:E})),x)});h.push(E)}u.resolveItems({items:(T={},T[e.itemKey]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},l.e.pack({itemKeys:h})),Object(w.e)().forFacet(l.e).thenInvalidate(C.e).pack()),a.ue.pack({webAbsoluteUrl:i})),l.i.pack({itemKey:o})),T)});n(u.execute());return[2]}})})}}var D=n(138),P=n(569),H=n(12),B=n(820),j=Object(H.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,i=t.handlers,s=e.demandItemFacet(a.F,n);if(i&&s){for(var o=[],u=0,f=i;u<f.length;u++){var l=f[u];".JPEG"===Object(B.e)(l)&&o.push("media")}return o.length<1?{}:{itemKey:a.F.serialize(Object(r.__assign)(Object(r.__assign)({},s),{types:o}))}}return{}}}});n.d(t,"e",function(){return I});var F=Object(D.t)(Object(D.e)(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("addon-sharepointhome-deferred")]).then(n.bind(null,3627))},{chunkName:"addon-sharepointhome-deferred"}),"getSPFollowedSitesItemSet"),I=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(o.t)({keyFacet:a.ue,facets:[f.f,l.t]}));e(Object(o.t)({keyFacet:a.k,facets:[a.k,l.e]}));e(Object(o.t)({keyFacet:a.L,facets:[a.L,l.e]}));e(Object(o.t)({keyFacet:a.F,facets:[a.F,l.e,l.t]}));e(Object(s.o)(a.O,u.e)(Object(i.i)({maxParallelOperationCount:4})(d)));e(Object(s.o)(a.d,u.e)(Object(i.i)()(y)));e(Object(s.o)(a.L,u.e)(Object(i.i)()(S)));e(Object(s.o)(a.ue,u.e)(Object(i.i)({maxParallelOperationCount:4})(T)));e(Object(s.o)(a.F,u.e)(Object(i.i)({maxParallelOperationCount:8})(_)));e(Object(H.r)(a.F,P.e)(j));e(Object(s.o)(a.k,u.e)(Object(i.r)(F)));return[2]})})}})}],Array(13),[function(e,t,n){"use strict";var r,i=n(0),s=n(566),o=n(374),u={Folder:"NewFolder",Word:"NewDOC",Excel:"NewXSL",PowerPoint:"NewPPT",OneNote:"NewONE",ExcelSurvey:"NewXSLSurvey",FormForExcel:"NewXSLForm",Visio:"NewVSDX"},a=((r={})[s.e.key]=u.Folder,r[o.o.key]=u.Word,r[o.e.key]=u.Excel,r[o.i.key]=u.PowerPoint,r[o.r.key]=u.OneNote,r[o.t.key]=u.ExcelSurvey,r[o.n.key]=u.FormForExcel,r[o.s.key]=u.Visio,r);var f=n(15),l=n(199),c=n(3131),h=n(2861);var p=n(196),d=n(1),v=n(370),m=n(2),g=n(258),y=n(558),b=n(1324),w=n(66),E=n(2862),S=n(3),x=function(e){var t=e.template,n=e.listKey;if(!t.url)throw new Error("Cannot create a command for a template without a URL.");var r,i,s=t.url,o=S.V.serialize({listKey:n,templateUrl:s});return{key:new m.e("createDocumentFromTemplate").id,automationId:"createDocumentFromTemplate",name:t.title,action:d.createElement(w.e,null,d.createElement(v.e,{documentType:Object(E.t)(s),templateItemKey:o})),iconProps:Object(g.e)({extension:(r=s,i=Object(y.t)(r,!0),Object(b.t)(i)),size:16})}};var T=n(2272);n.d(t,"e",function(){return N});function N(e,t){var n=t.contentTypes,r=t.newCommandMenu,d=t.fileHandlerCommands,v=t.isCreateFolderAvailable,m=t.newDocumentTemplates,g=t.contentTypeCommands,y=t.listKey,b={},w={},E=(function(){var e;return(e={})[u.Folder]=s.e,e[u.Word]=o.o,e[u.Excel]=o.e,e[u.PowerPoint]=o.i,e[u.OneNote]=o.r,e[u.ExcelSurvey]=o.t,e[u.FormForExcel]=o.n,e[u.Visio]=o.s,e})(),S={},N=[],C=[];if(!f.e.isActivated("7FE1672F-3DCA-41A7-8CAF-C5B376315694","11/19/2018","Build New menu with newDocumentTemplates")&&m&&m.length){if(g)for(var k=0,L=g;k<L.length;k++){(M=L[k]).name&&(b[M.name]=M)}if(n)for(var A=0,O=n;A<O.length;A++){var M;b[(M=O[A]).displayName]&&M.contentTypeId&&(w[M.contentTypeId]=b[M.displayName])}var _=r.subMenuProps&&r.subMenuProps.items;if(_)for(var D=0,P=_;D<P.length;D++){(I=P[D]).name&&(E[I.name]=I);I.automationId&&(E[I.automationId]=I)}for(var H=void 0,B=0,j=m;B<j.length;B++){var F=j[B];F.isContentType&&F.contentTypeId&&(S[F.contentTypeId]=!0);var I=void 0;F.isUpload&&y?I=x({template:F,listKey:y}):F.isContentType&&F.contentTypeId&&w[F.contentTypeId]?I=w[F.contentTypeId]:E[F.title]?I=E[F.title]:F.templateId&&E[F.templateId]&&(I=E[F.templateId]);if(I){var q=F.templateId||a[I.key];q===u.Folder&&(H=!0);C.push(Object(i.__assign)(Object(i.__assign)({},F),{templateId:q,command:I}));if(F.visible){N.push(I);E[F.title]&&E[F.title].key===s.e.key&&N.push({name:"-",key:"divider_1",itemType:p.e.Divider})}}}!H&&v&&s.e.name&&C.unshift({command:s.e,templateId:a[s.e.key],title:s.e.name,visible:!1});for(var R in w)if(w.hasOwnProperty(R)&&!S[R]){var U=w[R];U.name&&C.push({command:U,contentTypeId:R,isContentType:!0,templateId:R,title:U.name,visible:!0});N.push(U)}}else{C=(function(e,t){var n=t.isCreateFolderAvailable,r=t.contentTypeCommands,i=void 0===r?[]:r,o=t.contentTypes,u=[];n&&s.e.name&&u.push({command:s.e,templateId:a[s.e.key],title:s.e.name,visible:!0});var f=!(!i||!i.length),p={};if(o)for(var d=0,v=o;d<v.length;d++){var m=v[d];m.contentTypeId&&(p[m.displayName]=m.contentTypeId)}if(f)for(var g=0,y=i;g<y.length;g++){if((x=y[g]).name){var b=p[x.name];u.push({command:x,contentTypeId:b,isContentType:!0,templateId:b,title:x.name||"",visible:!0})}}var w=l.e.subMenuProps&&l.e.subMenuProps.items;if(w)for(var E=0,S=w;E<S.length;E++){var x;(x=S[E]).name&&-1===[s.e.key,"divider_1","divider_2",c.e.key,h.e].indexOf(x.key)&&u.push({command:x,templateId:a[x.key],title:x.name,visible:!f})}return u})(0,{isCreateFolderAvailable:v,contentTypeCommands:g,contentTypes:n});g&&g.length?N.push.apply(N,Object(i.__spreadArrays)([s.e,{name:"-",key:"divider_1",itemType:p.e.Divider}],g)):N=r.subMenuProps?Object(i.__spreadArrays)(r.subMenuProps.items):[]}d&&d.new&&(N=Object(T.t)(N,d.new));return{visibleNewCommands:Object(i.__assign)(Object(i.__assign)({},l.e),{subMenuProps:{items:N}}),allCommands:C}}},,,,,,,function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(196),o=n(3),u=n(4),a=n(7),f=n(115),l=n(2),c=n(126),h=n(24),p="needsAttentionIconOverlay_c2872345",d="needsAttentionIcon_c2872345",v=n(290),m=n(557),g=n(21),y=n(492),b=n(15),w=n(59),E=n(584),S=n(611),x=n(16),T=n(50),N=n(68),C=n(181),k=n(61),L=n(289),A={ODB:1725},O={ODB:1553};function M(e,t){var n=Object(T.e)(e,{enableQuickEdit:u.F}).enableQuickEdit,r=Object(k.e)(e).itemsScopeItemKey,i=r&&Object(C.e)(e,{itemsScopeItemKey:r}),s=i&&i.id===L.e.id;return!!(n&&!!s&&Object(w.e)(e,{feature:A})&&Object(w.e)(e,{feature:O}))}var _=Object(x.n)()(Object(N.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("dot_switchgridlayoutactionexecutor").then(n.bind(null,3629))];case 1:return[2,e.sent().SwitchGridLayoutActionExecutor]}})})},M,function(e,t){var n=t.itemKey,r=t.viewType,i=e.demandItem({deserizalizedKey:o.S},n).deserizalizedKey,s=i&&i.viewKey&&o.oe.serialize(i.viewKey),a=s&&e.demandItemFacet(u.Ht,s);return M(e)&&a===r}));n.d(t,"e",function(){return V});var D=[{ODB:1776}],P={ODB:1484},H={iconName:void 0,styles:{root:{display:"none!important"}}},B=new l.e("switchView").id,j=new l.e("needsAttentionView").id,F=new l.e("setDefaultView").id,I=new l.e("customizeView").id,q=Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3493))];case 1:return[2,e.sent().SwitchViewAction]}})})}),R=Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3493))];case 1:return[2,e.sent().SetDefaultViewAction]}})})}),U=Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3493))];case 1:return[2,e.sent().SaveViewAction]}})})}),z=Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.resolve().then(n.bind(null,3628))];case 1:return[2,e.sent().CreateViewAction]}})})}),W={key:new l.e("switchToFixedGridLayoutCommand").id,automationId:"switchToFixedGridLayoutCommand",name:v.e.fixedHeight,action:i.createElement(_,{viewType:"GRIDFIXED"}),iconProps:{iconName:"ViewList"}},X={key:new l.e("switchToDynamicGridLayoutCommand").id,automationId:"switchToDynamicGridLayoutCommand",name:v.e.dynamicHeight,action:i.createElement(_,{viewType:"GRID"}),iconProps:{iconName:"DynamicList"}};function V(e,t){var n=t.viewKeys,c=t.webAbsoluteUrl,x=t.listViewSetKey,T=t.itemSetKey,N=t.currentViewKey,C=o.U.serialize({webAbsoluteUrl:x.webAbsoluteUrl,listFullUrl:x.listFullUrl}),k=Object(w.e)(e,{feature:P})&&D.some(function(t){return Object(w.e)(e,{feature:t})}),L=e.demandItemFacet(u.ye,C),A=!!L&&!!L.templateType&&Object(h.s)(L.templateType),O=!!L&&!!L.templateType&&L.templateType===h.n.webPageLibrary,M=void 0,_=!1,V=v.e.Views,K=e.demandItem({showViewModifiedIndicator:u.Ke,currentDerivedView:u.p},N),Q=K.showViewModifiedIndicator,G=K.currentDerivedView;if(L&&G&&"POWER"!==G.viewType&&L.permissions&&G.canUserEdit(L.permissions)){_=!0;M=e.demandItemFacet(a.L,o.oe.serialize({viewId:G.id}))}G&&G.title&&(V=G.title);_&&(Q||G&&G.isDirty())&&(V=g.format(v.e.ViewModifiedIndicator,V));var Y=n.map(function(t){var n=e.demandItemFacet(u.Je,t);if(n&&!n.Hidden)return(function(e,t,n,r){var s=f.e.normalizeLower(e.Id,!1);return{key:B+"-"+s,automationId:"switchViewCommand_"+s,name:e.Title,iconProps:H,action:i.createElement(q,{viewId:s,currentDerivedView:r,itemSetKey:n})}})(n,0,T,G)}).filter(function(e){return!!e}),Z=(function(e,t){var n=e.demandItemFacet(u.Le,t);return!(!n||!e.demandItemFacet(a.C,n))})(e,T),ee=(function(e,t){var n,r=t.isPagesLib,s=t.isList,u=t.itemsNeedAttention,a=t.currentDerivedView,f=t.itemSetKey,l=o.f;n=r&&Object(w.e)(e,{feature:{ODB:1743}})?v.e.PagesThatNeedAttention:s?v.e.ItemsThatNeedAttention:v.e.FilesThatNeedAttention;return{key:j,automationId:"needsAttentionViewCommand",name:n,iconProps:u?{iconName:"error",styles:{root:d}}:H,action:i.createElement(q,{viewId:l,currentDerivedView:a,itemSetKey:f})}})(e,{isList:A,isPagesLib:O,itemsNeedAttention:Z,itemSetKey:T,currentDerivedView:G}),te=(function(e,t,n){var r=o.U.serialize({webAbsoluteUrl:t,listFullUrl:n}),i=e.demandItemFacet(u.h,r),s=[];i&&i.length&&i.forEach(function(t){var n=e.demandItemFacet(u.bt,t),r=n&&n.requiredFields&&n.requiredFields.split(",");r&&r.length>0&&(s=s.concat(r))});return s.length>0})(e,c,x.listFullUrl),ne=G?(function(e){var t=e.isCreateNewViewEnabled,n=e.currentDerivedView,s=e.listViewSetKey,u=e.editViewPageUrl,a=o.oe.serialize({viewId:n.id}),f=o.z.serialize(s),l=u||t&&"MODERNCALENDAR"===n.viewType;return Object(r.__spreadArrays)(t?[{key:J,automationId:"createViewCommand",name:v.e.CreateNewView,iconProps:H,action:i.createElement(z,{listViewSetKey:f,currentViewKey:a,isEditing:!1})}]:[],[{key:$,automationId:"saveCommand",name:v.e.SaveViewAs,iconProps:H,action:i.createElement(U,{listViewSetKey:f,currentViewKey:a})},{key:F,automationId:"setDefaultViewCommand",name:v.e.SetDefaultView,iconProps:H,action:i.createElement(R,{currentDerivedView:n,listViewSetKey:s})}],l?[{key:I,automationId:"customizeViewCommand",name:v.e.CustomizeView,iconProps:H,action:"MODERNCALENDAR"===n.viewType?i.createElement(z,{listViewSetKey:f,currentViewKey:a,isEditing:!0}):i.createElement(m.e,{itemKey:a})}]:[])})({listViewSetKey:x,editViewPageUrl:M,isCreateNewViewEnabled:k,currentDerivedView:G}):[],re="MODERNCALENDAR"===e.demandItemFacet(u.Ht,N)?[{key:new l.e("calendarMonth").id,isPermanent:!1,automationId:"calendarMonthCommand",name:v.e.calendarMonthTitle,title:v.e.calendarMonthDesc,action:i.createElement(E.e,{layoutType:S.e}),iconProps:{iconName:"calendar"}}]:[],ie=Object(r.__spreadArrays)(y.e.subMenuProps?y.e.subMenuProps.items:[],re,[{name:"-",key:"divider_1",itemType:s.e.Divider}],te?[ee,{name:"-",key:"divider_1",itemType:s.e.Divider}]:[],[W,X,{name:"-",key:"divider_1",itemType:s.e.Divider}],Y,[{name:"-",key:"divider_1",itemType:s.e.Divider}],ne,[{name:"-",key:"divider_1",itemType:s.e.Divider}]),se={name:V,key:y.e.key,automationId:y.e.automationId,iconProps:y.e.iconProps,title:v.e.SwitchViewsCommandTitle,ariaLabel:g.format(v.e.SwitchViewsCommandAriaLabel,V),postProcess:function(e){var t=e.subMenuProps&&e.subMenuProps.items,n=t&&t.filter(function(e){return e.checked})[0];return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t&&1===t.length?{subMenuProps:void 0,disabled:!0}:{}),n?{iconProps:Object(r.__assign)(Object(r.__assign)({},n.iconProps),Z?{styles:{root:p}}:{})}:{})},subMenuProps:{items:ie}};if(!b.e.isActivated("1F653F6B-43CA-48DE-9719-5E5D3A5B573B","06/07/2019","Create SwitchLayoutCommand cacheKey with current selected viewId")){var oe=G?f.e.normalizeLower(G.id,!1):"";se.cacheKey=y.e.key+"_viewId_"+oe}return se}var $=new l.e("saveView").id,J=new l.e("createView").id},,,,,,,,,,,,,function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(1133),o=n(3749),u=n(2792),a=n(1134),f=n(288);n.d(t,"e",function(){return l});var l=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onClose=function(){n.setState({isOpen:!1})};n._iframeOnLoad=function(){var e=n.props.heightOffset;if(n._iframeElement&&n._iframeElement.contentDocument){var t=n._iframeElement.contentDocument.body.clientHeight;t<=0&&e&&(t=document.body.clientHeight*e);n._iframeElement.style.height=t+"px"}n.setState({isIFrameLoaded:!0});n.props.onLoad&&n._iframeElement&&n.props.onLoad(n._iframeElement)};n.state={isOpen:!0,isIFrameLoaded:!1};return n}t.prototype.UNSAFE_componentWillReceiveProps=function(e){this.setState({isIFrameLoaded:!1})};t.prototype.render=function(){var e=this,t=this.props,n=t.url,l=(t.heightOffset,Object(r.__rest)(t,["url","heightOffset"])),c=this.state.isIFrameLoaded;return i.createElement(o.e,Object(r.__assign)({className:"IFrameDialog_14852148",hidden:!this.state.isOpen,type:u.e.close},l),i.createElement(s.e,null,!c&&i.createElement(a.e,{size:f.e.large}),i.createElement("iframe",{ref:function(t){return e._setupIFrameElementFunctions(t)},src:n,style:{display:c?"block":"none"},onLoad:this._iframeOnLoad})))};t.prototype._setupIFrameElementFunctions=function(e){if(e){var t=e;t.cancelPopUp=this._onClose;t.commitPopup=this._onClose}this._iframeElement=e};return t})(i.Component)},function(e,t,n){"use strict";var r=n(0),i=n(1856),s=n(172),o=n(7),u=n(13),a=n(56),f=n(574),l=n(5),c=new l.e("userById",{id:Object(l.s)(),endpoint:Object(l.s)()}),h=n(233),p=n(2828),d=n(2078);n.d(t,"e",function(){return v});n.d(t,"t",function(){return m});function v(e){var t,n=e.itemKey,l=e.driveItemKey,h=e.parentFolderItemKey,v=e.setItemKey,g=e.driveItemResponse,y=e.endpoint,b=e.getDriveItemFacets,w=void 0===b?i.e:b,E=new a.e,S=f.e.serialize({driveItemKey:l}),x=v?Object(s.e)().forFacet(o.f).thenInvalidate(v,u.e).forFacet(o.a).thenInvalidate(v,u.e).forFacet(o.A).thenInvalidate(v,u.e).pack():void 0,T=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},w({driveItemKey:l,driveItem:g,endpoint:y,parentFolderItemKey:h})),o.e.pack({itemKey:S})),x);E.resolveItems({items:(t={},t[n]=T,t)});if(g.lastModifiedBy){if(k=g.lastModifiedBy.user){var N=k.id&&c.serialize({id:k.id,endpoint:y});if(N=k.email&&d.e.serialize({email:k.email,endpoint:y})){var C=m({itemKey:n,personFacet:o.k,userKey:N,user:k}).itemResolver;E.merge(C)}}}if(g.remoteItem&&g.remoteItem.shared&&g.remoteItem.shared.sharedBy&&g.remoteItem.shared.sharedBy.user){var k,L=void 0;if((k=g.remoteItem.shared.sharedBy.user).email){L=d.e.serialize({email:k.email,endpoint:y});C=m({itemKey:n,personFacet:p.e,userKey:L,user:k}).itemResolver;E.merge(C)}}return{itemResolver:E}}function m(e){var t,n,i=e.itemKey,s=e.personFacet,u=e.userKey,f=e.user,l=new a.e;l.resolveItems({items:Object(r.__assign)((t={},t[u]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},o.f.pack(f.displayName)),h.e.pack(f.email)),h.n.pack(f.id)),t),s&&(n={},n[i]=Object(r.__assign)({},s.pack({itemKey:u,displayValue:f.displayName})),n))});return{itemResolver:l}}},function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(4),o=n(3),u=n(9),a=n(13),f=n(62),l=n(177),c=n(7),h=n(28),p=n(229),d=n(20),v=n(346),m=n(46),g=n(59),y=new(n(11).e)("filterActionControl"),b=n(26),w=n(1439),E=n(252),S=n(15),x=n(126);n.d(t,"e",function(){return L});var T={ODB:1352},N=Object(x.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("dotdot_components_filterpanel_filterpanel")]).then(n.bind(null,3816))];case 1:return[2,e.sent().FilterPanel]}})})}),C=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.itemSetKey,u=t.filterableSet,l=t.internalName,c=t.filterOptionSet,b=t.fieldType,w=t.checkedFilterKeys;return i.createElement(p.e,null,function(t){var p=t.itemCache,E=t.dispatch;if(!(l&&u&&c&&b))return i.createElement(d.n,null);for(var S=[],x={},N=0,C=c;N<C.length;N++){var k=C[N];x[k.value]=k}for(var L=0,A=w;L<A.length;L++){var O=A[L];x[O]&&S.push(x[O].value)}var M,_=u.getFilteredItemSetKey({filterField:l,filterValues:S,filterType:b,useLookupId:!1}),D=p.demandItemFacet(o.S,_),P=p.demandItemFacet(a.i,n),H=p.demandItemFacet(o.S,n),B=H&&H.viewKey&&o.oe.serialize(H.viewKey);H&&(M=p.demandItemFacet(s.Et,o.Z.serialize({webAbsoluteUrl:H.webAbsoluteUrl,listFullUrl:H.listFullUrl})));var j,F=Object(g.e)(p,{feature:T,pageContext:M});if(F){var I=p.demandItemFacet(y,n),q=y.evaluate(I)(p,{viewKey:B}).onFilter;j=q}var R=Object(m.e)(p,{itemKey:n,engagement:{name:"ApplyFilters",isIntentional:!0}});return i.createElement(d.n,{action:i.createElement(v.e,{itemKey:_})},function(t){var n=t.isAvailable,o=t.execute;return i.createElement(h.e,Object(r.__assign)({isAvailable:n,onExecute:function(t){return Object(r.__awaiter)(e,void 0,void 0,function(){var e,n,i;return Object(r.__generator)(this,function(u){switch(u.label){case 0:if(F&&j){e=D&&D.filterParams;E(j({filterParams:e}))}E(Object(f.e)({items:Object(r.__assign)((n={},n[_]=Object(r.__assign)({},a.i.pack(P)),n),B?(i={},i[B]=Object(r.__assign)({},s.Ke.pack(!0)),i):{})}));return[4,o(t)];case 1:u.sent();return[2]}})})}},R))})})};return t})(i.PureComponent),k=Object(u.t)(function(e,t){var n=t.columnKey,u=t.itemSetKey,f=e.demandItem({fieldType:s.J,mappedColumnFieldType:s.xe,internalName:s.ue},n),l=f.fieldType,c=f.mappedColumnFieldType,h=f.internalName,p=e.demandItem({deserializedSetKey:o.S,filterableSet:s.ot,filterOptionSets:a.n},u),d=p.deserializedSetKey,v=p.filterableSet,m=p.filterOptionSets,g=d&&e.demandItemFacet(s.Et,o.Z.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl})),y=d&&e.demandItemFacet(s.Tt,o.ee.serialize({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl})),x=e.demandItemFacet(s.K,m&&m[n]),T=e.isItemFacetResolved(s.K,m&&m[n]),N=v&&x&&v.appliedFilters&&h&&v.appliedFilters[h]?v.appliedFilters[h].values:[],k=d&&d.viewKey&&o.oe.serialize(d.viewKey),L=k&&e.demandItemFacet(s.p,k),A=e.dispatch,O="User"===l||"UserMulti"===l||c===b.e.Text||c===b.e.Title?{pageContextForPicker:g,peoplePickerDataSource:y,getFilterSuggestions:function(e,t,n){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o;return Object(r.__generator)(this,function(r){i=[];if(L&&d){s=!g||!Object(S.t)(g).isActivated("74450E1A-074B-45F1-82F4-FB3FBE834B78","10/15/2019","Use contains to get filter suggestion");o=s?w.f(L.getEffectiveViewXml(),e,t,n):w.a(L.getEffectiveViewXml(),e,t,n);return[2,A(Object(E.e)({webAbsoluteUrl:d.webAbsoluteUrl,listFullUrl:d.listFullUrl,currentPageContext:g,qosName:"FilterPanel.GetFilterSuggesitons",viewXml:o,rootFolder:d.rootFolder})).then(function(t){if(t.ListData&&t.ListData.Row){var n={};t.ListData.Row.forEach(function(t){var r=t[e],s={display:r,value:r};if(!n.hasOwnProperty(s.value)){n[s.value]=s;i.push(s)}})}return i})]}return[2,i]})})}}:void 0;return{filterOptionSet:x||[],mappedColumnFieldType:void 0!==c?c:b.e.Text,fieldInternalName:h||"",applyFiltersAction:function(e){return i.createElement(C,Object(r.__assign)({},e,{itemSetKey:u,filterableSet:v,fieldType:l,internalName:h}))},isLoading:!T,checkedFilterValues:N,filterPickerProps:O}})(N),L=Object(u.i)(function(e,t){var n=t.columnKey,s=t.itemSetKey,u=t.isToggled,a=e.demandItemFacet(c.f,n),f=e.demandItemFacet(y,s),p=e.demandItemFacet(o.S,s),v=p&&p.viewKey&&o.oe.serialize(p.viewKey),g=y.evaluate(f)(e,{viewKey:v,isAvailable:!0}).isAvailable,b=Object(d.o)(function(e){return i.createElement(k,{onClose:function(){e.reject(new l.e)},onComplete:function(){e.resolve()},columnName:a||"",columnKey:n,itemSetKey:s})});return i.createElement(h.e,Object(r.__assign)({isAvailable:g,isToggled:u,onExecute:b},Object(m.e)(e,{itemKey:s,engagement:{name:"LaunchFilterPanel",isIntentional:!0}})))})},,,,,function(e,t,n){"use strict";var r=n(1),i=n(66),s=n(2),o=n(290),u=n(0),a=n(617),f=n(175),l=n(457),c=n(251),h=n(18),p=n(3),d=n(180),v=n(394),m=n(4),g=n(24),y=n(51),b=n(483),w=n(9),E=Object(f.t)(function(){return{type:"file"}})(a.e),S=Object(w.t)(function(){return{fileSelector:E}})(l.e),x=Object(w.i)(function(e,t){var n=t.engagement,i=Object(c.e)(e);return i?r.createElement(d.t,{controlHandlers:Object(u.__assign)({},v.e.pack(T))},r.createElement(S,{itemKey:i,engagement:Object(h.p)({name:"UploadTemplate",isIntentional:!0},n)})):null});function T(e,t){var n=Object(c.e)(e),r=e.demandItemFacet(p.D,n);if(!r)return{isAvailable:!1};var i=r.listFullUrl;if(!i)return{isAvailable:!1};var s=new b.e(i+"/Forms").path,o=p.D.serialize(Object(u.__assign)(Object(u.__assign)({},r),{rootFolder:""})),a=p.D.serialize(Object(u.__assign)(Object(u.__assign)({},r),{rootFolder:s})),f=e.demandItemFacet(m.Fe,o);return{targetItemKey:a,isAvailable:y.t.hasItemPermission({permissions:f},y.t.manageLists)&&N(e,r)}}function N(e,t){var n=t&&e.demandItemFacet(m.ye,p.U.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}));return!!n&&!!n.isDocumentLibrary&&n.templateType!==g.t.webPageLibrary}n.d(t,"t",function(){return C});n.d(t,"e",function(){return k});var C={key:new s.e("UploadTemplate").id,automationId:"UploadTemplate",name:o.e.UploadTemplate,action:r.createElement(i.e,null,r.createElement(x,{engagement:{name:"UploadTemplate"}}))},k={key:new s.e("AddTemplate").id,automationId:"AddTemplate",name:o.e.AddTemplate,iconProps:{iconName:"Add"},action:r.createElement(i.e,null,r.createElement(x,{engagement:{name:"AddTemplate"}}))}},,,,,,function(e,t,n){"use strict";var r=n(3),i=n(4),s=n(885),o=n(123),u=n(2859);function a(e,t,n,r,i,s,o){return{key:n+r,name:r,action:t(o),iconProps:l(e,s,i)}}function f(e,t,n,r,i,s,o,u){return{key:n+r.displayName,name:r.displayName,action:t(r.contentTypeId||""),iconProps:l(e,s,i)}}function l(e,t,n){return t?{iconName:t}:{iconName:"CustomIcon",style:{backgroundImage:"url("+(n?e+n:n)+")",width:"16px",height:"16px",backgroundRepeat:"no-repeat"}}}function c(e,t,n,r,i,s){return Object(u.e)(e,t,a.bind(void 0,t.webAbsoluteUrl,r),f.bind(void 0,t.webAbsoluteUrl,i),n,s)}n.d(t,"e",function(){return h});function h(e,t){var n,u=t.key,a=t.listKey,f=t.listFacets,l=t.pageContext,h=[],p=r.D.serialize(u),d=e.demandItemFacet(i.h,p);if(d&&d.length){d.forEach(function(t){var n=e.demandItemFacet(i.at,t);n&&h.push(n)});if(!Object(s.e)(h,f)&&l){var v=new o.t({context:{webAbsoluteUrl:u.webAbsoluteUrl,listUrl:u.listFullUrl}}).getUrlParts({path:u.rootFolder});n=c(h,l,v,function(t){return u&&e.demandItemFacet(i.t,r.m.serialize({listKey:a,templateUrl:t}))},function(t){return u&&e.demandItemFacet(i.t,r.g.serialize({listKey:a,contentTypeId:t}))},f)}}return{contentTypes:h,contentTypeCommands:n}}},,,,function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(680),o=n(1195),u=n(4),a=n(2857),f="iconContainer_3e822284",l="menuItemIconContainer_3e822284",c="logoFillIcon_3e822284",h="logoIcon_3e822284",p=n(16),d=n(9),v=n(7),m=n(2348),g=n(2347),y=n(2);n.d(t,"t",function(){return w});n.d(t,"e",function(){return E});var b=new y.e("fileHandlerOpenCommand").id,w=Object(p.s)()(Object(p.r)()(Object(d.t)(function(e,t){var n=t.itemKey,r=t.item,i=e.demandItem({appMap:u.Pe},n).appMap,s=r.name;r.key===m.e.key?s=s||(i?Object(a.i)(i,!0):a.e.Open):r.key===g.e.key&&(s=s||(i?Object(a.r)(i,!0):a.e.OpenInBrowser));return{name:s}})(function(e){return i.createElement("div",{className:"contextualMenuItemLinkContent_3e822284"},i.createElement("span",{dir:"auto",className:"contextualMenuItemTextLabel_3e822284"},e.name))}))),E=Object(p.s)()(Object(p.r)()(Object(d.t)(function(e,t){var n=t.itemKey,i=t.menuProps,s=e.demandItem({appMap:u.Pe,fileName:v.h},n),o=s.appMap,f=s.fileName,l={};if(i&&i.items){var c=i.items[0];c&&-1!==c.key.indexOf(b)&&c.iconProps&&(l=c.iconProps)}var h=!!f&&!!f.extension&&".pdf"===f.extension.toLowerCase(),p=o&&Object(a.n)(o),d={iconName:o?Object(a.t)(o):h?"PDF":"OpenFile"},y=void 0;i&&i.items&&(y=i.items.map(function(e){return e.key===m.e.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:d,name:e.name||o&&Object(a.i)(o,!0)||a.e.Open,onRenderIcon:p?S.bind(void 0,p,!0):void 0}):e.key===g.e.key?Object(r.__assign)(Object(r.__assign)({},e),{iconProps:d,name:e.name||o&&Object(a.r)(o,!0)||(h?a.e.OpenInBrowser:a.e.Open),onRenderIcon:p?S.bind(void 0,p,!0):void 0}):e}));return{iconProps:l||d,onRenderIcon:p?S.bind(void 0,p,!1):void 0,text:a.e.Open,menuProps:y?Object(r.__assign)(Object(r.__assign)({},i),{items:y}):i}})(o.e)));function S(e,t){return e?i.createElement("span",{className:t?l:f},i.createElement(s.e,{iconName:e.logoFill16,className:c}),i.createElement(s.e,{iconName:e.logo16,className:h})):null}},,,,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(4),s=n(247),o=n(2837),u=n(135),a=n(3164);function f(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.fieldInternalName,i=e.viewId,s=e.rootFolder,f=e.excludeFieldFilteringHtml,l=e.filterParams,c=Object(a.e)({webAbsoluteUrl:t,listFullUrl:n}).segment("RenderListFilterData").parameter("FieldInternalName",r||"");i&&(c=c.parameter("ViewId",i));s&&(c=c.parameter("RootFolder",{raw:Object(o.e)(s)}));f&&(c=c.parameter("ExcludeFieldFilteringHtml",!0));if(l){var h=u.default.getFilterParams(l,!0);c=c.rawParameter(h)}return c.toString()}var l=n(1590),c=n(3),h=n(26),p=n(19),d=n(99),v=n(56),m=n(54),g=n(115);n.d(t,"getSPFilterOptionSetHandler",function(){return y});var y=Object(p.i)({maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,o=c.b.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,p,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:t=e((function(e){var t=e.itemSetKey,n=e.fieldKey;return function(e){var r=e(Object(m.e)({spDataSourceConfiguration:i.rt})).spDataSourceConfiguration,s=r&&r.ensureAuthToken,o=c.D.serialize(t),u=e(Object(d.e)({folderPath:i.Q},o)),a=e(Object(d.e)({internalName:i.ue,mappedColumnFieldType:i.xe,isCalculated:i.fe},c.y.serialize(n))),f=u&&u.folderPath,l=a&&a.internalName&&a.internalName,p=a&&a.mappedColumnFieldType===h.e.Taxonomy,v=a&&a.isCalculated,y=c.Z.serialize({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl}),b=e(Object(d.e)({pageContext:i.Et},y)).pageContext,w=t.viewKey&&t.viewKey.viewId,E=w===g.e.Empty?b&&b.viewId:w;return{webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,rootFolder:f,ensureAuthToken:s,fieldInternalName:l,isCalculatedField:v,filterParams:t.filterParams,excludeFieldFilteringHtml:p,viewId:E}}})({itemSetKey:o.itemSetKey,fieldKey:o.fieldKey}));return[4,e((w=t,function(e){return e(Object(s.t)({webAbsoluteUrl:w.webAbsoluteUrl,listFullUrl:w.listFullUrl,method:"POST",url:f(w),parseResponse:function(e){return e},qosName:"getFilterData",noRedirect:!0}))}))];case 1:u=b.sent();a=l.e.getFilterData(u,t.fieldInternalName||"",t.isCalculatedField);(p=new v.e).resolveItems({items:(y={},y[n]=Object(r.__assign)({},i.K.pack(a)),y)});e(p.execute());return[2]}var w})})}})}],Array(67),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointBasicItemDataAddonDeferred",function(){return s});var r=n(19),i=n(2499),s=Object(r.t)(function(){return function(e){e(i.sharePointItemByFullUrlAddon)}})}],Array(275),[function(e,t,n){"use strict";n.r(t);var r,i=n(0),s=n(19),o=n(64),u=n(817),a=n(146),f=n(840),l=n(3),c=n(2514),h=n(2512),p=n(2513),d=n(2839),v=n(2840),m=n(2493),g=n(2516),y=n(1558),b=n(2843),w=n(2844),E=n(2845),S=n(12),x=n(707),T=n(2);(function(e){e[e.preview=0]="preview";e[e.save=1]="save"})(r||(r={}));var N=new T.e("updateColumnFormatter"),C=(Object(o.i)({operationTypeFacet:N}),n(3090)),k=n(56),L=n(13),A=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.e.deserialize(n).tenantRootUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(i.__generator)(this,function(o){(t=new k.e).resolveItems({items:(s={},s[n]=Object(i.__assign)({},L.e.pack({itemKeys:[l.l.serialize({tenantRootUrl:r}),l.d.serialize({tenantRootUrl:r})]})),s)});e(t.execute());return[2]})})}});var O=n(1538),M=n(25),_=n(174),D=n(22),P=n(4),H=n(7),B=n(2008),j=n(293),F=n(292),I=n(568),q=n(204),R=n(173),U=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.l.deserialize(n).tenantRootUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(C){switch(C.label){case 0:t=new k.e;return[4,e(Object(O.demandItems)(function(e){var t=l.J.serialize({tenantRootUrl:r});return e.demandItemFacet(l.D,t,{suppressGetItems:!1})}))];case 1:return(s=C.sent())?[4,e(Object(O.demandItems)(function(e){return e.demandItemFacet(P.Et,l.Z.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}))}))]:[2];case 2:o=C.sent();u=e(Object(M.e)(function(e){return{isSavedForLaterEnabled:e.demandItemFacet(D.c,D.n),isSharedWithMeEnabled:!!e.demandItemFacet(R.a,D.n)}})),a=u.isSavedForLaterEnabled,f=u.isSharedWithMeEnabled;c={};h=o&&o.userDisplayName;p=l.D.serialize(s);c[p]={icon:"FabricFolder",displayName:q.e.files};d=j.e.serialize({endpoint:r+"/_api/v2.0"});c[d]={icon:"History",displayName:B.e.recentTitle};v=F.e.serialize({endpoint:r+"/_api/v2.0"});c[v]={icon:"SingleBookmark",displayName:B.e.saved};m=I.e.serialize({endpoint:""+r});c[m]={icon:"People",displayName:B.e.sharedWithMe};g=Object(i.__spreadArrays)([p,d],f?[m]:[],a?[v]:[]);for(y=0,b=g;y<b.length;y++){w=b[y];E=c[w],S=E.icon,x=E.displayName;t.resolveItems({items:(T={},T[w]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},_.t.pack(S)),H.f.pack(x)),H.d.pack({})),T)})}t.resolveItems({items:(N={},N[n]=Object(i.__assign)(Object(i.__assign)({},L.e.pack({itemKeys:g})),H.f.pack(h)),N)});e(t.execute());return[2]}})})}});var z=n(2176),W=n(284),X=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=this,n=Object.keys(e.options),r=e.itemKey,s=n[0],o=e.options[s],u=o.type,a=o.reorderPinInfo,f=l.c.serialize({itemKey:s,rootItemKey:r});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,n,o,c,h,p,d,v,m;return Object(i.__generator)(this,function(g){switch(g.label){case 0:t=e(Object(M.e)(function(e){return e.demandItem({siteId:P.Qe,webId:P.Bt,groupId:P.re},s)})),n=t.siteId,o=t.webId,c=t.groupId;h=new k.e;p=(function(e,t){switch(e){case"pin":return $();case"unpin":return;case"reorderPin":if(t){var n=t.nextPinOrder,r=t.prevPinOrder;if(n||r)return r?n?(r+n)/2:r/2:$()}return;default:return}})(u,a);h.resolveItems({items:(v={},v[f]=Object(i.__assign)({},P.Ie.pack(p)),v)});e(h.execute());return(d=l.d.deserialize(r).tenantRootUrl)?[4,e(V(d,{siteId:n||"",webId:o||"",groupId:c},u,a))]:[3,2];case 1:g.sent();(h=new k.e).invalidateItems({items:(m={},m[f]=[P.Ie],m)});e(h.execute());g.label=2;case 2:return[2]}})})}});function V(e,t,n,r){var s=this;return function(o){return Object(i.__awaiter)(s,void 0,void 0,function(){var s,u,a,f,l;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if("pin"===n){s="api/v1/sites/pinned/add";u="pinSite"}else if("unpin"===n){s="api/v1/sites/pinned/remove";u="unpinSite"}else{if("reorderPin"!==n)return[2];if(!r)return[2];a=Object(W.e)({PreviousPinOrder:r.prevPinOrder||"",NextPinOrder:r.nextPinOrder||""},void 0,!0);s="api/v1/sites/pinned/update?"+a;u="reorderSite"}return[4,o(Object(z.t)({tenantRootUrl:e}))];case 1:f=i.sent();l="";t&&(l=JSON.stringify({Title:t.title,Acronym:t.acronym,BannerColor:t.color,Url:t.url,Type:"Site",ItemReference:{Type:t.groupId?"GroupReference":"SiteReference",SiteId:t.siteId,WebId:t.webId,GroupId:t.groupId}}));return[4,o(Object(z.e)({path:s,method:"POST",qosName:u,context:f,body:l}))];case 2:i.sent();return[2]}})})}}function $(e){void 0===e&&(e=new Date);return 621355968e9+1e4*e.getTime()}var J=n(2340),K=n(327),Q=n(247),G=n(35),Y=n(3164),Z=n(230),ee=n(888),te=n(54),ne=n(2006),re=n(127),ie=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=l.J.deserialize(n).tenantRootUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,c,h,p,d,v;return Object(i.__generator)(this,function(m){switch(m.label){case 0:t=n(Object(te.e)({spPageFallbackWebAbsoluteUrl:P.xt})).spPageFallbackWebAbsoluteUrl;s=t||r;o=Object(Y.n)({webAbsoluteUrl:s}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return[4,n(Object(Q.t)({url:o.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:s,noRedirect:!0}))];case 1:if(!((u=m.sent())&&u.d&&u.d.mySite))throw new K.e({facets:Object(i.__assign)({},Z.f.pack({}))});a=u.d.mySite.replace(/\/$/,"");f={webAbsoluteUrl:a,listFullUrl:a+"/Documents",rootFolder:""};c=l.D.serialize(f);(h=new k.e).mapKeys({mappings:(d={},d[e.itemKey]=c,d)});p=new re.e(a).authority+"/_api/v2.0";void 0;"root";h.merge(n(Object(ee.e)({itemKey:c,spItem:f,driveUrl:Object(ne.n)({endpoint:p,driveId:void 0}),driveItemUrl:Object(ne.t)({endpoint:p,driveId:void 0,itemId:"root"})})).itemResolver);h.resolveItems({items:(v={},v[c]=Object(i.__assign)({},G.i.pack(l.D)),v)});n(h.execute());return[2]}})})}});var se=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.o)(l.J,a.e)(ie));e(Object(o.o)(l.e,a.e)(A));e(Object(o.o)(l.l,a.e)(U));e(Object(o.o)(l.d,J.t)(X));return[2]})})}}),oe=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=l.se.deserialize(n).tenantRootUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,c,h,p,d,v,m;return Object(i.__generator)(this,function(g){switch(g.label){case 0:t=l.ae.serialize({webAbsoluteUrl:r});return[4,n(Object(O.demandItems)(function(e){return e.demandItemFacet(P.He,t)}))];case 1:s=g.sent();o=n(Object(M.e)(function(e){return e.demandItemFacet(D.S,D.n)}));u=!s;f=o&&o.language||"en-US";c=Object(W.e)({Locale:f,v:2,msajax:1,cv:2});a=u?r+"/_layouts/15/online/handlers/SpoSuiteLinks.ashx?"+c:Object(Y.n)({webAbsoluteUrl:r}).segments("Microsoft.SharePoint.Portal.SuiteNavData.GetSuiteNavData").parameters({v:2,Locale:f});return[4,n(Object(Q.t)({url:a.toString(),qosName:"LoadData",method:"POST",webAbsoluteUrl:r,noRedirect:!0}))];case 2:h=g.sent();p=u?h:JSON.parse(h.d.GetSuiteNavData);d=!(!p.NavBarData||!p.NavBarData.AdminLink)||void 0;(v=new k.e).resolveItems({items:(m={},m[e.itemKey]=Object(i.__assign)({},P.At.pack(d)),m)});n(v.execute());return[2]}})})}});var ue=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.o)(l.se,a.e)(oe));return[2]})})}}),ae=n(2518),fe=n(62),le=n(723),ce=n(132),he=n(565),pe=n(59),de={ODB:1855},ve=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.formatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c;return Object(i.__generator)(this,function(h){switch(h.label){case 0:r=Object.keys(n)[0];s=n[r],o=s.updateType,u=s.formatter;return 0!==o?[3,1]:[2,e(Object(fe.e)({items:(l={},l[r]=Object(i.__assign)({},P.d.pack(u)),l)}))];case 1:return 2!==o?[3,4]:[4,e(Object(O.demandItems)(function(e){e.demandItemFacet(ce.e,ce.t.serialize({}))}))];case 2:h.sent();a=void 0;f=!1;return[4,e(Object(O.demandItems)(function(e){a=Object(he.t)(e,{mapping:{fieldData:P.W},itemSetKey:t}).map(function(e){return e.fieldData});f=Object(pe.e)(e,{feature:de})}))];case 3:h.sent();return[2,e(Object(fe.e)({items:(c={},c[r]=Object(i.__assign)({},P.Pt.pack(Object(le.e)({formatter:u,fields:a,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:f}}))),c)}))];case 4:return[2]}})})}}),me=n(2519),ge=n(99),ye=n(304),be=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.fields;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,c,h,p;return Object(i.__generator)(this,function(d){r=Object.keys(n)[0];s=n[r],o=s.displayName,u=s.fieldDescription,a=s.showInFiltersPane;if((f=e(Object(ge.e)({setKey:l.S},t)).setKey)&&r&&(c=e(Object(ge.e)({id:P.$},r)).id)){h={__metadata:{type:"SP.Field"},Title:o,SchemaXml:u,ShowInFiltersPane:a};p=Object(Y.e)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl}).method("Fields",c).toString();return[2,e(Object(Q.t)({webAbsoluteUrl:f.webAbsoluteUrl,listFullUrl:f.listFullUrl,url:p,qosName:"modifyFieldProperties",body:JSON.stringify(h),method:"POST",additionalHeaders:{"X-HTTP-Method":"MERGE"}})).then(function(){var t;return e(Object(fe.e)({items:(t={},t[r]=Object(i.__assign)(Object(i.__assign)({},void 0!==a?ye.n.pack(a):{}),void 0!==o?H.f.pack(o):{}),t)}))})]}return[2]})})}}),we=n(147),Ee=n(252),Se=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.X.deserialize(n),s={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,rootFolder:"",viewKey:{viewId:l.f}};return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,o;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e(Object(we.n)({itemSetKey:s}));return[4,e(Object(we.t)({itemSetKey:s,contentTypes:t,qosName:"getNeedsAttentionFlag"}))];case 1:r=i.sent();i.label=2;case 2:i.trys.push([2,5,,7]);return[4,e(Object(Ee.e)(r))];case 3:o=i.sent();return[4,e(xe(o,n))];case 4:i.sent();return[3,7];case 5:i.sent();return[4,e(xe(void 0,n))];case 6:i.sent();return[3,7];case 7:return[2]}})})}});function xe(e,t){var n=this;return function(r){return Object(i.__awaiter)(n,void 0,void 0,function(){var n,s,o,u;return Object(i.__generator)(this,function(a){n=!1;(s=e&&e.ListData&&e.ListData.Row)&&s.length>0&&s[0]&&(n=!0);(o=new k.e).resolveItems({items:(u={},u[t]=Object(i.__assign)({},H.C.pack(n||void 0)),u)});r(o.execute());return[2]})})}}var Te=n(3145),Ne=n(31),Ce=n(115),ke=n(1568),Le=Object(s.n)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,o,u,a,f,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,L,A,O,M;return Object(i.__generator)(this,function(_){switch(_.label){case 0:r=void 0;o=void 0;for(u=0,a=Object.keys(t);u<a.length;u++){m=a[u];f=n(Object(ge.e)({key:l.D,folderPath:P.Q},m));c=e.items[m];if(f&&f.key&&f.folderPath){if(!r){o=f.key.listFullUrl;r={webAbsoluteUrl:f.key.webAbsoluteUrl,items:[],checkInOutType:c.checkInOutType,checkInText:c.checkInText,checkInVersionType:c.checkInVersionType};o=f.key.listFullUrl}r.items.push({key:m,itemFullUrl:f.folderPath})}}if(!(h=r)||!h.items.length)return[3,4];p=h.items.length>1;d=void 0;d="checkIn"===h.checkInOutType?p?"batchCheckInItems":"CheckInItem":"checkOut"===h.checkInOutType?p?"batchCheckOutItems":"CheckOutItem":p?"batchUndoCheckOutItems":"UndoCheckOutItem";v="checkOut"===h.checkInOutType;if(p)return[3,2];m=h.items[0].key;g=Ae(h.webAbsoluteUrl,h.items[0].itemFullUrl,h.checkInOutType,h.checkInText,h.checkInVersionType);return[4,n(Object(Q.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:o,url:g,method:"POST",qosName:d}))];case 1:_.sent();n(Object(fe.e)({items:(O={},O[m]=Object(i.__assign)({},H.y.pack({byYou:!!v,byOther:void 0})),O)}));return[3,4];case 2:y=Ce.e.generate();b="multipart/mixed; boundary=batch_"+y;return[4,n(Object(Q.t)({webAbsoluteUrl:h.webAbsoluteUrl,listFullUrl:o,url:ke.t.getBatchOperationUrl(h.webAbsoluteUrl),body:Oe(h,y),method:"POST",additionalHeaders:void 0,contentType:b,parseResponse:function(e){return ke.t.processBatchResponse(e,h.items)},qosName:"batch",telemetryHandler:function(e){var t=e.response,n=e.eventData;return t&&n.resultType===Ne.t.success?{eventData:Object(i.__assign)(Object(i.__assign)({},n),{resultType:t.hasError?Ne.t.failure:Ne.t.success})}:{eventData:n}}}))];case 3:if((w=_.sent()).hasError){N={items:{}};for(C=0,L=w.items;C<L.length;C++)(A=L[C]).error&&A.key&&(N.items[A.key]=new K.e({message:A.error.message}));throw new s.e(N)}E=new k.e;for(S=0,x=h.items;S<x.length;S++){T=x[S];E.resolveItems({items:(M={},M[T.key]=Object(i.__assign)({},H.y.pack({byYou:!!v,byOther:void 0})),M)})}n(E.execute());_.label=4;case 4:return[2]}})})}});function Ae(e,t,n,r,i){var s;s="checkIn"===n?"CheckIn":"undoCheckOut"===n?"UndoCheckOut":"CheckOut";var o=Object(Y.r)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(o="checkIn"===n?o.methodWithAliases("CheckIn",{comment:r,checkintype:i||0}):o.segment(s)).toString()}function Oe(e,t){var n=e.items,r=ke.t.defaultBatchRequestPostData,i=n.map(function(t){return Ae(e.webAbsoluteUrl,t.itemFullUrl,e.checkInOutType,e.checkInText,e.checkInVersionType)});return ke.t.getBatchContentExtended(t,i,"POST",r)}var Me=n(2180),_e=n(2179),De=Object(s.n)()(function(e){var t=e.items;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(C){switch(C.label){case 0:r=void 0;s=void 0;o="";u=!0;for(a=0,f=Object.keys(t);a<f.length;a++){S=f[a];c=n(Object(ge.e)({key:l.D,folderPath:P.Q},S));h=n(Object(ge.e)({key:l.D,uiVersion:P.Mt,contentTypeId:P.c},S)),p=h.uiVersion,d=h.contentTypeId;o=_e.t(p);u=_e.i(d);v=e.items[S];m=n(Object(ge.e)({listItemId:P.we},S)).listItemId;if(c&&c.key&&c.folderPath){if(!r){s=c.key.listFullUrl;r={webAbsoluteUrl:c.key.webAbsoluteUrl,items:[],publishActionType:v.publishActionType,publishText:v.publishText};s=c.key.listFullUrl}r.items.push({key:S,itemFullUrl:c.folderPath,listItemId:m})}}if(!(g=r)||!g.items.length)return[3,4];y=g.publishActionType===Me.e.SchedulePublish;b=y?"ScheduleItem":"PublishItem";w=0;C.label=1;case 1:if(!(w<g.items.length))return[3,4];E=g.items[w];S=E.key;x=u&&g.publishActionType!==Me.e.CancelApproval;T=x?(function(e,t,n){return e+"/_api/sitepages/pages("+t+")/"+(n?"schedulepublish":"publish")})(g.webAbsoluteUrl,E.listItemId,y):(function(e,t,n){var r="Publish";n&&n===Me.e.CancelApproval&&(r="UnPublish");var i=Object(Y.r)({webAbsoluteUrl:e,listOrItemFullUrl:t}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:t});return(i=i.segment(r)).toString()})(g.webAbsoluteUrl,g.items[0].itemFullUrl,g.publishActionType);return[4,n(Object(Q.t)({webAbsoluteUrl:g.webAbsoluteUrl,listFullUrl:s,url:T,body:!y&&x?'{"__metadata":{"type":"SP.Publishing.SitePage"}}':"",method:"POST",qosName:b}))];case 2:C.sent();""!==o&&n(Object(fe.e)({items:(N={},N[S]=Object(i.__assign)({},P.Mt.pack(o)),N)}));C.label=3;case 3:w++;return[3,1];case 4:return[2]}})})}});var Pe=n(172),He=n(2181),Be=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,c,h;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(He.e)(t))];case 1:r=i.sent(),s=r.key,o=r.itemId;u=s.webAbsoluteUrl,a=s.listFullUrl;f=l.U.serialize({webAbsoluteUrl:u,listFullUrl:a});return(c=e(Object(M.e)(function(e){return e.demandItemFacet(P.ye,f)})))&&c.id&&o?[4,e(Object(Q.t)({webAbsoluteUrl:u,listFullUrl:a,url:Object(Y.n)({webAbsoluteUrl:u}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetRating",{listID:c.id,itemID:o,rating:n.userNewRating}).toString(),method:"POST",qosName:"updateRating"}))]:[3,3];case 2:i.sent();e(Object(Pe.t)({items:(h={},h[t]=[H.f],h)}));i.label=3;case 3:return[2]}})})}}),je=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,c,h;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(He.e)(t))];case 1:r=i.sent(),s=r.key,o=r.itemId;u=s.webAbsoluteUrl,a=s.listFullUrl;f=l.U.serialize({webAbsoluteUrl:u,listFullUrl:a});return(c=e(Object(M.e)(function(e){return e.demandItemFacet(P.ye,f)})))&&c.id&&o?[4,e(Object(Q.t)({webAbsoluteUrl:u,listFullUrl:a,url:Object(Y.n)({webAbsoluteUrl:u}).methodWithAliases("Microsoft.Office.Server.ReputationModel.Reputation.SetLike",{listID:c.id,itemID:o,like:n.liked}).toString(),method:"POST",qosName:"updateLikes"}))]:[3,3];case 2:i.sent();e(Object(Pe.t)({items:(h={},h[t]=[H.f],h)}));i.label=3;case 3:return[2]}})})}}),Fe=n(275),Ie=n(123),qe=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=e.options,s=r.newDocumentKey,o=r.extension;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,u,a,f;return Object(i.__generator)(this,function(c){switch(c.label){case 0:t=l.D.deserialize(n);r=t.rootFolder||new Fe.e(t.listFullUrl).path;u=new Ie.t({context:{webAbsoluteUrl:t.webAbsoluteUrl,listUrl:t.listFullUrl}});a=u.getUrlParts({path:r});f=a.fullItemUrl;return[4,e(Object(Q.t)({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,url:Re({webAbsoluteUrl:t.webAbsoluteUrl,listFullUrl:t.listFullUrl,parentFolderPath:a.listRelativeItemUrl||"",extension:o}),method:"POST",parseResponse:function(e){return JSON.parse(e)},qosName:"createCustomDocument",noRedirect:!0})).then(function(t){var r,o,u=t&&t.d&&t.d.CreateDocumentWithDefaultName;if(!u)throw"Fail to create custom document";var a=f+"/"+u;e(Object(fe.e)({items:(r={},r[s]=Object(i.__assign)(Object(i.__assign)({},H.f.pack(u)),H.i.pack(a)),r)}));e(Object(Pe.t)({items:(o={},o[n]=[L.t],o)}))})];case 1:c.sent();return[2]}})})}});function Re(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.extension,i=e.parentFolderPath;if(!r)throw new Error("document extension is not valid");return Object(Y.e)({webAbsoluteUrl:t,listFullUrl:n}).methodWithAliases("CreateDocumentWithDefaultName",{folderPath:i,extension:r}).toString()}var Ue=n(2757),ze=n(388),We=n(1633),Xe=n(437);function Ve(e){var t=e.sourceView,n=e.deserializedItemSetKey,r=e.appliedFilters,i=new ze.e(t.getEffectiveViewXml());n.sortFieldKey&&i.updateSort({fieldName:n.sortFieldKey,isAscending:n.sortAscending},{overwriteAll:!0});n.groupByFieldKey&&i.updateGroupBy({group1:{fieldName:n.groupByFieldKey,isAscending:!0}});if(r)for(var s in r)if(r.hasOwnProperty(s)){var o=r[s];We.updateFilter(i,o)}try{var u=Object(Xe.e)(t.id,!0);if(u){i.updateColumnWidths(u);Object(Xe.t)(t.id)}}catch(e){}return i}var $e=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,c,h,p,d,v,m,y,b,w,E,S,x,T;return Object(i.__generator)(this,function(N){r=l.z.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.sourceView,a=o.isPublic,f=o.itemSetKey,c=o.progressItemKey;if(u&&r){h=e(Object(ge.e)({deserializedItemSetKey:l.S,filterableSet:P.ot,childItems:L.e,parentItem:L.i,schema:L.s},f)),p=h.deserializedItemSetKey,d=h.filterableSet,v=h.childItems,m=h.parentItem,y=h.schema;(b=p?Ve({sourceView:u,deserializedItemSetKey:p,appliedFilters:d&&d.appliedFilters}):u).prepareForSaving();w=Object(Y.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).segment("Views").segment("Add");T=u.getEffectiveAggregatesFieldXml();return[2,e(Object(Q.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:w.toString(),method:"POST",body:JSON.stringify({parameters:{__metadata:{type:"SP.ViewCreationInformation"},Title:s,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:u.getEffectiveFieldNames()},Query:b.getEffectiveQueryXml(!1),Paged:!0,PersonalView:!a,RowLimit:u.rowLimit}}),qosName:"addView",noRedirect:!0})).then(function(t){var n,r,s;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;S={viewId:Ce.e.normalizeLower(o.Id,!1)};E=new ze.e(t.d);Object(Xe.n)(E);var u=new k.e;u.resolveItems({items:(n={},n[l.oe.serialize(S)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},l.oe.pack(S)),P.Je.pack(o)),P.p.pack(E)),P.Ke.pack(!1)),n)});if(p){x=l.S.serialize(Object(i.__assign)(Object(i.__assign)({},p),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:S}));u.resolveItems({items:(r={},r[x]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},v?L.e.pack(v):{}),m?L.i.pack(m):{}),y?L.s.pack(y):{}),r)})}c&&u.resolveItems({items:(s={},s[c]=Object(i.__assign)({},l.oe.pack(S)),s)});return e(u.execute())}).then(function(){var n,r;if(u.scope||T){var s={};u.scope&&(s.scope=u.scope);e(Object(te.e)({enableModernColumnTotalsSettings:P.M})).enableModernColumnTotalsSettings&&T&&(s.aggregations=T);return e(Object(g.e)({items:(n={},n[t]={views:(r={},r[E.id]=Object(i.__assign)({},s),r)},n)}))}}).then(function(){var n,r;return e(Object(Pe.t)({items:Object(i.__assign)((n={},n[t]=[L.e],n),T?(r={},r[l.oe.serialize(S)]=[P.Ye],r):{})}))})]}return[2]})})}}),Je=["MODERNCALENDAR"],Ke=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,A;return Object(i.__generator)(this,function(O){r=l.z.deserialize(t);s=Object.keys(n)[0];o=n[s],u=o.isPublic,a=o.viewType,f=o.viewFields,c=o.viewStyles,h=o.viewData,p=o.queryXml,d=o.rowLimit,v=o.itemSetKey,m=o.progressItemKey;if(r){g=e(Object(ge.e)({deserializedItemSetKey:l.S,childItems:L.e,parentItem:L.i,schema:L.s},v)),y=g.deserializedItemSetKey,b=g.childItems,w=g.parentItem,E=g.schema;S=Object(Y.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});x=S.segment("Views").segment("Add");return[2,e(Object(Q.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:x.toString(),method:"POST",body:JSON.stringify({parameters:Object(i.__assign)(Object(i.__assign)({__metadata:{type:"SP.ViewCreationInformation"},Title:s,ViewFields:{__metadata:{type:"Collection(Edm.String)"},results:f}},Je.indexOf(a)>=0?{ViewType2:a}:{}),{ViewData:h,CalendarViewStyles:c,Query:p,Paged:!0,PersonalView:!u,RowLimit:d})}),qosName:"addView",noRedirect:!0})).then(function(t){var n,r,s;if(!t||!t.d)throw new Error("No view returned by /Views/Add");var o=t.d;N=Ce.e.normalizeLower(o.Id,!1);C={viewId:N};T=new ze.e(o);Object(Xe.n)(T);var u=new k.e;u.resolveItems({items:(n={},n[l.oe.serialize(C)]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},l.oe.pack(C)),P.Je.pack(o)),P.p.pack(T)),P.Ke.pack(!1)),n)});if(y){A=l.S.serialize(Object(i.__assign)(Object(i.__assign)({},y),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0,viewKey:C}));u.resolveItems({items:(r={},r[A]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},b?L.e.pack(b):{}),w?L.i.pack(w):{}),E?L.s.pack(E):{}),r)})}m&&u.resolveItems({items:(s={},s[m]=Object(i.__assign)({},l.oe.pack(C)),s)});return e(u.execute())}).then(function(){var n;return e(Object(Pe.t)({items:(n={},n[t]=[L.e],n)}))})]}return[2]})})}}),Qe=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:4})(function(e){var t=e.itemKey,n=e.options.views;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a;return Object(i.__generator)(this,function(i){r=l.z.deserialize(t);s=Object.keys(n)[0];o=n[s].viewXml;if(r){u=Object(Y.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});a=u.method("Views",s).method("SetViewXml");return[2,e(Object(Q.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:a.toString(),method:"POST",body:JSON.stringify({viewXml:o}),qosName:"saveViewXML"}))]}return[2]})})}}),Ge=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.views,r=l.z.deserialize(t),s=Object.keys(n)[0];return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var o,u,a;return Object(i.__generator)(this,function(f){if(r&&s){o=n[s];u=Object(Y.e)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}).method("Views",s);a={__metadata:{type:"SP.View"},DefaultView:o.isDefault,Title:o.title};"number"==typeof o.scope&&(a.Scope=o.scope);if(o.aggregations){a.Aggregations=o.aggregations;a.AggregationsStatus="On"}return[2,e(Object(Q.t)({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl,url:u.toString(),method:"POST",body:JSON.stringify(a),additionalHeaders:{"X-HTTP-Method":"PATCH"},qosName:"modifyView"})).then(function(){var n,r,u=e(Object(ge.e)({childItems:L.e},t)).childItems;if(u){for(var a=new k.e,f=l.oe.serialize({viewId:s}),c=void 0,h=void 0,p=void 0,d=0,v=u.itemKeys;d<v.length;d++){var m=v[d],g=e(Object(ge.e)({view:P.p},m)).view;if(g){if(g.isDefault){c=g;h=m}m===f&&(p=g)}}if("boolean"==typeof o.isDefault){if(o.isDefault&&c&&h){c.isDefault=!1;a.resolveItems({items:(n={},n[h]=Object(i.__assign)({},P.p.pack(c)),n)})}if(p&&f){p.isDefault=o.isDefault;a.resolveItems({items:(r={},r[f]=Object(i.__assign)({},P.p.pack(p)),r)})}}return e(a.execute())}})]}return[2]})})}}),Ye=n(233),Ze={key:l.te,displayName:H.f,email:Ye.e,picture:Ye.t},et=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.a.deserialize(n),s=r&&r.spItem,o=s.webAbsoluteUrl,u=s.listFullUrl,a=s.itemId;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,f,c,h,p;return Object(i.__generator)(this,function(d){switch(d.label){case 0:t=a&&Object(Y.e)({webAbsoluteUrl:o,listFullUrl:u}).method("GetItemById",a).segment("likedByInformation");r=new k.e;return(f=t)?[4,e(Object(Q.r)({url:t.toString()+"&$expand=likedby&$top=10",method:"GET",qosName:"likedByInformation",webAbsoluteUrl:o,listFullUrl:u}))]:[3,2];case 1:f=d.sent();d.label=2;case 2:c=[];(h=(s=f)&&s.d&&s.d.likedBy&&s.d.likedBy.results)&&h.forEach(function(e){var t,n=e.email,i=l.te.serialize({id:String(n)});r.resolveItems({items:(t={},t[i]=Object(T.r)(Ze,{key:{id:String(n)},displayName:e.name,email:n,picture:n}),t)});c.push(i)});r.resolveItems({items:(p={},p[n]=Object(i.__assign)({},H.x.pack({personKeys:c})),p)});e(r.execute());return[2]}})})}});var tt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.views,s=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,u,a,f,c,h,p,d,v,m,g,y,b,w,E,S;return Object(i.__generator)(this,function(i){n=l.z.deserialize(t);o=Object.keys(r)[0];if(n&&o){u=r[o],a=u.itemSetKey,f=u.shouldSaveViewFieldsOnly,c=u.newDocumentTemplatesJsonString,h=u.shouldSaveAggregationsOnly;p=e(Object(ge.e)({deserializedViewKey:l.oe,currentDerivedView:P.p},o)),d=p.deserializedViewKey,v=p.currentDerivedView;m=d&&d.viewId;if(v&&m){g=void 0;if(f||c||h){if(v.baseViewXml){g=new ze.e(v.baseViewXml);f?g.replaceFields(v.getEffectiveFieldNames()):c?g.updateNewDocumentTemplates(c):h&&g.replaceAggregates(v.getEffectiveAggregatesData())}}else{y=e(Object(ge.e)({deserializedItemSetKey:l.S,filterableSet:P.ot},a)),b=y.deserializedItemSetKey,w=y.filterableSet;if(b){g=Ve({sourceView:v,deserializedItemSetKey:b,appliedFilters:w&&w.appliedFilters});(E=e(Object(ge.e)({viewType:P.Ht},o)).viewType)&&g.updateViewType(E)}}if(g){g.prepareForSaving();if(v.isDirty()||g.isDirty()){S=Object(Y.e)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl}).method("Views",m).method("SetViewXml");return[2,e(Object(Q.t)({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,url:S.toString(),method:"POST",body:JSON.stringify({viewXml:g.getEffectiveViewXml()}),qosName:s||"saveView"}))]}}}}return[2]})})}}),nt=n(90),rt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.columnModifyTypeMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,c,h,p,d,v,m,g,b,w,E,S,x,T,N;return Object(i.__generator)(this,function(C){switch(C.label){case 0:if(!(r=e(Object(ge.e)({setKey:l.S},t)).setKey))return[3,3];s=Object.keys(n)[0];o=n[s],u=o.modifyType,a=o.targetIndex;if(!(f=r.viewKey?l.oe.serialize(r.viewKey):void 0))return[3,3];if(!(c=e(Object(ge.e)({currentDerivedView:P.p},f)).currentDerivedView))return[3,3];h=c.getEffectiveFieldNames();if(!(p=e(Object(ge.e)({internalName:P.ue},s)).internalName))return[3,3];if((d=h.indexOf(p))<0||1===u&&0===d||2===u&&d===h.length-1)return[2];v=c.isDirty();switch(u){case 0:c.updateField(p);break;case 1:c.updateField(p,d-1);break;case 2:c.updateField(p,d+1);break;case 3:c.updateField(p,a)}m={ODB:1318};g=e(Object(M.e)(function(e){return e.demandItemFacet(P.Et,l.Z.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl}))}));b=e(Object(M.e)(function(e){return Object(pe.e)(e,{feature:m,pageContext:g})}));w=!1;return b?[4,e(Object(y.e)({items:(S={},S[l.z.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl})]={views:(x={},x[f]={shouldSaveViewFieldsOnly:!0},x),qosName:"autoSaveModifyColumn"},S)})).then(function(){v||(c.baseViewXml=c.getEffectiveViewXml());w=!0},function(e){nt.e.logError(e,{eventName:"ModifyColumn",feature:"ColumnFieldsAutoSave",columnFieldName:p,modifyType:u,errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});throw e})]:[3,2];case 1:C.sent();C.label=2;case 2:E=new k.e;b&&w||E.resolveItems({items:(T={},T[f]=Object(i.__assign)({},P.Ke.pack(!0)),T)});E.invalidateItems({items:(N={},N[t]=[L.e],N[f]=[P.p],N)});e(E.execute());C.label=3;case 3:return[2]}})})}}),it=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.options.columnFormatterMap;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,r,s,o,u;return Object(i.__generator)(this,function(a){n=Object.keys(t)[0];r=t[n],s=r.updateType,o=r.formatter;return 0===s?[2,e(Object(fe.e)({items:(u={},u[n]=Object(i.__assign)({},P.d.pack(o)),u)}))]:[2]})})}}),st=n(2749),ot=n(2498),ut=n(1868),at=n(69),ft=Object(s.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this,n=e.itemKey,r=e.options.sourceEntries,s=l._.deserialize(n),o=s&&s.itemSetKey,u=o.webAbsoluteUrl,a=o.listFullUrl,f=o.rootFolder,c=l.D.serialize({webAbsoluteUrl:u,listFullUrl:a,rootFolder:f}),h=Object.keys(r)[0],p=r[h].progressItemKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l;return Object(i.__generator)(this,function(d){switch(d.label){case 0:t=e(Object(ge.e)({sourceFile:ut.t},h)).sourceFile;s=e(Object(te.e)({listItemUploader:P.Ee})).listItemUploader,o=void 0===s?ot.e:s;return[4,e(o({itemKey:c,options:{sourceEntries:r}}))];case 1:u=d.sent().itemKey;d.label=2;case 2:d.trys.push([2,4,,5]);return[4,e(Object(st.e)({items:(a={},a[u]={groupKey:n},a)}))];case 3:d.sent();return[3,5];case 4:d.sent();return[3,5];case 5:e(Object(Pe.t)({items:(f={},f[c]=[L.t],f)}));p&&t&&e(Object(fe.e)({items:(l={},l[p]=Object(i.__assign)(Object(i.__assign)({},at.s.pack({itemKey:u})),Object(T.r)({progressSize:at.v},{progressSize:{current:t.size}})),l)}));return[2]}})})}});var lt=n(2517),ct=n(15),ht=Object(s.i)({maxParallelOperationCount:8})(function(e){var t=this,n=e.itemKey,r=l.z.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,u,a,f,c,h,p,d,v,m,g,y,b,w;return Object(i.__generator)(this,function(E){switch(E.label){case 0:t=[];u=new k.e;a=e(Object(ge.e)({pageContext:P.Et},l.Z.serialize({webAbsoluteUrl:s,listFullUrl:o}))).pageContext;f=l.U.serialize({webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl});c=e(Object(ge.e)({list:P.ye},f));h=e(Object(te.e)({localeConfiguration:D.S})).localeConfiguration;return[4,e(Object(lt.e)({webAbsoluteUrl:s,listFullUrl:o,listTemplate:c.list&&c.list.templateType,preferredLanguage:h&&h.language}))];case 1:p=E.sent();d={};v=void 0;m=[];g=a&&Object(ct.t)(a);p.filter(function(e){return!!e.view}).map(function(n){var r,f,h,p=n.serverView,y=n.view,b=y.id,w={viewId:b},E=l.oe.serialize(w);a&&c&&c.list&&c.list.id&&(h=(function(e){var t=e.webAbsoluteUrl,n=e.layoutsUrl,r=e.viewId,i=e.listId,s=e.sourceUrl;return t+"/"+n+"/ViewEdit.aspx?"+Object(W.e)({View:Ce.e.normalizeUpper(r,!0),List:Ce.e.normalizeUpper(i,!0),Source:s})})({webAbsoluteUrl:s,layoutsUrl:a.layoutsUrl,viewId:b,listId:c.list.id,sourceUrl:p.ServerRelativeUrl}));if(y.isDefault){v=E;var S=y.getDomParts().newDocumentTemplates;if(S&&S.textContent)try{var x=(m=JSON.parse(S.textContent)).map(function(e){return e.url});if((m=m.filter(function(e,t){return!e.url||x.indexOf(e.url)===t})).length)for(var T=0,N=m;T<N.length;T++){var C=N[T];if(C.url){var k=l.V.serialize({templateUrl:C.url,listKey:{webAbsoluteUrl:s,listFullUrl:o}});u.resolveItems({items:(r={},r[k]=Object(i.__assign)({},P.Oe.pack(C)),r)})}C.templateId||(C.isUpload?C.templateId=C.title:C.isContentType&&C.contentTypeId&&(C.templateId=C.contentTypeId))}}catch(e){}}d[E]=y;Object(Xe.n)(y);var L=e(Object(M.e)(function(e){if(e.isItemFacetResolved(P.p,E))return e.demandItemFacet(P.p,E)})),A=!!g&&!g.isActivated("E9B1A0B8-5A6E-4292-8EF8-68446FEF4A7D","4/20/2020","Skip resolve currentDerived when it is not changed")&&!!L&&L.getEffectiveViewXml().replace(/ \/>/g,"/>")===y.getEffectiveViewXml().replace(/ \/>/g,"/>");u.resolveItems({items:(f={},f[E]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},l.oe.pack(w)),P.Je.pack(p)),A?{}:P.p.pack(y)),P.Ke.pack(!1)),h?H.L.pack(h):{}),P.Ht.pack(y.viewType)),f)});t.push(E)});u.resolveItems({items:(y={},y[f]=Object(i.__assign)({},P.Me.pack(m)),y)});t.sort(function(e,t){return d[e].compareTo(d[t])});u.resolveItems({items:(b={},b[n]=Object(i.__assign)(Object(i.__assign)({},l.z.pack(r)),L.e.pack({itemKeys:t})),b)});v&&u.resolveItems({items:(w={},w[f]=Object(i.__assign)({},P.g.pack({viewKey:v})),w)});e(u.execute());return[2]}})})}});var pt=n(220),dt=n(2848),vt=n(189),mt=n(58),gt=n(2758),yt=n(2837),bt=n(495);function wt(e,t,n){var r=Object(Y.e)({webAbsoluteUrl:e,listFullUrl:t}).segment("CustomActionElements");return function(i){return i(Object(Q.r)({webAbsoluteUrl:e,listFullUrl:t,method:"POST",url:r.toString(),qosName:"getLegacyCustomActions",noRedirect:!0})).then(function(e){return(function(e,t){return Object(gt.t)(e,t)})(e.d.CustomActionElements.Items.results,n)})}}function Et(e,t){var n=yt.t(e)+"/_layouts/15/tenantappinfo.ashx?etag=0&lcid="+bt.e.lcid;return function(r){return r(Object(Q.t)({webAbsoluteUrl:e,listFullUrl:"",method:"POST",url:n,qosName:"getTenantAppCustomAction",noRedirect:!0})).then(function(e){return e.apps?(function(e,t){var n=[];e.forEach(function(e,r){e.customActions&&(n=n.concat(Object(gt.n)(e.customActions,t)))});return n})(e.apps,t):[]})}}var St=n(24),xt=n(740),Tt=n(84),Nt={Prefix:"ClientSideExtension",CommandSet:"ClientSideExtension.ListViewCommandSet",ContextMenu:"ClientSideExtension.ListViewCommandSet.ContextMenu",CommandBar:"ClientSideExtension.ListViewCommandSet.CommandBar"},Ct=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.u.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,u,a,f,c,h,p,d;return Object(i.__generator)(this,function(v){switch(v.label){case 0:t=e(Dt({webAbsoluteUrl:s,listFullUrl:o}));r=new k.e;if(t.listTemplate===St.t.mySiteDocumentLibrary){r.resolveItems({items:(d={},d[n]=Object(i.__assign)({},L.e.pack(void 0)),d)});e(r.execute());return[2]}u=l.n.serialize({webAbsoluteUrl:s,listFullUrl:o});return[4,e(wt(s,o,t))];case 1:a=v.sent();return[4,e(Object(O.demandItems)(function(e){return{enableDebugClientSideExtensions:e.demandItemFacet(P.E,D.n)}}))];case 2:(f=v.sent().enableDebugClientSideExtensions)&&f.customActions&&(function(e,t){if(!t)return;var n=e.ContextMenu||[],r=e["Ribbon.Documents"]||[],s=e["Ribbon.List"]||[],o={"ClientSideExtension.ListViewCommandSet.ContextMenu":"ContextMenu:","ClientSideExtension.ListViewCommandSet.CommandBar":"CommandBar:"};try{var u=JSON.parse(t);if(u)for(var a=0,f=Object.keys(u);a<f.length;a++){var l=f[a];try{var c=u[l],h=c.location,p=c.properties,d={text:o[h],action:"",allowMultiSelect:!0,isEnabled:!0,clientSideComponentId:l,clientSideComponentProperties:"object"==typeof p?JSON.stringify(p):""},v=h===Nt.CommandSet,m=h===Nt.ContextMenu||v,g=h===Nt.CommandBar||v;m&&n.push(d);if(g){r.push(Object(i.__assign)({},d));s.push(Object(i.__assign)({},d))}}catch(e){console.log("Error processing query parameter for "+l)}}}catch(e){console.log("error in parsing query parameter for custom actions")}})(a,f.customActions);c=t.isDocumentLibrary;return[4,Ot({setKey:n,actions:a[c?"Ribbon.Documents":"Ribbon.List"]})];case 3:h=v.sent().itemResolver;return[4,Ot({setKey:u,actions:a.ContextMenu})];case 4:p=v.sent().itemResolver;r.merge(p);r.merge(h);e(r.execute());return[2]}})})}}),kt=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.fe.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,u,a,f;return Object(i.__generator)(this,function(l){switch(l.label){case 0:if((t=e(Dt({webAbsoluteUrl:s,listFullUrl:o}))).listTemplate===St.t.mySiteDocumentLibrary){(r=new k.e).resolveItems({items:(f={},f[n]=Object(i.__assign)({},L.e.pack(void 0)),f)});e(r.execute());return[2]}return[4,e(Et(s,t))];case 1:u=l.sent();return[4,Ot({setKey:n,actions:u})];case 2:a=l.sent().itemResolver;e(a.execute());return[2]}})})}}),Lt=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.i.deserialize(n);return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a;return Object(i.__generator)(this,function(f){t=new k.e;s=l.u.serialize(r);o=l.fe.serialize(r);u=ct.e.isActivated("AD2F0461-E817-4A28-9DC3-F62DDB98C1EF","4/10/2020","kill tenantappinfo calls globally")?[s,o]:[s];t.resolveItems({items:(a={},a[n]=Object(i.__assign)(Object(i.__assign)({},mt.s.pack(!0)),L.e.pack({itemKeys:u})),a)});e(t.execute());return[2]})})}}),At=Object(s.i)()(function(e){var t=this,n=e.itemKey,r=l.s.deserialize(n),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.isSPFXandCustomActionsAvailable,a=r.itemsScopeItemKey,f=r.targetCustomActionSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,c,h,p,d,v,m,g,y,b;return Object(i.__generator)(this,function(w){switch(w.label){case 0:t=new k.e;r=l.U.serialize({webAbsoluteUrl:s,listFullUrl:o});c=e(Object(M.e)(xt.e));h=function(){var n;t.resolveItems({items:(n={},n[r]=vt.o.pack(void 0),n)});e(t.execute())};if(!u&&!c){h();return[2]}return(d=c)?[4,c()]:[3,2];case 1:d=w.sent();w.label=2;case 2:v=!1;if(!(p=d))return[3,7];m=p.createListViewAdapter();t.resolveItems({items:(b={},b[r]=Object(i.__assign)({},m?vt.o.pack(m):{}),b)});g=e(Object(ge.e)({rawCustomActions:P.We},f)).rawCustomActions;return[4,Mt({setKey:n,actions:g||[],listViewAdapter:m})];case 3:y=w.sent().itemResolver;t.merge(y);return[4,e(Object(O.demandItems)(function(e){var n=Object(Tt.e)(e,a);if(n&&m){var r=e.demandItemFacet(L.e,n),s=r&&r.itemKeys,o=function(n){var r,s=e.isItemFacetResolved(P.$e,n)?e.demandItemFacet(P.$e,n):void 0;if(s&&m){var u=m.createRowAdapter({values:s});t.resolveItems({items:(r={},r[n]=Object(i.__assign)({},u?vt.u.pack(u):{}),r)})}else if(e.demandItemFacet(l._,n)){var a=e.isItemFacetResolved(L.e,n)?e.demandItemFacet(L.e,n):void 0;if(a)for(var f=0,c=a.itemKeys;f<c.length;f++){var h=c[f];o(h)}}};if(s)for(var u=0,f=s;u<f.length;u++){var c=f[u];o(c)}var h=e.demandItemFacet(L.s,n),p=h&&h.columnKeys||[];if(p&&m)for(var d=function(n){var r,i=e.demandItem({fieldId:P.$,internalName:P.ue,realFieldName:P.Xe,fieldType:P.V,isRequired:pt.r,displayName:H.f,clientSideComponentId:vt.e,clientSideComponentProperties:vt.t},n),s=i.fieldId,o=i.internalName,u=i.realFieldName,a=i.fieldType,f=i.isRequired,c=i.displayName,h=i.clientSideComponentId,p=i.clientSideComponentProperties;if(s&&o){v=!0;var d={internalName:o},g={id:s,internalName:u||o,fieldType:a||"Text",isRequired:f||!1,isVisible:!0,displayName:c||"",clientSideComponentId:h||Ce.e.Empty,clientSideComponentProperties:p||"",onSetVisible:function(e){return console.log("ISpfxAdapter.IColumn.onSetVisible not implemented")},onFieldCustomizerError:function(e){console.log("Fail to load customizer for column: "+o+",\n                      componentId: "+h+", error: "+e.message)}},y=m.addColumnAdapter(g);if(h&&h!==Ce.e.Empty){var b=l.v.serialize(d);t.resolveItems({items:(r={},r[b]=vt.n.pack(y),r[n]=vt.r.pack(b),r)})}}},g=0,y=p;g<y.length;g++){d(y[g])}}}))];case 4:w.sent();return v?[4,m.loadFieldCustomizers()]:[3,6];case 5:w.sent();w.label=6;case 6:return[3,8];case 7:h();w.label=8;case 8:e(t.execute());return[2]}})})}});function Ot(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,s,o,u,a,f,c,h,p,d,v,m,g,y,b,w,E,S,x,T;return Object(i.__generator)(this,function(N){t=e.setKey,n=e.actions;r=new k.e;s=[];o=0;for(u=0,a=n;u<a.length;u++){f=a[u];c=[];if(Object(gt.e)(f)){h=f.children;p=0;for(d=0,v=h;d<v.length;d++){m=v[d];g=m.id?m.id:m.text+o+"."+p;y=l.r.serialize({actionId:g});Pt(m)||r.resolveItems({items:(S={},S[y]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},H.f.pack(m.text)),H.L.pack(m.action)),dt.e.pack(m.allowMultiSelect)),dt.n.pack(m.isEnabled||!1)),dt.t.pack(m.iconUrl)),S)});c.push(y);p++}}if(Object(gt.e)(f)||!Pt(f)){b=f.id?f.id:f.text+o.toString();w=l.r.serialize({actionId:b});r.resolveItems({items:(x={},x[w]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},H.f.pack(f.text)),L.e.pack({itemKeys:c})),H.L.pack(Object(gt.e)(f)?"":f.action)),Object(gt.e)(f)?{}:dt.e.pack(f.allowMultiSelect)),Object(gt.e)(f)?{}:dt.n.pack(f.isEnabled||!1)),Object(gt.e)(f)?{}:dt.t.pack(f.iconUrl)),x)});s.push(w)}o++}E=s.length>0?{itemKeys:s}:void 0;r.resolveItems({items:(T={},T[t]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},mt.s.pack(!0)),L.e.pack(E)),P.We.pack(n)),T)});return[2,{itemResolver:r}]})})}function Mt(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,s,o,u,a,f,c,h,p;return Object(i.__generator)(this,function(d){switch(d.label){case 0:t=e.setKey,n=e.actions,r=e.listViewAdapter;s=new k.e;o=[];u=0;a=function(e){var t,n,a,f,c,h,p,d,v,m,g,y;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=[];if(!Object(gt.e)(e))return[3,5];n=e.children;a=0;f=0,c=n;i.label=1;case 1:if(!(f<c.length))return[3,5];h=c[f];p=h.id?h.id:h.text+u+"."+a;d=l.r.serialize({actionId:p});return Pt(h)&&r?[4,_t({action:h,listViewAdapter:r})]:[3,3];case 2:v=i.sent(),y=v.actionKeys,g=v.itemResolver;s.merge(g);y.forEach(function(e){t.push(e)});i.label=3;case 3:t.push(d);a++;i.label=4;case 4:f++;return[3,1];case 5:return!Object(gt.e)(e)&&Pt(e)&&r?[4,_t({action:e,listViewAdapter:r})]:[3,7];case 6:m=i.sent(),g=m.itemResolver,y=m.actionKeys;s.merge(g);o=o.concat(y);i.label=7;case 7:u++;return[2]}})};f=0,c=n;d.label=1;case 1:if(!(f<c.length))return[3,4];h=c[f];return[5,a(h)];case 2:d.sent();d.label=3;case 3:f++;return[3,1];case 4:s.resolveItems({items:(p={},p[t]=Object(i.__assign)(Object(i.__assign)({},mt.s.pack(!0)),L.e.pack(0===o.length?void 0:{itemKeys:o})),p)});return[2,{itemResolver:s}]}})})}function _t(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,r,s,o,u,a;return Object(i.__generator)(this,function(f){switch(f.label){case 0:t=e.action,n=e.listViewAdapter;r=new k.e;s=[];o=t.clientSideComponentId&&t.clientSideComponentId.toString()||"";u=t.clientSideComponentProperties||"";return o&&o!==Ce.e.Empty?[4,n.loadCommandSet(o,u).catch(function(){})]:[2,{itemResolver:r,actionKeys:[]}];case 1:(a=f.sent())&&a.commandAdapters&&a.commandAdapters.forEach(function(e){var n,o=t.clientSideComponentId+"."+e.commandId,u=l.r.serialize({actionId:o});r.resolveItems({items:(n={},n[u]=Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)(Object(i.__assign)({},H.f.pack(e.title)),H.L.pack(t.action)),dt.e.pack(t.allowMultiSelect)),dt.n.pack(t.isEnabled||!1)),dt.t.pack(e.iconUrl||t.iconUrl)),vt.i.pack(e)),n)});s.push(u)});return[2,{itemResolver:r,actionKeys:s}]}})})}function Dt(e){var t=e.webAbsoluteUrl,n=e.listFullUrl;return function(e){var r=e(Object(ge.e)({pageContext:P.Et},l.Z.serialize({webAbsoluteUrl:t,listFullUrl:n}))),i=e(Object(ge.e)({list:P.ye},l.U.serialize({webAbsoluteUrl:t,listFullUrl:n})));return{currentUserIsSiteAdmin:r.pageContext&&r.pageContext.isSiteAdmin||!1,listTemplate:i.list&&i.list.templateType||St.t.invalidType,listId:i.list&&i.list.id||"",isDocumentLibrary:i.list&&i.list.isDocumentLibrary||!1}}}function Pt(e){return e&&(!!e.clientSideCommandAdapter||e.clientSideComponentId&&e.clientSideComponentId!==Ce.e.Empty)||!1}var Ht=Object(s.i)({maxParallelOperationCount:4})(function(e){var t=this,n=e.itemKey,r=l.ae.deserialize(n).webAbsoluteUrl;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,a,f,l;return Object(i.__generator)(this,function(c){switch(c.label){case 0:t=Object(Y.n)({webAbsoluteUrl:r}).segments("ComponentContextInfo");return[4,n(Object(Q.t)({url:t.toString(),qosName:"GetWebPageContext",method:"GET",webAbsoluteUrl:r,noRedirect:!0}))];case 1:s=c.sent();o=JSON.parse(s.d.SerializedData);u=o.isSPO,a=void 0===u||u;(f=new k.e).resolveItems({items:(l={},l[e.itemKey]=Object(i.__assign)(Object(i.__assign)({},P.He.pack(a?void 0:{})),P.Et.pack(o)),l)});n(f.execute());return[2]}})})}});var Bt=n(135),jt=n(2515),Ft=n(1841),It=Object(s.n)()(function(e){var t=e.items,n=Object.keys(t),r=t[n[0]].groupKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,s,o,u,a,f,c,h,p,d,v,m,g,y,b,w,E,S,x,T;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e(Object(M.e)(function(e){return e.demandItemFacet(l._,r)}));if(!(s=t&&t.itemSetKey&&l.S.serialize(t.itemSetKey))||n.length<1||!r)return[2];o=e(Object(ge.e)({spGroupField:P.ct,groupValue:P.se,parentGroupKey:P.je,defaultCollapsed:mt.t},r)),u=o.spGroupField,a=o.groupValue,f=o.parentGroupKey,c=o.defaultCollapsed;h=[];u&&u.internalName&&a&&h.push({FieldName:u.internalName,FieldValue:a});if(f&&f.itemKey){p=e(Object(ge.e)({parentGroupField:P.ct,parentGroupValue:P.se},f.itemKey)),d=p.parentGroupField,v=p.parentGroupValue;d&&d.internalName&&v&&h.push({FieldName:d.internalName,FieldValue:v})}if(t&&t.itemSetKey&&t.itemSetKey.filterParams&&(m=Bt.default.getFilterList(t.itemSetKey.filterParams,void 0,!0)).length>0)for(g=0;g<m.length;g++){y=m[g];b=e(Object(ge.e)({isReadOnly:P.ce},l.y.serialize({internalName:y.fieldName}))).isReadOnly;1===y.values.length&&!1===b&&h.push({FieldName:y.fieldName,FieldValue:y.values[0]})}return[4,e(Object(jt.e)({items:(E={},E[s]={itemKeys:n,formValues:h,qosName:"AssignItemsToGroup"},E)}))];case 1:i.sent();w={};n.forEach(function(e){w[e]={}});return[4,e(Object(Ft.e)({items:(S={},S[s]=w,S)}))];case 2:i.sent();e(c?Object(Pe.t)({items:(x={},x[r]=[L.e],x)}):Object(Pe.t)({items:(T={},T[s]=[L.e],T)}));return[2]}})})}}),qt=n(2850),Rt=n(2521),Ut=Object(S.t)()(function(){return function(e){return zt}});function zt(e,t){var n=t.itemKey,r=e.demandItem({driveItem:l.D,canonicalLinkUrl:H.i},n),s=r.driveItem,o=r.canonicalLinkUrl;return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h,p;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.canonicalLinkUrl;if(t&&r)return[3,1];throw new Error("Unable to obtain default share URL");case 1:s=void 0;if(r){o=new Fe.e(r);u=o.authority;for(a=0,f=o.segments;a<f.length;a++)""!==(l=f[a])&&(u=u+"/"+encodeURIComponent(l));c=Object(Rt.e)(u.toString());s="u!"+c.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}h=new Fe.e(t.webAbsoluteUrl).authority;return[4,n(Object(Q.t)({webAbsoluteUrl:h,listFullUrl:void 0,url:h+"/_api/v2.0/shares/"+s+"/driveItem/invite",body:void 0,method:"POST",additionalHeaders:{prefer:"getDefaultLink","Content-type":"application/json",Accept:"application/json"},qosName:"getDefaultShareLink",noRedirect:!0}))];case 2:return[2,{url:(p=i.sent()).value[0].link.webUrl,scope:p.value[0].link.scope}]}})})}})({driveItem:s,canonicalLinkUrl:o})}}}var Wt=n(2836),Xt=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.bNewDocumentUpdate,s=n.checkInComment,o=n.formValues,u=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,a,f,l,c;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return o.length>0?[4,e(Object(He.e)(t))]:[3,3];case 1:n=i.sent(),a=n.key,f=n.itemId;l=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return Object(Y.e)({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).method("ValidateUpdateListItem").toString()})({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl,itemId:f||a.itemId||""});(c={}).formValues=o;c.bNewDocumentUpdate=r;c.checkInComment=s;return[4,e(Object(Q.t)({body:JSON.stringify(c),listFullUrl:a.listFullUrl,method:"POST",qosName:u,url:l,webAbsoluteUrl:a.webAbsoluteUrl,noRedirect:!0})).then(function(e){var t=e.d.ValidateUpdateListItem.results[0];if(t.HasException)throw new Error(t.ErrorMessage||void 0)})];case 2:i.sent();i.label=3;case 3:return[2]}})})}});var Vt=n(485),$t=n(48);var Jt=n(217),Kt=n(255),Qt=Object(s.i)()(function(e){var t=e.itemKey;return function(n){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f;return Object(i.__generator)(this,function(c){switch(c.label){case 0:r=l.S.deserialize(t);s=n(Object(we.n)({itemSetKey:r}));o=Object.keys(e.options);return[4,n((h={itemSetKey:t,itemKeys:o},function(e){for(var t=h.itemSetKey,n=h.itemKeys,r=e(Object(M.e)(function(e){var n=e.demandItemFacet(l.S,t)||l.S.deserialize(t);return Object(i.__assign)(Object(i.__assign)({},n),{pageContext:Object($t.e)(e,l.D.serialize(n))})})),s=r.webAbsoluteUrl,o=r.listFullUrl,u=r.pageContext,a=[],f=0,c=n;f<c.length;f++){var p=c[f],d=l.D.deserialize(p).itemId;d||(d=e(Object(ge.e)({listItemId:P.we},p)).listItemId);d&&a.push(d)}var v=e(Object(he.e)({internalName:P.ue},t)),m=["Modified"];if(v)for(var g=0,y=v;g<y.length;g++){var b=y[g];b.internalName&&"Modified"!==b.internalName&&m.push(b.internalName)}return{webAbsoluteUrl:s,listFullUrl:o,currentPageContext:u,qosName:"refreshItemsInSet",viewXml:Object(Vt.r)({itemIds:a,recurseInFolders:!0,pageSize:n.length,fieldNames:m.length>0?m:void 0}),postDataContext:{needsSchema:!0}}}))];case 1:u=c.sent();return[4,n(Object(Ee.e)(u))];case 2:a=c.sent();f=n(Object(Jt.t)({serverData:a,itemSetKey:r,currentPageContext:u.currentPageContext,contentTypes:s,isItemSetRequest:!0})).itemResolver;n(f.execute());n(Object(Kt.e)({itemSetKey:t,serverData:a,isItemSetRequest:!0}));return[2]}var h})})}}),Gt=n(2851),Yt=Object(S.t)()(function(){return function(e){return Zt}});function Zt(e,t){var n=t.itemKey,r=t.link,s=t.recipients,o=e.demandItem({driveItem:l.D},n).driveItem;return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s,o,u,a,f,l,c,h;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.driveItem,r=e.link,s=e.recipients;if(!t)return[3,2];void 0;u=Object(Rt.e)(r);o="u!"+u.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");a=s.map(function(e){return{email:e}});f={recipients:a,roles:["read"]};l=new Fe.e(t.webAbsoluteUrl).authority;return[4,n(Object(Q.t)({webAbsoluteUrl:l,listFullUrl:void 0,url:l+"/_api/v2.0/shares/"+o+"/permission/invite",body:JSON.stringify(f),method:"POST",additionalHeaders:{"Content-type":"application/json",Accept:"application/json"},qosName:"permissionInvite",noRedirect:!0}))];case 1:c=i.sent();h=c.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:h}];case 2:throw new Error("Unable to set permissions on the sharing URL")}})})}})({driveItem:o,link:r,recipients:s})}}}var en=n(2520),tn=Object(S.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(l.D,n);if(!r)return{};var i={webAbsoluteUrl:r.webAbsoluteUrl,listFullUrl:r.listFullUrl},s=e.demandItemFacet(P.ye,l.U.serialize(i)),o=e.demandItemFacet(P.Et,l.Z.serialize(i));if(!o)return{};var u=s&&s.templateType===St.t.mySiteDocumentLibrary||!1;return{sharedPostData:{cultureName:o.currentUICultureName||o.currentCultureName||"en-US",client:u?"OneDrive":"SharePoint",domainHint:"organizations",userId:o.userLoginName}}}}});var nn=n(2849),rn=n(144),sn=n(238),on=Object(S.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=void 0,i=e.demandItem({key:l.D,driveItemKey:rn.e},n),s=i.key,o=i.driveItemKey;if(o)return{driveItemFullUrl:Object(ne.t)(o)};if(s){var u={webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl},a=e.demandItem({listMediaFacets:sn.t},l.U.serialize(u)).listMediaFacets;if(a&&a[".driveUrl"]){var f=a[".driveUrl"],c=s.rootFolder||"",h="";if(c){var p=new Ie.t({context:{webAbsoluteUrl:s.webAbsoluteUrl,listUrl:s.listFullUrl}}).getUrlParts();p.serverRelativeListUrl&&"/"!==(h=c.replace(p.serverRelativeListUrl,"")).charAt(0)&&(h="/"+h)}return{driveItemFullUrl:r=f+"/items/root"+(h?":":"")+h}}}return{driveItemFullUrl:r}}}});var un=n(407),an=Object(s.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,r=n.aggregateType,s=n.columnKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,o,u,a,f,c,h,p,d,v,m,g,b;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(n=e(Object(ge.e)({setKey:l.S},t)).setKey))return[3,2];if(!(o=n.viewKey?l.oe.serialize(n.viewKey):void 0))return[3,2];if(!(u=e(Object(ge.e)({currentDerivedView:P.p},o)).currentDerivedView))return[3,2];a=e(Object(ge.e)({internalName:P.ue,fieldType:P.J,fieldFieldType:P.V},s)),f=a.internalName,c=a.fieldType,h=a.fieldFieldType;if(!f)return[3,2];p=e(Object(ge.e)({spFolderAggregates:P.a},t)).spFolderAggregates;d=u.isDirty();if(!(v=p&&p[s]?p[s].aggregateFunctionType:void 0)&&0===r||v===un.e[r])return[2];m=0===r?void 0:un.e[r];u.updateColumnAggregateType(f,m);return[4,e(Object(y.e)({items:(g={},g[l.z.serialize({webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl})]={views:(b={},b[o]={shouldSaveAggregationsOnly:!0},b),qosName:"SaveModifyColumnAggregateType"},g)})).then(function(){var n,r=u.getEffectiveViewXml(),i=new ze.e(u.baseViewXml||"");i.replaceAggregates(u.getEffectiveAggregatesData());u.baseViewXml=i.getEffectiveViewXml();u.setDom(r);u.setIsDirty(d);var s=new k.e;s.invalidateItems({items:(n={},n[t]=[L.e],n[o]=[P.Ye],n)});e(s.execute())},function(e){nt.e.logError(e.errorData,{eventName:"ModifyColumnAggregateType",feature:"ModernColumnTotalsSettings",fieldType:c,fieldFieldType:h,currentAggregateType:v||"None",newAggregateType:m||"None",errorCode:e.errorData.code,correlationId:e.errorData.correlationId,status:e.errorData.status});u.updateColumnAggregateType(f,v);u.setIsDirty(d);throw e})];case 1:i.sent();i.label=2;case 2:return[2]}})})}}),fn=n(2846),ln=Object(s.i)()(function(e){var t=e.itemKey,n=e.options,r=n.itemKeys,s=n.bNewDocumentUpdate,o=n.checkInComment,u=n.formValues,a=n.qosName;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var n,f,c,h,p,d,v,m,g,y,b,w,E,S,x;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!(u&&u.length&&r&&r.length))return[2];n=l.S.deserialize(t),f=n.viewKey,c=n.rootFolder,h=n.webAbsoluteUrl,p=n.listFullUrl;d=c||"";f&&(!(v=e(Object(ge.e)({currentDerivedView:P.p},l.oe.serialize(f))).currentDerivedView)||1!==v.scope&&2!==v.scope||(d=""));m=[];g={};y=0,b=r;i.label=1;case 1:if(!(y<b.length))return[3,4];w=b[y];return[4,e(Object(He.e)(w))];case 2:E=i.sent().itemId;m.push(parseInt(E,10));g[E]=w;i.label=3;case 3:y++;return[3,1];case 4:S=Object(Y.e)({webAbsoluteUrl:h,listFullUrl:p}).method("BulkValidateUpdateListItems").toString();x={itemIds:m,formValues:u,folderPath:d,bNewDocumentUpdate:s,checkInComment:o};return[4,e(Object(Q.t)({body:JSON.stringify(x),listFullUrl:p,method:"POST",qosName:a,url:S,webAbsoluteUrl:h,noRedirect:!0})).then(function(n){for(var r,i="",s={},o=0,u=n.d.BulkValidateUpdateListItems.results;o<u.length;o++){var a=u[o];if(a.HasException)i=a.ErrorMessage+"\n"+i;else{g[a.ItemId]&&(s[g[a.ItemId]]={})}}Object.keys(s).length>0&&e(Object(Ft.e)({items:(r={},r[t]=s,r)}));if(i)throw new Error(i)})];case 5:i.sent();return[2]}})})}}),cn=n(2343),hn=n(2344),pn=n(2434),dn=n(958),vn=n(2346),mn=n(205),gn=n(285),yn=n(483),bn=Object(s.n)()(function(e){var t=e.items,n=t[Object.keys(t)[0]].itemSetKey;return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var r,s,o,u,a,f,l,c,h,p,d,v,m;return Object(i.__generator)(this,function(i){switch(i.label){case 0:r=[];return[4,e(wn({itemSetKey:n}))];case 1:o=i.sent();u=function(t){var n=e(Object(M.e)(function(e){return e.demandItemFacet(H.i,t)}))||"",i={DecodedUrl:decodeURIComponent(n)};i&&r.push(i)};for(a=0,f=Object.keys(t);a<f.length;a++){l=f[a];u(l)}s=JSON.stringify({itemPaths:r});c="RemoveItemsFromSharedWithMeViewByPath";h=Object(Y.n)({webAbsoluteUrl:o}).segment("SP.Sharing.DocumentSharingManager."+c);return[4,e(Object(Q.t)({url:h.toString(),qosName:"RemoveFromSharedList",method:"POST",webAbsoluteUrl:o,body:s,noRedirect:!0}))];case 2:if((p=i.sent())&&p.d&&p.d[c]&&p.d[c].results){if((d=p.d[c].results).length<1)throw new K.e({message:mn.e.DefaultTitle});d.forEach(function(e){if(!e.Success&&-3!==e.ErrorCode)throw new K.e({message:e.ErrorMessage||void 0})})}(v=new k.e).invalidateItems({items:(m={},m[n]=[L.e],m)});e(v.execute());return[2]}})})}});function wn(e){var t=this,n=e.itemSetKey;return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,r,s;return Object(i.__generator)(this,function(i){switch(i.label){case 0:"";t=e(Object(M.e)(function(e){return e.demandItemFacet(gn.e,n)}));r=t&&t.driveItemKey.endpoint||"";return[4,e(Object(O.demandItems)(function(e){return e.demandItemFacet(l.D,l.J.serialize({tenantRootUrl:new yn.e(r).authority}))}))];case 1:s=i.sent();return[2,s&&s.webAbsoluteUrl||""]}})})}}var En=n(3505),Sn=n(3213);n.d(t,"spDataOnlyAddonDeferred",function(){return xn});n.d(t,"spItemUploadItemsOperationHandler",function(){return cn.e});n.d(t,"spItemCreateFolderOperationHandler",function(){return hn.t});n.d(t,"spItemCreateDocumentOperationHandler",function(){return pn.n});n.d(t,"getSPFilterOptionSetHandler",function(){return Te.getSPFilterOptionSetHandler});var xn=Object(s.t)(function(){return function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){return Object(i.__generator)(this,function(t){e(Object(o.o)(l.X,a.e)(Se));e(Object(o.o)(l.D,h.t)(Le));e(Object(o.o)(l.D,p.t)(De));e(Object(o.o)(l.D,d.t)(Be));e(Object(o.o)(l.D,v.t)(je));e(En.sharePointBasicActionsAddonDeferred);e(Object(o.o)(l.D,f.t)(qe));e(Object(o.o)(l.ne,c.e)(Ue.n));e(Object(o.o)(l.D,m.e)(It));e(Object(o.o)(l.z,b.t)($e));e(Object(o.o)(l.z,w.t)(Ke));e(Object(o.o)(l.z,E.t)(Qe));e(Object(o.o)(l.z,g.t)(Ge));e(Object(o.o)(l.z,y.t)(tt));e(Object(o.o)(l.S,x.t)(rt));e(Object(o.o)(l.S,fn.t)(an));e(Object(o.o)(l.S,N)(it));e(Object(o.o)(l.S,Ft.t)(Qt));e(Object(o.o)(l.S,jt.t)(ln));e(Object(o.o)(l._,u.t)(ft));e(Object(o.o)(l.a,a.e)(et));e(Object(o.o)(l.z,a.e)(ht));e(Object(o.o)(l.u,a.e)(Ct));e(Object(o.o)(l.fe,a.e)(kt));e(Object(o.o)(l.i,a.e)(Lt));e(Object(o.o)(l.s,a.e)(At));e(Object(o.o)(l.ae,a.e)(Ht));e(Object(o.o)(l.S,ae.t)(ve));e(Object(o.o)(l.S,me.t)(be));e(Object(S.r)(l.D,en.e)(tn));e(Object(S.r)(l.D,nn.e)(on));e(Sn.sharePointBasicItemDataAddonDeferred);e(dn.e);e(C.e);e(se);e(ue);e(Object(S.r)(l.D,qt.e)(Ut));e(Object(o.o)(l.D,Wt.e)(Xt));e(Object(S.r)(l.D,Gt.e)(Yt));e(Object(o.o)(l.D,vn.n)(bn));return[2]})})}})},,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(19),s=n(64),o=n(12),u=n(144),a=n(839),f=n(813),l=n(832),c=n(817),h=n(509),p=n(711),d=n(710),v=n(394),m=n(497),g=n(508),y=n(2006),b=n(1418),w=n(69),E=n(13),S=n(1856),x=n(56),T=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.folders,i=u.e.deserialize(t),s=i.endpoint,o=i.driveId,a=i.itemId,f=Object.keys(n)[0],l=n[f].progressItemKey,c=Object(y.n)(i);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,h,p,d,v,m,g,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:n=Object(y.t)(i)+"/children";h={name:f,folder:{},"@microsoft.graph.conflictBehavior":"rename"};o&&a&&(h.parentReference={driveId:o,id:a});return[4,e(Object(b.n)({url:n,driveUrl:c,method:"POST",body:h,qosName:"createFolder",endpoint:s}))];case 1:p=N.sent();d=u.e.serialize({endpoint:s,driveId:o,itemId:p.id});v=new x.e;l&&v.resolveItems({items:(m={},m[l]=Object(r.__assign)({},w.s.pack({itemKey:d})),m)});v.invalidateItems({items:(g={},g[t]=[E.t],g)});v.resolveItems({items:(T={},T[d]=Object(r.__assign)({},Object(S.e)({driveItem:p,parentFolderItemKey:t,endpoint:s})),T)});e(v.execute());return[2]}})})}}),N=n(172),C=n(7),k=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=u.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:i=Object(y.t)(n);return[4,e(Object(b.n)({url:i,method:"DELETE",qosName:"deleteItem",endpoint:n.endpoint}))];case 1:r.sent();e(Object(N.t)({items:(s={},s[t]=[C.a],s)}));return[2]}})})}}),L=n(327),A=n(230),O=n(99),M=n(1599),_=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.names,i=u.e.deserialize(t);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var s,o,u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:s=Object.keys(n)[0];o=n[s],u=o.newName,a=o.newExtension;f=Object(y.t)(i);l=Object(y.n)(i);c=e(Object(O.e)({fileName:C.h},t)).fileName;h="string"==typeof a?a:c&&c.extension||"";return[4,e(Object(b.n)({url:f,driveUrl:l,method:"PATCH",body:{name:""+u+h},qosName:"renameItem",endpoint:i.endpoint})).then(function(n){var i,s,o=new x.e;o.invalidateItems({items:(i={},i[t]=[C.f],i)});o.resolveItems({items:(s={},s[t]=Object(r.__assign)(Object(r.__assign)({},C.f.pack(n.name)),C.h.pack(Object(S.t)(n.name||"",!!n.folder))),s)});e(o.execute())}).catch(function(e){if(e instanceof M.e&&e.status===L.t)throw new L.e({facets:Object(r.__assign)({},A.h.pack({})),innerError:e});throw e})];case 1:p.sent();return[2]}})})}}),D=n(3300),P=n(3298),H=n(3296),B=n(3299),j=n(3297),F=n(2007),I=n(182),q=n(102),R=n(25),U=n(1868),z=n(62),W=n(2),X=n(17),V=n(177),$=Object(q.e)(function(){return new H.e({},{})}),J=Object(q.e)(function(e){var t=e(b.e).dataRequestor,n=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t,{performanceNow:j.t})||this}return t})(j.e),i=new P.e({},{dataRequestor:t}),s=new B.e({},{activityBandwidthVerifierType:n,uploadService:i});return new D.e({},{uploadService:i,uploadStateMachine:s})}),K=0;function Q(e){var t=this,n=e.itemKey,i=e.options.sourceEntries,s=u.e.deserialize(n),o=s.endpoint,a=s.driveId,f=Object.keys(i)[0],l=i[f],c=l.progressItemKey,h=l.conflictResolution,p=void 0===h?"fail":h;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,l,h,d,v,m,g,b,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:if(!(t=e(Object(O.e)({sourceFile:U.t},f)).sourceFile))throw new Error("No source file for Graph upload.");i=Object(y.t)(s)+":";l=Object(y.n)(s);c&&e(Object(z.e)({items:(m={},m[c]=Object(r.__assign)({},w.v.pack({total:t.size,current:0})),m)}));return[4,e(G({progressItemKey:c,sourceFile:t,itemUrl:i,driveUrl:l,conflictResolution:p,endpoint:o}))];case 1:h=N.sent();d=u.e.serialize({endpoint:o,driveId:a,itemId:h.id});v=new x.e;c&&v.resolveItems({items:(g={},g[c]=Object(r.__assign)(Object(r.__assign)({},w.s.pack({itemKey:d})),Object(W.r)({progressSize:w.v},{progressSize:{current:t.size}})),g)});v.invalidateItems({items:(b={},b[n]=[E.t],b)});v.resolveItems({items:(T={},T[d]=Object(r.__assign)({},Object(S.e)({driveItem:h,parentFolderItemKey:n,endpoint:o})),T)});return[2,{itemResolver:v,driveItem:h,itemKey:d}]}})})}}function G(e){var t=this,n=e.progressItemKey,i=e.sourceFile,s=e.itemUrl,o=e.driveUrl,u=e.endpoint,a=(function(e){switch(e){case"rename":return"rename";case"replace":return"replace";default:return"fail"}})(e.conflictResolution);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,f,l,h,p,d,v,m,g,y;return Object(r.__generator)(this,function(b){switch(b.label){case 0:t=e(J);f=e($);return[4,e(Object(F.e)(u,o))];case 1:l=b.sent();h=new I.e;p=0;d=h.debounce(function(t){var r;if(t>p){n&&e(Object(z.e)({items:(r={},r[n]=Object(W.r)({progressSize:w.v},{progressSize:{current:t}}),r)}));p=t}},300,{leading:!1});v=e(Object(R.e)(function(e){return e.demandItemFacet(w.i,n)}));m=t.upload({conflictBehavior:a,qosData:{uploadId:""+ ++K},accessToken:l,fileName:i.name,content:i,itemUrl:s,onProgress:d,onPromptForConfictBehavior:function(e){return Promise.reject(e)},onWait:function(e){return f.wait(e)},select:"*,sharepointIds"});g=v?v.token.subscribe(function(){m.cancel()}):void 0;b.label=2;case 2:b.trys.push([2,4,5,6]);return[4,m];case 3:return[2,b.sent()];case 4:y=b.sent();if(X.n.isCanceled(y))throw new V.e;throw new c.e({facets:Object(r.__assign)({},Object(M.t)(y,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return A.e.pack({});case"nameAlreadyExists":case 409:return A.n.pack({supportsRename:!0})}})||Object(W.r)({},{})),innerError:y});case 5:g&&g();h.dispose();return[7];case 6:return[2]}})})}}var Y=Object(i.i)({mergeForSameItemKey:!1,maxParallelOperationCount:3,timeout:864e5})(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,n(Q(e))];case 1:t=r.sent().itemResolver;n(t.execute());return[2]}})})}});var Z=n(2507),ee=n(2504),te=n(2503),ne=n(74),re=n(174),ie=(new ne.e("addToOneDrive",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.e}))}),new ne.e("canCreateFolder",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.t}))})),se=(new ne.e("canCreateLink",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.n}))}),new ne.e("canDelete",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.r}))})),oe=new ne.e("canDownload",function(e,t){return!e.demandItemFacet(re.n,t.itemKey)&&fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.i}))}),ue=(new ne.e("canInvite",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.s}))}),new ne.e("canMove",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.o}))}),new ne.e("canUseOfficeLens",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.u}))}),new ne.e("canRename",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.a}))})),ae=new ne.e("canUpload",function(e,t){return fe(e,Object(r.__assign)(Object(r.__assign)({},t),{commandFacet:ee.f}))});function fe(e,t){var n=t.itemKey,r=t.commandFacet,i=e.demandItemFacet(u.e,n);if(!i)return!1;var s=i.endpoint,o=i.driveId,a=e.demandItemFacet(r,te.e.serialize({endpoint:s,driveId:o}));return!!a&&!!a.roles&&(function(e,t){var n=t.itemKey,r=t.oneOfRequiredRoles,i=(function(e,t){if((function(e,t){var n=e.demandItemFacet(Z.e,t);return!n||!n.effectiveRoles||!n.owner})(e,t))return["read","write","owner"];var n=e.demandItemFacet(Z.e,t);if(n&&n.effectiveRoles)return n.effectiveRoles;return[]})(e,n);return(function(e,t){var n=t.oneOfRequiredRoles,r=t.effectiveRoles;for(var i in r)if(i in n)return!0;return!1})(0,{oneOfRequiredRoles:r,effectiveRoles:i})})(e,{itemKey:n,oneOfRequiredRoles:a.roles})}var le=Object(o.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ie,n)}}}});var ce=n(2345),he=Object(o.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ue,n),validator:ce.e}}}});var pe=Object(o.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(se,n)}}}});var de=Object(o.t)()(function(){return function(){return function(e,t){var n=t.itemKey;return{isAvailable:e.demandItemFacet(ae,n)}}}});var ve=Object(o.t)()(function(){return function(e){return me}});function me(e,t){if(1!==t.itemKeys.length)return{};var n=t.itemKeys[0];if(e.demandItemFacet(C.d,n))return{};var i=e.demandItemFacet(u.e,n),s=i?Object(y.t)(i):void 0,o=i?Object(y.n)(i):void 0,a=i&&i.endpoint||"";return{isAvailable:e.demandItemFacet(oe,n),getDownloadData:s&&o?function(){return(function(e){var t=this,n=e.itemUrl,i=e.driveUrl,s=e.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,o(Object(b.n)({url:e.itemUrl,driveUrl:i,method:"GET",qosName:"getItemDownloadUrl",endpoint:s}))];case 1:t=r.sent();if(!(u=(function(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)})(n)?t["@microsoft.graph.downloadUrl"]:t["@content.downloadUrl"]))throw new Error("Unable to obtain download URL.");return[2,{method:"GET",url:u}];case 2:if((a=r.sent())instanceof M.e){f=Object(M.t)(a,function(e,t){switch(e){case"unauthenticated":case 401:return A.t.pack({});case"itemNotFound":case 404:return A.s.pack({});case"accessDenied":case 403:return A.e.pack({});default:return A.h.pack({})}});throw new L.e({innerError:a,facets:f})}throw a;case 3:return[2]}})})}})({itemUrl:s,driveUrl:o,endpoint:a})}:void 0}}var ge=Object(o.t)()(function(){return function(e){return ye}});function ye(e,t){var n=t.itemKey,i=e.demandItemFacet(u.e,n);return{isAvailable:!0,getShareLink:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(t=e.driveItem))return[3,2];i=Object(y.t)(t)+"/invite";s=Object(y.n)(t);return[4,n(Object(b.r)({url:i,driveUrl:s,method:"POST",qosName:"getDefaultShareLink",endpoint:t.endpoint,headers:{prefer:"getDefaultLink","Content-type":"application/json"}}))];case 1:if(!(o=r.sent()))throw new Error("Unable to obtain default share URL");return[2,{url:o.value[0].link.webUrl,scope:o.value[0].link.scope}];case 2:throw new Error("Unable to obtain default share URL")}})})}})({driveItem:i})}}}var be=Object(o.t)()(function(){return function(){return function(){return{}}}});var we=Object(o.t)()(function(){return function(e){return Ee}});function Ee(e,t){var n=t.itemKey,i=t.link,s=t.recipients,o=e.demandItemFacet(u.e,n);return{isAvailable:!0,permissionInvite:function(){return(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=e.driveItem,i=e.link,s=e.recipients;if(!t||!i)throw new Error("Unable to obtain default share URL");o=t.endpoint;a=btoa(i);u="u!"+a.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-");f=s.map(function(e){return{email:e}});l={recipients:f,roles:["read"]};c=o.replace("v1.0","beta");h=c+"/shares/"+u+"/permission/grant";return[4,n(Object(b.r)({url:h,method:"POST",qosName:"permissionGrant",endpoint:t.endpoint,headers:{"Content-type":"application/json",Accept:"application/json"},body:l}))];case 1:p=r.sent();d=p.value[0].grantedToIdentities.map(function(e){return{email:e.user.email}});return[2,{recipients:d}]}})})}})({driveItem:o,link:i,recipients:s})}}}var Se=n(2850),xe=n(2851),Te=n(347),Ne=n(173),Ce=n(54),ke=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,i=n.isFollowed,s=n.progressItemKey,o=Te.e.deserialize(t),a=o.driveItemKey,f=a.itemId,l=void 0===f?"":f,c=Object(y.n)(a);return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,f,h,p,d,v,m,g;return Object(r.__generator)(this,function(y){switch(y.label){case 0:t=e(Object(Ce.e)({saveForLaterGraphEndpoint:Ne.p})).saveForLaterGraphEndpoint;n=new x.e;f=Te.e.serialize(o);h=t||a.endpoint;s&&e(Object(z.e)({items:(v={},v[s]=Object(r.__assign)({},w.m.pack({itemKey:u.e.serialize(a)})),v)}));p=i?{url:h+"/drives/"+a.driveId+"/items/"+l+"/follow",method:"POST",qosName:"followItem"}:{url:h+"/drives/"+a.driveId+"/following/"+l,method:"DELETE",qosName:"unfollowItem"};y.label=1;case 1:y.trys.push([1,3,,4]);return[4,e(Object(b.n)({url:p.url,driveUrl:c,method:p.method,qosName:p.qosName,endpoint:h}))];case 2:y.sent();n.invalidateItems({items:(m={},m[f]=[C.b],m)});n.resolveItems({items:(g={},g[f]=Object(r.__assign)({},C.b.pack(i||void 0)),g)});e(n.execute());return[3,4];case 3:d=y.sent();throw new Error(d.message);case 4:return[2]}})})}}),Le=n(412),Ae=n(739),Oe=n(1746),Me=n(2178);function _e(e,t){return Me.e.serialize(Object(r.__assign)(Object(r.__assign)({},{driveItemKey:e.driveItemKey}),t?{searchTerm:t}:{searchTerm:void 0}))}var De=Object(o.t)()(He),Pe=Object(o.t)()(He);function He(){return function(e){return function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(Oe.e,r);if(i)n=function(e){return i?_e(i,e):void 0};else{var s=e.demandItemFacet(Me.e,r);n=function(e){return s?_e(s,e):void 0}}return{isAvailable:!0,getSearchItemKey:n}}}}var Be=n(569),je=n(820),Fe=n(316),Ie=Object(o.t)()(function(){return function(e){return qe}});function qe(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(Oe.e,i),o=e.demandItemFacet(Me.e,i);if(n&&(s||o)){for(var u=[],a=0,f=n;a<f.length;a++){var l=f[a];if(l.key===Fe.o.key)u.push("photo");else if(l.key===Fe.u.key)u.push("video");else if(l.key===Fe.e.key)u.push("folder");else if(l.key===Fe.s.key)u.push("onenote");else if(l.key===Fe.r.key)u.push("!photo");else if(l.key===Fe.i.key)u.push("!video");else if(l.key===Fe.t.key)u.push("!folder");else if(l.key===Fe.n.key)u.push("!onenote");else{var c=Object(je.e)(l);c&&u.push(c)}}if(s)return{itemKey:Oe.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{extFilters:u}))}}return{}}var Re=n(2316),Ue=n(1538),ze=n(2341),We=Object(i.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options,i=Object.keys(n)[0];return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var s,o,a,f,l,c,h,p,d,v,m,g,w,S;return Object(r.__generator)(this,function(T){switch(T.label){case 0:if(!e(Object(R.e)(function(e){return e.demandItemFacet(u.e,i)})))throw new Error("Source item does not have a driveItem key");s=n[i],o=s.isMove,a=s.conflictBehavior,f=s.progressItemKey;l=u.e.deserialize(t);return[4,e(Object(Ue.demandItems)(function(e){return e.demandItemFacet(u.e,i)}))];case 1:if(!(c=T.sent()))throw new Error("Unable to get metadata for destination item.");h=Object(y.t)(c);p=Object(y.n)(c);d=c.endpoint;T.label=2;case 2:T.trys.push([2,4,,5]);return[4,e(Object(b.n)({url:h+(o?"":"/copy"),driveUrl:p,method:o?"PATCH":"POST",body:{parentReference:{id:l.itemId||ze.n,driveId:l.driveId||""},"@microsoft.graph.conflictBehavior":a},qosName:o?"moveItem":"copyItem",endpoint:d}))];case 3:v=T.sent();(m=new x.e).invalidateItems({items:(w={},w[i]=o?[C.A,C.a]:[],w[t]=[E.t],w)});f&&!o&&v.name&&m.resolveItems({items:(S={},S[f]=Object(r.__assign)({},C.f.pack(v.name)),S)});e(m.execute());return[3,5];case 4:if((g=T.sent())instanceof M.e&&g.status===L.t)throw new Re.e({innerError:g,facets:Object(r.__assign)({},A.u.pack(g.status))});throw g;case 5:return[2]}})})}}),Xe=n(857),Ve=Object(o.t)()(function(){return function(){return function(e,t){return{validator:ce.e}}}});var $e=n(70),Je=n(138),Ke=n(574),Qe=n(146),Ge=n(2832),Ye=n(128),Ze=n(586),et=n(2508),tt=n(285),nt=n(2875),rt=Object(i.i)()(function(e){var t=e.itemKey,n=e.options.itemSetKey;return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var i,s,o,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!tt.e.matches(n))throw new L.e({code:"invalidItemSetForAddToOneDrive"});i=tt.e.deserialize(n).driveItemKey.endpoint;s=e(Object(R.e)(function(e){return e.demandItemFacet(C.h,t)}));o=e(Object(R.e)(function(e){return e.demandItemFacet(et.e,t)}));a=e(Object(R.e)(function(e){return e.demandItemFacet(u.e,t)}));if(!(i&&s&&a&&o))throw new L.e({code:"missingItemInfoForAddToOneDrive"});return[4,e(Object(nt.n)("GetDriveInfo",i))];case 1:f=r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,e(Object(nt.t)(s.name,f.id,o,"AddToOneDrive_SWM",i))];case 3:r.sent();return[3,5];case 4:if(!((l=r.sent())instanceof M.e))throw l;Object(nt.e)(l);return[3,5];case 5:return[2]}})})}});n.d(t,"graphAddonDataOnlyDeferred",function(){return st});var it=Object(Je.e)(function(){return Promise.resolve().then(n.bind(null,3691))},{chunkName:"addon-graph-deferredoperations"}),st=Object(i.t)(function(){return function(e){var t=e(Object(Ce.e)({useBatchedDeleteConfiguration:Ne.m})).useBatchedDeleteConfiguration;e(Object(Ye.e)(function(){e(Object(o.r)(Oe.e,Ae.e)(De));e(Object(o.r)(Me.e,Ae.e)(Pe));e(Object(o.r)(Oe.e,Be.e)(Ie));e(Object(s.o)(u.e,a.t)(T));e(t?Object(s.o)(u.e,f.t)(Object(i.r)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object($e.o)())];case 1:t.sent();return[4,it()];case 2:return[2,t.sent().driveItemDeleteItemsBatchedOperationHandler]}})})})):Object(s.o)(u.e,f.t)(k));e(Object(s.o)(u.e,l.t)(_));e(Object(s.o)(u.e,c.t)(Y));e(Object(s.o)(u.e,Re.t)(We));e(Object(s.o)(u.e,Ze.t)(rt));e(Object(o.r)(u.e,h.e)(le));e(Object(o.r)(u.e,Xe.e)(Ve));e(Object(o.r)(u.e,p.e)(he));e(Object(o.r)(u.e,d.e)(pe));e(Object(o.r)(u.e,v.e)(de));e(Object(o.r)(u.e,Se.e)(ge));e(Object(o.r)(u.e,xe.e)(we));e(Object(o.r)(u.e,m.e)(ve));e(Object(o.r)(u.e,g.e)(be));e(Object(s.o)(Te.e,Le.e)(ke));e(Object(s.o)(Ke.e,Qe.e)(Ge.e))}))}})},,function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1),s=n(3124),o=(function(e){Object(r.__extends)(t,e);function t(){var t=null!==e&&e.apply(this,arguments)||this;t._onDismiss=function(){t.props.resolve()};return t}t.prototype.render=function(){var e=this.props,t=e.title,n=e.linkLocation,r=e.launchBehaviorType;if(n&&void 0!==r){if("dialog"===r)return i.createElement(s.e,{url:n,heightOffset:.7,dialogContentProps:{title:t},onDismiss:this._onDismiss});"inPageNavigation"===r?window.open(n,"_self"):window.open(n,"_blank")}this.props.resolve();return null};return t})(i.PureComponent),u=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props.targetUrl;e&&window.open(e,"_blank");this.props.resolve();return null};return t})(i.PureComponent),a=n(842),f=n(859),l=n(9),c=n(28),h=n(46),p=n(3),d=n(4),v=n(402),m=n(7),g=n(2521),y=n(59),b={ODB:670},w=Object(l.t)(function(e,t){var n=t.itemKey,i=e.demandItem({key:p.D,itemUrl:m.B},n),s=i.key,o=i.itemUrl,u="",a="",f="",l=!1,c=!1;if(s&&o){var w=e.demandItemFacet(d.Et,p.Z.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}));Object(y.e)(e,{feature:b,pageContext:w})&&(c=!0);var E=p.U.serialize({webAbsoluteUrl:s.webAbsoluteUrl,listFullUrl:s.listFullUrl}),S=e.demandItem({driveUrl:d.b},E).driveUrl;if(S){var x=Object(v.e)(S);if(x){u=x.driveId||"";var T=e.demandItemFacet(m.h,n);if(T){f=T.name;(x=Object(v.e)(o))&&(l=!!(a=x.itemId||""))}}}}var N,C=s?Object(g.e)("spo:"+s.webAbsoluteUrl):void 0;if(c){var k=e.demandItemFacet(m.i,n)||"";N="https://www.office.com/launch/fluid/content?drive="+u+"&item="+a+"&file="+encodeURIComponent(k)}else N="https://fluidpreview.office.net/p/"+C+"/"+u+"/"+a+"/"+encodeURIComponent(f);return Object(r.__assign)({isAvailable:l,onExecute:l?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){window.open(N);return[2]})})}:void 0},Object(h.e)(e,{itemKey:n,engagement:{name:"OpenInBFile",isIntentional:!0}}))})(c.e),E=n(2352),S=n(2516),x=Object(l.t)(function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey,s=!1,o=i&&p.U.serialize(i);if(i&&n){var u=e.demandItemFacet(d.ye,o);s=!(!(u&&u.permissions&&u.permissions.manageLists&&n&&n.id)||n.isPersonal||n.isDefault)}return Object(r.__assign)({isAvailable:s},Object(h.e)(e,{itemKey:o,engagement:{name:"SetDefaultView",isIntentional:!0}}))},function(e,t){var n=t.currentDerivedView,i=t.listViewSetKey;return{onExecute:n?function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(r){e(Object(S.e)({items:(t={},t[p.z.serialize(i)]={views:(s={},s[n.id]={isDefault:!0},s)},t)}));return[2]})})}:void 0}})(c.e),T=n(84),N=n(2843),C=n(177),k=n(2517),L=n(2353),A=n(21),O=n(13),M=n(99),_=n(592),D=n(172),P=n(449),H=n(1558),B=n(56);var j=n(156),F=n(564),I=n(126),q=n(313),R=n(120),U=n(61),z=new j.e("saveViewProgressBatch"),W=Object(I.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("dot_saveviewdialog")]).then(n.bind(null,3648))];case 1:return[2,e.sent().SaveViewDialog]}})})});function X(){return z.serializeNext()}var V=Object(F.e)()(E.t);function $(e){var t=this,n=e.viewTitle,s=e.isPublicView,o=e.onViewSaved,u=e.currentViewKey,a=e.itemSetKey,f=e.itemsScopeItemKey,l=e.listViewSetKey,c=e.reject,h=e.resolve,v=i.useState(!0),m=v[0],g=v[1],y=i.useState(X)[0],b=i.useState(),w=b[0],E=b[1],S=i.useState(),x=S[0],T=S[1],j=Object(R.t)(),F=Object(q.e)(function(){T(!0);o&&o();h()}),I=Object(q.e)(function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,n,i,s,v,m,b,w;return Object(r.__generator)(this,function(S){switch(S.label){case 0:t=e.viewTitle,n=e.isPublicView;i=j(Object(M.e)({currentDerivedView:d.p},u)).currentDerivedView;s=i&&i.title!==t;v=j(Object(M.e)({deserializedSetKey:p.S},a)).deserializedSetKey;return s&&v&&i?[4,j(Object(k.e)({webAbsoluteUrl:v.webAbsoluteUrl,listFullUrl:v.listFullUrl}))]:[3,3];case 1:if(S.sent().some(function(e){return e.serverView.Title===t}))throw new Error(A.format(L.e.SaveViewErrorCannotOverwrite,t));return[4,j(Object(N.e)({items:(b={},b[l]={views:(w={},w[t]={itemSetKey:a,isPublic:n,sourceView:i,progressItemKey:y},w)},b)}))];case 2:S.sent();if(m=j(Object(M.e)({createdViewKey:p.oe},y)).createdViewKey){E(m.viewId);g(!1)}return[3,5];case 3:if(!f){c(new Error("Cannot save a view without a current ItemsScope"));return[2]}return[4,j((x={itemsScopeItemKey:f,listViewSetKey:l,itemSetKey:a,currentViewKey:u},function(e){var t,n,i=x.itemsScopeItemKey,s=x.listViewSetKey,o=x.itemSetKey,u=x.currentViewKey,a=e(Object(M.e)({childItems:O.e,parentItem:O.i,deserializedItemSetKey:p.S},o)),f=a.childItems,l=a.parentItem,c=a.deserializedItemSetKey;return e(Object(H.e)({items:(t={},t[s]={views:(n={},n[u]={itemSetKey:o},n)},t)})).then(function(){var t,n;if(c){var s=p.S.serialize(Object(r.__assign)(Object(r.__assign)({},c),{filterParams:void 0,sortFieldKey:void 0,sortAscending:void 0,groupByFieldKey:void 0})),o=e(Object(M.e)({filterOptionSets:O.n},s)).filterOptionSets;if(o&&c.filterParams){var a={};for(var h in o)o.hasOwnProperty(h)&&(a[o[h]]=!0);e(Object(_.e)({items:a}))}var v=new B.e;v.resolveItems({items:(t={},t[s]=Object(r.__assign)(Object(r.__assign)({},f?O.e.pack(f):{}),l?O.i.pack(l):{}),t[u]=Object(r.__assign)({},d.Ke.pack(!1)),t)});e(v.execute());e(Object(D.t)({items:(n={},n[u]=[d.Je,d.p],n[s]=[O.e],n)}));e(Object(P.e)({itemsScopeItemKey:i,currentItemKey:s}))}})}))];case 4:S.sent();o&&o();h();S.label=5;case 5:return[2]}var x})})}),U=Object(q.e)(function(){c(new C.e)});return m?i.createElement(W,{viewTitle:n,isPublicView:s,onContinue:I,onCancel:U}):!x&&w?i.createElement(V,{viewId:w,currentDerivedView:void 0,onComplete:F,itemSetKey:a}):null}var J=Object(l.i)(function(e,t){var n=Object(U.e)(e).itemsScopeItemKey;return i.createElement($,Object(r.__assign)({},t,{itemsScopeItemKey:n}))}),K=n(2877),Q=n(20),G=n(487),Y=Object(l.i)(function(e,t){var n=t.currentViewKey,s=Object(T.e)(e),o=Object(U.e)(e).itemsScopeItemKey,u=!1,a=e.demandItemFacet(p.S,s),f=e.demandItemFacet(d.p,n),l=e.demandItemFacet(K.e,s),v=K.e.evaluate(l)(e,{viewKey:n}).onViewSaved;if(a&&f){var m=p.U.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}),g=e.demandItemFacet(d.ye,m);u=!!(g&&f&&"POWER"!==f.viewType&&g.permissions&&(g.permissions.managePersonalViews||g.permissions.manageLists))}if(!f||!s||!o)return null;var y=Object(Q.o)(function(e){return i.createElement(G.e,{itemsScopeItemKey:o},i.createElement(J,Object(r.__assign)({},e,t,{itemSetKey:s,viewTitle:f.title,isPublicView:!f.isPersonal,onViewSaved:v})))},{scope:"global"});return i.createElement(c.e,Object(r.__assign)({isAvailable:u,onExecute:y},Object(h.e)(e,{itemKey:s,engagement:{name:"SaveView",isIntentional:!0}})))}),Z=n(3126),ee=n(2806),te=n(62),ne=n(346),re=new(n(11).e)("groupByActionControl"),ie=n(24),se=n(50),oe={ODB:1352},ue=Object(l.i)(function(e,t){var n=t.groupByFieldKey,s=t.itemSetKey,o=e.demandItemFacet(p.S,s);if(!o)return i.createElement(Q.n,null);var u=p.U.serialize(o),a=e.demandItemFacet(d.ye,u),f=a&&a.templateType===ie.n.mySiteDocumentLibrary,v=Object(se.e)(e,{enableGroupByInOneDrive:d.N}).enableGroupByInOneDrive,m=o.groupByFieldKey===n,g=p.S.serialize(Object(r.__assign)(Object(r.__assign)({},o),{groupByFieldKey:m?void 0:n})),b=p.D.serialize(o),w=o.viewKey&&p.oe.serialize(o.viewKey),E=e.demandItemFacet(re,s),S=re.evaluate(E)(e,{itemSetKey:s,viewKey:w,groupedItemSetKey:g,isAvailable:!f||!!v}),x=S.isAvailable,T=S.onGroupBy,N=e.demandItemFacet(d.Et,p.Z.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl})),C=Object(y.e)(e,{feature:oe,pageContext:N}),k=Object(h.e)(e,{itemKey:s,engagement:{name:"GroupBy",isIntentional:!0}}),L=e.dispatch,A=Object(l.s)(e,i.createElement(ne.e,{itemKey:g}));return i.createElement(Q.n,{action:A},function(e){var t=e.isAvailable,n=e.execute;return i.createElement(c.e,Object(r.__assign)({isAvailable:t&&x,isToggled:m,onExecute:function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,i,s,o;return Object(r.__generator)(this,function(u){switch(u.label){case 0:if(C&&T){t=p.S.deserialize(g);i=t&&t.groupByFieldKey;L(T({groupByFieldKey:i}))}L(Object(te.e)({items:Object(r.__assign)((s={},s[g]=Object(r.__assign)({},O.i.pack({itemKey:b})),s),w?(o={},o[w]=Object(r.__assign)({},d.Ke.pack(!0)),o):{})}));return[4,n(e)];case 1:u.sent();return[2]}})})}},k))})}),ae=n(707),fe=n(3519),le={ODB:1318},ce=!1,he=Object(l.t)(function(e,t){var n=t.itemSetKey,i=t.modifyType,s=t.columnKey,o=!1,u=e.demandItem({setKey:p.S,canModifySchema:d.u},n),a=u.setKey,f=u.canModifySchema,l=a&&a.viewKey?p.oe.serialize(a.viewKey):void 0,c=e.demandItem({currentDerivedView:d.p},l).currentDerivedView,v=e.demandItemFacet(d.ue,s);if(a&&f&&c&&c.baseViewXml&&v)if(1===i||2===i){var m=c.getEffectiveFieldNames();if(m&&m.length){var g=m.indexOf(v),b=a.groupByFieldKey?1:0;o=1===i?g>b+1:g>=b&&g<m.length-1}}else o=!0;if(a){var w=e.demandItemFacet(d.Et,p.Z.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}));ce=Object(y.e)(e,{feature:le,pageContext:w})}return Object(r.__assign)({isAvailable:o},Object(h.e)(e,{itemKey:n,engagement:{name:"ModifyColumn",isIntentional:!0}}))},function(e,t){var n=t.itemSetKey,i=t.modifyType,s=t.columnKey,o=ce?fe.modifyColumnWithProgress:ae.e;return{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,u;return Object(r.__generator)(this,function(r){e(o({items:(t={},t[n]={columnModifyTypeMap:(u={},u[s]={modifyType:i},u)},t)}));return[2]})})}}})(c.e),pe=n(2846),de=n(407),ve=Object(l.t)(function(e,t){var n=t.itemSetKey,i=t.columnKey,s=t.aggregateType,o=e.demandItemFacet(d.a,n),u=o&&o[i]&&o[i].aggregateFunctionType||de.e[0],a=u===de.e[s]?void 0:de.e[s];return Object(r.__assign)({isAvailable:!0,isToggled:u===de.e[s]},a?Object(h.e)(e,{itemKey:n,engagement:{isIntentional:!0,action:"ModifyColumnAggregateType",name:a||"AggregateTypeNone",extraData:{PreviousAggregateType:u||"AggregateTypeNone",component:"ColumnContextMenu"}}}):{})},function(e,t){var n=t.itemSetKey,i=t.columnKey,s=t.aggregateType;return{onExecute:function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(r){e(Object(pe.e)({items:(t={},t[n]={aggregateType:s,columnKey:i},t)}));return[2]})})}}})(c.e),me=n(2524),ge=n(2525);n.d(t,"OpenAsHyperLinkExecutor",function(){return o});n.d(t,"OpenAsShortcutExecutor",function(){return u});n.d(t,"NewItemInOfficeClientAction",function(){return a.t});n.d(t,"ItemOpenInOfficeClientAction",function(){return a.e});n.d(t,"OpenInOfficeClientAction",function(){return a.n});n.d(t,"ItemOpenInOfficeOnlineAction",function(){return f.e});n.d(t,"OpenInOfficeOnlineAction",function(){return f.t});n.d(t,"OpenInBFileAction",function(){return w});n.d(t,"ItemSwitchViewAction",function(){return E.e});n.d(t,"SwitchViewAction",function(){return E.t});n.d(t,"SetDefaultViewAction",function(){return x});n.d(t,"SaveViewAction",function(){return Y});n.d(t,"LaunchFilterPanelAction",function(){return Z.e});n.d(t,"SortAction",function(){return ee.e});n.d(t,"GroupByAction",function(){return ue});n.d(t,"ModifyColumnAction",function(){return he});n.d(t,"ModifyColumnAggregateTypeAction",function(){return ve});n.d(t,"ApproveRejectAction",function(){return me.e});n.d(t,"ItemFileHandlerOpenAction",function(){return ge.t});n.d(t,"FileHandlerOpenAction",function(){return ge.e})},,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(19),i=n(64),s=n(12),o=n(3),u=n(813),a=n(0),f=n(4),l=n(247),c=n(277),h=n(2841),p=n(1568),d=n(115),v=n(327),m=n(7),g=n(230),y=n(25),b=n(174),w=n(3164),E=n(56),S=n(31),x=n(22),T=n(54),N=n(232),C=n(13),k=n(15),L=n(2488),A=n(86),O=n(2333),M=n(58),_=Object(r.n)()(function(e){var t=e.items;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var n,i,s,u,w,_,H,B,j,F,I,q,R,U,z,W,X,V,$,J,K,Q,G,Y,Z,ee,te,ne,re,ie,se,oe,ue;return Object(a.__generator)(this,function(ae){switch(ae.label){case 0:n=void 0;i=void 0;s=void 0;u=void 0;w=e(L.e);_={};H=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n],s=_[i];s&&s.id&&t.push(s.id)}t.length&&A.e.raise(w,O.e.deleteCompletedEventName,{itemIds:t})};B=function(r){u=t[r].currentItemSetKey;var a=e(Object(y.e)(function(e){return e.demandItem({key:o.D,folder:m.d,uniqueId:f._t,folderPath:f.Q,oneNote:b.n,itemId:f.we},r)}));if(a&&a.key&&a.folderPath){i=a.key.webAbsoluteUrl;s=a.key.listFullUrl;if(!n){var l=o.U.serialize({webAbsoluteUrl:i,listFullUrl:s}),c=e(Object(y.e)(function(e){return e.demandItemFacet(f.ye,l)}));n={webAbsoluteUrl:i,listFullUrl:s,items:[],deletionType:h.e.Recycle,listId:c&&c.id}}var p={key:r,serverRelativeItemUrl:a.folderPath,id:a.itemId,uniqueId:a.uniqueId,isFolder:!!a.folder||!!a.oneNote};n.items.push(p);_[p.key]=p}};for(j=0,F=Object.keys(t);j<F.length;j++){I=F[j];B(I)}q=n;R=[];U=e(Object(y.e)(function(e){return i&&s?e.demandItemFacet(f.Et,o.Z.serialize({webAbsoluteUrl:i,listFullUrl:s})):void 0}));if(!q||!q.items.length)return[3,5];z=e(Object(T.e)({enableOverrideDeleteFileLocks:x.m})).enableOverrideDeleteFileLocks;if(1!==q.items.length)return[3,2];W=q.items[0];X=D({webAbsoluteUrl:q.webAbsoluteUrl,listFullUrl:q.listFullUrl,deletionType:q.deletionType,listId:q.listId,serverRelativeItemUrl:W.serverRelativeItemUrl,uniqueId:W.uniqueId,isFolder:!!W.isFolder,itemId:W.id});V={};q.deletionType===h.e.PermanantDelete&&(V["X-HTTP-Method"]="DELETE");Z=t[Object.keys(t)[0]];($=!!Z.breakLock)&&(V.Prefer="bypass-shared-lock");return[4,e(Object(l.t)({webAbsoluteUrl:q.webAbsoluteUrl,listFullUrl:s||"",url:X,body:void 0,method:"POST",additionalHeaders:V,qosName:"deleteSingleItem",telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var r=t.status===v.t||z&&t.code&&t.code.indexOf("-2130575306")>-1?S.t.expectedFailure:S.t.failure;return{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultType:r})}}return{eventData:n}}})).then(function(){R.push(W.key);H(R)}).catch(function(t){if(t instanceof c.e){if(t.code&&t.code.indexOf("-2130575306")>-1){z&&e(Object(N.e)({name:"DeleteOperationFileLockedWithForcedDeleteEnabled",isIntentional:!1,extraData:{errorCode:t.code,overrideFileLocksEnabled:z,isBatch:!1}}));throw new v.e({innerError:t,facets:Object(a.__assign)({},g.i.pack({}))})}$&&e(Object(N.e)({name:"DeleteOperationOverrideFilelockedFailed",isIntentional:!1,extraData:{errorCode:t.code,overrideFileLocksEnabled:z,isBatch:!1}}));if(t.errorData.status===v.t)throw new v.e({innerError:t,facets:Object(a.__assign)({},g.h.pack({}))})}throw t})];case 1:ae.sent();return[3,4];case 2:if(!(q.items.length>1))return[3,4];J=d.e.generate();K="multipart/mixed; boundary=batch_"+J;return[4,e(Object(l.t)({webAbsoluteUrl:q.webAbsoluteUrl,listFullUrl:s||"",url:p.e.getBatchOperationUrl(q.webAbsoluteUrl),body:P(U,q,J),method:"POST",additionalHeaders:void 0,contentType:K,parseResponse:function(e){return p.e.processBatchResponse(e,q.items)},qosName:"deleteMultipleItems"})).then(function(t){for(var n=0,i=t.items;n<i.length;n++){!(f=i[n]).error&&f.key&&R.push(f.key)}H(R);if(t.hasError){for(var s={items:{}},o=0,u=t.items;o<u.length;o++){var f;if((f=u[o]).error&&f.key){var l=f.error.code&&"-2130575306"===f.error.code.toString();z&&e(Object(N.e)({name:"DeleteOperationFileLockedInBatchWithForcedDeleteEnabled",isIntentional:!1,extraData:{errorCode:f.error.code,overrideFileLocksEnabled:z,isBatch:!0}}));s.items[f.key]=new v.e({message:f.error.message,facets:l?Object(a.__assign)({},g.i.pack({})):void 0})}}throw new r.e(s)}return Promise.resolve({data:t})})];case 3:ae.sent();ae.label=4;case 4:Q=new E.e;for(G=0,Y=q.items;G<Y.length;G++){Z=Y[G];Q.invalidateItems({items:(se={},se[Z.key]=[m.a],se)});Q.resolveItems({items:(oe={},oe[Z.key]=m.a.pack({}),oe)})}(!U||!Object(k.t)(U).isActivated("C5C6F559-B975-4336-BEFB-0483A5A24929","02/14/2020","Resolve remaining items for current itemSet after delete to avoid going back to first page for current itemSet."))&&u&&R.length&&(ee=e(Object(y.e)(function(e){var t=e.demandItemFacet(C.e,u);if(t&&t.itemKeys){for(var n=[],r=0,i=t.itemKeys;r<i.length;r++){var s=i[r],a=e.demandItemFacet(o.D,s),f=a&&o.D.serialize(a)||s;R.indexOf(f)<0&&n.push(s)}return n}})))&&Q.resolveItems({items:(ue={},ue[u]=C.e.pack({itemKeys:ee}),ue)});if(!U||!Object(k.t)(U).isActivated("126A8F89-8146-4B38-A8DE-6F115DCF594C","03/26/2020","Invalidate parent folder countFacet of the deleted items")){te=function(t){var n,r=e(Object(y.e)(function(e){return e.demandItemFacet(m.A,t)}));r&&r.itemKey&&Q.invalidateItems({items:(n={},n[r.itemKey]=[M.e],n)})};for(ne=0,re=R;ne<re.length;ne++){ie=re[ne];te(ie)}}e(Q.execute());ae.label=5;case 5:return[2]}})})}});function D(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.serverRelativeItemUrl,i=e.deletionType,s=e.uniqueId,o=e.isFolder,u=e.listId,a=e.itemId,f=Object(w.r)({webAbsoluteUrl:t,listOrItemFullUrl:n});f=o?s?f.method("GetFolderById",s):f.methodWithAliases("GetFolderByServerRelativePath",{DecodedUrl:r}):u&&a?f.method("Lists",u).method("GetItemById",a):f.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:r});i===h.e.Recycle&&(f=f.segment("recycle"));return f.toString()}function P(e,t,n){var r=t.items,i=t.deletionType===h.e.PermanantDelete?"DELETE":"POST",s=t.deletionType===h.e.PermanantDelete?"If-Match: *":p.e.defaultBatchRequestPostData,o=!e||!Object(k.t)(e).isActivated("590D55F5-FED8-4FD8-8854-21CC6E9C2A01","02/14/2020","Resolve remaining items for current itemSet after delete to avoid going back to first page for current itemSet."),u=r.map(function(e){return D({webAbsoluteUrl:o?encodeURI(t.webAbsoluteUrl):t.webAbsoluteUrl,listFullUrl:o?encodeURI(t.listFullUrl):t.listFullUrl,deletionType:t.deletionType,serverRelativeItemUrl:o?encodeURI(e.serverRelativeItemUrl):e.serverRelativeItemUrl,uniqueId:e.uniqueId,isFolder:e.isFolder,listId:t.listId,itemId:e.id})});return p.e.getBatchContentExtended(n,u,i,s)}var H=n(832),B=n(123),j=n(275),F=n(562),I=n(172),q=n(62),R=Object(r.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.names;return function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var r,i,s,u,h,p,d,b,E,x,T,N,C,k,L,A,O,M,_,D,P,H;return Object(a.__generator)(this,function(R){switch(R.label){case 0:r=Object.keys(n)[0];i=n[r].newName;s=e(Object(y.e)(function(e){return e.demandItem({existingFileName:m.h,spItemKey:o.D,listItemId:f.we,isFolder:m.d},t)})),u=s.existingFileName,h=s.spItemKey,p=s.listItemId,d=s.isFolder;b=h||o.D.deserialize(t);if(!(E=p||b.itemId))throw new Error("Cannot find itemId for itemKey: "+t);x=b.rootFolder||new j.e(b.listFullUrl).path;T=new B.t({context:{webAbsoluteUrl:b.webAbsoluteUrl,listUrl:b.listFullUrl}});N=T.getUrlParts({path:x});C=T.getUrlParts({path:b.webAbsoluteUrl});k=(function(e){var t=e.webAbsoluteUrl,n=e.listFullUrl,r=e.itemId;return Object(w.e)({webAbsoluteUrl:t,listFullUrl:n}).method("Items",r).toString()})({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl,itemId:E});L={};return(A=C.serverRelativeItemUrl)?[3,2]:[4,e(Object(l.t)({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl,url:(U={webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl},z=U.webAbsoluteUrl,W=U.listFullUrl,X=Object(w.e)({webAbsoluteUrl:z,listFullUrl:W}).segment("ParentWeb").segment("ServerRelativeUrl"),X.toString()),method:"POST",qosName:"GetWebUrl",noRedirect:!0})).then(function(e){A=e.d.ServerRelativeUrl})];case 1:R.sent();R.label=2;case 2:if(!A&&N.serverRelativeListUrl){(O=N.serverRelativeListUrl.indexOf("/lists/"))<0&&(O=N.serverRelativeListUrl.lastIndexOf("/"));O>=0&&(A=N.serverRelativeListUrl.substring(0,O))}(M=N.serverRelativeListUrl)&&(L.__metadata={type:Object(F.n)(M,A)});_=(_=u&&u.extension?i+u.extension:i).trim();L.FileLeafRef=_;d&&(L.Title=_);(D={})["X-HTTP-Method"]="MERGE";D["If-Match"]="*";D.Prefer="bypass-shared-lock";return[4,e(Object(l.t)({webAbsoluteUrl:b.webAbsoluteUrl,listFullUrl:b.listFullUrl,url:k,method:"POST",body:JSON.stringify(L),additionalHeaders:D,qosName:"renameItem",telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var r=!1;t.status===v.t?r=!0:t.code&&(t.code.indexOf("-2130575257")>-1||t.code.indexOf("-2147024894")>-1||t.code.indexOf("-2147024891")>-1)&&(r=!0);var i=r?S.t.expectedFailure:S.t.failure;return{eventData:Object(a.__assign)(Object(a.__assign)({},n),{resultType:i})}}return{eventData:n}}})).catch(function(e){if(e instanceof c.e&&e.errorData.status===v.t)throw new v.e({facets:Object(a.__assign)({},g.h.pack({})),innerError:e});throw e})];case 3:R.sent();e(Object(I.t)({items:(P={},P[t]=[m.f],P)}));e(Object(q.e)({items:(H={},H[t]=Object(a.__assign)(Object(a.__assign)({},m.f.pack(u&&u.extension?i+u.extension:i)),m.h.pack({name:i,extension:u&&u.extension||""})),H)}));return[2]}var U,z,W,X})})}});var U=n(711),z=n(51),W=n(3212),X=n(2345),V=Object(s.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItem({key:o.D,permissions:f.Fe,isCheckedOut:m.y,isFolder:m.d,rowData:f.$e},n),i=r.key,s=r.permissions,u=r.isCheckedOut,l=r.isFolder,c=r.rowData,h=i&&e.demandItemFacet(f.Et,o.Z.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})),p=void 0,d=!1,v=X.e;if(h){p=c&&u&&!!u.byOther;d=!(e.demandItemFacet(f.ke,n,{suppressGetItems:!0})||h.isAnonymousGuestUser)&&z.e.hasItemPermission({permissions:s},z.e.deleteListItems)&&z.e.hasItemPermission({permissions:s},z.e.editListItems);h.supportPercentStorePath&&h.supportPoundStorePath||(v=X.t)}var g={},y=i&&e.demandItemFacet(f.ye,o.U.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl}));if(p){g.lockedWarningMessage=W.e.FileCheckedoutOrLockedWarning;g.title=W.e.FileCheckedoutOrLockedWarningTitle}else if(y&&y.isForceCheckout&&u&&!u.byYou&&!l){g.lockedWarningMessage=W.e.CheckoutRequired;g.title=W.e.Error}return Object(a.__assign)({isAvailable:d,validator:v,isFolder:!!l},g)}}});var $=n(497),J=n(1),K=n(856),Q=n(24),G=n(2842),Y=n(741),Z=n(348),ee=n(50),te=n(284),ne=n(112);function re(e){var t=e.defaultRender,n=Object(a.__rest)(e,["defaultRender"]);return t?J.createElement(t,Object(a.__assign)({},n,{preferOpenInBrowser:!0})):null}function ie(e){var t=e.defaultRender,n=Object(a.__rest)(e,["defaultRender"]);return t?J.createElement(t,Object(a.__assign)({},n,{preferSameWindow:!0})):null}var se=Object(s.t)()(function(){return function(e){var t=new ne.e;return function(e,n){var r=n.itemKeys,i=r[0],s=e.demandItemFacet(m.d,i),u=e.demandItemFacet(b.n,i);return 1!==r.length||s||u?r.length>0?(function(e,t){var n=t.itemKeys,r=e.demandItemFacet(o.D,n[0]);if(!r||!r.webAbsoluteUrl||!r.listFullUrl)return{};var i=r.webAbsoluteUrl,s=r.listFullUrl,u=o.U.serialize({webAbsoluteUrl:i,listFullUrl:s}),c=e.demandItem({listFacets:f.ye,downloadZipApiUrl:Y.e},u),h=c.listFacets,p=c.downloadZipApiUrl;if(!h||!p||h.templateType===Q.t.webPageLibrary)return{};for(var v=[],g=Object(ee.e)(e,{enableOAuthTokenInDownload:f.D}).enableOAuthTokenInDownload,y=void 0!==g&&g,w=!1,E=0,S=n;E<S.length;E++){var x=S[E],T=e.demandItem({name:m.f,size:m.p,itemUrl:m.B,folder:m.d,permissions:f.Fe,itemComplianceStatus:Z.e,isOneNote:b.n},x),N=T.name,C=T.size,k=T.itemUrl,L=T.folder,A=T.permissions,O=T.itemComplianceStatus;if(T.isOneNote)return{isAvailable:!1};var M=void 0,_=void 0,D=e.demandItemFacet(f.ke,x,{suppressGetItems:!0});if(D){M=void 0;_=new j.e(D.siteUrl).authority+"/_api/v2.1/drives/"+D.driveId+"/items/"+D.itemId;w=!0}else{if(!k)return{};M=e.demandItemFacet(Y.t,u);_=Object(K.n)(k,(M?M.accessToken:void 0)||"")}if(_){var P=!!L;3!==O&&4!==O&&z.e.hasItemPermission({permissions:A},z.e.openItems)&&v.push({name:N||"",size:C||0,docId:_,isFolder:P})}}if(0===v.length)return{};return{isAvailable:!0,getDownloadData:function(){return(function(e){var t=this,n=e.zipApiUrl,r=e.itemsData,i=e.useOAuthToken;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(a.__generator)(this,function(u){switch(u.label){case 0:t=void 0;return i?[4,e(Object(l.e)({url:new j.e(n).authority}))]:[3,2];case 1:t=u.sent();u.label=2;case 2:s=r&&1===r.length?r[0].name+".zip":"OneDrive_"+ ++oe+"_"+(new Date).toLocaleDateString().replace(/\//g,"-").replace(/[^ -~]/g,"")+".zip";o=d.e.generate();return[2,{url:n,method:"POST",postData:{zipFileName:s,guid:o,provider:"spo",files:JSON.stringify({items:r}),oAuthToken:t||""}}]}})})}})({zipApiUrl:p,itemsData:v,useOAuthToken:y||w})}}})(e,{itemKeys:r}):{}:(function(e,t){var n=t.itemKey,r=t.platformDetection,i=e.demandItem({spItem:o.D,permissions:f.Fe,folderPath:f.Q,uniqueId:f._t,itemComplianceStatus:Z.e,isBFile:f.ae},t.itemKey),s=i.spItem,u=i.permissions,c=i.folderPath,h=i.uniqueId,p=i.itemComplianceStatus,d=i.isBFile,v=e.demandItemFacet(m.N,t.itemKey),g=s&&o.Z.serialize(s),y=e.demandItemFacet(f.Et,g);if(!y||!s||d)return{};var b=s.webAbsoluteUrl,E=s.listFullUrl,S=o.U.serialize(s),x=e.demandItemFacet(f.ye,S);if(x&&x.templateType===Q.t.webPageLibrary)return{};if(3===p||4===p||!z.e.hasItemPermission({permissions:u},z.e.openItems))return{};var T=Object(ee.e)(e,{spCookieDomainConfiguration:f.et,enableMalwareDownloadInNewWindow:f.L}),N=T.spCookieDomainConfiguration,C=T.enableMalwareDownloadInNewWindow;if(v){if(!y.allowInfectedDownload)return{};var k=e.demandItemFacet(m.i,n);return k?C?{isAvailable:!0,downloader:re,getDownloadData:function(){return ue({canconicalUrl:k})}}:N?new j.e(N).authority!==new j.e(k).authority?{}:Object(a.__assign)(Object(a.__assign)({isAvailable:!0},r.isIE?{downloader:ie}:{}),{getDownloadData:function(){return ue({canconicalUrl:k})}}):{}:{}}if(!c)return{};var L=y.layoutsUrl;if(!L)return{};return Object(a.__assign)(Object(a.__assign)({isAvailable:!0},r.isIE?{downloader:ie}:{}),{getDownloadData:function(){return N&&h?(function(e){var t=this,n=e.webAbsoluteUrl,r=e.layoutsUrl,i=e.uniqueId;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){return Object(a.__generator)(this,function(e){return[2,{url:n+"/"+r+"/download.aspx?"+Object(te.e)({UniqueId:i}),method:"GET"}]})})}})({webAbsoluteUrl:b,uniqueId:h,layoutsUrl:L}):(function(e){var t=this,n=e.webAbsoluteUrl,r=e.listFullUrl,i=e.folderPath;return function(e){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,s,o,u,f,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:t=e(Object(l.n)({webAbsoluteUrl:n,listFullUrl:r})),s=t.dataRequestor,o=t.hasDigest;if(!t.hasTokenProvider)return[3,1];f=void 0;return[3,3];case 1:return[4,e(Object(l.e)({url:n||r,disallowCookies:!o}))];case 2:f=a.sent();a.label=3;case 3:u=f;c=Object(w.r)({webAbsoluteUrl:n,listOrItemFullUrl:r});return[4,Object(G.e)({dataRequestor:s,authToken:u,serverRelativeItemUrl:i,webApiUrl:c})];case 4:return[2,{url:a.sent(),method:"GET"}]}})})}})({webAbsoluteUrl:b,listFullUrl:E,folderPath:c,layoutsUrl:L})}})})(e,{itemKey:i,platformDetection:t})}}});var oe=0;function ue(e){var t=this;return function(n){return Object(a.__awaiter)(t,void 0,void 0,function(){var t;return Object(a.__generator)(this,function(n){(t=e.canconicalUrl)&&(-1===t.indexOf("?")?t+="?avcmd=1":t+="&avcmd=1");return[2,{url:t,method:"GET"}]})})}}var ae=n(710),fe=Object(s.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(f.ke,n,{suppressGetItems:!0}),i=e.demandItemFacet(f.Fe,n,{suppressGetItems:!0});return{isAvailable:!r&&z.e.hasItemPermission({permissions:i},z.e.deleteListItems)}}}});n.d(t,"sharePointBasicActionsAddonDeferred",function(){return le});var le=Object(r.t)(function(){return function(e){e(Object(i.o)(o.D,u.t)(_));e(Object(i.o)(o.D,H.t)(R));e(Object(s.r)(o.D,U.e)(V));e(Object(s.r)(o.D,$.e)(se));e(Object(s.r)(o.D,ae.e)(fe))}})}],Array(13),[function(e,t,n){"use strict";n.r(t);var r,i=n(707),s=n(111),o=n(0),u=n(3233),a=n(19),f=n(12),l=n(486),c=n(273),h=n(2317),p=n(13),d=n(69),v=n(5),m=new v.e("modifyColumnProgressItem",{columnKey:Object(v.s)(),modifyType:Object(v.i)(),targetIndex:Object(v.i)()}),g=new s.e("modifyColumnProgress",function(e,t){var n=Object.keys(t.columnModifyTypeMap)[0],r=t.columnModifyTypeMap[n].modifyType,i=t.columnModifyTypeMap[n].targetIndex;return m.serialize({columnKey:n,modifyType:r,targetIndex:i})}),y=n(4),b=((r={})[d.r.started]=u.e.columnOperationStarted,r[d.r.completed]=u.e.columnOperationCompleted,r[d.r.failed]=u.e.columnOperationFailed,r),w=Object(a.t)(function(){return function(e){e(Object(f.r)(g,l.e)(Object(f.t)()(E)));e(Object(f.r)(g,c.n)(Object(f.t)()(S)));e(Object(f.r)(g,h.t)(Object(f.t)()(x)))}});function E(){return function(e){return function(e,t){var n,r=t.itemKey,i=t.format,u=Object(s.i)(e,t).phase,a=void 0,f=e.demandItemFacet(p.e,r),l=f&&f.itemKeys;if(l&&l.length>0)n=(a=b)&&a[u];else if("item"===i){var c=e.demandItemFacet(g,r),h=c&&c.taskKey;if(h){var d=e.demandItemFacet(m,h),v=d&&d.columnKey;if(v){n=e.demandItemFacet(y.ue,v)}}}return Object(o.__assign)({},n?{title:n}:{})}}}function S(){return function(e){return function(e,t){return{reportMode:c.e.pin}}}}function x(){return function(e){return function(e,t){return{maxChildItemCount:0}}}}n.d(t,"modifyColumnWithProgress",function(){return T});var T=Object(s.s)({operationTypeFacet:i.t,progressKeyFacet:g,initializeBatch:function(){return w}})}],Array(19),[function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(1239),o=n(1612),u=n(20),a=n(16),f=n(28),l=n(126),c=n(46),h=n(9),p=Object(l.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("dotdot_dotdot_filehovercard_hovercardstats_socialbarpanel")]).then(n.bind(null,3649))];case 1:return[2,e.sent().default]}})})}),d=Object(h.i)(function(e,t){var n=t.itemKey,s=Object(u.o)(function(e){return i.createElement(p,Object(r.__assign)({},e,{itemKey:n}))},{scope:"global"});return i.createElement(f.e,Object(r.__assign)({onExecute:s},Object(c.e)(e,{itemKey:n,engagement:{name:"SocialBar",isIntentional:!0}})))}),v=(Object(a.i)()(d),n(2880));n.d(t,"e",function(){return m});var m=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.likeLabel,n=e.itemKey,r=i.createElement(o.e,{activityDescription:t,isCompact:!0});return i.createElement(u.n,{action:i.createElement(d,{itemKey:n})},function(e){var t=e.isAvailable,n=e.execute,o=t?function(){n().catch(function(){})}:void 0;return i.createElement(s.e,{disabled:!1,className:v.e,onClick:o},r)})};return t})(i.Component)}],Array(43),[function(e,t,n){"use strict";n.r(t);n.d(t,"ItemAutoRefresh",function(){return a});n.d(t,"CurrentItemAutoRefresh",function(){return f});var r=n(1),i=n(16),s=n(9),o=n(2804);function u(e){var t=e.subscribe;r.useLayoutEffect(function(){return t()},[t]);return null}var a=Object(s.i)(function(e,t){var n=t.itemKey,i=e.demandItemFacet(o.e,n),s=o.e.evaluate(i)(e,{itemKey:n,itemSubscriber:null}),a=s.isAvailable,f=s.itemSubscriber,l=s.subscribe;return a?f||(l?r.createElement(u,{subscribe:l}):null):null}),f=Object(i.n)()(a)}],Array(22),[function(e,t,n){"use strict";n.r(t);n.d(t,"sharePointGraphAddon",function(){return E});var r=n(0),i=n(19),s=n(62),o=n(22),u=n(173),a=n(56),f=n(3),l=n(35),c=n(18),h=n(2),p=n(2499),d=n(7),v=n(2834),m=n(4),g=n(54),y=n(275);function b(e){var t=e.itemKey,n=e.driveItem;return function(e){var i,s;e(p.sharePointItemByFullUrlAddon);var o=e(Object(g.e)({enableSharePointItemMapping:m.R})).enableSharePointItemMapping,u=void 0===o||o,y=new a.e,b=n.webDavUrl||n.remoteItem&&n.remoteItem.webDavUrl||n.webUrl,w=b&&decodeURIComponent(b);if(w){var E={itemFullUrl:w},S=Object(v.e)(w),x={itemFullUrl:S},T=f.M.serialize(E),N=f.M.serialize(x);y.mapKeys({mappings:(i={},i[T]=t,i)});y.resolveItems({items:(s={},s[T]=Object(r.__assign)(Object(r.__assign)({},u?Object(r.__assign)({},Object(h.r)({preferredKeyFacet:l.i},{preferredKeyFacet:new c.a(f.M,function(e){return e===f.D})})):{}),d.A.pack({itemKey:N})),s[N]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d.d.pack({})),d.i.pack(S)),d.L.pack(encodeURI(S))),s)})}return{itemResolver:y}}}function w(e){var t=this;return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,Promise.resolve().then(n.bind(null,1538))];case 1:t=r.sent().demandItems;return[4,i(t(function(t){var n=f.J.serialize({tenantRootUrl:e});return t.demandItemFacet(f.D,n,{suppressGetItems:!1})}))];case 2:s=r.sent();o=s&&(s.webAbsoluteUrl||s.listFullUrl);if(!(u=o&&new y.e(o).authority))throw new Error("Unable to determine the endpoint for the user's OneDrive.");return[2,u+"/_api/v2.0"]}})})}}var E=Object(i.t)(function(){return function(e){var t;e(Object(s.e)({items:(t={},t[o.n]=Object(r.__assign)(Object(r.__assign)({},u.c.pack({process:b})),u.s.pack({getUserOneDriveEndpoint:w})),t)}))}})}],Array(21),[function(e,t,n){"use strict";n.r(t);n.d(t,"CreateViewAction",function(){return g});var r=n(0),i=n(1),s=n(9),o=n(3),u=n(4),a=n(84),f=n(2877),l=n(46),c=n(20),h=n(28),p=n(126),d=n(61),v=n(487),m=Object(p.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("addon-sp-listviewdeferredactions")]).then(n.bind(null,3350))];case 1:return[2,e.sent().FreshViewCreator]}})})}),g=Object(s.i)(function(e,t){var n=t.isEditing,s=t.currentViewKey,p=Object(a.e)(e),g=Object(d.e)(e).itemsScopeItemKey,y=e.demandItemFacet(o.S,p),b=e.demandItemFacet(f.e,p),w=e.demandItemFacet(u.p,s),E=f.e.evaluate(b)(e,{viewKey:s}).onViewSaved;if(!p||!g)return null;var S=!1;if(y&&w){var x=o.U.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl}),T=e.demandItemFacet(u.ye,x);S=!!(T&&w&&"POWER"!==w.viewType&&T.permissions&&(T.permissions.managePersonalViews||T.permissions.manageLists))}var N=y?e.demandItemFacet(u.Et,o.Z.serialize({webAbsoluteUrl:y.webAbsoluteUrl,listFullUrl:y.listFullUrl})):void 0,C=Object(c.o)(function(e){return i.createElement(v.e,{itemsScopeItemKey:g},i.createElement(m,Object(r.__assign)({},e,t,{pageContext:N,itemSetKey:p,onViewSaved:E})))},{scope:"global"});return i.createElement(h.e,Object(r.__assign)({isAvailable:S,onExecute:C},Object(l.e)(e,{itemKey:p,engagement:{name:n?"EditView":"CreateNewView",isIntentional:!0}})))})}],Array(62),[function(e,t,n){"use strict";n.r(t);n.d(t,"driveItemDeleteItemsBatchedOperationHandler",function(){return E});var r,i=n(0),s=n(327),o=n(19),u=n(306),a=n(36),f=n(69),l=n(62),c=n(172),h=n(7),p=n(144),d=n(2006),v=n(1418),m=n(230);(function(e){e.Completed="completed";e.Failed="failed";e.InProgress="inProgress"})(r||(r={}));var g=408,y=500,b=3e5,w=500,E=Object(o.n)({maxParallelOperationCount:4,timeout:b,areSameBatch:function(e,t){var n=p.e.deserialize(e.itemKey).driveId,r=p.e.deserialize(t.itemKey).driveId;return!!n&&!!r&&n===r}})(function(e){var t=this,n=e.items,E=Object.keys(n),S=E.map(function(e){return p.e.deserialize(e)});return function(e){return Object(i.__awaiter)(t,void 0,void 0,function(){var t,p,x,T,N,C,k;return Object(i.__generator)(this,function(L){switch(L.label){case 0:e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return Object(i.__assign)(Object(i.__assign)({},f.v.pack({total:1,current:0})),f.p.pack(!0))},function(e,t){return t.progressItemKey})}));t={value:S.map(function(e){return{id:e.itemId,deleted:{}}})};p="";x=Object(d.n)(S[0]);return[4,e(Object(v.n)({url:x+"/items",method:"PATCH",body:t,qosName:"deleteItems",endpoint:S[0].endpoint,parseResponse:function(e){p=e.getResponseHeader("Location")||""}}))];case 1:L.sent();T=0;N=!1;C=!1;Object(u.t)(b).then(function(){return C=!0});k=function(){var t;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return[4,e(Object(v.n)({url:p,qosName:"getOperationStatus",endpoint:S[0].endpoint}))];case 1:t=i.sent();E.forEach(function(){e(Object(l.e)({items:Object(a.t)(n,function(e){e.progressItemKey;return f.v.pack({total:1,current:t.percentageComplete/E.length})},function(e,t){return t.progressItemKey})}))});if(t.status!==r.Completed&&t.status!==r.Failed)return[3,2];N=!0;T=t.summary.failed;return[3,4];case 2:return[4,Object(u.t)(w)];case 3:i.sent();i.label=4;case 4:return[2]}})};L.label=2;case 2:return[5,k()];case 3:L.sent();L.label=4;case 4:if(!N&&!C)return[3,2];L.label=5;case 5:if(C)throw new s.e({facets:Object(i.__assign)({},m.u.pack(g))});e(Object(c.t)({items:Object(a.e)(E,function(){return[h.a]})}));if(T>0)throw new o.e({items:Object(a.e)(E.slice(0,T),function(){return new s.e({facets:Object(i.__assign)({},m.u.pack(y))})})});return[2]}})})}})}],Array(22),[function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(19),s=n(64),o=n(573),u=n(285),a=n(70),f=n(12),l=n(439),c=n(234),h=Object(r.__assign)(Object(r.__assign)({},l.e),{key:c.n,minWidth:32,maxWidth:32}),p=n(2437),d=n(47),v=n(137),m=n(2),g=n(570),y=n(7),b=n(22),w=n(254),E=Object(d.i)({key:new m.e("dateFollowedColumn").id,name:v.e.SavedDate,fieldName:"",minWidth:d.e.regularMin,maxWidth:d.e.regularMax,isCollapsable:!0},g.e)(function(e,t){var n=e.demandItemFacet(y.o,t),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(b.S,b.n),s=i&&i.language||window.navigator.language;return s?{text:Object(w.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(y.o,t)}),S=n(943),x=Object(f.t)()(function(){return function(e){return N}});var T=[h,p.e,E,S.e];function N(e,t){return{columns:T}}var C=n(298),k=n(809),L=n(352),A=n(1),O=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){return this.props.group?A.createElement("div",{className:"root_111b036f"},this.props.group.name):null};return t})(A.PureComponent),M=n(1156),_=n(180),D=n(453),P=n(303),H=n(575);function B(e,t){var n=t.signals;if(n){var i=Object(P.t)(n,function(e){return e.key===H.n});if(i&&i.index>-1){var s=i.index;return{signals:Object(r.__spreadArrays)(n.slice(0,s),n.slice(s+1))}}}return{}}var j=Object(f.t)()(function(){return function(e){return I}});var F=function(e){var t=e.defaultRender,n=Object(r.__assign)({},D.e.pack(B));return t?A.createElement(_.t,{controlHandlers:n},A.createElement(t,Object(r.__assign)({},e))):null};function I(){return{groupHeaderRenderer:O,rowRenderer:F,groupProps:{collapseAllVisibility:M.e.hidden}}}var q=n(1945),R=Object(f.t)()(function(){return function(e){return W}});function U(e,t){var n=t.itemKey,r=e.demandItemFacet(y.o,n,{suppressGetItems:!0}),i=r&&new Date(r).getTime();if("number"==typeof i&&!isNaN(i)){var s=e.demandItemFacet(b.S,b.n),o=s&&s.language||window.navigator.language,u=Object(w.n)(new Date(i),o);return{itemActivity:u&&A.createElement(g.e,{text:u})||null}}return{}}var z=(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=Object(r.__rest)(e,["defaultRender"]),i=Object(r.__assign)(Object(r.__assign)({},D.e.pack(B)),q.t.pack(U));return t?A.createElement(_.t,{controlHandlers:i},A.createElement(t,Object(r.__assign)({},n))):null};return t})(A.PureComponent);function W(){return{tileRenderer:z}}var X=n(769),V=n(880),$=n(2507),J=Object(d.i)({name:V.e.dateSharedColumnHeaderText,key:c.e,fieldName:"",minWidth:d.e.regularMin,maxWidth:d.e.regularMax,isCollapsable:!0,sortProps:d.t},g.e)(function(e,t){var n=e.demandItemFacet($.e,t),r=n&&new Date(n.sharedDateTime).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(b.S,b.n);return i&&i.language||window.navigator.language?{text:Object(X.n)(new Date(r),!1)}:{dateValue:r}}),K=n(501),Q=n(233),G=n(2828),Y=n(2078),Z=n(2510),ee=n(801),te=n(680),ne=n(21),re=n(1152),ie=n(3210),se=(function(e){Object(r.__extends)(t,e);function t(t){return e.call(this,t)||this}t.prototype.render=function(){var e=this.props,t=e.userName,n=e.isPlaceholder,r=A.createElement(te.e,{className:"topCollaboratorIcon_fc1f83bb",iconName:"TeamFavorite"}),i=A.createElement("span",{className:"topCollaboratorUserName_fc1f83bb"},t),s=A.createElement("div",{className:"topCollaboratorTooltip_fc1f83bb"},ne.formatToArray(ie.e.topCollaboratorWith,i));return A.createElement("div",{className:"topCollaPlaceHolder_fc1f83bb"},n?null:t?A.createElement(re.e,{content:s},r):r)};return t})(ee.e),oe=n(13),ue=Object(d.i)({name:V.e.sharedByColumnHeaderText,key:c.i,fieldName:"",minWidth:d.e.regularMin,maxWidth:d.e.regularMax,isCollapsable:!0,sortProps:d.r,headerClassName:"columnHeader_fc1f83bb"},K.e)(function(e,t){var n=e.demandItem({shareByPerson:G.e},t).shareByPerson,r=n&&n.itemKey,i=!1;if(r&&Y.e.matches(r)){var s=Y.e.deserialize(r).email,o=e.demandItemFacet(oe.e,Z.e.serialize({endpoint:"https://graph.microsoft.com/beta"}));o&&(i=o.itemKeys.slice(0,3).some(function(t){var n=e.demandItemFacet(Q.e,t);return!!n&&n===s}))}return r?{people:[{itemKey:r}],onRenderUser:function(e,t){if(!e||!t)return null;var n=t(e),r=e.user;return A.createElement("div",{className:"userWithTopCollaborator_fc1f83bb"},A.createElement(se,{userName:r.title,isPlaceholder:!i}),n)}}:{people:[]}},function(e,t){return""+e.demandItemFacet(Q.e,t)}),ae=Object(f.t)()(function(){return function(e){return le}});var fe=[h,p.e,J,ue];function le(e,t){return{columns:fe}}var ce=n(821),he=n(62),pe=n(146),de=n(144),ve=n(2006),me=n(1418),ge=n(1856),ye=n(3125),be=n(2341),we=n(5),Ee=new we.e("driveItem",{endpoint:Object(we.s)(),driveId:Object(we.s)({shouldNormalizeToEmpty:!0}),canonicalUrl:Object(we.s)()}),Se=n(275);function xe(e){var t,n,i,s,o=e.driveItemResponse,u=e.endpoint,a=o.remoteItem,f=a&&a.parentReference,l=o.parentReference,c=l||f,h=c&&c.driveId,p=c&&c.id,d="personal"===(c&&c.driveType),v=!!o.root;if(a){s=a.id;f&&(h=f.driveId)}else s=d&&o.root?be.n:o.id;var m={endpoint:u,driveId:h,itemId:s},g=de.e.serialize(m),b=o&&(o.webDavUrl||o.webUrl),w=d&&c&&c.path===be.e?be.n:p||void 0,E=c&&w?de.e.serialize({endpoint:u,driveId:c.driveId||h,itemId:w}):void 0,S=[],x="";if(b){var T=new Se.e(b);S.push.apply(S,T.path.split("/").slice(1,-1).map(function(e){return decodeURIComponent(e)}));S.unshift(T.authority);x=S.join("/")}c&&!v&&!w&&x&&(E=Ee.serialize({endpoint:u,driveId:c.driveId,canonicalUrl:x}));var N=Object(ye.e)(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:g,driveItemKey:m,parentFolderItemKey:E})).itemResolver;N.resolveItems({items:Object(r.__assign)({},E&&(t={},t[E]=Object(r.__assign)({},x?y.L.pack(x):{}),t))});if(a&&f){var C=de.e.serialize({endpoint:u,driveId:l&&l.driveId,itemId:o.id}),k=de.e.serialize({endpoint:u,driveId:f.driveId,itemId:a.id});N.mapKeys({mappings:(n={},n[C]=k,n)});N.resolveItems({items:(i={},i[k]=Object(r.__assign)({},Object(ge.e)({driveItem:o,endpoint:u})),i)})}return{itemResolver:N,actualDriveItemKey:m,actualItemKey:g}}var Te=n(37),Ne=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=de.e.deserialize(n),s=i.endpoint;return function(o){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:t=Object(ve.n)(i);return[4,o(Object(me.r)({url:Object(ve.t)(i),driveUrl:t,qosName:"getItem",endpoint:s}))];case 1:u=p.sent();a=xe({driveItemResponse:u,endpoint:s}),f=a.itemResolver,l=a.actualItemKey;f.resolveItems({items:(c={},c[e.itemKey]=Object(r.__assign)({},Te.n.pack(de.e)),c)});f.mapKeys({mappings:(h={},h[l]=n,h)});o(f.execute());return[2]}})})}});var Ce=n(579),ke=n(819),Le=n(3530),Ae=n(2830),Oe=n(15),Me=n(581),_e=n(2009),De=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Ce.e.deserialize(n).driveItemKey,s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p,d=this;return Object(r.__generator)(this,function(v){t={Caller:"HoverCard"};o="GetItemAnalytics_addon-graph";u=Object(r.__awaiter)(d,void 0,void 0,function(){var u,a,f,l,c,h;return Object(r.__generator)(this,function(p){switch(p.label){case 0:return[4,e(Object(me.r)({url:(d=Object(ve.t)(i),v=He(d),m="$expand=analytics($expand=allTime($expand=activities))",g="$select=*,id,reactions,trending",b=g+"&"+m+",insights($expand=keyPoints)",w=v+"?"+b,w),qosName:o+"_GetAnalyticsSections",endpoint:s,timeout:6e3,headers:t,driveUrl:He(Object(ve.n)(i))}))];case 1:u=p.sent();a=Object(Le.t)(u);if(f=a.createdBy){l=Y.e.serialize({email:f.email,endpoint:s});e(Object(he.e)({items:(c={},c[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack(f.displayName)),Q.e.pack(f.email)),Q.t.pack(f.image)),Q.n.pack(f.id)),c[n]=Object(r.__assign)({},ke.r.pack({itemKey:l,displayValue:f.displayName})),c)}))}e(Object(he.e)({items:(h={},h[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ke.h.pack(a.viewCount)),ke.p.pack(a.viewerCount)),ke.o.pack(a.isTrending)),ke.e.pack(a.activities)),ke.f.pack(a.likeCount)),ke.t.pack(a.commentCount)),ke.a.pack(a.lifeCycleStatus)),ke.u.pack(a.keyPointsData)),ke.s.pack(a.incompleteData)),ke.i.pack(a.createdDateTime)),h)}));return[2]}var d,v,m,g,b,w})});a=[u];if(Object(_e.t)()){f=Object(r.__awaiter)(d,void 0,void 0,function(){var u,a,f,l;return Object(r.__generator)(this,function(c){switch(c.label){case 0:return[4,e(Object(me.r)({url:Pe(Object(ve.t)(i)),qosName:o+"_GetRecommendedActionsAndConversations",endpoint:s,timeout:6e3,headers:t,driveUrl:He(Object(ve.n)(i))}))];case 1:u=c.sent();a=Be(u);f=je(u);e(Object(he.e)({items:(l={},l[n]=Object(r.__assign)(Object(r.__assign)({},ke.l.pack(a)),ke.n.pack(f)),l)}));return[2]}})});a.push(f)}else{l=Object(r.__awaiter)(d,void 0,void 0,function(){var u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:return[4,e(Object(me.r)({url:(c=Object(ve.t)(i),h=He(c),h+"?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities))"),qosName:o+"_GetRecommendedActions",endpoint:s,timeout:6e3,headers:t,driveUrl:He(Object(ve.n)(i))}))];case 1:u=l.sent();a=Be(u);e(Object(he.e)({items:(f={},f[n]=Object(r.__assign)({},ke.l.pack(a)),f)}));return[2]}var c,h})});a.push(l);if(!Fe()){c=Object(r.__awaiter)(d,void 0,void 0,function(){var u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:return[4,e(Object(me.r)({url:(c=Object(ve.t)(i),h=He(c),h+"?$expand=conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"),qosName:o+"_GetConversations",endpoint:s,timeout:6e3,headers:t,driveUrl:He(Object(ve.n)(i))}))];case 1:u=l.sent();a=je(u);e(Object(he.e)({items:(f={},f[n]=Object(r.__assign)({},ke.n.pack(a)),f)}));return[2]}var c,h})});a.push(c)}}if(Object(_e.r)()){h=Object(r.__awaiter)(d,void 0,void 0,function(){var u,a;return Object(r.__generator)(this,function(f){switch(f.label){case 0:return[4,e(Object(me.r)({url:(l=Object(ve.t)(i),c=He(l),c+"/recommendations/shareWith/users?$top=2&$filter=userType eq 'Internal'"),driveUrl:He(Object(ve.n)(i)),qosName:o+"_GetShareWithPeople",endpoint:s,timeout:6e3,headers:t}))];case 1:u=f.sent();e(Object(he.e)({items:(a={},a[n]=Object(r.__assign)({},ke.c.pack(u.value)),a)}));return[2]}var l,c})});a.push(h)}else e(Object(he.e)({items:(p={},p[n]=Object(r.__assign)({},ke.c.pack([])),p)}));return[2,Object(Me.e)(a)]})})}});function Pe(e){var t=He(e),n="?$expand=recommendedActionSet($expand=nonAggregatedRecommendedActions,aggregatedEditRecommendedAction($expand=importantActorsAndActivities)),";Fe()||(n=n.concat("conversationSet($expand=emailConversations($expand=participants),meetingConversations($expand=participants),teamsConversations($expand=participants))"));return""+t+n}function He(e){return e.replace("2.0","2.1")}function Be(e){var t=e.recommendedActionSet,n=t.nonAggregatedRecommendedActions;t.aggregatedEditRecommendedAction&&t.aggregatedEditRecommendedAction.recentEditorCount&&(n=n.concat(t.aggregatedEditRecommendedAction));return n}function je(e){var t=e.conversationSet,n=t.emailConversations.concat(t.meetingConversations,t.teamsConversations),r={},i=[];n.forEach(function(e){var t=e.teamsMessageThreadId||e.conversationInstance.conversationId;if(!r.hasOwnProperty(t)){r[t]=!0;i.push({activityTimestamp:e.conversationInstance.sharedByTime,context:e.conversationInstance.subject,conversationType:Ae.e[e.conversationInstance.referenceType],deepLink:e.conversationInstance.deepLink,referencePreview:e.conversationInstance.referencePreview,isSharedByMe:e.conversationInstance.isSharedByMe,sharedByUserDisplayName:e.sharedByUser.displayName,sharedByUserEmail:e.sharedByUser.email,participants:e.participants})}});return i.sort(function(e,t){return Date.parse(t.activityTimestamp)-Date.parse(e.activityTimestamp)})}function Fe(){return Oe.e.isActivated("c0189bf0-b5ab-40e7-b523-42ca8f2d4b11","11/11/2019","shadow call for conversations")}var Ie=new we.e("specialDriveItem",{endpoint:Object(we.s)(),driveId:Object(we.s)({shouldNormalizeToEmpty:!0}),name:Object(we.s)()}),qe=n(1746),Re=n(56),Ue=n(35),ze=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Ie.deserialize(n),s=i.driveId,o=i.endpoint,u=Object(ve.n)(i);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l,c,h,p,d,v;return Object(r.__generator)(this,function(m){switch(m.label){case 0:return[4,e(Object(me.n)({url:Object(ve.i)(i),driveUrl:u,qosName:"getItem",endpoint:o}))];case 1:t=m.sent();a=new Re.e;f=t&&t.parentReference;l=f&&f.driveId;c={endpoint:o,driveId:l||s,itemId:t.id};h=de.e.serialize(c);p=f&&f.id?de.e.serialize({endpoint:o,driveId:l,itemId:f.id}):void 0;a.resolveItems({items:(d={},d[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(ge.e)({driveItem:t,endpoint:o,parentFolderItemKey:p})),Ue.i.pack(de.e)),oe.t.pack({itemKey:qe.e.serialize({driveItemKey:c,sortBy:"",isAscending:!0})})),d)});a.mapKeys({mappings:(v={},v[h]=n,v)});e(a.execute());return[2]}})})}});var We=new we.e("driveItemPage",{endpoint:Object(we.s)(),setItemKey:Object(we.s)(),token:Object(we.s)()}),Xe=n(172),Ve=n(201),$e=n(54),Je=n(173);function Ke(e){return e.reduce(function(e,t){return e&&t?"("+e+" or "+t+")":t||e})}function Qe(e){return e.reduce(function(e,t){return e&&t?"("+e+" and "+t+")":t||e})}function Ge(e){return function(t){for(var n=void 0,r=void 0,i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("."===u[0])if(t.name){var a=new RegExp(u.toLocaleLowerCase()+"$"),f=t.name.toLocaleLowerCase().split(a),l=2===f.length&&""===f[1]||!1;o?n=void 0!==n?n&&!l:l:r=r||l}else{n=!1;r=!1}else if("folder"===u){var c=void 0!==t.folder||void 0!==t.remoteItem&&void 0!==t.remoteItem.folder||!1;o?n=void 0!==n?n&&!c:c:r=r||c}else if("onenote"===u){var h=t.package&&"oneNote"===t.package.type||t.remoteItem&&t.remoteItem.package&&"oneNote"===t.remoteItem.package.type||!1;o?n=void 0!==n?n&&!h:h:r=r||h}}return void 0===r?void 0!==n&&n:void 0===n?!r:n&&!r}}var Ye=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=We.deserialize(n),s=i.setItemKey,o=i.endpoint,u=i.token,a=we.e.get(s).deserialize(s),f=a.extFilters,l=a.driveItemKey,c=Object(ve.n)(l);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,a,l,h,p,d,v,m,g,b,w,E,S,x,T;return Object(r.__generator)(this,function(N){switch(N.label){case 0:return[4,e(Object(me.n)({endpoint:o,url:u,driveUrl:c,qosName:"getChildrenPage"}))];case 1:t=N.sent();i=f&&f.length>0?Ge(f):void 0;a=new Re.e;l=[];h=0,p=t.value;N.label=2;case 2:if(!(h<p.length))return[3,5];d=p[h];if(!!i&&i(d))return[3,4];v=d&&(d.parentReference||d.remoteItem&&d.remoteItem.parentReference);m=v&&v.driveId;g=de.e.serialize({itemId:d.id,driveId:m,endpoint:o});b=v?de.e.serialize({itemId:v.id,driveId:m,endpoint:o}):void 0;l.push(g);a.resolveItems({items:(T={},T[g]=Object(r.__assign)(Object(r.__assign)({},Object(ge.e)({driveItem:d,endpoint:o,parentFolderItemKey:b})),Object(Xe.e)().forFacet(y.f).thenInvalidate(n,oe.e).forFacet(y.a).thenInvalidate(n,oe.e).pack()),T)});return(w=e(Object($e.e)({processDriveItemFromSharePoint:Je.c})).processDriveItemFromSharePoint)?[4,e(w.process({itemKey:g,driveItem:d}))]:[3,4];case 3:E=N.sent().itemResolver;a.merge(E);N.label=4;case 4:h++;return[3,2];case 5:if(S=t["@odata.nextLink"]){x=We.serialize({setItemKey:s,endpoint:o,token:S});a.merge(Object(Ve.t)({itemKey:x}).itemResolver);l.push(x)}a.merge(Object(Ve.e)({itemKey:n,itemSetKey:s,childItemKeys:l}).itemResolver);e(a.execute());return[2]}})})}});var Ze=n(568),et=n(2008),tt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Ze.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(o){(t=new Re.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},oe.t.pack({itemKey:u.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0})})),y.f.pack(et.e.sharedWithMe)),y.d.pack({})),y.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var nt=n(442),rt=n(342),it=n(30),st=n(25),ot=n(58);var ut=n(506),at=n(57);function ft(e){var t=e.itemKey,n=e.itemSetKeyFacet,i=e.parentItemKeyFacet,s=e.childItemsResponse,o=e.parentItemResponse,u=e.mapItemSetKey,a=n.deserialize(t),f=i.serialize(a.driveItemKey),l=a.driveItemKey.endpoint;return function(n){var i;at.n(ut.e.processData.start);var a=n((function(e){return function(t){var n,i,s,o,u=e.itemKey,a=e.parentItemKey,f=e.itemSetKeyFacet,l=e.filterChildItems,c=e.onProcessResponse,h=e.groupChildItems,p=e.response,d=e.skip,v=void 0===d?0:d,m=e.enableRandomAccess,g=void 0!==m&&m,y=e.totalChildCount,b=e.getDriveItemFacets,w=f.deserialize(u),E=w.driveItemKey.endpoint,S=new Re.e,x=t(Object(rt.e)({name:"remoteItemsMissingParentRef"})),T="number"==typeof p["@odata.count"]?p["@odata.count"]:y||p.value.length,N=p["@odata.nextLink"],C=!!N,k=t(Object(st.e)(function(e){return{childItemsFacetResolved:e.isItemFacetResolved(oe.e,u),prevChildKeys:e.demandItemFacet(oe.e,u)}})),L=k.childItemsFacetResolved,A=k.prevChildKeys,O=A&&A.itemKeys;g&&(L&&O?o=O.slice(0):"number"==typeof T&&(o=new Array(T+(C&&T<=p.value.length?1:0))));o||(o=new Array(p.value.length+(C?1:0)));for(var M=v,_=0,D=0,P=p.value;D<P.length;D++){var H=P[D],B=l&&l(H),j=H.remoteItem,F=!(H.remoteItem&&H.remoteItem.parentReference&&H.remoteItem.parentReference.driveId),I=j&&F;I&&_++;if(B||I){o.splice(M,1);T--}else{var q=H.webDavUrl||H.remoteItem&&H.remoteItem.webDavUrl||H.webUrl,R=t(Object($e.e)({graphEndpoint:Je.o,graphRecentEndpoint:Je.u})),U=R.graphEndpoint,z=R.graphRecentEndpoint,W=E.indexOf("/_api/v2.0")>-1||E.indexOf("/_api/v2.1")>-1,X=U||z;if(q&&(W||X)){var V=q&&decodeURIComponent(q);E=X?new Se.e(V).authority+"/_api/v2.0":""+new Se.e(V).authority+new Se.e(E).path}var $=xe({setItemKey:u,driveItemResponse:H,endpoint:E,getDriveItemFacets:b}),J=$.itemResolver,K=$.actualItemKey,Q=$.actualDriveItemKey;o[M]=K;S.merge(J);if(c){var G=c({itemKey:u,driveItemKey:Q,item:H});G&&S.merge(G.itemResolver)}var Y=t(Object($e.e)({processDriveItemFromSharePoint:Je.c})).processDriveItemFromSharePoint;if(Y&&(W||X)){var Z=t(Y.process({itemKey:K,driveItem:H})).itemResolver;S.merge(Z)}M++}}t(x(Object(r.__assign)({resultType:_<1?it.e.Success:it.e.Failure},_>0?{extraData:{count:_}}:{})));if(C){var ee=We.serialize({setItemKey:u,endpoint:E,token:N});S.merge(Object(Ve.t)({itemKey:ee}).itemResolver);o[M]=ee}if(h){var te=h(w);te&&S.merge(te.itemResolver)}else S.resolveItems({items:(n={},n[u]=Object(r.__assign)({},oe.e.pack({itemKeys:o})),n)});T!==y&&S.resolveItems({items:(i={},i[a]=Object(r.__assign)({},ot.e.pack(T)),i)});S.resolveItems({items:(s={},s[u]=Object(r.__assign)(Object(r.__assign)({},oe.i.pack({itemKey:a})),Object(Xe.e)().forFacet(oe.e).thenInvalidate(nt.e).pack()),s)});return{itemResolver:S}}})(Object(r.__assign)(Object(r.__assign)({},e),{response:s,parentItemKey:f}))).itemResolver;if(u){var c=u().itemResolver;a.merge(c)}if(o){var h=xe({setItemKey:t,driveItemResponse:o,endpoint:l}).itemResolver;a.merge(h)}a.resolveItems({items:(i={},i[f]=Object(r.__assign)({},Object(Xe.e)().forFacet(oe.t).thenInvalidate(e.itemKey,oe.e).pack()),i)});at.n(ut.e.processData.end);return{itemResolver:a}}}function lt(e){var t=this,n=e.itemKey,i=e.itemSetKeyFacet,s=e.getUrl,o=e.sortChildItems,u=e.qosName,a=e.preprocessResponse,f=e.expectedErrors,l=i.deserialize(n),c=l.driveItemKey.endpoint;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:t=Object(ve.n)(l.driveItemKey);return[4,n(Object(me.r)({url:s(l),driveUrl:t,qosName:"getChildren"+(u?"."+u:""),endpoint:c,headers:e.additionalHeaders,expectedErrors:f}))];case 1:i=v.sent();h=Object(r.__spreadArrays)(i.value);p=a?a(h):i.value;d=o?o(p):p;return[4,n(ft(Object(r.__assign)(Object(r.__assign)({},e),{childItemsResponse:Object(r.__assign)(Object(r.__assign)({},i),{value:d})})))];case 2:return[2,{itemResolver:v.sent().itemResolver}]}})})}}var ct=n(187),ht=n(558),pt=n(1324),dt=n(240);function vt(e,t){var n=new Date(e.valueOf());n.setDate(n.getDate()-t);return n}var mt=n(1449),gt={fileType:"fileName",sharedByUser:"sharedByName",dateModified:"dateModified"};var yt=new Map([["code",ct.e.text],["csv",ct.e.excel],["docx",ct.e.word],["dotx",ct.e.word],["one",ct.e.onenote],["onepkg",ct.e.onenote],["onetoc",ct.e.onenote],["pdf",ct.e.pdf],["photo",ct.e.media],["potx",ct.e.powerpoint],["ppsx",ct.e.powerpoint],["pptx",ct.e.powerpoint],["rtf",ct.e.text],["txt",ct.e.text],["video",ct.e.media],["xlsx",ct.e.excel],["xltx",ct.e.excel],["zip",ct.e.zip]]);function bt(e,t){var n,r,i=(n=e,r=Object(ht.t)(n,!0),Object(pt.t)(r)),s=yt.get(i);return!!s&&Object(ct.t)(t.filters,s)}function wt(e,t){void 0===t&&(t=[]);return t.every(function(t){var n,r=!(t.type===gt.sharedByUser)||(function(e,t){var n=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName;return!!n&&t.indexOf(n)>-1})(e,t.values),i=!(t.type===gt.fileType)||(function(e,t){return!!e.name&&bt(e.name,t)})(e,Object(dt.t)(t.values)),s=!(t.type===gt.dateModified)||(function(e,t){var n=e.lastModifiedDateTime||"";return(n&&new Date(n))>=t})(e,(function(e){var t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate());switch(e){case mt.e.today:return n;case mt.e.yesterday:return vt(n,1);case mt.e.last7Days:return vt(n,7);case mt.e.last30Days:return vt(n,30);case mt.e.last3Months:return vt(n,90);default:return new Date(0)}})((n=t.values).length<1?mt.e.none:-1===Object.keys(mt.e).indexOf(n[0])?mt.e.none:mt.e[n[0]]));return r&&i&&s})}var Et=n(202);function St(e,t,n){var r=e.lastModifiedDateTime,i=t.lastModifiedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function xt(e,t,n){var r=e&&e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedDateTime,i=t&&t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedDateTime,s=r&&i&&new Date(r).getTime()-new Date(i).getTime()||0,o=r&&i&&new Date(i).getTime()-new Date(r).getTime()||0;return n?s:o}function Tt(e,t,n){var r=e.name,i=t.name,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function Nt(e,t,n){var r=e.remoteItem&&e.remoteItem.shared&&e.remoteItem.shared.sharedBy&&e.remoteItem.shared.sharedBy.user&&e.remoteItem.shared.sharedBy.user.displayName,i=t.remoteItem&&t.remoteItem.shared&&t.remoteItem.shared.sharedBy&&t.remoteItem.shared.sharedBy.user&&t.remoteItem.shared.sharedBy.user.displayName,s=r&&i&&r.localeCompare(i)||0,o=r&&i&&i.localeCompare(r)||0;return n?s:o}function Ct(e,t,n,i){return(function(e,t){return Object(r.__spreadArrays)(e).sort(t)})(e,function(e,r){var s=e.folder,o=r.folder;return n&&s&&!o?-1:n&&!s&&o?1:i(e,r,t)})}var kt=n(2831),Lt=n(3206),At=n(392),Ot=n(33),Mt=n(3207);function _t(e){if(u.e.matches(e)){var t=u.e.deserialize(e).groupBy;if(t===c.t[c.i])return(function(e){var t={};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedBy,u=o&&o.user,a=de.e.serialize(r);if(u&&u.email){var f=kt.n.serialize({displayName:u.displayName,email:u.email});if(n=f,t.hasOwnProperty(n))t[f].push(a);else{t[f]=[];t[f].push(a)}}}},groupChildItems:function(n){for(var i,s,o=new Re.e,u=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!kt.n.matches(i))return e;var s=kt.n.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&e.displayName.localeCompare(t.displayName)}).map(function(e){return kt.n.serialize(e)})})(Object.keys(t)),a=[],f=0,l=u;f<l.length;f++){var c=l[f];if(kt.n.matches(c)){var h=kt.n.deserialize(c);o.resolveItems({items:(i={},i[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack(h.displayName)),ot.s.pack(!0)),oe.e.pack({itemKeys:t[c]})),i)});a.push(c)}}o.resolveItems({items:(s={},s[e]=Object(r.__assign)(Object(r.__assign)({},oe.e.pack({itemKeys:a})),Ot.e.pack(!0)),s)});return{itemResolver:o}}}})(e);if(t===c.t[c.e])return(function(e){var t={};return{onProcessResponse:function(e){var n,r=e.driveItemKey,i=e.item;if(i&&r){var s=i.remoteItem,o=s&&s.shared&&s.shared.sharedDateTime,u=de.e.serialize(r);if(o){var a=(function(e,t){if(!e)return Lt.e.older;var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());if(e>=n)return At.e.today;n.setDate(n.getDate()-1);if(e>=n)return At.e.yesterday;n.setDate(t.getDate()-t.getDay());if(e>=n)return Lt.e.thisWeek;n.setDate(n.getDate()-7);if(e>n)return Lt.e.lastWeek;var r=new Date(t.getFullYear(),t.getMonth(),1),i=new Date(t.getFullYear(),t.getMonth()-1,1);if(e>=i&&e<r)return Lt.e.lastMonth;n.setDate(n.getDate()-7);if(e>n)return Lt.e.twoWeeksAgo;n.setDate(n.getDate()-7);if(e>n)return Lt.e.threeWeeksAgo;if(e>=r)return Lt.e.thisMonth;var s=t.getFullYear()===e.getFullYear(),o=Mt.e[e.getMonth()];if(s)return o;return ne.format(At.e.MonthAndYear,o,e.getFullYear())})(new Date(o),new Date),f=kt.e.serialize({relativeTime:a,sharedDateTime:o});if(n=f,t.hasOwnProperty(n))t[f].push(u);else{t[f]=[];t[f].push(u)}}}},groupChildItems:function(n){for(var i,s,o=new Re.e,u=(function(e){for(var t={},n=(function(e){for(var t=[],n=0,r=e;n<r.length;n++){var i=r[n];if(!kt.e.matches(i))return e;var s=kt.e.deserialize(i);t.push(s)}return t.sort(function(e,t){return e&&t&&new Date(t.sharedDateTime).getTime()-new Date(e.sharedDateTime).getTime()}).map(function(e){return kt.e.serialize(e)})})(Object.keys(e)),r=function(e){return t.hasOwnProperty(e)},i=0,s=n;i<s.length;i++){var o=s[i];if(kt.e.matches(o)){var u=kt.e.deserialize(o).relativeTime,a=kt.t.serialize({relativeTime:u});if(r(a))for(var f=e[o],l=0,c=f;l<c.length;l++){var h=c[l];t[a].push(h)}else{t[a]=[];f=e[o];for(var p=0,d=f;p<d.length;p++){h=d[p];t[a].push(h)}}}}return t})(t),a=[],f=0,l=Object.keys(u);f<l.length;f++){var c=l[f];if(kt.t.matches(c)){var h=kt.t.deserialize(c).relativeTime;o.resolveItems({items:(i={},i[c]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack(h)),ot.s.pack(!0)),oe.e.pack({itemKeys:u[c]})),i)});a.push(c)}}o.resolveItems({items:(s={},s[e]=Object(r.__assign)(Object(r.__assign)({},oe.e.pack({itemKeys:a})),Ot.e.pack(!0)),s)});return{itemResolver:o}}}})(e)}return{onProcessResponse:void 0,groupChildItems:void 0}}var Dt=Object(i.i)()(function(e){var t=this,n=u.e.deserialize(e.itemKey),i=n.filters,s=n.sortBy,o=n.isAscending;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,a,f,l,h,p,d,v;return Object(r.__generator)(this,function(m){switch(m.label){case 0:t=_t(e.itemKey),a=t.onProcessResponse,f=t.groupChildItems;l=u.e.deserialize(e.itemKey);h=l.driveItemKey.endpoint;p=n(Object($e.e)({graphSharedWithMeEndpoint:Je.a})).graphSharedWithMeEndpoint;h=p||h;return[4,n(Object(me.i)(h))];case 1:d=m.sent();return[4,n(lt(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedWithMe",itemSetKeyFacet:u.e,parentItemKeyFacet:Ze.e,getUrl:function(e){return d?h+"/drive/view.sharedWithMe?allowExternal=true":h+"/me/drive/sharedWithMe?expand=formats&allowExternal=true&$top=500"},filterChildItems:function(e){return!wt(e,i)},sortChildItems:function(e){return(function(e,t,n,r){void 0===r&&(r=!1);var i=c.t[c.e],s=c.t[c.i],o=c.t[Et.t],u=c.t[c.r],a=c.t[Et.r];switch(t){case i:return Ct(e,n,r,xt);case s:return Ct(e,n,r,Nt);case o:case a:return Ct(e,n,r,Tt);case u:return Ct(e,n,r,St);default:return e}})(e,s,o,!0)},onProcessResponse:a,groupChildItems:f})))];case 2:v=m.sent().itemResolver;n(v.execute());return[2]}})})}});var Pt=new we.e("sharedByMeRootItem",{endpoint:Object(we.s)()}),Ht=new we.e("sharedByMeItemSet",{driveItemKey:Object(we.o)(de.e)}),Bt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Pt.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(o){(t=new Re.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},oe.t.pack({itemKey:Ht.serialize({driveItemKey:i})})),y.f.pack(et.e.sharedByMe)),y.d.pack({})),y.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var jt=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,n(lt(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"sharedByMe",itemSetKeyFacet:Ht,parentItemKeyFacet:Pt,getUrl:function(e){return e.driveItemKey.endpoint+"/drive/shared"}})))];case 1:t=i.sent().itemResolver;n(t.execute());return[2]}})})}});var Ft=n(432),It=n(293),qt=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=It.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s,o;return Object(r.__generator)(this,function(u){t=e(Object($e.e)({groupBy:Je.h})).groupBy;(s=new Re.e).resolveItems({items:(o={},o[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},oe.t.pack({itemKey:Ft.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0,groupBy:t||""})})),y.f.pack(et.e.recentTitle)),y.d.pack({})),y.A.pack(void 0)),o)});e(s.execute());return[2]})})}});var Rt=n(292),Ut=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Rt.e.deserialize(n);return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,s;return Object(r.__generator)(this,function(u){(t=new Re.e).resolveItems({items:(s={},s[n]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},oe.t.pack({itemKey:o.e.serialize({driveItemKey:i,sortBy:"",isAscending:!0})})),y.f.pack(et.e.saved)),y.d.pack({})),y.A.pack(void 0)),s)});e(t.execute());return[2]})})}});var zt,Wt=n(113),Xt=new we.e("recentGroup",{relativeTime:Object(we.s)()}),Vt=864e5,$t=7;(function(e){e.today="Today";e.yesterday="Yesterday";e.thisWeek="This week";e.lastWeek="Last week";e.twoWeeksAgo="Two weeks ago";e.threeWeeksAgo="Three weeks ago";e.thisMonth="This month";e.lastMonth="Last month";e.twoMonthsAgo="Two months ago";e.older="Older"})(zt||(zt={}));function Jt(e){var t=new Date;return(function(e,t){return Kt(t,e)})(e,t)?zt.today:(function(e,t){return Kt(new Date(t.getTime()-Vt),e)})(e,t)?zt.yesterday:(function(e,t){var n=t.setHours(0,0,0,0)-t.getDay()*Vt;return e.getTime()>n})(e,t)?zt.thisWeek:(function(e,t){var n=t.setHours(0,0,0,0)-(t.getDay()+$t)*Vt;return e.getTime()>n})(e,t)?zt.lastWeek:(function(e,t){var n=t.setHours(0,0,0,0)-2*$t*Vt;return e.getTime()>n})(e,t)?zt.twoWeeksAgo:(function(e,t){var n=t.setHours(0,0,0,0)-3*$t*Vt;return e.getTime()>n})(e,t)?zt.threeWeeksAgo:(function(e,t){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()})(e,t)?zt.thisMonth:(function(e,t){var n=t.getMonth(),r=e.getMonth();return n-r==11||t.getFullYear()===e.getFullYear()&&t.getMonth()-e.getMonth()==1})(e,t)?zt.lastMonth:(function(e,t){var n=t.getFullYear(),r=e.getFullYear(),i=t.getMonth(),s=e.getMonth(),o=n-r==1&&i-s==-10;return n===r&&i-s==2||o})(e,t)?zt.twoMonthsAgo:""}function Kt(e,t){return e.toDateString()===t.toDateString()}var Qt=["January","February","March","April","May","June","July","August","September","October","November","December"],Gt=n(2506);var Yt=function(e,t){var n=new RegExp("^"+t+"\\/","i");return e.filter(function(e){var t=e&&e.remoteItem||e;return!(!t||!t.file)&&n.test(t.file.mimeType)})},Zt=Object(i.i)()(function(e){var t=this,n=Ft.e.deserialize(e.itemKey),i=n.filters,s=void 0===i?[]:i,o=n.groupBy,u=void 0===o?"":o,a=n.driveItemKey.endpoint,f=Object(dt.e)({extFilters:Object(dt.t)(s),allowedMediaTypes:[ct.e.photo,ct.e.video],fileTypeIconMap:Wt.e}),l=Object(dt.e)({extFilters:Object(dt.t)(s),allowedMediaTypes:[ct.e.photo],fileTypeIconMap:Wt.e}),c=Object(dt.e)({extFilters:Object(dt.t)(s),allowedMediaTypes:[ct.e.video],fileTypeIconMap:Wt.e});return function(i){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,h,p,d,v,m,g,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j;return Object(r.__generator)(this,function(F){switch(F.label){case 0:t=i(Object($e.e)({graphRecentEndpoint:Je.u})).graphRecentEndpoint;a=t||a;o=Ft.e.serialize(Object(r.__assign)(Object(r.__assign)({},n),{driveItemKey:{endpoint:a}}));h=Xt.serialize({relativeTime:"today"});p=Xt.serialize({relativeTime:"yesterday"});d=Xt.serialize({relativeTime:"thisWeek"});v=Xt.serialize({relativeTime:"lastWeek"});m=Xt.serialize({relativeTime:"twoWeeksAgo"});g=Xt.serialize({relativeTime:"threeWeeksAgo"});b=Xt.serialize({relativeTime:"lastMonth"});w=Xt.serialize({relativeTime:"twoMonthsAgo"});E=[];S=[];x=[];T=[];N=[];C=[];k=[];L=[];A="";O="date"===u;M=function(e){var t,n=e.driveItemKey,i=e.item,s=new Re.e;if(i&&n){var o=i.remoteItem,u=o&&o.fileSystemInfo,a=u&&u.lastAccessedDateTime,f=de.e.serialize(n);if(O&&a){var l=new Date(a);switch(Jt(l)){case zt.today:E.push(f);break;case zt.yesterday:S.push(f);break;case zt.thisWeek:x.push(f);break;case zt.lastWeek:T.push(f);break;case zt.twoWeeksAgo:N.push(f);break;case zt.threeWeeksAgo:C.push(f);break;case zt.lastMonth:k.push(f);break;case zt.twoMonthsAgo:L.push(f);A=Qt[l.getMonth()]}}s.resolveItems({items:(t={},t[f]=Object(r.__assign)({},y.d.pack(void 0)),t)});return{itemResolver:s}}};_=!f&&O?function(t){var n,i,s=new Re.e;s.resolveItems({items:(n={},n[h]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack("Today")),ot.s.pack(!0)),oe.e.pack({itemKeys:E})),n[p]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack("Yesterday")),ot.s.pack(!0)),oe.e.pack({itemKeys:S})),n[d]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack("This Week")),ot.s.pack(!0)),oe.e.pack({itemKeys:x})),n[v]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack("Last Week")),ot.s.pack(!0)),oe.e.pack({itemKeys:T})),n[m]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack("Two Weeks Ago")),ot.s.pack(!0)),oe.e.pack({itemKeys:N})),n[g]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack("Three Weeks Ago")),ot.s.pack(!0)),oe.e.pack({itemKeys:C})),n[b]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack("Last Month")),ot.s.pack(!0)),oe.e.pack({itemKeys:k})),n[w]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.f.pack(A)),ot.s.pack(!0)),oe.e.pack({itemKeys:L})),n)});var o=[];E.length>0&&o.push(h);S.length>0&&o.push(p);x.length>0&&o.push(d);T.length>0&&o.push(v);N.length>0&&o.push(m);C.length>0&&o.push(g);k.length>0&&o.push(b);L.length>0&&o.push(w);s.resolveItems({items:(i={},i[e.itemKey]=Object(r.__assign)({},oe.e.pack({itemKeys:o})),i)});return{itemResolver:s}}:void 0;return[4,i(Object(me.i)(a))];case 1:D=F.sent();P=[{code:"notAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"notAllowed",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"notAllowed",message:"Operation not allowed"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,i(lt(Object(r.__assign)(Object(r.__assign)({},e),{qosName:f?"recentMedia":D?"ODC-recent":"recent",itemKey:o,itemSetKeyFacet:Ft.e,parentItemKeyFacet:It.e,getUrl:function(e){var t=a+"/"+(a.indexOf("/v2.")>-1?"drives/me":"me/drive")+"/recent?";if(D)t=a+"/drive/view.recent?";else if(f){return t+="$filter=(remoteItem/image ne null or remoteItem/video ne null)&$expand=thumbnails"}return""+t+(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}"folder"===u?!o&&t.push("folder ne null"):"onenote"===u?o?n.push("(remoteItem/package/type ne 'oneNote' and package/type ne 'oneNote')"):t.push("(remoteItem/package/type eq 'oneNote' or package/type eq 'oneNote')"):"."!==u[0]||!o&&t.push("(endsWith(name, '"+u.toLowerCase()+"') or endsWith(remoteItem/name, '"+u.toLowerCase()+"'))")}return t.length>0||n.length>0?"&$filter="+(0===n.length?Ke(t):0===t.length?Qe(n):Qe(Object(r.__spreadArrays)([Ke(t)],n))):""})(s)},getDriveItemFacets:function(e){var t=Object(ge.e)(e);return Object(r.__assign)(Object(r.__assign)({},t),Gt.e.pack(!1))},expectedErrors:P,preprocessResponse:function(e){l?e=Yt(e,"image"):c&&(e=Yt(e,"video"));return(function(e){if(!e)return e;return e.filter(function(e,t,n){return n.map(function(e){return e.id}).indexOf(e.id)===t})})(e.sort(function(e,t){var n=e.remoteItem&&e.remoteItem.fileSystemInfo&&e.remoteItem.fileSystemInfo.lastAccessedDateTime,r=t.remoteItem&&t.remoteItem.fileSystemInfo&&t.remoteItem.fileSystemInfo.lastAccessedDateTime;return n||r?n?r?n>r?-1:1:-1:1:0}))},additionalHeaders:f?{Prefer:"ApiVersion=2.1,NoPreAuthThumbnailUrls"}:{Prefer:"ApiVersion=2.1;ODC,returnparentresource,returnowner"},onProcessResponse:M,groupChildItems:_})))];case 2:H=F.sent().itemResolver;f&&H.resolveItems({items:(B={},B[e.itemKey]=Object(r.__assign)({},ot.o.pack({})),B)});H.mapKeys({mappings:(j={},j[o]=e.itemKey,j)});i(H.execute());return[2]}})})}});var en=n(347);function tn(e){var t,n,r=e.name&&(t=e.name,n=".aspx",t.substr(t.length-n.length)===n),i=e.package||e.remoteItem&&e.remoteItem.package,s=i&&"oneNote"===i.type;return r||s||!1}var nn=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,u,a,f,l,c,h,p,d;return Object(r.__generator)(this,function(v){switch(v.label){case 0:t=n(Object($e.e)({saveForLaterGraphEndpoint:Je.p})).saveForLaterGraphEndpoint;i=e.itemKey;s=o.e.deserialize(i);u=s.driveItemKey.endpoint;a=n(Object($e.e)({getUserOneDriveEndpoint:Je.s})).getUserOneDriveEndpoint;f=new Se.e(u).authority;return(l=t)?[3,3]:(c=a)?[4,n(a.getUserOneDriveEndpoint(f))]:[3,2];case 1:c=v.sent();v.label=2;case 2:l=c;v.label=3;case 3:u=l||u;h=o.e.serialize({driveItemKey:{endpoint:u},sortBy:"",isAscending:!0});p=[{code:"provisioningNotAllowed",message:"You do not have permission to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Unable to retrieve user's mysite URL."},{code:"InvalidAuthenticationToken",message:"Access token has expired."},{code:"resourceBeingProvisioned",message:"The requested resource is being automatically provisioned. Please try again in a few minutes."}];return[4,n(lt(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:h,qosName:"savedForLater",itemSetKeyFacet:o.e,parentItemKeyFacet:Rt.e,getUrl:function(e){if(t){return u+"/me/drive/following?top=5000&select="+["followed","name","parentReference","webDavUrl","webUrl","id","size","lastModifiedBy","lastModifiedDateTime","sharepointIds"].join(",")}return u+"/drives/me/followed?top=5000&select=*,webDavUrl"},onProcessResponse:function(e){var t,n,i=e.itemKey,s=e.driveItemKey,o=e.item,u=new Re.e;if(s&&o){var a=de.e.serialize(s),f=en.e.serialize({driveItemKey:s}),l=o&&(o.webDavUrl||o.webUrl);u.resolveItems({items:(t={},t[a]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},y.v.pack({itemKey:f})),y.i.pack(l)),y.p.pack(o.size)),t[f]=Object(r.__assign)(Object(r.__assign)({},y.b.pack(!0)),Object(Xe.e)().forFacet(y.b).thenInvalidate(i,oe.e).pack()),t)});u.invalidateItems({items:(n={},n[i]=[oe.e],n)})}return{itemResolver:u}},filterChildItems:tn,getDriveItemFacets:function(e){var t=e.driveItem,n=t.root,i=t.remoteItem,s=t.name,o=n?et.e.files:s||i&&i.name||"",u=!t.webDavUrl,a=t.followed&&t.followed.followedDateTime;return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(ge.e)(Object(r.__assign)(Object(r.__assign)({},e),{shouldReturnShareFacets:!1}))),y.h.pack(Object(ge.t)(o,u))),a?y.o.pack(new Date(a).getTime()):{}),y.d.pack(u?{}:void 0))},mapItemSetKey:function(){var t,n=new Re.e;n.mapKeys({mappings:(t={},t[e.itemKey]=h,t)});return{itemResolver:n}},expectedErrors:p})))];case 4:d=v.sent().itemResolver;n(d.execute());return[2]}})})}});var rn=n(2832),sn=n(1538),on=Object(i.n)()(function(e){var t=this,n=e.items;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,u,a,f,l,c,h,p,d,v,m,g,w,E,S;return Object(r.__generator)(this,function(x){switch(x.label){case 0:return[4,e(Object(st.e)(function(e){return e.demandItemFacet(b.c,b.n)}))];case 1:if(!x.sent())return[2];t=Object.keys(n);i=t[0];s=en.e.deserialize(i);if(!(u=s.driveItemKey.endpoint))throw new Error("No endpoint to determine followed items.");a=o.e.serialize({driveItemKey:{endpoint:u},sortBy:"",isAscending:!0});return[4,e(Object(sn.demandItems)(function(e){return e.demandItemFacet(oe.e,a)}))];case 2:f=x.sent();l=f&&f.itemKeys||[];c=new Re.e;h={};for(p=0,d=l;p<d.length;p++){w=d[p];h[w]=!0}for(v=0,m=t;v<m.length;v++){g=m[v];w=en.e.deserialize(g).driveItemKey;E=!!h[de.e.serialize(w)];c.resolveItems({items:(S={},S[g]=Object(r.__assign)(Object(r.__assign)({},y.b.pack(E||void 0)),Object(Xe.e)().forFacet(y.b).thenInvalidate(a,oe.e).pack()),S)})}e(c.execute());return[2]}})})}});var un=n(2178),an=new we.e("searchRootItem",{endpoint:Object(we.s)()}),fn=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=[{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"503"},{code:"ItemNotFound"},{code:"activityLimitReached"},{code:"serviceNotAvailable"}];return[4,n(lt(Object(r.__assign)(Object(r.__assign)({},e),{qosName:"search",itemSetKeyFacet:un.e,parentItemKeyFacet:an,getUrl:function(e){var t,n=e.driveItemKey,r=e.searchTerm;r&&(t=encodeURIComponent(r));return Object(ve.t)(n)+"/search(q='"+t+"')?$expand=thumbnails&select=*,webDavUrl"},expectedErrors:t})))];case 1:i=s.sent().itemResolver;n(i.execute());return[2]}})})}});var ln=n(2177);function cn(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A;return Object(r.__generator)(this,function(O){switch(O.label){case 0:t=e.itemKey,i=e.top,s=e.skip;o=qe.e.deserialize(t);u=o.driveItemKey,a=o.extFilters;f=de.e.serialize(o.driveItemKey);l=o.driveItemKey.endpoint,c=o.sortBy,h=o.isAscending;p=Object(ve.n)(o.driveItemKey);return[4,n(Object(st.e)(function(e){return{isParentItemResolved:e.isItemFacetResolved(de.e,f),totalChildCount:e.isItemFacetResolved(ot.e,f)?e.demandItemFacet(ot.e,f):void 0,driveType:e.isItemFacetResolved(ln.e,f)?e.demandItemFacet(ln.e,f):void 0}}))];case 1:d=O.sent(),v=d.isParentItemResolved,m=d.totalChildCount,g=d.driveType;y=Promise.resolve(void 0);v||(y=n(Object(me.r)({url:Object(ve.t)(u),driveUrl:p,qosName:"getItem",endpoint:l})));b=[{code:"notAllowed",message:"You do not have access to create this personal site or you do not have a valid license"},{code:"BadRequest",message:"Tenant does not have a SPO license."},{code:"AccessDenied",message:"Access to this site has been blocked. Please contact the administrator to resolve this problem."},{code:"UnknownError",message:"401 UNAUTHORIZED"},{code:"ItemNotFound"},{code:"503"}];w=Object(ve.t)(u);E=s?"&skiptoken="+(s+1)+"/"+m+"&skip="+s:"";S=c&&void 0!==h?Object(me.t)(c,h):"";x=(function(e){if(!e||0===e.length)return"";for(var t=[],n=[],i=0;i<e.length;i++){var s=e[i],o=!1,u=s;if("!"===s[0]){u=s.slice(1);o=!0}if("folder"===u)!o&&t.push("folder ne null");else if("."!==u[0]);else{t=[];n=[]}}return t.length>0||n.length>0?"&$filter="+(0===n.length?Ke(t):0===t.length?Qe(n):Qe(Object(r.__spreadArrays)([Ke(t)],n))):""})(a);T=n(Object(me.r)({url:w+"/children?$top="+i+E+S+"&$expand=thumbnails&select=*,webDavUrl"+x,driveUrl:p,qosName:"getChildren.folder",endpoint:l,expectedErrors:b}));N=[T,y];return[4,Promise.all(N)];case 2:C=O.sent(),k=C[0];if(L=C[1]){L.folder&&(m=L.folder.childCount);L.parentReference&&L.parentReference.driveType&&(g=L.parentReference.driveType)}A=n(Object(me.s)(l,g));return[4,n(ft({itemKey:t,itemSetKeyFacet:qe.e,parentItemKeyFacet:de.e,parentItemResponse:L,childItemsResponse:k,filterChildItems:a&&a.length>0?Ge(a):void 0,skip:s,enableRandomAccess:A,totalChildCount:m,onProcessResponse:function(e){var t,n=new Re.e;n.resolveItems({items:(t={},t[e.itemKey]=Object(r.__assign)({},Te.n.pack(de.e)),t)});return{itemResolver:n}}}))];case 3:return[2,O.sent().itemResolver]}})})}}var hn=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i;return Object(r.__generator)(this,function(s){switch(s.label){case 0:t=n(Object($e.e)({pageSize:Je.n})).pageSize;return[4,n(cn(Object(r.__assign)(Object(r.__assign)({},e),{skip:pn,top:t||be.t})))];case 1:i=s.sent();at.n(ut.e.resolveData.start);n(i.execute());at.n(ut.e.resolveData.end);return[2]}})})}}),pn=0;var dn=n(128),vn=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){e(Object(dn.e)(function(){e(Object(he.t)({keyFacet:qe.e,facets:[qe.e,oe.e]}));e(Object(s.o)(qe.e,pe.e)(hn))}));return[2]})})}}),mn=n(574),gn=n(2504),yn=n(2503),bn=Object(i.i)()(function(e){var t=this;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=e.itemKey;i=yn.e.deserialize(t);s=i.endpoint;o=Object(ve.n)(i);return[4,n(wn({url:Object(ve.e)(i),driveUrl:o,qosName:"commands",endpoint:s}))];case 1:u=l.sent();(a=new Re.e).resolveItems({items:(f={},f[t]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},gn.e.pack(u.addToOneDrive)),gn.t.pack(u.createFolder)),gn.n.pack(u.createLink)),gn.r.pack(u.delete)),gn.i.pack(u.download)),gn.s.pack(u.invite)),gn.o.pack(u.move)),gn.u.pack(u.officeLens)),gn.a.pack(u.rename)),gn.f.pack(u.upload)),f)});n(a.execute());return[2]}})})}});function wn(e){var t=this;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{addToOneDrive:{roles:["write"]},createFolder:{roles:["owner","write"]},createLink:{defaultScope:"anonymous",linkTypes:["view","edit"],scopes:["anonymous","application"]},delete:{roles:["owner","write"]},download:{roles:["owner","write","read"]},invite:{roles:["owner","write"]},move:{roles:["owner","write"]},officeLens:{extensions:["jpeg","jpg","jpe"],lensNames:["officeLens"],roles:["owner"]},rename:{roles:["owner","write"]},upload:{roles:["owner","write"]}}]})})}}var En=n(2833),Sn=n(350),xn=n(569),Tn=n(820),Nn=n(316),Cn=Object(f.t)()(function(){return function(e){return kn}});function kn(e,t){var n=t.handlers,i=t.itemKey,s=e.demandItemFacet(Ft.e,i);if(n&&s){for(var o=[],u=0,a=n;u<a.length;u++){var f=a[u];if(f.key===Nn.o.key)o.push("photo");else if(f.key===Nn.u.key)o.push("video");else if(f.key===Nn.e.key)o.push("folder");else if(f.key===Nn.s.key)o.push("onenote");else if(f.key===Nn.r.key)o.push("!photo");else if(f.key===Nn.i.key)o.push("!video");else if(f.key===Nn.t.key)o.push("!folder");else if(f.key===Nn.n.key)o.push("!onenote");else{var l=Object(Tn.e)(f);l&&o.push(l)}}return{itemKey:Ft.e.serialize(Object(r.__assign)(Object(r.__assign)({},s),{filters:o}))}}return{}}var Ln=n(396),An=n(267),On=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;if(n){var r=e.demandItemFacet(Ft.e,n);if(r&&r.filters&&Object(dt.e)({extFilters:Object(dt.t)(r.filters),allowedMediaTypes:[ct.e.photo,ct.e.video],fileTypeIconMap:Wt.e}))return{defaultLayout:An.e,isLayoutResolved:!0}}return{}}}});var Mn=n(257),_n=new we.e("sharesItem",{endpoint:Object(we.s)(),shareId:Object(we.s)()}),Dn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=_n.deserialize(n),s=i.endpoint;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l,c,h,p;return Object(r.__generator)(this,function(d){switch(d.label){case 0:return[4,e(Object(me.n)({url:Object(ve.r)(i)+"?$expand=thumbnails&select=*,webDavUrl",qosName:"getSharesItem",endpoint:s,headers:{Prefer:"redeemSharingLinkIfNecessary"}}))];case 1:t=d.sent();o=new Re.e;u=t&&t.parentReference;a=u&&u.driveId;f={endpoint:s,driveId:a,itemId:t.id};l=de.e.serialize(f);c=u&&u.id?de.e.serialize({endpoint:s,driveId:a,itemId:u.id}):void 0;o.resolveItems({items:(h={},h[l]=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},Object(ge.e)({driveItem:t,endpoint:s,parentFolderItemKey:c})),Ue.i.pack(de.e)),oe.t.pack({itemKey:qe.e.serialize({driveItemKey:f,sortBy:"",isAscending:!0})})),h)});o.mapKeys({mappings:(p={},p[l]=n,p)});e(o.execute());return[2]}})})}});var Pn=n(957),Hn=new we.e("driveItemVirtualizedPage",{endpoint:Object(we.s)(),setItemKey:Object(we.s)(),skip:Object(we.i)(),top:Object(we.i)()}),Bn=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=Hn.deserialize(n),s=i.setItemKey,o=i.top,u=i.skip;return function(n){return Object(r.__awaiter)(t,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(i){switch(i.label){case 0:return[4,n(cn(Object(r.__assign)(Object(r.__assign)({},e),{itemKey:s,skip:u,top:o})))];case 1:t=i.sent();n(t.execute());return[2]}})})}});var jn=n(138),Fn=Object(jn.e)(function(){return Promise.resolve().then(n.bind(null,3491))},{chunkName:"graphaddondeferred"}),In=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e(Object(dn.e)(function(){e(Object(he.t)({keyFacet:de.e,facets:[de.e,y.f,y.p,y.d,y.L,y.u,oe.t,y.A,y.i,y.l,ce.n]}));e(Object(he.t)({keyFacet:We,facets:[We,oe.e,oe.r]}));e(Object(he.t)({keyFacet:Ze.e,facets:[Ze.e,y.f,y.p,y.d,y.L,y.i,y.u,oe.t,y.A,ce.n]}));e(Object(he.t)({keyFacet:u.e,facets:[u.e,oe.e]}));e(Object(he.t)({keyFacet:Pt,facets:[Pt,y.f,y.p,y.d,y.L,y.i,y.u,oe.t,y.A,ce.n]}));e(Object(he.t)({keyFacet:Ht,facets:[Ht,oe.e]}));e(Object(he.t)({keyFacet:It.e,facets:[It.e,y.f,y.p,y.d,y.L,y.u,oe.t,y.A,ce.n]}));e(Object(he.t)({keyFacet:Ft.e,facets:[Ft.e,oe.e]}));e(Object(he.t)({keyFacet:Rt.e,facets:[Rt.e,y.f,y.p,y.d,y.L,y.u,oe.t,y.A]}));e(Object(he.t)({keyFacet:yn.e,facets:[gn.e,gn.t,gn.n,gn.r,gn.i,gn.s,gn.o,gn.u,gn.a,gn.f]}));e(vn);e(Object(s.o)(de.e,pe.e)(Ne));e(Object(s.o)(Hn,pe.e)(Bn));e(Object(s.o)(Ce.e,pe.e)(De));e(Object(s.o)(Ie,pe.e)(ze));e(Object(s.o)(_n,pe.e)(Dn));e(Object(s.o)(We,pe.e)(Ye));e(Object(s.o)(Ze.e,pe.e)(tt));e(Object(s.o)(u.e,pe.e)(Dt));e(Object(s.o)(Pt,pe.e)(Bt));e(Object(s.o)(Ht,pe.e)(jt));e(Object(s.o)(It.e,pe.e)(qt));e(Object(s.o)(Rt.e,pe.e)(Ut));e(Object(s.o)(Ft.e,pe.e)(Zt));e(Object(s.o)(o.e,pe.e)(nn));e(Object(s.o)(un.e,pe.e)(fn));e(Object(he.t)({keyFacet:en.e,facets:[y.b]}));e(Object(s.o)(en.e,pe.e)(on));e(Object(s.o)(mn.e,pe.e)(rn.e));e(Object(s.o)(yn.e,pe.e)(bn));e(Object(f.r)(de.e,Sn.e)(En.t));e(Object(f.r)(Ft.e,xn.e)(Cn));e(Object(f.r)(Ft.e,Ln.e)(On));e(Pn.e)}));return[4,e(Object(a.o)({waitIndefinitely:!0}))];case 1:r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,Fn()];case 3:if(!(t=r.sent().graphAddonDataOnlyDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:n=r.sent();e(Object(Mn.e)({error:n}));return[3,5];case 5:return[2]}})})}}),qn=n(359),Rn=n(3209),Un=Object(f.t)()(function(){return function(e){return function(e,t){return{emptyFolderIconUrl:"https://static2.sharepointonline.com/files/fabric/onedrive-assets/images/empty_state_sfl.svg",emptyFolderTitle:Rn.e.savedForLaterEmptyStateTitle}}}});var zn=n(982),Wn=n(84),Xn=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(Je.d,b.n),i=Object(Wn.e)(e);return e.demandItemFacet(u.e,i)&&!r?{isAvailable:!1}:"personal"!==e.demandItemFacet(ln.e,n)?{hoverCard:zn.e}:{}}}});var Vn=n(2826),$n=n(357),Jn=n(814),Kn=Object(d.i)({key:new m.e("dateAccessedColumn").id,name:v.e.AccessedDate,fieldName:"",minWidth:d.e.regularMin,maxWidth:d.e.regularMax,isCollapsable:!0},g.e)(function(e,t){var n=e.demandItemFacet(y.s,t,{suppressGetItems:!0}),r=n&&new Date(n).getTime();if("number"!=typeof r||isNaN(r))return{text:""};var i=e.demandItemFacet(b.S,b.n),s=i&&i.language||window.navigator.language;return s?{text:Object(w.n)(new Date(r),s)}:{dateValue:r}},function(e,t){return""+e.demandItemFacet(y.s,t)}),Qn=Object(f.t)()(function(){return function(e){return Yn}});var Gn=[h,p.e,Kn];function Yn(e,t){return{columns:Gn}}var Zn=n(703),er=Object(f.t)()(function(){return function(){return function(e,t){var n=t.setItemKey,r=e.demandItemFacet(qe.e,n);if(!n||!r)return{};var i=r.driveItemKey.endpoint,s=de.e.serialize(r.driveItemKey),o=e.demandItemFacet(ln.e,s),u=e.demandItemFacet(Je.n,b.n)||be.t,a=e.demandItemFacet(Je.v,b.n);if(a&&a(i,o)){return{totalItemCount:e.demandItemFacet(ot.e,s),getPageKey:function(e,t){return Hn.serialize({setItemKey:n,endpoint:r.driveItemKey.endpoint,skip:e,top:t-e})},pageSize:u}}return{}}}});var tr=n(355),nr=n(721),rr=n(661),ir=n(747),sr=n(706),or=Object(f.t)()(function(){return function(e){return ar}});var ur=[l.e,tr.e,nr.e,sr.e,rr.e,ir.e];function ar(e,t){return{columns:ur}}var fr=n(519),lr=Object(i.t)(function(){return function(e){e(Object(f.r)(de.e,fr.e)(Object(f.n)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,e(Object(a.o)())];case 1:t.sent();return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("dot_handlers_controls_driveitem_itemactivityfieldcontrolhandler")]).then(n.bind(null,3234))];case 2:return[2,t.sent().driveItemActivityFieldControlHandler]}})})})))}}),cr=n(243),hr=n(50),pr=Object(f.t)()(function(){return function(e){return dr}});function dr(e,t){return(function(e,t,n){var i=n.itemSetKey,s=n.handler,o=s.columnKey,u=s.isAscending,a=e.demandItemFacet(t,i);if(!a)return{};var f=e.demandItemFacet(ln.e,de.e.serialize(Object(r.__assign)({},a.driveItemKey)));if(!f||"business"===f||"documentLibrary"===f)return{};if(!a.sortBy&&o===tr.e.key&&!0===u)return{newItemSetKey:i};var l=Object(hr.e)(e,{customColumnKeysToFieldNamesConfiguration:Je.t}).customColumnKeysToFieldNamesConfiguration,h=Object(r.__assign)(Object(r.__assign)({},c.t),l),p=h?h[o]:void 0;if(!p)return{};return{newItemSetKey:t.serialize(Object(r.__assign)(Object(r.__assign)({},a),{sortBy:p,isAscending:u}))}})(e,qe.e,t)}var vr=n(503),mr=Object(f.t)()(function(){return function(e){return function(e,t){return{isAvailable:!0}}}});var gr=n(2342),yr=n(2007),br=n(2827),wr=Object(i.i)()(function(e){var t=this,n=e.itemKey,i=gr.e.deserialize(n),s=i.endpoint,o=i.driveId;return function(e){return Object(r.__awaiter)(t,void 0,void 0,function(){var t,i,u,a,f;return Object(r.__generator)(this,function(l){switch(l.label){case 0:t=Object(ve.n)({endpoint:s,driveId:o});return[4,e(Object(yr.e)(s,t))];case 1:i=l.sent();u=i&&i.accessToken;(a=new Re.e).resolveItems({items:(f={},f[n]=Object(r.__assign)({},br.e.pack(u)),f)});e(a.execute());return[2]}})})}});var Er=n(9),Sr=n(281),xr=n(2509),Tr=Object(f.t)()(function(){return function(e){return function(e,t){return{fileTypeIconAs:Nr}}}});var Nr=Object(Er.i)(function(e,t){var n=t.defaultRender,i=Object(r.__rest)(t,["defaultRender"]),s=i.isFolder,o=i.itemKey,u=i.type,a=u;if(s&&void 0===u){var f=e.demandItemFacet(xr.e,o);void 0!==f&&("desktop"===f?a=Sr.e.desktopFolder:"documents"===f?a=Sr.e.desktopFolder:"pictures"===f&&(a=Sr.e.picturesFolder))}return n?A.createElement(n,Object(r.__assign)({},i,{type:a})):null}),Cr=n(505),kr=n(164),Lr=Object(f.t)()(function(){return function(e){return function(e,t){var n=t.signalData,r=e.demandItem({specialFolder:xr.e},t.itemKey).specialFolder;return{signalData:n||Ar(r)}}}});function Ar(e){var t=null;"desktop"===e?t=A.createElement(kr.r,null):"documents"===e?t=A.createElement(kr.i,null):"pictures"===e&&(t=A.createElement(kr.h,null));return{signal:t,key:e||""}}n.d(t,"graphAddon",function(){return Mr});var Or=Object(jn.e)(function(){return Promise.resolve().then(n.bind(null,3725))},{chunkName:"graphaddondeferred"}),Mr=Object(i.t)(function(){return function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e(Object(dn.e)(function(){e(In);e(Object(f.r)(qe.e,L.e)(or));e(Object(f.r)(qe.e,cr.e)(pr));e(Object(f.r)(o.e,C.e)(j));e(Object(f.r)(o.e,k.e)(R));e(Object(f.r)(o.e,L.e)(x));e(Object(f.r)(o.e,qn.e)(Un));e(Object(f.r)(Ft.e,L.e)(Qn));e(Object(f.r)(u.e,L.e)(ae));e(Object(f.r)(de.e,$n.e)(Xn));e(Object(f.r)(qe.e,Zn.e)(er));e(Object(f.r)(de.e,vr.e)(mr));e(Object(s.o)(gr.e,pe.e)(wr));e(Object(f.r)(de.e,Jn.e)(Vn.e));e(Object(f.r)(de.e,Cr.e)(Tr));e(Object(f.r)(Ie,Cr.e)(Tr));e(Object(f.r)(de.e,q.e)(Lr));e(Object(f.r)(Ie,q.e)(Lr));e(lr)}));return[4,e(Object(a.o)({waitIndefinitely:!0}))];case 1:r.sent();r.label=2;case 2:r.trys.push([2,4,,5]);return[4,Or()];case 3:if(!(t=r.sent().graphAddonDeferred))throw new Error("Couldn't load extended Microsoft Graph features.");e(t);return[3,5];case 4:n=r.sent();e(Object(Mn.e)({error:n}));return[3,5];case 5:return[2]}})})}})},,,,function(e,t,n){"use strict";n.r(t);var r,i,s=n(0),o=n(19),u=n(64),a=n(12),f=n(394),l=new(n(11).e)("itemsBreadcrumbControl"),c=n(350),h=n(315),p=n(802),d=n(735),v=n(3),m=n(3489),g=n(4),y=n(2428),b=n(500),w=n(2856),E=n(3111),S=n(2738),x=n(1),T=n(2),N=n(290),C=n(2513),k=n(36),L=n(2180),A=n(7),O=n(25),M=n(172),_=n(2179),D=n(24),P=n(486),H=n(21),B=n(111),j=n(69),F=n(2750),I=n(13),q=n(2527),R=((r={})[j.r.started]=function(e){var t=e.count,n=e.isScheduled;return Object(H.formatToArray)(Object(H.getLocalizedCountValue)(n?q.e.schedulePublishStartedItemsTitle:q.e.publishStartedItemsTitle,q.e.publishCompletedItemsTitleIntervals,t)||"",t)},r[j.r.completed]=function(e){var t=e.count,n=e.isScheduled;return Object(H.formatToArray)(Object(H.getLocalizedCountValue)(n?q.e.schedulePublishCompletedItemsTitle:q.e.publishCompletedItemsTitle,q.e.publishCompletedItemsTitleIntervals,t)||"",t)},r[j.r.failed]=function(e){var t=e.count,n=e.isScheduled;return Object(H.formatToArray)(Object(H.getLocalizedCountValue)(n?q.e.schedulePublishFailedItemsTitle:q.e.publishFailedItemsTitle,q.e.publishFailedItemsTitleIntervals,t)||"",t)},r[j.r.canceled]=function(e){var t=e.count,n=e.isScheduled;return Object(H.formatToArray)(Object(H.getLocalizedCountValue)(n?q.e.schedulePublishFailedItemsTitle:q.e.publishFailedItemsTitle,q.e.publishFailedItemsTitleIntervals,t)||"",t)},r),U=((i={})[j.r.started]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(H.formatToArray)(Object(H.getLocalizedCountValue)(r?q.e.schedulePublishStartedItemsTitle:q.e.publishStartedItemsTitle,q.e.publishStartedItemsDestinationTitleIntervals,t)||"",t,x.createElement(F.e,{key:"link",itemKey:n}))},i[j.r.completed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(H.formatToArray)(Object(H.getLocalizedCountValue)(r?q.e.schedulePublishCompletedItemsDestinationTitle:q.e.publishCompletedItemsDestinationTitle,q.e.publishCompletedItemsDestinationTitleIntervals,t)||"",t,x.createElement(F.e,{key:"link",itemKey:n}))},i[j.r.failed]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(H.formatToArray)(Object(H.getLocalizedCountValue)(r?q.e.schedulePublishFailedItemsDestinationTitle:q.e.publishFailedItemsDestinationTitle,q.e.publishFailedItemsDestinationTitleIntervals,t)||"",t,x.createElement(F.e,{key:"link",itemKey:n}))},i[j.r.canceled]=function(e){var t=e.count,n=e.itemKey,r=e.isScheduled;return Object(H.formatToArray)(Object(H.getLocalizedCountValue)(r?q.e.schedulePublishFailedItemsDestinationTitle:q.e.publishFailedItemsDestinationTitle,q.e.publishFailedItemsDestinationTitleIntervals,t)||"",t,x.createElement(F.e,{key:"link",itemKey:n}))},i),z=Object(o.t)(function(){return function(e){e(Object(a.r)(C.e,P.e)(Object(a.t)()(W)))}});function W(){return function(e){return X}}function X(e,t){var n,r,i=Object(B.i)(e,t),o=i.phase,u=i.count,a=(function(e,t){var n=void 0,r=e.demandItemFacet(I.e,t.itemKey);if(r)for(var i=0,s=r.itemKeys;i<s.length;i++){var o=s[i],u=e.demandItemFacet(j.m,o),a=u&&u.itemKey,f=e.demandItemFacet(A.A,a),l=f&&f.itemKey;if(l)if(n){if(l!==n)break}else n=l}return n})(e,t),f=e.demandItemFacet(I.e,t.itemKey),l=f&&f.itemKeys;l&&l.length>0&&(r=e.demandItemFacet(C.t,l[0]));var c=!!r&&r.publishActionType===L.e.SchedulePublish;n="group"===t.format&&a?U[o]({count:u,itemKey:a,isScheduled:c}):R[o]({count:u,isScheduled:c});return Object(s.__assign)(Object(s.__assign)({},n&&"item"!==t.format?{title:n}:{}),{})}var V=n(15),$=n(1841),J=n(275),K=V.e.isActivated("991d2b61-3537-434c-8a72-45623f632435","1/13/2020","Use progress addon for publish")?Object(B.s)({operationTypeFacet:C.t,progressKeyFacet:C.e}):Object(B.s)({operationTypeFacet:C.t,progressKeyFacet:C.e,initializeBatch:function(){return z}}),Q=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.state={publishItemError:void 0};return n}t.prototype.componentDidMount=function(){var e=this.props,t=e.itemCacheDispatch,n=e.itemKeys,r=e.itemSetKey,i=e.resolve,s=e.reject,o=n[0],u=t(Object(O.e)(function(e){return e.demandItem({firstItemKey:v.D,displayName:A.f},n[0])})),a=u.firstItemKey,f=u.displayName,l=t(Object(O.e)(function(e){return _.n(e,o)})),c={publishActionType:l},h=!1;if(a){var p=t(Object(O.e)(function(e){return e.demandItemFacet(g.ye,v.U.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}))}));h=!!p&&p.templateType===D.t.webPageLibrary}if(a&&h&&l===L.e.SubmitForApproval){var d=V.e.isActivated("bb2acf46-d145-4ac4-9aed-542d0b2c2e0b","6/2/2020","FixPageUrlInLibSubFolder2"),m=d?"":new J.e(a.webAbsoluteUrl).authority,y=d?"":t(Object(O.e)(function(e){return e.demandItemFacet(g.Q,n[0])})),b=d?a.listFullUrl+"/"+f:""+m+y;window.location.href=b}else t(K({items:Object(k.e)(n,function(){return c})})).then(function(){var e,s;t(Object(M.t)({items:(e={},e[o]=[g.Mt],e[o]=[g.Ae],e)}));r&&t(Object($.e)({items:(s={},s[r]=Object(k.e)(n,function(){return{}}),s)}));i()}).catch(function(e){s(e)})};t.prototype.render=function(){return null};return t})(x.PureComponent),G=n(16),Y=n(9),Z=n(177),ee=n(46),te=n(860),ne=n(2153),re=n(20),ie=n(28),se=n(84),oe=Object(Y.t)()(Q),ue=Object(Y.t)(function(e,t){var n=t.onCancel,r=t.reject;return{onCancel:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){r(new Z.e);n&&n();return[2]})})},title:q.e.MissingMetadataDialogTitle,prompt:q.e.MissingMetadataDialogText,cancelText:q.e.MissingMetadataDialogButton}})(ne.e),ae=Object(Y.i)(function(e,t){var n=t.itemKeys,r=t.publishType,i=t.source;if(!n||!n.length)return null;var o=Object(se.e)(e),u=e.demandItem({firstItemKey:v.D,hasMissingMetadata:A.C},n[0]),a=u.firstItemKey,f=u.hasMissingMetadata;if(!a)return null;var l=a&&e.demandItemFacet(g.Et,v.Z.serialize({webAbsoluteUrl:a.webAbsoluteUrl,listFullUrl:a.listFullUrl}));if(l&&(l.isAnonymousGuestUser||l.isEmailAuthenticationGuestUser))return null;for(var c=!1,h=0,p=n;h<p.length;h++){var d=p[h];if(!(c=!!_.e(e,d)&&(te.t(e,d)?1===r:0===r)))break}var m=Object(re.o)(function(e){if(f){return x.createElement(ue,Object(s.__assign)({},e,{onCancel:function(e){}}))}return x.createElement(oe,Object(s.__assign)({},e,{itemKeys:n,itemSetKey:o}))});return x.createElement(ie.e,Object(s.__assign)({isAvailable:c,onExecute:m},Object(ee.e)(e,{itemKey:n[0],engagement:{name:"PublishItem",isIntentional:!0,extraData:{publishSource:i}}})))}),fe=Object(G.s)()(ae),le=n(229),ce=new T.e("Publish").id,he=new T.e("Schedule").id,pe=new Map([[L.e.Publish,N.e.Publish],[L.e.CancelApproval,N.e.CancelApproval],[L.e.SubmitForApproval,N.e.SubmitForApproval],[L.e.SchedulePublish,N.e.Schedule],[L.e.Republish,N.e.Republish]]),de=(function(e){Object(s.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this.props,t=e.defaultRender,n=e.itemKeys,r=Object(s.__rest)(e,["defaultRender","itemKeys"]),i=n[0];return x.createElement(le.e,null,function(e){var n=e.itemCache,o=Object(_.n)(n,i),u=pe.get(o)||N.e.Publish;return t?x.createElement(t,Object(s.__assign)({},r,{text:u})):null})};return t})(x.PureComponent),ve={key:ce,automationId:"PublishCommand",iconProps:{iconName:"ReadingMode"},name:N.e.Publish,action:x.createElement(fe,{publishType:0,source:"Command"}),commandBarButtonAs:Object(G.s)()(de)},me={key:he,automationId:"ScheduleCommand",iconProps:{iconName:"DateTime2"},name:N.e.Schedule,action:x.createElement(fe,{publishType:1,source:"Command"}),commandBarButtonAs:Object(G.s)()(de)},ge=n(2522),ye=n(587),be=n(507),we=n(725),Ee=n(115),Se=n(199),xe=n(492),Te=n(189),Ne=n(2848),Ce=n(2758),ke=n(2847),Le=function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return[2]})})},Ae=Object(G.e)()(Object(G.s)()(Object(Y.t)(function(e,t){var n,r,i,o=t.itemKey,u=t.itemKeys,a=t.enabledForMultipleItems,f=void 0===a?t.enabledForMultipleItems||!1:a,l=t.isEnabledFunc,c=t.url,h=!!f||1===u.length,p=void 0,d=void 0;if(h&&u[0]){var m=e.demandItem({key:v.D,permissions:g.Fe,rowData:g.$e},u[0])||void 0;if(m){d=m.key;p=m.rowData;i=m.permissions}}else if(h&&o){var y=e.demandItem({key:v.D,permissions:g.Fe},o);if(y){d=y.key;i=y.permissions}}n=d&&d.webAbsoluteUrl;r=d&&d.listFullUrl;var b=n&&r&&e.demandItemFacet(g.Et,v.Z.serialize({webAbsoluteUrl:n,listFullUrl:r}))||void 0;if(h&&!f)if("boolean"==typeof l)h=l;else if("function"==typeof l){var w="",E="",S="";if(p){var x=p;w=x.File_x0020_Type||"";E=x.ContentTypeId||"";S=x.ProgId||""}else h=!1;h=l({permissions:i||0,extension:w,contentTypeId:E,progId:S})}if(h&&c){var T=[];u.forEach(function(t){var n=e.demandItem({itemId:g.we,itemUrl:g.Q},t);n&&T.push({id:n.itemId||"",url:n.itemUrl||""})});b&&(c=Object(Ce.r)(c,T,b))}var N=Le;N=c&&"javascript:LaunchApp("===c.substring(0,21)&&");"===c.substring(c.length-2)?function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){c&&b&&Object(ke.e)(c,b);return[2]})})}:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(s.__generator)(this,function(t){(e=window.open(c,"_blank"))&&e.focus();return[2]})})};return Object(s.__assign)({isAvailable:h,onExecute:N},Object(ee.e)(e,{itemKey:u[0],engagement:{name:"CustomActionNavigation",isIntentional:!0}}))})(ie.e))),Oe=n(99),Me=n(62),_e=function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return[2]})})},De=Object(Y.i)(function(e,t){var n=t.itemKeys,r=t.enabledForMultipleItems,i=void 0===r?t.enabledForMultipleItems||!1:r,o=t.isEnabledFunc,u=t.commandAdapter,a=e.dispatch,f=!!i||1===n.length;if(f&&1===n.length&&"function"==typeof o){var l=e.demandItem({key:v.D,permissions:g.Fe,rowData:g.$e},n[0]),c="",h="",p="";if(l&&l.rowData){var d=l.rowData;c=d.File_x0020_Type||"";h=d.ContentTypeId||"";p=d.ProgId||""}else f=!1;f=f&&o({permissions:l&&l.permissions||0,extension:c,contentTypeId:h,progId:p})}if(f&&u){var m=[];n.forEach(function(t){var n=e.demandItemFacet(Te.u,t);n&&m.push(n)});u.refresh(m);f=f&&u.visible}var y=_e;u&&(y=function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){return[2,u.execute()]})})});var b=!V.e.isActivated("416CBFAD-51CE-4EFF-8231-D4EFCAC3DB3C","12/13/2019","Generate rowAdapter if not available");return x.createElement(x.Fragment,null,b?x.createElement(Pe,{dispatch:a,itemKeys:n}):null,x.createElement(ie.e,Object(s.__assign)({isAvailable:f,onExecute:y},Object(ee.e)(e,{itemKey:n[0],engagement:{name:"ClientSideCommandSet",isIntentional:!0}}))))}),Pe=function(e){var t=e.dispatch,n=e.itemKeys;if(n.length<1)return null;var r=n[0],i=void 0;if(v.D.matches(r)){var o=v.D.deserialize(r);if(o){var u=v.U.serialize({webAbsoluteUrl:o.webAbsoluteUrl,listFullUrl:o.listFullUrl});i=t(Object(Oe.e)({listViewAdapter:Te.o},u)).listViewAdapter}}var a={};if(i){n.forEach(function(e){var n=t(Object(Oe.e)({rowData:g.$e,rowAdapter:Te.u},e)),r=n.rowData;if(!n.rowAdapter&&r&&i){var o=i.createRowAdapter({values:r});o&&(a[e]=Object(s.__assign)({},Te.u.pack(o)))}});Object.keys(a).length>0&&t(Object(Me.e)({items:a}))}return null},He=Object(G.s)()(De),Be=n(712),je=n(94),Fe="customActionCommandIcon_ef18b8c0",Ie=n(61),qe=new T.e("customActionNavigationCommand").id;function Re(e){var t=e.key,n=e.name,r=e.url,i=e.iconUrl,s=e.enabledForMultipleItems,o=e.isEnabledFunc,u=e.commandAdapter;return{key:qe+"-"+t,automationId:"customactionNavigation",name:n,iconProps:{iconType:Be.e.image,className:Fe,imageProps:{src:i||"",imageFit:je.t.contain,className:Fe}},action:u?x.createElement(He,{enabledForMultipleItems:s,isEnabledFunc:o,commandAdapter:u}):r?x.createElement(Ae,{url:r,enabledForMultipleItems:s,isEnabledFunc:o}):void 0}}var Ue=new T.e("customActionGroupCommand").id;function ze(e,t){var n=[],r=e.demandItemFacet(I.e,t);r&&r.itemKeys&&r.itemKeys.forEach(function(t){var r,i,s,o,u=e.demandItem({displayName:A.f,openUrl:A.L,iconUrl:Ne.t,childItemKeys:I.e,enabledForMultipleItems:Ne.e,isEnabledFunc:Ne.n,commandAdapter:Te.i},t);if(u&&u.displayName){var a=u.displayName,f=u.openUrl,l=u.iconUrl,c=u.enabledForMultipleItems,h=u.isEnabledFunc,p=u.childItemKeys,d=u.commandAdapter;if(p&&p.itemKeys&&p.itemKeys.length>0){var v=[];p.itemKeys.forEach(function(n,r,i){var s=e.demandItem({subMenuDisplayName:A.f,openUrl:A.L,iconUrl:Ne.t,enabledForMultipleItems:Ne.e,isEnabledFunc:Ne.n,commandAdapter:Te.i},n);s&&s.subMenuDisplayName&&v.push(Re({key:t+"-"+n,name:s&&s.subMenuDisplayName,url:s&&s.openUrl,iconUrl:s&&s.iconUrl,enabledForMultipleItems:s&&s.enabledForMultipleItems,isEnabledFunc:s&&s.isEnabledFunc,commandAdapter:s&&s.commandAdapter}))});n.push((i=(r={key:t,name:a,subCommands:v}).key,s=r.name,o=r.subCommands,{key:Ue+"-"+i,automationId:"customActionGroupCommand",name:s,subMenuProps:{items:o}}))}else a&&n.push(Re({key:t,name:a,url:f,iconUrl:l,enabledForMultipleItems:c,isEnabledFunc:h,commandAdapter:d}))}});return n}function We(e){var t=e.keys,n=t.webAbsoluteUrl,r=t.listFullUrl,i=t.itemsScopeItemKey,s=e.itemCache,o=e.targetCustomActionSetKey,u=void 0,a=v.U.serialize({webAbsoluteUrl:n,listFullUrl:r}),f=s.demandItemFacet(Te.s,a),l=s.demandItemFacet(g.We,o),c=!!f&&!!l;if(c){var h=v.s.serialize({webAbsoluteUrl:n,listFullUrl:r,isSPFXandCustomActionsAvailable:c,targetCustomActionSetKey:o,itemsScopeItemKey:i});s.demandItemFacet(I.e,h)&&(u=h)}return u}var Xe=n(391),Ve=n(571),$e=n(253),Je=n(1132),Ke=n(3749),Qe=n(2792),Ge=n(3522),Ye="keyboardMapGroup_61a4d558",Ze="keyboardMapTable_61a4d558",et="keyboardMapRow_61a4d558",tt="keyboardMapKey_61a4d558",nt="keyboardMapVal_61a4d558",rt=n(2460),it=n(313),st=[{keys:"Ctrl + a",desc:$e.e.selectAllDesc},{keys:"Ctrl + d",desc:$e.e.deselectAllDesc},{keys:"esc",desc:$e.e.escDesc},{keys:"space",desc:$e.e.spaceDesc},{keys:"enter",desc:$e.e.enterDesc}],ot=[{keys:"F2",desc:$e.e.renameDesc},{keys:"Delete",desc:$e.e.deleteDesc},{keys:"s",desc:$e.e.showShareDesc},{keys:"alt + up",desc:$e.e.altUpDesc},{keys:"?",desc:$e.e.showKeymapDesc},{keys:"g",desc:$e.e.showActionDetailsDesc},{keys:"i",desc:$e.e.toggleInfoDesc}];function ut(e){var t=e.resolve,n=Object(it.e)(function(){t()}),r=[st,ot],i=-1,s=-1;return x.createElement(rt.e,null,x.createElement(Ke.e,{onDismiss:n,hidden:!1,dialogContentProps:{type:Qe.e.close,title:$e.e.KeyboardMapTitle},styles:ft},r.map(function(e){return x.createElement("div",{className:Ye,key:"keyMap"+ ++i},x.createElement("ul",{className:Ze,key:""+i},e.map(function(e){return x.createElement("li",{className:et,key:""+ ++s},x.createElement("span",{className:tt,key:i+"."+s+".0.0"},e.keys),x.createElement("span",{className:nt,key:i+"."+s+".1.1"},e.desc))})))}),x.createElement(Ge.e,null,x.createElement(Je.e,{onClick:n},$e.e.okButtonText))))}var at=Object(Y.i)(function(e){var t=Object(re.o)(ut);return x.createElement(ie.e,{onExecute:t})});function ft(){return{main:{maxWidth:"700px !important"}}}var lt={key:new T.e("ShowKeymapShortcut").id,automationId:"ShowKeymapShortcut",shortcutProps:{keySequences:["Shift/"],content:$e.e.showKeymapDesc},action:x.createElement(at,null)},ct=n(346),ht=Object(Y.i)(function(e,t){var n=t.itemKey,r=e.demandItemFacet(A.A,n),i=r&&r.itemKey;return x.createElement(ct.e,{itemKey:i})}),pt=Object(G.i)()(ht),dt={key:new T.e("NavigateUpShortcut").id,automationId:"NavigateUpShortcut",shortcutProps:{keySequences:["AltUp"],content:$e.e.altUpDesc},action:x.createElement(pt,null)},vt=Object(Y.i)(function(e,t){return x.createElement(ie.e,{onExecute:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(s.__generator)(this,function(n){e=null;t.selector?e=document.querySelector(t.selector):t.elementId&&(e=document.getElementById(t.elementId));if(e){e.focus();t.shouldClick&&e.click&&e.click()}return[2]})})},engagement:{name:"SetFocus",isIntentional:!0}})}),mt={key:new T.e("GetNPSSurveyFocusShortcut").id,automationId:"GetNPSSurveyFocusShortcut",shortcutProps:{keySequences:["AltDown"],content:$e.e.getNPSSurveyFocusShortcut},action:x.createElement(vt,{elementId:"obf-TPromptContainer"})},gt=n(2272),yt=n(889),bt=n(3104),wt=n(2860),Et=n(3137),St=n(59),xt=n(289),Tt=n(50),Nt=n(48),Ct=n(2855),kt=n(433),Lt=n(181),At={ODB:1544},Ot=[ge.t,ge.e,ge.r],Mt=[lt,dt,mt],_t={ODB:1231},Dt="658D384B-C862-48CC-986B-F1CD32B00BFE",Pt="9cf4436a-b8a9-4b05-a921-e34436841ba3",Ht=Object(a.t)()(It),Bt=Object(a.t)()(It),jt=function(e,t){var n=Object(s.__rest)(w.e,[]);if(e&&e.open&&e.open.length>0){n.subMenuProps=n.subMenuProps||{};n.subMenuProps.items=Object(gt.t)(n.subMenuProps&&n.subMenuProps.items||[],e.open,t);!V.e.isActivated("BC85A80B-0AA5-41F5-98B6-C875D1773EE5","12/9/2019","Log engagement for open menu for promoted file handler")&&e.open.some(function(e){return e.isPromoted||!1})&&(n.engagement={name:"OpenCommand",isIntentional:!0,extraData:{hasPromotedFileHandler:!0}})}return n};function Ft(e,t){var n,r,i=t.itemKey,o=t.itemSetKey,u=t.commands,a=t.overflowCommands,f=t.farCommands,l=t.shortcutCommands,c=e.demandItemFacet(v.D,i),h=e.demandItemFacet(v.S,o),p=a?Object(s.__spreadArrays)(a):[],d=!0,m=!1,x=void 0,T=void 0,N=void 0,C=u?Object(s.__spreadArrays)(u):[],k=f,L=[],A="",O=c&&v.U.serialize(c),M=e.demandItemFacet(v.U,O);h&&h.viewKey&&(A=h.viewKey.viewId);var _,P,H,B=[],j=!1;if(c&&M){j=Object(yt.t)(e,i,c);var F=e.demandItemFacet(g.ye,O);d=!!F&&!!F.isDocumentLibrary;_=Object(Nt.e)(e,i);if(d)L=l?Object(s.__spreadArrays)(l,Mt):Object(s.__spreadArrays)(Mt);else{C=Object(y.e)(_);L.push(mt)}if(!(m=!!F&&F.templateType===D.t.mySiteDocumentLibrary)){d&&p.push.apply(p,Ot);p&&p.push(Object(Ct.e)({listFacets:F}));var q={webAbsoluteUrl:M.webAbsoluteUrl,listFullUrl:M.listFullUrl},R=v.z.serialize(q),U=e.demandItemFacet(I.e,R);if(U&&U.itemKeys&&f){!A&&_&&_.viewId&&(A=Ee.e.normalizeLower(_.viewId,!1));r=e.demandItemFacet(g.Me,O);k=(P=f,H=Object(E.e)(e,{viewKeys:U.itemKeys,webAbsoluteUrl:c.webAbsoluteUrl,listViewSetKey:q,itemSetKey:o,currentViewKey:v.oe.serialize({viewId:A})}),P.map(function(e){return e.key===xe.e.key?H:e}))}}F&&M&&(B=(n=Object(Et.e)(e,{key:c,listFacets:F,listKey:M,pageContext:_})).contentTypes,x=n.contentTypeCommands);T=(function(e,t){var n=t.webAbsoluteUrl,r=t.listFullUrl,i=Object(Ie.e)(e).itemsScopeItemKey,o=v.i.serialize({webAbsoluteUrl:n,listFullUrl:r,itemsScopeItemKey:i}),u=v.u.serialize({webAbsoluteUrl:n,listFullUrl:r,itemsScopeItemKey:i}),a=We({itemCache:e,targetCustomActionSetKey:u,keys:{webAbsoluteUrl:n,listFullUrl:r,itemsScopeItemKey:i}}),f=[];if(V.e.isActivated("B03860D4-606B-4112-A032-481939B2D004","4/22/2020","single custom action set")){var l=e.demandItemFacet(I.e,o);if(l&&l.itemKeys){var c=Object(s.__spreadArrays)(l.itemKeys);a&&c.push(a);for(var h=0,p=c;h<p.length;h++){var d=p[h];f=f.concat(ze(e,d))}}}else{f=ze(e,u);a&&(f=f.concat(ze(e,a)))}return f})(e,c);_&&F&&(N=Object(wt.e)(e,{isODB:m,key:c,listFacets:F,pageContext:_}).fileHandlerCommands)}var z=Object(Tt.e)(e,{enableQuickEdit:g.F}).enableQuickEdit,W=!!_&&!!z&&Object(St.e)(e,{feature:_t,pageContext:_});if(W){var X=Object(Ie.e)(e).itemsScopeItemKey;if(Object(Lt.e)(e,{itemsScopeItemKey:X})===xt.e)return{commands:[Object(we.t)(_)],overflowCommands:[],farCommands:[],shortcutCommands:[]}}var $=(function(e,t){for(var n=t.quickEditEnabled,r=t.defaultCommands,i=t.isDocumentLibrary,s=t.isODB,o=t.contentTypeCommands,u=t.customActionCommands,a=t.fileHandlerCommands,f=t.newDocumentTemplates,l=t.contentTypes,c=t.isCreateFolderAvailable,h=t.listKey,p=t.pageContext,d=[],v=!V.e.isActivated(Dt,"7/5/2019","Show file handler commands before OOB commands"),m=!V.e.isActivated(Pt,"3/9/2020","Show publish command"),g=Object(be.e)(p),y={},E=0,x=r;E<x.length;E++){var T=x[E];y[T.key]=T}for(var N=0,C=r;N<C.length;N++){if((T=C[N]).key===Se.e.key){var k=Object(bt.e)(e,{contentTypes:l,newCommandMenu:T,fileHandlerCommands:a,isCreateFolderAvailable:c,newDocumentTemplates:f,contentTypeCommands:o,listKey:h}).visibleNewCommands;d.push(k)}else if(T.key===kt.e.key&&n&&!y[g.key])d.push(T,g);else if(T.key===w.e.key){var L=jt(a,v);d.push(L)}else if(T.key===Xe.t.key&&i&&!y[ye.e.key])d.push(T,ye.e);else if(T.key===Ve.e.key&&i){d.push(T);s||y[b.e.key]||d.push(b.e);d.push(S.t,S.e)}else if(T.key===Xe.n.key){!i&&Object(St.e)(e,{feature:At,pageContext:p})?d.push(Xe.e):d.push(T);m&&d.push(ve,me)}else d.push(T)}u&&u.length>0&&d.push.apply(d,u);a&&a.custom&&a.custom.length>0&&(d=Object(gt.t)(d,a.custom));return{overrideDefaultCommands:d}})(e,{defaultCommands:C,isDocumentLibrary:d,isODB:m,contentTypeCommands:x,customActionCommands:T,fileHandlerCommands:N,newDocumentTemplates:r,contentTypes:B,isCreateFolderAvailable:j,quickEditEnabled:W,listKey:c,pageContext:_});return{commands:C=$.overrideDefaultCommands,overflowCommands:p,farCommands:k,shortcutCommands:L}}function It(){return function(e){return function(e,t){return Ft(e,t)}}}var qt=n(2429),Rt=n(398),Ut=n(963),zt=n(961),Wt=n(580),Xt=n(522),Vt=n(54),$t=n(31),Jt={ODB:1544},Kt=Object(a.t)()(function(){return function(e){return function(t,n){var r,i=n.itemKey,o=n.commands,u=t.demandItemFacet(v.D,i);if(u){var a=v.U.serialize(u);r=t.demandItemFacet(g.ye,a)}var f=o?Object(s.__spreadArrays)(o):[];f.push(S.t,S.e);var l=void 0;if(u){var c=u.listFullUrl,h=u.webAbsoluteUrl,p=Object(ge.i)({listFacets:r}),d=t.demandItemFacet(g.Et,v.Z.serialize({webAbsoluteUrl:h,listFullUrl:c}));if(r&&!r.isDocumentLibrary){f=[y.t];for(var m=0,w=Object(y.e)(d);m<w.length;m++){var E=w[m];E.key===Xe.n.key&&Object(St.e)(t,{feature:Jt,pageContext:d})?f.push(Xe.e):E.key!==b.e.key&&f.push(E)}}f.push(p);var x=v.n.serialize({webAbsoluteUrl:h,listFullUrl:c}),T=We({itemCache:t,targetCustomActionSetKey:x,keys:{webAbsoluteUrl:h,listFullUrl:c,itemsScopeItemKey:Object(Ie.e)(t).itemsScopeItemKey}});f=f.concat(ze(t,x));T&&(f=f.concat(ze(t,T)));if(d&&r&&(r.templateType===D.t.documentLibrary||r.templateType===D.t.mySiteDocumentLibrary)){var N=new J.e(h||c).authority+"/_api/v2.0",C=Rt.t.serialize({endpoint:N});l=Object(gt.e)(t,{itemKey:C})}}var k=!V.e.isActivated(Dt,"7/5/2019","Show file handler commands before OOB commands");return{commands:Qt(f,l,r&&r.templateType===D.t.mySiteDocumentLibrary,k),onMenuOpened:function(){e(function(e){var t=(e(Object(Vt.e)({spLoggerConfiguration:$t.u})).spLoggerConfiguration||{}).scenarioId,n=void 0===t?"":t;e(Xt.t(n))})}}}}});function Qt(e,t,n,r){for(var i=[],s=0,o=e;s<o.length;s++){var u=o[s],a=u.key;if(a===w.e.key){var f=t&&t.open||[];f.length>0&&qt.t.subMenuProps&&(qt.t.subMenuProps.items=Object(gt.t)(qt.t.subMenuProps.items,f,r));i.push(qt.t)}else{i.push(u);a===Ve.e.key?i.push(zt.e):a===Wt.e.key&&!1===n&&i.push(Ut.e)}}return t&&t.custom&&t.custom.length>0?Object(gt.t)(i,t.custom):i}var Gt=n(29),Yt=n(447),Zt=Object(a.t)()(function(){return function(e){return function(e,t){var n=Object(se.e)(e),r=(function e(t,n,r){var i=n,o=r;if(n&&r){var u=t.demandItem({spGroupField:g.ct,groupValue:g.se,parentGroupKey:g.je,groupFilterByValue:g.ne},n),a=u.spGroupField,f=u.groupValue,l=u.parentGroupKey,c=u.groupFilterByValue;l&&(o=e(t,l.itemKey,r));var h=t.demandItemFacet(v.S,o);if(h){var p=t.demandItemFacet(v._,n),d=Object(Yt.e)(Object(s.__assign)(Object(s.__assign)({},h),p?{viewKey:p.viewKey}:{})),m=c||f;void 0!==m&&a&&a.internalName&&a.fieldType&&(i=d({filterField:a.internalName,filterValues:[m],filterType:a.fieldType,useLookupId:!1}))}}return i})(e,t.itemKey,n),i=e.demandItem({parentItem:I.i},n).parentItem,o=(function(e){var t=this,n=e.stageItem,r=e.parentItemKey;return n?Object(Gt.t)(function(e){var i=e.itemsScopeItemKey,o=e.currentItemKey;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t;return Object(s.__generator)(this,function(u){switch(u.label){case 0:r&&e(Object(Me.e)({items:(t={},t[o]=Object(s.__assign)({},I.i.pack({itemKey:r})),t)}));return[4,e(n({currentItemKey:o,itemsScopeItemKey:i}))];case 1:u.sent();return[2]}})})}}):void 0})({parentItemKey:i&&i.itemKey,stageItem:t.stageItem});return r?Object(s.__assign)({itemKey:r},o?{stageItem:o}:{}):{}}}});var en=n(74),tn=new en.e("siteTargetDocumentLibraryItem",function(e,t){var n=t.itemKey,r=e.demandItemFacet(I.t,n),i=r&&r.itemKey,s=e.demandItemFacet(I.e,i),o=s&&s.itemKeys;if(o&&1===o.length)return{itemKey:o[0]}}),nn=Object(a.t)()(function(){var e=this;return function(){return function(t,r){var i=r.itemKey,o=r.stageItem,u=t.demandItemFacet(tn,i,{suppressGetItems:!0});return Object(s.__assign)({},u?{itemKey:u.itemKey}:{stageItem:function(t){return function(r){return Object(s.__awaiter)(e,void 0,void 0,function(){var e,i,u,a,f,l;return Object(s.__generator)(this,function(c){switch(c.label){case 0:u=[Object(s.__assign)({},t)];return(a=o)?[4,r(o(t))]:[3,2];case 1:a=c.sent();c.label=2;case 2:e=s.__assign.apply(void 0,u.concat([a||{}])).currentItemKey,i=void 0===e?t.currentItemKey:e;return[4,Promise.resolve().then(n.bind(null,1538))];case 3:f=c.sent().demandItems;return[4,r(f(function(e){return e.demandItemFacet(tn,i)}))];case 4:return(l=c.sent())?[2,{currentItemKey:l.itemKey}]:[2]}})})}}})}}});var rn=n(135),sn=n(742),on=n(204),un=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.createOpenItem,r=t.rootItemKey,i=t.itemKey,s=Object(se.e)(e),o=void 0;if(r){var u=e.demandItemFacet(v.D,r);u&&(o=v.D.serialize(u))}return{getBreadcrumbItems:function(){var t=[],u={},a=e.demandItemFacet(v.S,s),f=a&&a.filterParams,l=e.demandItemFacet(g.ot,s),c=l&&l.filterList;!l&&f&&(c=rn.default.getFilterList(f,void 0,!0));if(c&&c.length&&f)for(var h=c.length-1;h>=0;h--){var p=c[h],d=p.values.map(function(e){return e||on.e.EmptyFilterOptionLabel}),m=rn.default.formatBreadcrumbFilterValues(d,p.type||"",{booleanFalse:on.e.booleanFalse,booleanTrue:on.e.booleanTrue}),y=an(f,c,h+1),b=(w=Object(sn.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:y}))?v.S.serialize(w):i;t.unshift({key:p.fieldName,text:m,onClick:n&&b?n(b):void 0})}for(;i&&!u[i];){u[i]=!0;var w,E=e.demandItem({displayName:A.f,parentFolder:A.A},i),S=E.displayName,x=E.parentFolder;b=(w=Object(sn.e)(e,{folderItemKey:i,currentItemSetKey:s,newFilterParams:""}))?v.S.serialize(w):i;t.unshift({key:i,text:S||"",onClick:n&&b?n(b):void 0});if(r&&(r===i||o===i))break;i=x&&x.itemKey||""}return t}}}}});function an(e,t,n){for(var r=n=n||0;r<t.length;r++){var i=t[r];e=rn.default.addFilterInfo(e,i.fieldName,"",!0)}return e}var fn=n(58),ln=n(934),cn=n(320),hn=n(274),pn=n(270),dn=hn.e.serialize({}),vn={key:new T.e("uploadToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(hn.t,dn),i=r&&r.draggedItem,s=!i||i.type===pn.t,o=e.demandItemFacet(fn.s,n);return{action:s&&o?x.createElement(ln.e,{itemKey:n}):void 0}},canHandleEvent:function(e){return function(t){return e.event&&e.event&&Object(cn.n)(e.event)||!1}}},mn=n(2749),gn={isAvailable:!1,onExecute:void 0},yn=Object(Y.t)(function(e,t){var n=t.itemKeys,r=t.groupKey;if(!(!!e.demandItemFacet(v._,r)&&n&&n.length>0))return gn;var i=e.demandItem({childItems:I.e},r).childItems,o=i&&i.itemKeys||[],u=!!e.demandItemFacet(v._,o[0]);if(0===o.length||u)return gn;var a=n.filter(function(e){return!o.some(function(t){return t===e})});if(0===a.length)return gn;var f=a[0],l=e.dispatch;return Object(s.__assign)({isAvailable:!0,onExecute:function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(s.__generator)(this,function(t){e={groupKey:r};return[2,l(Object(mn.t)({items:Object(k.e)(n,function(){return e})}))]})})}},Object(ee.e)(e,{itemKey:f,engagement:{name:"Move",isIntentional:!0}}))})(ie.e),bn=hn.e.serialize({}),wn={key:new T.e("moveToGroupDefaultDropActionHandler").id,evaluate:function(e,t){var n=t.itemKey,r=e.demandItemFacet(fn.s,n),i=e.demandItemFacet(hn.t,bn),s=i&&i.draggedItem;return{action:(!s||s.type===pn.e)&&r?x.createElement(yn,{itemKeys:s&&s.itemKeys||[],groupKey:n}):void 0}},canHandleEvent:function(e){return function(t){if(e&&e.event){var n=e.event.dataTransfer;return n&&n.type===pn.e||!1}return!1}}},En=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.handlers;return{handlers:Object(s.__spreadArrays)([vn,wn],n||[])}}}});var Sn=n(51),xn=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItem({key:v._,isDropEnabled:fn.i},n),i=r.key,s=r.isDropEnabled,o=i&&i.itemSetKey&&v.D.serialize(i.itemSetKey),u=o&&e.demandItemFacet(g.Fe,o),a=Sn.e.hasItemPermission({permissions:u},Sn.e.insertListItems);if(a){var f=i&&i.itemSetKey&&e.demandItemFacet(g.ye,v.U.serialize({webAbsoluteUrl:i.itemSetKey.webAbsoluteUrl,listFullUrl:i.itemSetKey.listFullUrl}));a=!!s&&!!f&&!!f.isDocumentLibrary&&f.templateType!==D.t.webPageLibrary}return{isAvailable:a}}}});var Tn=n(2862),Nn=n(126),Cn=Object(Y.t)()(Object(Nn.e)(function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("dot_contenttypenavigationcreator").then(n.bind(null,3630))];case 1:return[2,e.sent().ContentTypeNavigationCreator]}})})})),kn=Object(Y.i)(function(e,t){var n,r=t.itemKey,i=e.demandItemFacet(v.D,r),o=!1;if(i&&(n=e.demandItemFacet(g.Et,v.Z.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})))&&!n.isAnonymousGuestUser){var u=e.demandItemFacet(g.Fe,r);o=Sn.e.hasItemPermission({permissions:u},Sn.e.insertListItems)}var a=Object(re.o)(function(e){return x.createElement(Cn,Object(s.__assign)({},e,t,{pageContext:n}))});return x.createElement(ie.e,Object(s.__assign)({isAvailable:o,onExecute:a},Object(ee.e)(e,{itemKey:r,engagement:{name:"ContentTypeNavigation",isIntentional:!0}})))}),Ln=Object(G.i)()(kn),An=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=v.g.deserialize(n);return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u;return Object(s.__generator)(this,function(a){t=e(Object(Oe.e)({listFacets:g.ye},v.U.serialize(r.listKey))).listFacets;i=v.q.serialize({listKey:{webAbsoluteUrl:r.listKey.webAbsoluteUrl,listFullUrl:r.listKey.listFullUrl},contentTypeId:r.contentTypeId});o=!!t&&t.openInClient;e(Object(Me.e)({items:(u={},u[n]=Object(s.__assign)({},g.t.pack(function(){return x.createElement(Ln,{contentTypeId:r.contentTypeId,openInClient:o,contentTypeKey:i})})),u)}));return[2]})})}});var On=n(146),Mn=n(427),_n=n(247),Dn=n(1375),Pn=n(56),Hn=Object(o.i)()(function(e){var t=this,n=v.ee.deserialize(e.itemKey),r=n.webAbsoluteUrl,i=n.listFullUrl;return function(n){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f,l;return Object(s.__generator)(this,function(c){t=n(Object(Oe.e)({pageContext:g.Et},v.Z.serialize({webAbsoluteUrl:r,listFullUrl:i}))).pageContext;o=n(Object(_n.n)({webAbsoluteUrl:r,listFullUrl:i})).hasTokenProvider;if(t){u=o?void 0:function(e){return n(Object(_n.e)({url:e}))};a=new Dn.e({},{pageContext:t,getAuthToken:u});(f=new Pn.e).resolveItems({items:(l={},l[e.itemKey]=Object(s.__assign)({},g.Tt.pack(a)),l)});n(f.execute())}return[2]})})}});var Bn=n(2835),jn=n(503),Fn=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.itemKeys;if(e.demandItemFacet(g.ke,n,{suppressGetItems:!0}))return{isAvailable:!1};for(var i=0,s=r;i<s.length;i++){var o=s[i];if(e.demandItemFacet(g.ke,o,{suppressGetItems:!0}))return{isAvailable:!1}}return{}}}});var In=Object(o.t)(function(){return function(e){e(Object(a.r)(v.D,jn.e)(Fn))}}),qn=n(2864),Rn=n(1558),Un=n(2863),zn=Object(o.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.childItemKey;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r,i,o,u,a,f,l,c,h,p,d,m,y,b,w,E,S,x,T;return Object(s.__generator)(this,function(N){r=e(Object(Oe.e)({deserializedItemKey:v.D,displayName:A.f},n)),i=r.deserializedItemKey,o=r.displayName;if(i&&o){u=e(Object(Oe.e)({contentTypeKeys:g.h},t)).contentTypeKeys;a=[];u&&u.length&&u.forEach(function(t){var n=e(Object(Oe.e)({contentType:g.bt},t)).contentType;n&&a.push(n)});f=a.length?a[0].contentTypeId:void 0;l=o.replace(/\.[^.]+$/,"");if(!(c={contentTypeId:f,isUpload:!0,templateId:l,title:l,url:i.itemId,visible:!0}).url)throw new Error("No template URL to save.");if((h=e(Object(Oe.e)({defaultView:g.g},t)).defaultView)&&h.viewKey){p=h.viewKey;d=e(Object(Oe.e)({existingTemplates:g.Me},t)).existingTemplates,m=void 0===d?[]:d;(y=Object(s.__spreadArrays)(m)).length||(b=e(Object(Oe.e)({newCommands:Un.e},t)).newCommands)&&b.forEach(function(e){var t=e.contentTypeId,n=e.isContentType,r=e.templateId,i=e.title,s=e.visible;y.push({contentTypeId:t,isContentType:n,templateId:r,title:i,visible:s})});y.filter(function(e){return e.url===c.url}).length>0||y.push(Object(s.__assign)({},c));w=v.U.deserialize(t);E=v.V.serialize({templateUrl:c.url,listKey:w});e(Object(Me.e)({items:(S={},S[t]=Object(s.__assign)({},g.Me.pack(y)),S[E]=Object(s.__assign)({},g.Oe.pack(c)),S)}));return[2,e(Object(Rn.e)({items:(x={},x[v.z.serialize({webAbsoluteUrl:i.webAbsoluteUrl,listFullUrl:i.listFullUrl})]={views:(T={},T[p]={newDocumentTemplatesJsonString:JSON.stringify(y)},T),qosName:"saveNewTemplatesToDefaultView"},x)}))]}}return[2]})})}}),Wn=n(743),Xn=n(2511),Vn=n(821),$n=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(g.ke,n,{suppressGetItems:!0}),i=e.demandItemFacet(Vn.e,n);return{isAvailable:!!r||!!i}}}});var Jn=Object(o.t)(function(){return function(e){e(Object(a.r)(v.D,Wn.e)($n));e(Object(u.o)(v.D,Xn.e)(Object(o.r)(function(){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(e){switch(e.label){case 0:return[4,n.e("dotdot_dotdot_dotdot_handlers_operations_addtoonedrive_removefromonedriveoperationhandler").then(n.bind(null,3815))];case 1:return[2,e.sent().removeFromOneDriveOperationHandler]}})})})))}}),Kn=Object(o.i)({mergeForSameItemKey:!1})(function(e){var t=e.itemKey,n=e.options.templates;return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){var r;return Object(s.__generator)(this,function(i){e(Object(Me.e)({items:(r={},r[t]=Object(s.__assign)({},g.Me.pack(n)),r)}));return[2]})})}}),Qn=n(723),Gn=n(132),Yn=n(232),Zn=n(2865),er=n(180),tr=n(1945),nr=n(565),rr=n(968),ir=n(39);function sr(e,t){return{enableItemHoverCard:!1}}var or=Object(Y.t)(function(e,t){var n=ar(e,t.itemSetKey);return{customFormatterFeature:n&&e.demandItemFacet(Gn.n,Gn.t.serialize({})),viewFormatter:n,dispatch:e.dispatch,isDefaultCardEnabled:Object(St.e)(e,{feature:{ODB:1615}}),cardDesignerFeatureEnabled:Object(rr.e)(e)}})(function(e){Object(x.useEffect)(function(){r&&r.isTileFormatterAvailable()&&0===f&&e.dispatch(Object(Yn.e)({name:"CustomFormatterTileLoad",isIntentional:!0}))},[]);var t=e.defaultRender,n=e.customFormatterFeature,r=e.viewFormatter,i=e.isDefaultCardEnabled,o=e.cardDesignerFeatureEnabled,u=Object(s.__rest)(e,["defaultRender","customFormatterFeature","viewFormatter","isDefaultCardEnabled","cardDesignerFeatureEnabled"]);if(!t)return null;var a=n&&n.tileRenderer,f=u.selectionIndex,l=u.itemKey,c=u.itemSetKey,h=void 0===c?"":c;if(r&&r.isTileFormatterAvailable()&&a){var p=r.shouldHideSelectionInTiles(),d=r.getTileFormatter(),v=x.createElement(t,Object(s.__assign)({},u,o?{href:void 0,invokeSelection:!1}:{},{className:Object(ir.e)(u.className,"customTile_3e20ef37"),itemName:null,itemActivity:null,foreground:null,isSelectable:!p,selection:p?void 0:u.selection,selectionIndex:p?-1:u.selectionIndex,background:x.createElement(a,{rowIndex:f,itemKey:l,itemSetKey:h,formatter:d})}));return i&&d?x.createElement(er.t,{controlHandlers:tr.t.pack(sr)},v):v}return x.createElement(t,Object(s.__assign)({},u))}),ur=new en.e("generatedViewFormatter",function(e,t){var n=t.itemKey;if(e.isItemFacetResolved(g.Se,n)&&n){var r=Object(Zn.e)(e,{itemSetKey:n}),i=e.demandItemFacet(Gn.n,Gn.t.serialize({})),s=e.demandItemFacet(v.S,n);if(s&&r&&i){var o=e.demandItemFacet(g.ye,v.U.serialize(s)),u=Object(nr.t)(e,{mapping:{fieldData:g.W},itemSetKey:n}),a=Object(St.e)(e,{feature:{ODB:522}}),f=Object(St.e)(e,{feature:{ODB:1822}}),l=u.map(function(e){return e.fieldData}),c=o&&o.templateType||D.n.invalidType,h=l&&l.length>0&&c===D.n.genericList,p=Object(Qn.e)({formatter:void 0,fields:l,generatedTileProps:h?i.tileDesigner.createDefaultTileProps(l,a):void 0,columnFormatterReferenceProps:{columnFormatterReferenceEnabled:f}});if(p)return p.viewFormatter}}});function ar(e,t){if(t){var n=e.demandItemFacet(g.Pt,Object(Zn.e)(e,{itemSetKey:t})),r=n&&n.viewFormatter,i=r&&r.getTileProps();i&&i.formatter&&i.formatter||!Object(rr.e)(e)||(r=e.demandItemFacet(ur,t));return r}}var fr=n(969),lr=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemSetKey;return n&&Object(St.e)(e,{feature:{ODB:1294}})?(function(e,t){var n=ar(e,t);if(!(n&&n.isTileFormatterAvailable()))return{};var r=(function(e){var t=254,n=340,r=e&&e.getTileProps(),i=r&&r.width&&r.width>=0?r.width:t;return{height:r&&r.height&&r.height>=0?r.height:n,width:i,disableMarqueeSelection:r&&r.hideSelection}})(n),i=r.height,s=r.width,o=r.disableMarqueeSelection;return{tileRenderer:or,grid:{minRowHeight:i},disableMarqueeSelection:o,tileControlHandler:function(){return{desiredSize:{width:s,height:i}}}}})(e,n):Object(Tt.e)(e,{enableMediaTilesInDocumentGroup:g.O}).enableMediaTilesInDocumentGroup?{tileControlHandler:fr.e}:{}}}});var cr=n(809),hr=n(730),pr=n(22),dr=n(956),vr=n(3508),mr=n(210),gr=n(483),yr=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=Object(Nt.e)(e,n),i=r&&(r.env2||r.env);return{initializeShareFrame:function(e){var t=e.parentElement,n=e.calloutProps,r=e.sharingInformation,o=e.onError,u=n.defaultRecipients,a=n.itemName,f=n.locale,l=n.mode,c=n.openManageAccess,h=n.theme,p=n.getClientId,d=r.authToken,v=r.isListSharing,m=r.listId,g=r.serverRelativeItemUrl,y=r.shareItemKey,b=r.webAbsoluteUrl,w={authToken:d||"",clientId:p(),defaultRecipients:u,itemName:a,mode:Number(l),theme:h||Object(mr.t)(),webAbsoluteUrl:b||""},E={};if(y&&dr.e.matches(y)){var S=dr.e.deserialize(y);E={listId:S.listId,uniqueId:S.uniqueId,webAbsoluteUrl:S.webAbsoluteUrl}}else{E={isListSharing:v,itemUrl:""+new gr.e(b).authority+g,listId:m}}new vr.e({element:t,environment:i||pr.e.prod,locale:f,context:Object(s.__assign)(Object(s.__assign)({},w),E),options:{onError:o,openManageAccess:c}}).initializeUI()}}}}});var br=n(831),wr=n(2867),Er=n(71),Sr=n(2852),xr=Object(a.t)()(function(){return function(e){return function(t,n){var r=n.itemKey,i=t.demandItemFacet(v.D,r),s=i&&v.Z.serialize(i),o=t.demandItemFacet(g.Et,s),u=t.demandItemFacet(g._t,r),a=t.demandItemFacet(A.i,r),f=i&&i.listFullUrl,l=i&&i.webAbsoluteUrl,c=t.demandItemFacet(A.h,r);return{checkInAction:x.createElement(Sr.e,{checkInOutType:"checkIn"}),undoCheckOutAction:x.createElement(Sr.e,{checkInOutType:"undoCheckOut"}),onDismiss:function(t,n){var r=e(Object(_n.n)({webAbsoluteUrl:l||"",listFullUrl:f})).dataRequestor,i={ListId:o&&o.listId,ListItemUniqueId:u,Operation:"RecommendationActedOn",AffectedResourceUrl:a,ItemType:"File",json:JSON.stringify({FileName:c&&c.name,Scenario:"RecommendedActions",SourceRelativeUrl:f,DismissRecommendationsCategory:"FocusedTask",PositionNumber:(n+1).toString(),TotalRecommendationsPresented:"3",RecommendationAlgorithmVersion:"1",ReferringCorrelationId:t,Canvas:"Web",Workload:"SharePoint",WebId:o&&o.webId,SiteId:o&&o.siteId,SiteUrl:o&&o.siteAbsoluteUrl,ClientLocalTime:(new Date).toISOString(),SourceFileName:c&&c.name,SourceFileExtension:c&&c.extension,ClientUTCOffsetInMinutes:(new Date).getTimezoneOffset().toString(),RecommendationId:t,ActionType:"Dismiss"})},s=new Er.t(l+"/_api/web/ActivityLogger/FeedbackDirect");r.getData({url:s.toString(),qosName:"DismissActions",method:"POST",needsRequestDigest:!0,additionalPostData:JSON.stringify(i),timeout:6e3,qosExtraData:{Caller:"HoverCard"}})}}}}});var Tr=n(248),Nr=n(744),Cr=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.signalData,r=t.itemKey;if(n&&r&&n.key===Nr.t.key){var i=e.demandItemFacet(g.Ae,r),o=e.demandItemFacet(v.D,r),u=o&&v.Z.serialize(o),a=e.demandItemFacet(g.Et,u);if(!i||!a||a.listBaseTemplate!==D.n.webPageLibrary)return{};if(1===Object(Tr.e)(90021,a)){var f=e.demandItemFacet(g.Mt,r),l=e.demandItemFacet(g.Ce,r),c=Object(te.t)(e,r),h=a&&Object(V.t)(a),p=!!h&&h.isActivated("0b95f189-dff4-441e-a8e1-e860c9d15392","4/9/2020","add schedule action to hoverCard"),d=q.e.publishNowAction,m=0,y=Nr.t.signal,b=q.e.pageNeedsRepublishing;if(l)d=q.e.submitNowAction;else if(!p&&c){d=q.e.scheduleAction;m=1;y=Nr.e.signal;b=q.e.pageNeedsScheduling}else if(f){var w=Math.floor(Number(f)/512);d=0===w?q.e.publishNowAction:q.e.republishNowAction}return{onRenderLifeCycleSignal:function(e,t){return t?x.createElement(re.n,{action:x.createElement(ae,{itemKeys:[r],publishType:m,source:"FileCard"})},function(n){var r=n.isAvailable,i=n.execute,o=r?function(){i()}:void 0,u=Object(s.__assign)(Object(s.__assign)({},e),{actionName:d,action:o,content:b,signal:y});return t(u)}):null}}}return{}}return{}}}});var kr=n(618),Lr=n(799),Ar=n(436),Or=n(450),Mr=n(27),_r=n(66),Dr=n(344),Pr={key:new T.e("manageAccess").id,automationId:"manageAccessCommand",name:Mr.e.ManageAccess,title:Mr.e.ManageAccessCommandTooltipV3,action:x.createElement(_r.t,null,x.createElement(Or.t,null)),iconProps:{iconName:"PlayerSettings"},facets:Object(s.__assign)({},Dr.t.pack(!0))},Hr=!V.e.isActivated(Dt,"7/5/2019","Show file handler commands before OOB commands"),Br=Object(a.t)()(function(){return function(e){return Fr}});var jr=[Lr.e,Xe.n,Xe.t,Pr];function Fr(e,t){var n=Ir(e,t.itemKey);return{commands:(function(e,t){return e.map(function(e){return e.key===Lr.e.key?jt(t,Hr):e})})(jr,n)}}function Ir(e,t){var n,r=e.demandItemFacet(Ar.t,t);if(r){var i=new J.e(r.tenantRootUrl).authority+"/_api/v2.0",s=Rt.t.serialize({endpoint:i});n=Object(gt.e)(e,{itemKey:s})}return n}var qr=!V.e.isActivated(Dt,"7/5/2019","Show file handler commands before OOB commands"),Rr=[Lr.e,Xe.n,Xe.t],Ur=Object(a.t)()(function(){return function(e){return zr}});function zr(e,t){var n=Ir(e,t.itemKey);return{commands:Qt(Rr,n,!0,qr)}}var Wr=n(439),Xr=n(2437),Vr=n(706),$r=Object(a.t)()(function(){return function(e){return Kr}});var Jr=[Wr.e,Xr.e,Vr.e];function Kr(e,t){return{columns:Jr}}var Qr=n(352),Gr=n(327),Yr=n(435),Zr=n(3219),ei=n(3164),ti=n(230),ni=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=Ar.t.deserialize(n).tenantRootUrl;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u,a,f,l;return Object(s.__generator)(this,function(c){switch(c.label){case 0:t=Object(ei.n)({webAbsoluteUrl:r}).segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return[4,e(Object(_n.t)({url:t.toString(),qosName:"GetMyOneDriveUrl",method:"POST",webAbsoluteUrl:r,noRedirect:!0}))];case 1:if(!((i=c.sent())&&i.d&&i.d.mySite))throw new Gr.e({facets:Object(s.__assign)({},ti.f.pack({}))});o=i.d.mySite.replace(/\/$/,"");u=Yr.t.serialize({webAbsoluteUrl:o||r});a=e(Object(Vt.e)({sharedByMeYouEnabled:pr.L})).sharedByMeYouEnabled;(f=new Pn.e).resolveItems({items:(l={},l[n]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},I.t.pack({itemKey:u})),A.f.pack(a||Zr.e.sharedByMe)),A.d.pack({})),l)});e(f.execute());return[2]}})})}});var ri=n(3605),ii=n(233),si=n(174),oi=n(2834),ui=n(281),ai=n(574),fi=n(402),li=n(579),ci=n(347),hi=n(144);function pi(e,t){var n=[];e.d.results.forEach(function(e){var r,i,o,u,a=""+new J.e(e.SiteUrl).authority+e.UrlPath,f=v.M.serialize({itemFullUrl:a});n.push(f);var l=Object(ri.t)(e.Modified),c=(function(e){var t=Object(oi.e)(e),n={itemFullUrl:t};return{parentItemUrl:t,parentItemKey:v.M.serialize(n)}})(a),h=c.parentItemKey,p=c.parentItemUrl;t.mapKeys({mappings:(r={},r[v.M.serialize({itemFullUrl:p})]=h,r)});var d=(function(e,t){var n=void 0!==t?t:3,r=!1,i=!1;if(e.IsContainer){n=ui.e.folder;i=!0}"OneNote.Notebook"===e.ProgId&&(r=!0);return{isOneNote:r,isDocSet:!1,fileIconType:n,isFolder:i}})(e),m=e.SpItemUrl?Object(fi.e)(e.SpItemUrl):void 0;if(m)for(var g=0,y=Object(fi.t)(m);g<y.length;g++){var b=y[g];t.mapKeys({mappings:(i={},i[b]=f,i)})}var w=e.Editor,E=v.te.serialize({id:w.email}),S={itemKey:E,displayValue:w.name};t.resolveItems({items:(o={},o[E]=Object(s.__assign)(Object(s.__assign)({},A.f.pack(w.name)),ii.e.pack(w.email)),o)});t.resolveItems({items:(u={},u[f]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},A.f.pack(e.FileLeafRef)),A.E.pack(!0)),A.h.pack({name:e.FileLeafRef,extension:e.Extension})),si.e.pack(d.fileIconType)),A.u.pack(l.getTime())),A.i.pack(a)),A.A.pack({itemKey:h})),A.k.pack(S)),si.n.pack(d.isOneNote?{}:void 0)),A.d.pack(d.isFolder?{}:void 0)),A.L.pack(a)),hi.e.pack(m)),m?Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},A.n.pack({itemKey:li.e.serialize({driveItemKey:m})})),A.v.pack({itemKey:ci.e.serialize({driveItemKey:m})})),A.e.pack({itemKey:ai.e.serialize({driveItemKey:m})})):{}),Object(M.e)().forFacet(A.f).thenInvalidate(f,I.e).pack()),u[h]=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},A.d.pack({})),A.i.pack(p)),A.L.pack(p)),u)})});return n}var di=n(1067),vi=n(201),mi=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=Yr.t.deserialize(n).webAbsoluteUrl;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u,a,f,l,c,h;return Object(s.__generator)(this,function(p){switch(p.label){case 0:t=(t=Object(ei.r)({webAbsoluteUrl:r,listOrItemFullUrl:""})).segment("OneDriveSharedItems").parameter("$top",100).parameter("$expand",{raw:"SpItemUrl,DriveAccessToken,DriveAccessTokenV21,DriveUrl"});i=t.toString();return[4,e(Object(_n.t)({url:i,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:r}))];case 1:o=p.sent();u=new Pn.e;a=pi(o,u);f=""+new J.e(r).authority;l=Ar.t.serialize({tenantRootUrl:f});if(o.d.__next){c=di.e.serialize({itemSet:Yr.t.deserialize(n),after:o.d.__next});a.push(c);u.merge(Object(vi.t)({itemKey:c}).itemResolver)}u.resolveItems({items:(h={},h[n]=Object(s.__assign)(Object(s.__assign)({},I.e.pack({itemKeys:a})),I.i.pack({itemKey:l})),h[l]=Object(s.__assign)({},Object(M.e)().forFacet(I.t).thenInvalidate(n,I.e).pack()),h)});e(u.execute());return[2]}})})}});var gi=Object(o.i)()(function(e){var t=this,n=e.itemKey,r=di.e.deserialize(n).after,i=di.e.deserialize(n).itemSet;return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,o,u,a,f;return Object(s.__generator)(this,function(s){switch(s.label){case 0:return[4,e(Object(_n.t)({url:r,method:"GET",qosName:"getSharedByMeDocs",webAbsoluteUrl:i.webAbsoluteUrl}))];case 1:t=s.sent();o=Yr.t.serialize(i);u=new Pn.e;a=pi(t,u);if(t.d.__next){f=di.e.serialize({itemSet:i,after:t.d.__next});a.push(f);u.merge(Object(vi.t)({itemKey:f}).itemResolver)}u.merge(Object(vi.e)({itemKey:n,itemSetKey:o,childItemKeys:a}).itemResolver);e(u.execute());return[2]}})})}});var yi=n(2072);var bi=new T.e("projection");var wi=Object(o.i)()(function(e){var t=this,n=v.re.deserialize(e.itemKey).itemSetKey;return function(r){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o;return Object(s.__generator)(this,function(u){t=v.S.serialize(n);(i=new Pn.e).resolveItems({items:(o={},o[e.itemKey]=Object(s.__assign)(Object(s.__assign)({},bi.pack({})),Object(M.e)().forFacet(bi).thenInvalidate(function(){return function(){r((function(e){var t=this,n=e.itemSetKey,r=v.S.deserialize(n),i=v.re.serialize({itemSetKey:r});return function(e){return Object(s.__awaiter)(t,void 0,void 0,function(){var t;return Object(s.__generator)(this,function(n){e(Object(O.e)(function(e){var t=Object(Tt.e)(e,{isProjectedUploadedItemSetEnabled:g.j}).isProjectedUploadedItemSetEnabled;if(void 0!==t&&t){var n=v.D.serialize(r),i=e.demandItemFacet(g.n,n);if(i&&Object.keys(i).length>0)return!1;for(var s=e.demandItemFacet(I.e,B.a),o=0,u=s&&s.itemKeys||[];o<u.length;o++){var a=u[o];if(e.demandItemFacet(yi.t,a)){var f=e.demandItemFacet(j.o,a),l=e.demandItemFacet(v.D,f&&f.itemKey);if(l&&l.rootFolder===r.rootFolder)return!1}}}return!0}))&&e(Object(Me.e)({items:(t={},t[i]=Object(s.__assign)({},I.e.pack({itemKeys:[]})),t)}));return[2]})})}})({itemSetKey:t}))}}).pack()),o[t]=Object(M.e)().forFacet(I.e).thenInvalidate(e.itemKey,bi).pack(),o)});r(i.execute());return[2]})})}}),Ei=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=t.itemKeys,i=Object(Tt.e)(e,{isProjectedUploadedItemSetEnabled:g.j}).isProjectedUploadedItemSetEnabled;if(void 0!==i&&i){var s=e.demandItemFacet(v.S,n);if(s){var o=(function(e,t,n){var r=[],i=v.re.serialize({itemSetKey:t}),s=e.demandItemFacet(I.e,i);e.demandItemFacet(bi,v.re.serialize({itemSetKey:t}));if(!s||s.itemKeys&&0===s.itemKeys.length)return;for(var o={},u={},a=0,f=s.itemKeys;a<f.length;a++){var l=f[a];r.push(l);var c=e.demandItemFacet(v.D,l);if(c){c.itemId&&(o[c.itemId]=!0);c.rootFolder&&(u[c.rootFolder]=!0)}o[l]=!0}if(n)for(var h=0,p=n;h<p.length;h++){var d=p[h],m=e.demandItemFacet(v.D,d);if(m){if(e.demandItemFacet(A.d,d)){if(m.rootFolder&&m.rootFolder in u)continue}else if(m.itemId&&m.itemId in o)continue}r.push(d)}return r})(e,s,r);return o?{itemKeys:o}:{}}}return{}}}});var Si=n(619),xi=n(960),Ti=n(570),Ni=n(903),Ci=Object(a.t)()(function(){return function(e){return function(e,t){return(function(e,t){var n=t.itemKey,r=Object(Tt.e)(e,{enableItemActivityField:g.C}).enableItemActivityField,i=e.demandItemFacet(g.G,n),s=r&&Object(Y.s)(e,x.createElement(Ni.e,{itemKey:n,isCompact:!0,hideDate:!0}))||i&&x.createElement(Ti.e,{text:i});return s?{itemActivity:s}:{}})(e,t)}}});var ki=n(814),Li=n(698),Ai=n(2006),Oi=n(284),Mi=Object(a.t)()(function(){return function(e){return Di}}),_i={ODB:1928};function Di(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(v.D,n);if(!i)return{};var s=(function(e,t){var n=t.itemKey,r=t.spItem,i=t.desiredSize,s=Object(Tt.e)(e,{enableSharePointDirectThumbnails:g.q,spCookieDomainConfiguration:g.et}),o=s.enableSharePointDirectThumbnails,u=void 0===o||o,a=s.spCookieDomainConfiguration,f=Object(Nt.e)(e,n);if(u&&Object(St.e)(e,{pageContext:f,feature:_i})&&f&&!Object(V.t)(f).isActivated("C5892D55-79FA-4399-8941-95AD020ABB93","3/30/2020","Support direct SharePoint thumbnails")){var l=r.webAbsoluteUrl,c=r.listFullUrl,h=new J.e(l||c).authority;if(a&&a===h){var p=h+"/_api/v2.1",d=e.demandItemFacet(hi.e,n),v=e.demandItemFacet(A.l,n)||"";if(d){var m=d.driveId,y=d.itemId,b=Object(Ai.t)({endpoint:p,driveId:m,itemId:y}),w=Math.ceil(i.width),E=Math.ceil(i.height);return{url:b+"/thumbnails/0/c"+w+"x"+E+"/content?"+Object(Oi.e)({prefer:"noredirect,closestavailablesize",cb:v}),width:0,height:0}}}}})(e,{itemKey:n,spItem:i,desiredSize:r})||(function(e,t){var n=t.itemKey,r=t.desiredSize,i=e.demandItemFacet(Li.t,n),s=i&&i(r.width,r.height);if(s)return{url:s,width:0,height:0}})(e,{itemKey:n,desiredSize:r})||(function(e,t){var n=t.spItem,r=t.itemKey,i=v.U.serialize(n),s=e.demandItemFacet(g.ye,i);if(!s)return;var o=s.templateType===D.n.publishingAsset;if(s.isPromotedLinks||o){var u=e.demandItemFacet(g.$e,r),a=void 0;s.isPromotedLinks?a=u&&u.BackgroundImageLocation:o&&u&&u.AlternateThumbnailUrl&&(a=e.demandItemFacet(Li.e,r));if(a)return{url:a,width:0,height:0}}})(e,{spItem:i,itemKey:n});return s?{thumbnail:s}:{}}var Pi=n(894),Hi=n(1538),Bi=n(238),ji=n(818);function Fi(e){var t=e.listMediaTransformSchema,n=e.itemMediaTransformSchema;if(t&&n){var r=t[".transformUrl"],i=n[".hasThumbnail"],o=Object(s.__assign)(Object(s.__assign)(Object(s.__assign)({},t),n),{".method":"thumbnail"});if("True"===i&&r)return function(e,t){var n=t?{width:e,height:t}:{width:e};return Object(ji.t)(r,o)+"&"+Object(Oi.e)(n)}}}var Ii=Object(o.i)({maxParallelOperationCount:16})(function(e){var t=this,n=Pi.e.deserialize(e.itemKey).itemKey;return function(r){return Object(s.__awaiter)(t,void 0,void 0,function(){var t,i,o,u;return Object(s.__generator)(this,function(a){switch(a.label){case 0:return[4,r(Object(Hi.demandItems)(function(e){var t=e.demandItemFacet(v.D,n),r=t&&v.U.serialize(t);return{generator:Fi({listMediaTransformSchema:e.demandItemFacet(Bi.t,r),itemMediaTransformSchema:e.demandItemFacet(Bi.e,n)})}}))];case 1:t=a.sent().generator;(i=new Pn.e).resolveItems(((o={items:(u={},u[e.itemKey]=Object(s.__assign)({},Bi.n.pack(t)),u)})[n]=Object(s.__assign)({},Object(M.e)().forFacet(Bi.e).thenInvalidate(e.itemKey,Bi.n).pack()),o));r(i.execute());return[2]}})})}});var qi=n(980),Ri=Object(o.t)(function(){return function(e){e(Object(a.r)(v.D,tr.t)(Ci));e(Object(a.r)(v.D,ki.e)(Mi));e(Object(u.o)(Pi.e,On.e)(Ii));e(qi.e)}}),Ui=n(2868),zi=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;return{isAvailable:!!e.demandItemFacet(v.D,n)}}}});var Wi=n(520),Xi=n(964);n.d(t,"SpAddonDeferred",function(){return Vi});var Vi=Object(o.t)(function(){return function(e){return Object(s.__awaiter)(void 0,void 0,void 0,function(){return Object(s.__generator)(this,function(t){e(In);e(Jn);e(kr.e);e(Si.e);e(m.spDataOnlyAddonDeferred);if(e(Object(Vt.e)({enablePltCommands:g.B})).enablePltCommands)e(Object(a.r)(v.D,xi.e)(Ht));else{e(Object(a.r)(v.D,h.e)(Bt));e(Object(a.r)(v.D,Wi.e)(Xi.e))}e(Object(a.r)(v.D,p.e)(Kt));e(Object(a.r)(v._,c.e)(Zt));e(Object(a.r)(v.D,l)(un));e(Object(a.r)(v._,d.e)(En));e(Object(a.r)(v._,f.e)(xn));e(Ri);e(Object(u.o)(v.m,On.e)(Tn.e));e(Object(u.o)(v.g,On.e)(An));e(Object(u.o)(v.ee,On.e)(Hn));e(Object(u.o)(v.U,Bn.t)(zn));e(Object(u.o)(v.U,qn.t)(Kn));e(Object(a.r)(v.S,cr.e)(lr));e(Object(a.r)(v.D,hr.e)(yr));e(Object(a.r)(v.D,br.e)(xr));e(Object(a.r)(Ar.t,h.e)(Br));e(Object(a.r)(Yr.t,Qr.e)($r));e(Object(a.r)(Ar.t,p.e)(Ur));e(Object(u.o)(Ar.t,On.e)(ni));e(Object(u.o)(Yr.t,On.e)(mi));e(Object(u.o)(di.e,On.e)(gi));e(Object(a.r)(v.ue,c.e)(nn));e(Object(a.r)(v.S,Mn.e)(Ei));e(Object(a.r)(v.D,wr.e)(Cr));e(Object(u.o)(v.re,On.e)(wi));e(Object(a.r)(v.D,Ui.e)(zi));return[2]})})}})},,,,,,,function(e,t,n){"use strict";n.r(t);var r,i=n(19),s=n(64),o=n(315),u=n(802),a=n(12),f=n(799),l=n(391),c=n(2),h=n(1),p=n(400),d=n(610),v={action:h.createElement(d.e,null),automationId:"addShortcutFromSharedWithMeCommand",iconProps:{iconName:"OneDriveAdd"},key:new c.e("AddShortcutFromSharedWithMe").id,name:p.e.AddShortcutFromSharedWithMe},m=n(66),g=n(0),y=n(177),b=n(229),w=n(1939),E=n(111),S=n(2346),x=n(7),T=n(9),N=n(84),C=n(36),k=n(20),L=n(28),A=n(16),O=n(2868),M=n(46),_=Object(T.i)(function(e,t){var n=t.itemKeys,r=t.removeFromSharedListWizard,i=t.removeItemsFromSharedList,s=void 0===i?S.t:i,o=Object(N.e)(e)||"";if(0===n.length)return null;for(var u=n.length<=200,a=r,f=0,l=n;f<l.length;f++){var c=l[f],p=e.demandItemFacet(O.e,c);O.e.evaluate(p)(e,{itemKey:c,isAvailable:!1}).isAvailable||(u=!1)}var d=e.dispatch,v=function(){return Object(g.__awaiter)(void 0,void 0,void 0,function(){var e,t;return Object(g.__generator)(this,function(r){switch(r.label){case 0:e={itemSetKey:o};t=Object(C.e)(n,function(){return e});return[4,d(s({items:t}))];case 1:r.sent();return[2]}})})},m=Object(k.o)(function(e){return h.createElement(a,Object(g.__assign)({},e,{onItemRemoved:v,itemKeys:n}))});return h.createElement(L.e,Object(g.__assign)({isAvailable:u,onExecute:m},Object(M.e)(e,{itemKey:void 0,engagement:{name:"RemoveFromSharedList",isIntentional:!0,extraData:{itemCount:n.length}}})))}),D=Object(A.s)()(_),P=n(3301),H=n(2951),B=n(21),j=n(69),F=n(486),I=((r={})[j.r.started]=function(e){return Object(B.formatToArray)(Object(B.getLocalizedCountValue)(H.e.removeStartedItemsTitle,H.e.removeCompletedItemsTitleIntervals,e)||"",e)},r[j.r.completed]=function(e){return Object(B.formatToArray)(Object(B.getLocalizedCountValue)(H.e.removeCompletedItemsTitle,H.e.removeCompletedItemsTitleIntervals,e)||"",e)},r[j.r.failed]=function(e){return Object(B.formatToArray)(Object(B.getLocalizedCountValue)(H.e.removeFailedItemsTitle,H.e.removeFailedItemsTitleIntervals,e)||"",e)},r[j.r.canceled]=function(e){return Object(B.formatToArray)(Object(B.getLocalizedCountValue)(H.e.removeFailedItemsTitle,H.e.removeFailedItemsTitleIntervals,e)||"",e)},r),q=Object(i.t)(function(){return function(e){e(Object(a.r)(S.e,F.e)(Object(a.t)()(R)))}});function R(){return function(e){return U}}function U(e,t){var n,r=Object(E.i)(e,t),i=r.phase,s=r.count;n=I[i](s);return Object(g.__assign)({},n&&"item"!==t.format?{title:n}:{})}var z=(function(e){Object(g.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.render=function(){var e=this,t=this.props,n=t.resolve,r=t.reject,i=t.onItemRemoved,s=t.itemKeys,o=function(){return Object(g.__awaiter)(e,void 0,void 0,function(){return Object(g.__generator)(this,function(e){switch(e.label){case 0:n();return[4,i()];case 1:e.sent();return[2]}})})},u=function(){return Object(g.__awaiter)(e,void 0,void 0,function(){return Object(g.__generator)(this,function(e){r(new y.e);return[2]})})};return h.createElement(b.e,null,function(e){var t=e.itemCache,n=W(t,s),r=n.title,i=n.prompt;return h.createElement(w.e,{onCancel:u,onConfirm:o,yesText:H.e.removeFromSharedListConfirmButtonText,noText:P.e.removeFromSharedListCancelButtonText,defaultToYes:!0,title:r,prompt:i})})};return t})(h.PureComponent),W=function(e,t){if(t.length>1)return{title:P.e.itemsTitleWithAccess,prompt:P.e.itemsSubTextWithAccess};if(1===t.length){var n=e.demandItemFacet(x.d,t[0]);return{title:n?P.e.folderTitleWithAccess:P.e.fileTitleWithAccess,prompt:n?P.e.folderSubTextWithAccess:P.e.fileSubTextWithAccess}}return{title:"",prompt:""}},X=Object(E.s)({operationTypeFacet:S.n,progressKeyFacet:S.e,initializeBatch:function(){return q}});var V=Object(T.t)(function(){return{removeFromSharedListWizard:z,removeItemsFromSharedList:X}})(D),$={key:new c.e("removeFromSharedList").id,automationId:"removeFromSharedListCommand",name:p.e.removeFromSharedList,title:p.e.removeFromSharedListTooltip,action:h.createElement(m.t,null,h.createElement(V,null)),iconProps:{iconName:"Cancel"}},J=Object(a.t)()(function(){return function(e){return Q}});var K=[f.e,l.n,l.t,v,$];function Q(e,t){return{commands:K}}var G=n(3491),Y=n(568),Z=n(962),ee={action:h.createElement(m.t,null,h.createElement(Z.e,null)),automationId:"removeShortcutFromSharedWithMeCommand",iconProps:{iconName:"Cancel"},key:new c.e("RemoveShortcutFromSWM").id,name:p.e.RemoveShortcutFromSWM},te=Object(a.t)()(function(){return function(e){return re}});var ne=[f.e,l.n,l.t,v,ee,$];function re(e,t){return{commands:ne}}var ie,se=n(285),oe=n(243),ue=n(234),ae=n(202),fe=((ie={})[ae.t]=!0,ie[ae.r]=!0,ie[ue.i]=!0,ie[ue.e]=!0,ie[ue.r]=!0,ie),le=Object(a.t)()(function(){return function(e){return ce}});function ce(e,t){var n=t.itemSetKey,r=t.handler,i=r.columnKey,s=r.isAscending;if(!fe[i])return{};var o=e.demandItemFacet(se.e,n);if(!o)return{};var u=ue.t[i];return u?{newItemSetKey:se.e.serialize(Object(g.__assign)(Object(g.__assign)({},o),{sortBy:u,isAscending:s}))}:{}}var he,pe=n(350),de=n(371),ve=n(2833),me=Object(a.t)()(function(){return function(e){return function(e,t){var n=t.itemKey,r=e.demandItemFacet(se.e,n),i=r&&r.driveItemKey.endpoint,s=i&&Object(ve.e)(e,{parentItemKey:Y.e.serialize({endpoint:i}),stageItem:t.stageItem});return Object(g.__assign)({},s?{stageItem:s}:{})}}});var ge=((he={})[ue.i]=!0,he[ue.e]=!0,he),ye=Object(a.t)()(function(){return function(e){return be}});function be(e,t){var n=t.itemSetKey,r=t.handler.columnKey;if(!ge[r])return{};var i=e.demandItemFacet(se.e,n);if(!i)return{};var s=ue.t[r];return s?{newItemSetKey:se.e.serialize(Object(g.__assign)(Object(g.__assign)({},i),{groupBy:s}))}:{}}var we=Object(a.t)()(function(){return function(e){return Ee}});function Ee(e,t){var n=t.itemSetKey,r=e.demandItemFacet(se.e,n);return r?{newItemSetKey:se.e.serialize(Object(g.__assign)(Object(g.__assign)({},r),{groupBy:void 0}))}:{}}var Se=n(2831),xe=Object(a.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Te=Object(a.t)()(function(){return function(e){return function(e,t){return{isAvailable:!1}}}});var Ne=n(128),Ce=n(2510),ke=n(146),Le=n(56),Ae=n(54),Oe=n(173),Me=n(1418),_e=n(5),De=new _e.e("topCollaboratorItemKeyFacet",{id:Object(_e.s)()}),Pe=n(62),He=n(233),Be=n(13),je=Object(i.i)()(function(e){var t=this,n=e.itemKey;return function(r){return Object(g.__awaiter)(t,void 0,void 0,function(){var t,i,s,o,u,a,f,l,c,h,p,d,v,m,y,b;return Object(g.__generator)(this,function(w){switch(w.label){case 0:t=new Le.e;i=r(Object(Ae.e)({graphEndpoint:Oe.o})).graphEndpoint;s=Ce.e.deserialize(n);o=i||s.endpoint;u=o+"/me/people/";return[4,r(Object(Me.n)({url:u,qosName:"getTopCollaborator",endpoint:o}))];case 1:a=w.sent();f=[];for(l=0,c=a.value;l<c.length;l++){h=c[l];p=h.id,d=h.displayName,v=h.userPrincipalName;m=De.serialize({id:p});r(Object(Pe.e)({items:(y={},y[m]=Object(g.__assign)(Object(g.__assign)({},x.f.pack(d)),He.e.pack(v)),y)}));f.push(m)}t.resolveItems({items:(b={},b[e.itemKey]=Object(g.__assign)({},Be.e.pack({itemKeys:f})),b)});r(t.execute());return[2]}})})}});n.d(t,"graphAddonDeferred",function(){return Fe});var Fe=Object(i.t)(function(){return function(e){e(Object(Ne.e)(function(){e(G.graphAddonDataOnlyDeferred);e(Object(a.r)(Y.e,o.e)(te));e(Object(a.r)(Y.e,u.e)(J));e(Object(a.r)(se.e,oe.e)(le));e(Object(a.r)(se.e,pe.e)(me));e(Object(a.r)(se.e,de.e)(ye));e(Object(a.r)(se.e,de.t)(we));e(Object(a.r)(Se.n,pe.e)(xe));e(Object(a.r)(Se.t,pe.e)(Te));e(Object(s.o)(Ce.e,ke.e)(je))}))}})}],Array(17),[function(e,t,n){"use strict";n.r(t);var r,i=n(19),s=n(12),o=n(3),u=n(2804),a=n(0),f=n(1),l=n(342),c=n(50),h=n(13),p=n(7),d=n(56),v=n(143),m=n(110),g=n(887),y=n(2870),b=n(1599),w=n(83),E=n(30);(function(e){e[e.New=0]="New";e[e.Update=1]="Update";e[e.Delete=2]="Delete"})(r||(r={}));var S=1e4,x={ODB:819,ODC:"EnablePushChannelLogging"},T={ODB:459},N=(function(){function e(e){var t=this;this.subscribe=function(){t._log("Subscribe");if(0===t._subscribers){t._async=new v.e;var e=t._async.debounce(function(){return t._onNotification()},S,{leading:!0,maxWait:S});t._pushChannelService.setupNotificationHandler({source:y.t.WebhookSubscription},function(){t._log("PushChannelMessageSource",y.t.WebhookSubscription);e()});t._pushChannelService.setupNotificationHandler({source:y.t.EventHub},function(){t._log("PushChannelMessageSource",y.t.EventHub);e()});t._pushChannelService.addConnectionHandler(t._id,function(e){return t._onPushChannelConnection(e)})}t._subscribers++;t._pushChannelService.isConnected()||t._pushChannelService.connect(void 0,{methodInvoker:"ItemAutoRefreshHelper.subscribe"});return t._unsubscribe.bind(t)};this._id=e.id;this._driveUrlParts=e.driveUrl?Object(g.e)(e.driveUrl):void 0;this._dispatch=e.dispatch;this._template=e.template;this._itemScopeItemKey=e.itemsScopeItemKey||"";this._pushChannelService=e.pushChannelService;this._onUnsubscribe=e.onUnsubscribe;this._isTestMode=e.isTestMode;this._onPushChannelConnected=e.onPushChannelConnected;this._subscribers=0;this._syncToken="latest";this._getChangesAttempts=0}e.prototype._unsubscribe=function(){this._log("Unsubscribe");this._subscribers--;this._template.onUnsubscribe(this._subscribers);if(0===this._subscribers){if(this._async){this._async.dispose();this._async=void 0;this._refreshSubscriptionTimeoutId=void 0}this._pushChannelService.setupNotificationHandler({source:y.t.WebhookSubscription},function(){});this._pushChannelService.removeConnectionHandler(this._id);this._pushChannelService.disconnect()}this._onUnsubscribe(this._subscribers);return this._subscribers};e.prototype._onPushChannelConnection=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r=this;return Object(a.__generator)(this,function(i){switch(i.label){case 0:if(!e){this._log("Disconnected");this._clearRefreshSubscriptionTimeout();return[2]}this._log("Connected");this._isTestMode&&this._onPushChannelConnected&&this._onPushChannelConnected();if("latest"!==this._syncToken)return[3,4];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,this._getChangeMessages()];case 2:i.sent();return[3,4];case 3:t=i.sent();this._getChangesAttempts++;if(this._getChangesAttempts>10)return[2];n=!1;if(Object(b.s)(t))switch(t.status){case 404:case 410:n=!0;this._syncToken="latest"}n&&this._async&&this._async.setTimeout(function(){return r._onPushChannelConnection(r._pushChannelService.isConnected())},500+Math.pow(2,this._getChangesAttempts));return[2];case 4:this._refreshSubscriptionHandler();return[2]}})})};e.prototype._refreshSubscriptionHandler=function(){var e=this;if(this._async){var t=this._pushChannelService.getSocketIoSubscription();if(t){var n=105001*Math.random()+15e3,r=Date.parse(t.expirationDateTime),i=Date.now(),s=r-i-n;if(s<12e4){if(m.e.isFeatureEnabled(T)){var o={refreshDelay:s,expirationDateTime:t.expirationDateTime,expirationDateTimeinMS:r,dateTimeNow:i,recreateBufferRandom:n};new w.e({name:"ItemAutoRefreshHelper.refreshSubscription",extraData:o}).end({resultType:E.e.Failure,extraData:o})}s=12e4}this._clearRefreshSubscriptionTimeout();this._refreshSubscriptionTimeoutId=this._async.setTimeout(function(){return Object(a.__awaiter)(e,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:this._log("Refreshing subscription");this._refreshSubscriptionTimeoutId=void 0;return[4,this._pushChannelService.refreshSubscription()];case 1:!0===e.sent()&&this._refreshSubscriptionHandler();return[2]}})})},s)}}};e.prototype._clearRefreshSubscriptionTimeout=function(){if(this._async&&void 0!==this._refreshSubscriptionTimeoutId){this._async.clearTimeout(this._refreshSubscriptionTimeoutId);this._refreshSubscriptionTimeoutId=void 0}};e.prototype._getChangeMessages=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e;return Object(a.__generator)(this,function(t){switch(t.label){case 0:return[4,this._template.getChangeMessages(this._dispatch,this._syncToken,this._driveUrlParts)];case 1:e=t.sent();this._syncToken=e.syncToken?e.syncToken:"latest";this._getChangesAttempts=0;return[2,e]}})})};e.prototype._onNotification=function(){return Object(a.__awaiter)(this,void 0,void 0,function(){var e,t,n,i,s,o,u,f,l,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:a.trys.push([0,2,,3]);e=new d.e;return[4,this._getChangeMessages()];case 1:t=a.sent();this._log("Change messages",t);n=this._processMessages(t.messages);this._log("Changes",n);e.merge(t.itemResolver);for(i=0,s=n;i<s.length;i++)switch((o=s[i]).type){case r.New:e.invalidateItems({items:(f={},f[o.invalidateKey]=[h.t],f)});break;case r.Update:o.hasSelection&&this._itemScopeItemKey?this._updateItems(o.invalidateKey):e.invalidateItems({items:(l={},l[o.invalidateKey]=[o.invalidateFacet],l)});break;case r.Delete:e.invalidateItems({items:(c={},c[o.invalidateKey]=[p.a],c)})}this._dispatch(e.execute());return[3,3];case 2:u=a.sent();this._log("onNotification error",u);return[3,3];case 3:return[2]}})})};e.prototype._processMessages=function(e){var t=[];e.sort(function(e,t){return e.parentItemKey?0:1});for(var n=0;n<e.length;n++){var r=e[n],i=this._template.processMessage(this._dispatch,r,this._itemScopeItemKey);if(void 0!==i){this._log("Change",i.invalidateKey,i.reason);t.push(i)}else if(r.parentItemKey)for(var s=n+1;s<e.length;s++){if(e[s].itemKey===r.parentItemKey){e.splice(s,1);break}}}return t};e.prototype._updateItems=function(e){this._template.updateItems(this._dispatch,e)};e.prototype._log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];m.e.isFeatureEnabled(x)&&console.log.apply(console,Object(a.__spreadArrays)(["ItemAutoRefreshHelper"],e))};return e})(),C=n(1418),k=n(2007),L=n(173),A=n(3223),O=n(3222),M=n(24),_=n(15),D=n(238),P=n(59),H=n(4),B=n(247),j=n(99),F=n(25),I=n(54),q=n(144),R=n(402),U=n(779),z=n(107),W=(function(){function e(e){this._dataRequestor=e.dataRequestor;this._rootItemKey=e.rootItemKey}e.prototype.onUnsubscribe=function(e){};e.prototype.getChangeMessages=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var r,i,s,u,f,l,c,h,p,v,m,g,y,b,w,E,S,x,T,N,C,A,O,M,P,W,X,V=this;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(void 0===n||void 0===n.endpoint||void 0===n.driveId)throw"Invalid drive url parts";r=n.endpoint+"/drives/"+n.driveId;i=e(Object(I.e)({isTAB:L.l})).isTAB;s=e(Object(F.e)(function(e){var t=e.demandItemFacet(o.D,V._rootItemKey);return{spItem:t,pageContext:t&&e.demandItemFacet(H.Et,o.Z.serialize(t))}})),u=s.spItem;if(!(f=s.pageContext)||!Object(_.t)(f).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!i)return[3,1];l=e(Object(F.e)(function(e){var t=u&&o.U.serialize(u),n=e.demandItemFacet(D.t,t),r=n&&n[".driveAccessToken"];return r&&r.replace("access_token=","")}));return[3,3];case 1:return[4,e(Object(B.e)({url:r,disallowCookies:!0}))];case 2:l=a.sent();a.label=3;case 3:return[3,7];case 4:return(h=n.endpoint)?[4,e(Object(k.e)(n.endpoint,r))]:[3,6];case 5:h=a.sent();a.label=6;case 6:l=(c=h)&&c.accessToken;a.label=7;case 7:if(void 0===l)throw new z.e({code:"authFailure"});p=f&&Object(_.t)(f).isActivated("C827C03F-4B57-4B6A-8BAB-3AE30D6AB56B","01/23/2020","including drive endpoint in the path")?"/drive/root/view.delta?token="+encodeURIComponent(t):r+"/root/view.delta?token="+encodeURIComponent(t);return[4,this._dataRequestor.send({apiName:"viewDelta",path:p,accessToken:{accessToken:l,tokenUrl:r},useAuthorizationHeaders:!0,headers:{"X-RestrictedReadCapabilities":"ForceCheckOut,RequiredColumn,ContentApproval,Irm,ExcludeFromOfflineClient,DocumentParser,DraftItemSecurity,ItemLevelPermissions"}})];case 8:v=a.sent();m=[];g=new d.e;if(v&&v.value)for(y=0,b=v.value;y<b.length;y++){w=b[y];E=void 0;S={endpoint:n.endpoint,driveId:n.driveId,itemId:w.id};if(w.root){A=Object(R.t)(S);for(x=0,T=A;x<T.length;x++){P=T[x];g.mapKeys({mappings:(W={},W[P]=this._rootItemKey,W)})}}else if(w.webUrl&&(N=Object(U.n)(w.webUrl))){C=o.M.serialize({itemFullUrl:N});if(e(Object(j.e)({spItemKey:o.D},C)).spItemKey){A=Object(R.t)(S);for(O=0,M=A;O<M.length;O++){P=M[O];g.mapKeys({mappings:(X={},X[P]=C,X)})}}}if(!w.root){w.parentReference&&(E=w.parentReference.id);m.push({itemKey:q.e.serialize(S),parentItemKey:E&&q.e.serialize({endpoint:n.endpoint,driveId:n.driveId,itemId:E}),isDeleted:!!w.deleted,isShared:!!w.shared,name:w.name,dateModified:w.lastModifiedDateTime,eTag:w.eTag})}}return[2,{syncToken:v["@delta.token"],messages:m,itemResolver:g}]}})})};e.prototype.updateItems=function(e,t,n){};e.prototype.processMessage=function(e,t,n){if(t.isDeleted){if(e(Object(j.e)({deleted:p.a},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(j.e)({spItemKey:o.D,mediaTransformSchema:D.e,displayName:p.f},t.itemKey)),s=i.spItemKey,u=i.mediaTransformSchema,a=i.displayName;if(void 0===s){if(!t.parentItemKey)return;return{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(u&&t.eTag){var f=u[".etag"];if(f&&t.eTag&&t.eTag!==f)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:D.e,reason:"eTag changed from "+f+" to "+t.eTag}}if(void 0!==t.name&&a!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:p.f,reason:"Name changed from "+a+" to "+t.name}};return e})(),X=n(122),V=n(49),$=n(388),J=n(26),K=n(31),Q=n(1539),G=n(115),Y=n(38),Z=n(3164),ee={ODB:819,ODC:"EnablePushChannelLogging"},te=(function(){function e(e){this._dispatch=e.dispatch;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._listId=e.listId}e.prototype.getSocketIoSubscription=function(e){return Object(a.__awaiter)(this,void 0,void 0,function(){var t,n,r,i,s,o,u,f,c,h,p,d,v,m,g;return Object(a.__generator)(this,function(a){switch(a.label){case 0:if(e.existingSubscription)return[3,5];n=Object(Z.n)({webAbsoluteUrl:this._webAbsoluteUrl}).segments("microservicemanager","getserviceurls").parameter("service","push");return[4,this._dispatch(Object(B.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:n.toString(),method:"GET",qosName:"GetServiceUrls",noRedirect:!0})).catch(function(e){Y.n.isFeatureEnabled(ee)&&console.log("Error getting service url: ",e)})];case 1:r=a.sent();i=this._dispatch(Object(I.e)({isTest:L.l})).isTest;if(!(s=r&&r.d&&r.d.GetServiceUrls&&r.d.GetServiceUrls.results&&r.d.GetServiceUrls.results[0])&&!i)throw new Error("Unable to retrieve PushChannel base url");i&&(s="https://northcentralus0-pushs.svc.ms");o=s+"/notifications/register";u=G.e.generate();f=this._dispatch(Object(l.e)({name:"SubscriptionServiceGenericList.Register"}));c={correlationId:u};a.label=2;case 2:a.trys.push([2,4,,5]);return[4,Q.e.start({url:o,method:"GET",headers:{"X-Correlation-Id":u},requestTimeoutInMS:1e4})];case 3:(h=a.sent())&&h.responseText&&h.responseText.length>0&&(p=JSON.parse(h.responseText))&&p.serverUrl&&p.webhookUrl&&(t=p.webhookUrl);if(void 0===t)throw new Error("Unable to retireve PushChannel notification url");this._dispatch(f({resultType:K.t.success,extraData:c}));return[3,5];case 4:d=a.sent();this._dispatch(f({resultType:K.t.failure,extraData:c}));throw d;case 5:v=Object(Z.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId);if(e.existingSubscription){v=v.method("Subscriptions",{guid:e.existingSubscription.id}).segment("Update");t=e.existingSubscription.notificationUrl}else v=v.segments("Subscriptions","Add");m={parameters:{resource:this._listId,notificationUrl:t,expirationDateTime:new Date(Date.now()+3e5).toISOString(),clientState:""}};return[4,this._dispatch(Object(B.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:v.toString(),body:JSON.stringify(m),qosName:"SubscriptionServiceGenericList.getSocketIoSubscription",method:"POST",noRedirect:!0}))];case 6:if((g=a.sent())&&g.d){delete g.d.__metadata;if(e.existingSubscription){g.d.id=e.existingSubscription.id;g.d.notificationUrl=e.existingSubscription.notificationUrl;g.d.expirationDateTime=m.parameters.expirationDateTime}return[2,g.d]}throw new Error("Invalid subscription object")}})})};e.prototype.deleteSocketIoSubscription=function(e){var t=Object(Z.r)({webAbsoluteUrl:this._webAbsoluteUrl,listOrItemFullUrl:this._listFullUrl}).segment("lists").method("GetById",this._listId).method("Subscriptions",e.id);return this._dispatch(Object(B.t)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,url:t.toString(),qosName:"SubscriptionServiceGenericList.deleteSocketIoSubscription",method:"DELETE",noRedirect:!0}))};return e})(),ne=n(252),re=n(48),ie=n(215),se=n(217),oe=n(147),ue=(function(){function e(e){this._pushChannelService=e.pushChannelService;this._subscriptionService=e.subscriptionService;this._webAbsoluteUrl=e.webAbsoluteUrl;this._listFullUrl=e.listFullUrl;this._itemSetKey=e.itemSetKey;this._serverResponse=void 0}e.prototype.onUnsubscribe=function(e){if(0===e&&this._subscriptionService instanceof te){var t=this._pushChannelService.getSocketIoSubscription();t&&this._subscriptionService.deleteSocketIoSubscription(t)}};e.prototype.getChangeMessages=function(e,t,n){return Object(a.__awaiter)(this,void 0,void 0,function(){var n,r,i,s,u,f,l,c,h,p,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,D,P,H,B,j,I=this;return Object(a.__generator)(this,function(q){switch(q.label){case 0:if(i=!!t&&"SPO_LIST,"===t.substr(0,9)){s=t.split(",");u=s[1];f=s[2];l='<Eq><FieldRef Name="Modified" />';l+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+f+"</Value></Eq>";c='<Gt><FieldRef Name="ID" /><Value Type="Number">'+u+"</Value></Gt>";n=Object(X.e)([l,c],V.n.and);h='<Gt><FieldRef Name="Modified" />';h+='<Value Type="DateTime" IncludeTimeValue="True" StorageTZ="True">'+f+"</Value>";h+="</Gt>";n=Object(X.e)([n,h],V.n.or);r=["ID","FileRef","Modified","Title"];p=this._getListColumns(e);for(v=0,m=p;v<m.length;v++)"ID"!==(g=m[v]).internalName&&"FileRef"!==g.internalName&&"Modified"!==g.internalName&&"Title"!==g.internalName&&r.push(g.internalName)}else r=["ID","FileRef","Modified"];"ID";y=i;b=i?200:1;w=new $.e("<View></View>");n&&w.addFilters([n]);r&&w.replaceFields(r);w.updateSort({fieldName:"ID",isAscending:y});w.updateRowLimit({rowLimit:b,isPerPage:!1});E=e(Object(F.e)(function(e){return Object(re.e)(e,o.D.serialize({webAbsoluteUrl:I._webAbsoluteUrl,listFullUrl:I._listFullUrl}))}));this._requestDatesInUtc=!E||Object(_.t)(E).isActivated("3599C6B2-C5C1-42F2-A5E1-CA0C352D20AB","01/09/2020","Do not request dates in UTC for autorefresh");return[4,e(Object(ne.e)({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,qosName:"ItemAutoRefreshGenericList.GetChanges",viewXml:w.getEffectiveViewXml(),postDataContext:{requestDatesInUtc:this._requestDatesInUtc,needsSchema:!0},currentPageContext:E}))];case 1:S=q.sent();this._serverResponse=S;x=S.ListData;T=x&&x.Row||[];N=[];C=this._getLastIdInList(T);k=i?this._getLastModifiedTimeInList(T,E):(new Date).toISOString();for(L=0,A=T;L<A.length;L++)if(void 0!==(O=A[L]).FileRef){M={};D=Object.keys(O);for(P=0,H=D;P<H.length;P++){B=H[P];j=0===B.indexOf("OData_")?B.substr(6):B;M[j]=O[B]}N.push(Object(a.__assign)(Object(a.__assign)({itemKey:o.D.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl,itemId:O.ID}),parentItemKey:o.D.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1,name:O.Title||""},O.Modified?{dateModified:""+O.Modified}:{}),{fields:M}))}0===N.length&&N.push({itemKey:o.D.serialize({webAbsoluteUrl:this._webAbsoluteUrl,listFullUrl:this._listFullUrl}),isDeleted:!1,isShared:!1});return[2,{syncToken:"SPO_LIST,"+C+","+k,messages:N,itemResolver:new d.e}]}})})};e.prototype.updateItems=function(e,t){if(t&&o.S.matches(this._itemSetKey)&&this._serverResponse){var n=o.S.deserialize(this._itemSetKey),r={webAbsoluteUrl:n.webAbsoluteUrl,listFullUrl:n.listFullUrl,rootFolder:n.rootFolder||""},i=e(Object(oe.n)({itemSetKey:r})),s=e(Object(oe.e)(n,i,"getSPItem")),u=e(Object(se.t)({serverData:this._serverResponse,itemSetKey:r,contentTypes:i,currentPageContext:s.currentPageContext,isItemSetRequest:!1})).itemResolver;e(u.execute())}this._serverResponse=void 0};e.prototype.processMessage=function(e,t,n){if(void 0===t.parentItemKey)return{type:r.New,invalidateKey:t.itemKey,reason:"Deleted an unknown item"};if(t.isDeleted){if(e(Object(j.e)({deleted:p.a},t.itemKey)).deleted)return;return{type:r.Delete,invalidateKey:t.itemKey,reason:"Deleted"}}var i=e(Object(F.e)(function(e){return e.isItemFacetResolved(o.D,t.itemKey)?{rowData:e.demandItemFacet(H.$e,t.itemKey),spItemKey:e.demandItemFacet(o.D,t.itemKey),title:e.demandItemFacet(H.Ot,t.itemKey),selectedItemKeys:Object(ie.e)(e,{itemsScopeItemKey:n})}:{rowData:void 0,spItemKey:void 0,title:void 0,selectedItemKeys:void 0}})),s=i.rowData,u=i.spItemKey,a=i.title,f=i.selectedItemKeys,l=f&&f.length>0;if(void 0===u||void 0===s){if(!t.parentItemKey)return;if(void 0===e(Object(j.e)({spParentItemKey:o.D},t.parentItemKey)).spParentItemKey)return;return l?void 0:{type:r.New,invalidateKey:t.parentItemKey,reason:"New item"}}if(void 0!==a&&void 0!==t.name&&a!==t.name)return{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:H.Ot,reason:'Item title changed from "'+a+'" to '+t.name+")"};if(t.fields){l||(this._serverResponse=void 0);for(var c=this._getListColumns(e),h=function(e){for(var n=e.internalName,i=Object(H.Y)(e.internalName,e.fieldType),o=0,u=Object.keys(t.fields).filter(function(e){return e!==n+".COUNT"&&0===e.indexOf(n)});o<u.length;o++){var a=u[o],f=s&&s[a],c=t.fields[a];try{"object"==typeof f&&(f=JSON.stringify(f));"object"==typeof c&&(c=JSON.stringify(c));if(d._requestDatesInUtc&&"DateTime"===e.fieldType){var h=Date.parse(f),p=Date.parse(c);if(!isNaN(h)&&!isNaN(p)){f=h;c=p}}}catch(e){continue}if(f!==c)return{value:{type:r.Update,invalidateKey:t.itemKey,invalidateFacet:i,hasSelection:l,reason:'Item field "'+n+'" changed from "'+f+'" ('+typeof f+') to "'+c+'" ('+typeof c+")"}}}},d=this,v=0,m=c;v<m.length;v++){var g=h(m[v]);if("object"==typeof g)return g.value}}};e.prototype._getLastIdInList=function(e){return e&&e.length>0?Math.max.apply(Math,e.map(function(e){return parseInt(e.ID,10)})):0};e.prototype._getLastModifiedTimeInList=function(e,t){var n=(new Date).toISOString();if(e&&e.length>0)for(var r=void 0,i=0,s=e;i<s.length;i++){var o=s[i];if(this._requestDatesInUtc){var u=o.Modified;if(u){f=new Date(u);if(void 0===r||r<f){r=f;n=""+u}}}else{var a=o["Modified."];if(a){var f=new Date(a),l=t&&t.webTimeZoneData?t.webTimeZoneData.Bias-f.getTimezoneOffset():0;l&&f.setTime(f.getTime()+6e4*l);if(void 0===r||r<f){r=f;n=f.toISOString()}}}}return n};e.prototype._getListColumns=function(e){var t=[],n=e(Object(j.e)({schema:h.s},this._itemSetKey)).schema,r=n&&n.columnKeys;if(r)for(var i=0,s=r;i<s.length;i++){var o=s[i],u=e(Object(j.e)({internalName:H.ue,fieldType:H.J,mappedFieldType:H.xe},o)),a=u.internalName,f=u.fieldType,l=u.mappedFieldType;void 0!==a&&void 0!==f&&void 0!==l&&l!==J.t.Title&&t.push({internalName:a,fieldType:f,mappedFieldType:l})}return t};return e})(),ae=n(120),fe=n(102),le=n(61),ce=n(5),he=n(181),pe=n(289),de={ODB:860},ve={ODB:818},me=new ce.e("itemAutoRefreshHelper",{itemsScopeItemKey:Object(ce.s)(),spPageContextKey:Object(ce.s)()}),ge=Object(fe.e)(function(e){return{}});function ye(e){var t=Object(ae.t)();f.useLayoutEffect(function(){var n,r,i,s,o,u,a,f,c,h;return t((r=(n=e).spPageContextKey,i=n.pageContext,s=n.listId,o=n.webAbsoluteUrl,u=n.listFullUrl,a=n.isTAB,f=n.itemKey,c=n.driveUrl,h=n.itemsScopeItemKey,function(e){var t=e(ge),n=me.serialize({itemsScopeItemKey:h,spPageContextKey:r}),p=t[n];if(!p){var d,v,m=void 0;if(i&&!Object(_.t)(i).isActivated("1280C2A6-E41F-4140-9BBD-AD7F6BC4C604","10/31/2019","Use socketIo api for list subscriptions")){var g=e(C.e).dataRequestor;m=new A.e({listId:s,webAbsoluteUrl:o},{dataRequestor:g})}else m=new te({dispatch:e,webAbsoluteUrl:o,listFullUrl:u,listId:s});d=new O.e({disableWebSockets:!0},{subscriptionService:m});v=new ue({pushChannelService:d,subscriptionService:m,webAbsoluteUrl:o,listFullUrl:u,itemSetKey:f});p=t[n]=new N({id:n,isTestMode:a,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:c,dispatch:e,template:v,itemsScopeItemKey:h,pushChannelService:d,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete t[n]}})}return p})).subscribe()},[]);return null}function be(e){var t=Object(ae.t)();f.useLayoutEffect(function(){return t((function(e){var t=this,n=e.spPageContextKey,r=e.webAbsoluteUrl,i=e.listFullUrl,s=e.isTAB,u=e.driveAccessToken,f=e.pageContext,c=e.driveUrl,h=e.endpoint,p=e.itemsScopeItemKey;return function(e){var d=e(ge),v=me.serialize({itemsScopeItemKey:p,spPageContextKey:n}),m=d[v];if(!m){var g,y,b=e(C.e).dataRequestor;y=new W({dataRequestor:b,rootItemKey:o.D.serialize({webAbsoluteUrl:r,listFullUrl:i,rootFolder:""})});g=new O.e({disableWebSockets:!0},{subscriptionService:new A.e({},{dataRequestor:b}),sessionTokenFetcher:function(){return Object(a.__awaiter)(t,void 0,void 0,function(){var t,n,r;return Object(a.__generator)(this,function(i){switch(i.label){case 0:if(!f||!Object(_.t)(f).isActivated("60D2CD4A-EAEC-4EBC-94E9-B0FB14B7CBB5","01/23/2020","Use Graph auth for auto-refresh"))return[3,4];if(!s)return[3,1];t=u;return[3,3];case 1:return[4,e(Object(B.e)({url:c,disallowCookies:!0}))];case 2:t=i.sent();i.label=3;case 3:return[3,7];case 4:return(r=h)?[4,e(Object(k.e)(h,c))]:[3,6];case 5:r=i.sent();i.label=6;case 6:t=(n=r)&&n.accessToken;i.label=7;case 7:if(!t)throw new z.e({code:"authFailure"});return[2,{accessToken:t,tokenUrl:c}]}})})}});m=d[v]=new N({id:v,isTestMode:s,onPushChannelConnected:function(){return window._isPushChannelConnected=!0},driveUrl:c,dispatch:e,itemsScopeItemKey:p,template:y,pushChannelService:g,logQoS:function(t){var n=e(Object(l.e)(t));return function(t){return e(n(t))}},onUnsubscribe:function(e){0===e&&delete d[v]}})}return m}})(e)).subscribe()},[]);return null}var we=Object(s.t)()(function(){return function(e){return function(e,t){var n=t.itemKey;if(!n)return{};var r=e.demandItem({key:o.S},n).key;if(!r||!r.webAbsoluteUrl||!r.listFullUrl)return{};var i=r.webAbsoluteUrl,s=r.listFullUrl,u=o.Z.serialize({webAbsoluteUrl:i,listFullUrl:s}),a=e.demandItemFacet(H.Et,u);if(!Object(P.e)(e,{feature:de,pageContext:a})||!Object(P.e)(e,{feature:ve,pageContext:a}))return{};var l=o.U.serialize({webAbsoluteUrl:i,listFullUrl:s}),h=e.demandItem({listFacets:H.ye,listMediaTransformSchema:D.t},l),p=h.listFacets,d=h.listMediaTransformSchema;if(!p||void 0===p.id||void 0===p.templateType)return{};var v=p.isDocumentLibrary,m=M.s(p.templateType);if(!v&&!m)return{};var y,b=Object(c.e)(e,{isTAB:L.l}).isTAB,w=d&&d[".driveUrl"],E=w&&Object(g.e)(w),S=E&&E.endpoint,x=Object(le.e)(e).itemsScopeItemKey||"itemsSCopeItemKey";if(v&&!w)return{};var T=Object(he.e)(e,{itemsScopeItemKey:x});if(T&&T.id===pe.e.id)return{};if(v){if(!d)return{};if(!w)return{};if(b){var N=d[".driveAccessToken"];y=N&&N.replace("access_token=","")}if(!E)return{};var C=E.driveId;return S&&C?{isAvailable:!0,itemSubscriber:f.createElement(be,{spPageContextKey:u,driveUrl:w,isTAB:b,listFullUrl:s,endpoint:S,driveAccessToken:y,webAbsoluteUrl:i,pageContext:a,itemsScopeItemKey:x})}:{}}return{isAvailable:!0,itemSubscriber:f.createElement(ye,{spPageContextKey:u,isTAB:b,itemKey:n,listFullUrl:s,webAbsoluteUrl:i,listId:p.id,pageContext:a,driveUrl:w,itemsScopeItemKey:x})}}}});n.d(t,"sharePointAddonAutoRefresh",function(){return Ee});var Ee=Object(i.t)(function(){return function(e){e(Object(s.r)(o.S,u.e)(we))}})}],Array(95),[function(e,t,n){"use strict";n.r(t);var r=n(19),i=n(12),s=n(3),o=n(517),u=n(1),a=n(941),f=Object(i.t)()(function(){return function(e){return function(e,t){return{quickEditLayout:u.createElement(a.e,null)}}}});var l=n(2871);n.d(t,"sharePointAddonQuickEdit",function(){return c});n.d(t,"QuickEditActionExecutor",function(){return l.QuickEditActionExecutor});var c=Object(r.t)(function(){return function(e){e(Object(i.r)(s.S,o.e)(f))}})}])]);