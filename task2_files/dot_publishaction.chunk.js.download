(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["dot_publishaction"],{1301:function(e,t,n){"use strict";var r=n(1403),i=n(1258),s=n(1260),o=n(30),u=n(1253),a=n(51),f=n(17),l=n(677),c=n(1319),h=n(479),p=n(15),d=new RegExp("^Templates$","i"),v=(function(){function e(){}e.isFolder=function(e,t){return t?e&&(e.type===u.e.Folder||e.type===u.e.OneNote):e&&e.type===u.e.Folder};e.isCheckedOut=function(e){return l.e(e)};e.isCheckedOutByUser=function(e,t){return l.n(e,t)};e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)};e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:r.e.FileCheckedoutOrLockedWarningTitle,component:{name:c.e.tagName,params:{text:r.e.FileCheckedoutOrLockedWarning}},actions:[{name:i.e.cancelActionText,execute:function(){return f.n.wrap(2)},icon:new s.e("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:o.e.Success}})};e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major};e.needsPublishingReminder=function(t,n){return!e.isPublished(t,n)&&(!(e.isPendingApproval(t,n)||!p.e.isActivated("20638368-710f-41c5-b78b-464db07fb707","04/27/2020","No publishing banner for page templates")&&e.isPageTemplate(t))&&(!(Object(h.isFeatureEnabled)(h.WexSitePagesScheduling)&&t.properties&&t.properties._ScheduledVersion&&t.properties.owshiddenversion===t.properties._ScheduledVersion)&&(a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0))))};e.isPublishingRelevant=function(t,n){return a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)};e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)};e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var r=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:r}}return{major:0,minor:0}};e.isPendingApproval=function(t,n){return!!n.isModerated&&(t&&t.properties&&t.properties[e.PublishProperty]&&"2"===t.properties[e.PublishProperty])};e.isPageTemplate=function(e){if(!e.id)return!1;var t=e.id.split("/"),n=t.length;return d.test(t[n-2])};e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&a.e.hasItemPermission(t,a.e.editListItems)&&a.e.hasItemPermission(t,a.e.approveItems)};e.FileTypeProperty="FSObjType";e.PublishProperty="_ModerationStatus.";e.VersionProperty="_UIVersion";return e})();t.e=v},1407:function(e,t,n){"use strict";var r=n(8),i=n(10),s=new r.t({name:"IFrameDialog.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("dot_iframedialog")]).then(n.bind(null,1690)).then(function(e){return e.resourceKey.local})})});t.e=s},2721:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(17),s=n(246),o=n(30),u=n(24),a=n(1260),f=n(1301),l=n(1484),c=n(151);Object(c.n)([{rawString:".Publish-textarea{overflow:auto;width:100%;border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";border-radius:0;font-weight:300;font-size:14px;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.Publish-textarea:hover{border-color:"},{theme:"neutralSecondaryAlt",defaultValue:"#8a8886"},{rawString:"}.Publish-textarea:focus{border-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}"}]);var h=n(1243),p=n(2976),d=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.commentsPlaceholder=p.e.CommentsPlaceholder;n.commentsLabel=p.e.CommentsLabel;n.comments=t.comments;return n}return t})(h.t),v=n(1245).e({tagName:"ms-publish-dialog-builder",template:'<div class="Publish"><div class="od-TextField od-TextField--multiline"><label class="od-Label" for="PublishTextArea" data-bind="text:commentsLabel"></label><textarea id="PublishTextArea" class="Publish-textarea od-TextField-field" rows="5" cols="45" title="commentsLabel" data-bind="value:comments,textInput:comments,hasFocus:true,attr:{placeholder:commentsPlaceholder}"></textarea></div></div>',viewModel:d}),m=n(479),g=n(23),y=n(34),b=n(1258),w=n(1249),E=n(1407),S=n(1250),x=n(163),T=n(89),N=n(141),C=n(1264),k=n(1261),L=n(1259),A=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Publish";r._itemParentHelper=r.resources.consume(k.e);r._pageContext=r.resources.consume(y.h);r._urlDataSource=r.resources.consume(T.me);r._publishProvider=r.resources.consume(x.v);r._itemSelectionHelper=new(r.child(L.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem(),t=e&&this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list")),n=e&&this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"subsite"));return(!n||n.subsite.serverRelativeUrl===this._pageContext.webAbsoluteUrl)&&(e&&t&&f.e.isPublishingRelevant(e,t.list)&&!f.e.isPublished(e,t.list))};t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,i.n,function(){var t,n,s,c,h,p,d,y,w=this;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=this._itemSelectionHelper.currentItem.peek();n=this.resources.consume(C.e);s=this.resources.consume(N.n);return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(c=r.sent()))return[2,i.n.resolve({resultCode:"EmptySelection",resultType:o.e.Failure})];h=s.getItemUrlParts(c.key);p=new(this.managed(l.default))({url:this._urlDataSource.getDefaultClickUrl(c),target:"_blank"});if(c.properties[f.e.PublishProperty]){d=this.observables.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(c,"list"));if(!g.e.isActivated("2eef7fc2-e16f-483d-b7da-bb467cbbfd1a","06/09/2018","Show submit for publish")&&d&&d.list.templateType===u.t.webPageLibrary&&Object(m.isFeatureEnabled)(m.WexSitePagesContentApproval)){p.execute(e);return[2,i.n.resolve({resultType:o.e.Success})]}return[2,this.invokeLegacyPublishingDialog(d,c,h,n,t)]}y=this.observables.create("");return[2,n.requestDialog({title:b.e.Publish,component:{name:v.tagName,params:{comments:y}},actions:[{name:b.e.Publish,execute:function(){return i.n.resolve(2)},isAvailable:this.observables.create(!0),isDefault:!0,icon:new a.e("Save"),automationId:"publishDialogCommit"}]}).wait().then(function(){return w._publishProvider.publishItem({parentKey:t.key,item:c,comments:y.peek()}).then(function(){return{resultType:o.e.Success}},function(){return{resultType:o.e.Failure}})})]}})})};t.prototype.invokeLegacyPublishingDialog=function(e,t,n,r,i){var u=this,a=this._pageContext.webAbsoluteUrl+"/"+this._pageContext.layoutsUrl+"/checkin.aspx?"+Object(s.t)({List:e.list.id,FileName:t.id,Publish:!0,Source:n.serverRelativeListUrl,IsDlg:1});return r.requestDialog({title:b.e.Publish,size:"XLarge",control:Object(w.r)(E.e,{componentUrl:a,showInDialog:!0,heightOffset:.75}),actions:[]}).wait().then(function(){u._publishProvider.invalidateItem({parentKey:i.key,item:t});return{resultType:o.e.Success}})};return t})(S.e);t.default=A}}]);