(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["dotdot_showshare_showshareaction"],{2241:function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(17),i=n(30),s=n(10),o=n(89),u=(function(){function e(e,t){this._ticketRedeemer=t.ticketRedeemer}e.prototype.redeemItem=function(e,t,n){return this.redeemItems([e],t,n)};e.prototype.redeemItems=function(e,t,n){return e&&e.some(function(e){return e&&e.tokenNeedsRedeeming})||n?r.n.resolve(this._ticketRedeemer()).then(function(n){return n?n.startRedeem(t,e&&e[0]):{resultType:i.e.Success}}):r.n.resolve({resultType:i.e.Success})};return e})(),a=Object(s.s)("ItemRedeemer",u,{ticketRedeemer:o.de.async.optional})},2611:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(30),s=n(89),o=n(1250),u=n(1259),a=n(17),f=n(1798),l=n(141),c=n(103),h=n(1285),p=n(1481),d=n(1638),v=n(34),m=n(2241),g=n(154),y=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.overrideItem,i=t.scenarioId,o=t.defaultRecipients;n._itemRedeemer=n.resources.consume(m.e);n._itemBeingShared=n.resources.consume(t.focusItemResourceKey);n._selectionHelper=new(n.child(u.e))({overrideItem:r?n.createObservable(t.overrideItem):null,allowMultiSelect:!1,canFallback:!0});n._sharingDataSourceHelper=new(n.managed(f.e));n._urlDataSource=n.resources.consume(s.me);n._itemCommandHelper=n.resources.consume(h.t);n._itemUrlHelper=n.resources.consume(l.n);n._pageContext=n.resources.consume(v.h);n._scenarioId=i;n._defaultRecipients=o;n.name="ShowShareAction";return n}t.prototype.onIsAvailable=function(){var t=this._selectionHelper.firstItem();if(!t)return!1;if(!this._itemCommandHelper.isCommandSupported(t,p.n))return!1;var n=this._itemUrlHelper.getItemUrlParts(t.key);if(n&&n.siteRelation===l.t.crossSite&&!this._pageContext.isNoScriptEnabled)return!1;var r=t.mruState,i=!r||r.canBeShared,s=!!this._sharingDataSourceHelper.getParentListId(t),o=t.properties&&(!!t.properties.ID||!!t.properties.uniqueId);return!!this._itemBeingShared()||e.prototype.onIsAvailable.call(this)&&!this._urlDataSource.isRecycleBin(t.queryType)&&!t.isRootFolder&&!t.list&&i&&s&&o&&!(t.lifeCycleStatus&&t.lifeCycleStatus.isExternal)};t.prototype.onExecute=function(e,t){var n=this;this._itemBeingShared.peek()&&this._itemBeingShared(void 0);var r=this._selectionHelper.firstItem.peek();return this._itemRedeemer.redeemItems([r],this).then(function(){t.data.extraData||(t.data.extraData={});c.e(t.data.extraData,{uniqueId:r.properties?r.properties.uniqueId:void 0,Host:Object(g.t)()});n._itemBeingShared({items:[r],scenarioId:n._scenarioId,defaultRecipients:n._defaultRecipients});return a.n.wrap({resultType:i.e.Success})},function(e){return a.n.reject(e)})};t.prototype.getEngagement=function(){return e.prototype.getEngagement.call(this).withPart(d.e,{item:this._selectionHelper.firstItem.peek()})};return t})(o.e);t.default=y}}]);