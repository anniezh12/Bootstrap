(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["deferred.odsp-shared-react"],{481:function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(2468),s=n(8),o=(function(){function e(e,t){this._componentType=e;this.dependencies=Object(r.__assign)(Object(r.__assign)({},e.dependencies||{}),t||{})}e.prototype.create=function(e){return{instance:Object(i.t)(this._componentType,e)}};return e})();(function(){function e(e,t){this._statelessComponent=e;this.dependencies=t}e.prototype.create=function(e){return{instance:Object(i.n)(this._statelessComponent,e)}}})();function u(e,t,n){return new s.t({name:e,factory:new o(t,n)})}},1171:function(e,t,n){"use strict";n.r(t);var r=n(38),i=n(155),s=n(871),o=r.n.isFeatureEnabled({ODB:1556}),u=(function(){function e(){}e.registerContentElement=function(t){if(e===Object(s.n)()){if(t!==e._contentElement){e._contentElement&&e._contentElement.removeEventListener("scroll",e._onScroll);e._contentElement=t;if(t)e._manageEventAttachment();else{e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}})}}}else Object(s.n)().registerContentElement(t)};e.registerCallbacks=function(t){if(e===Object(s.n)()){if(e._callbacks.indexOf(t)<0){e._callbacks.push(t);e._totalHeightDifference+=t.heightDifference;try{e._contentElement&&(e._contentElement.scrollTop-=t.heightDifference);this._isShyMode&&t.onShy()}catch(e){}e._manageEventAttachment();return!0}return!1}Object(s.n)().registerCallbacks(t)};e.unregisterCallback=function(t){if(e===Object(s.n)()){var n=e._callbacks.indexOf(t);if(n>=0){var r=e._callbacks[n];try{if(e._isShyMode){e._contentElement&&(e._contentElement.scrollTop+=r.heightDifference);r.onUnshy()}}catch(e){}e._totalHeightDifference-=r.heightDifference;e._callbacks.splice(n,1);e._manageEventAttachment();return!0}return!1}Object(s.n)().unregisterCallback(t)};e.unshy=function(){if(e===Object(s.n)()){e._enabledEventSent=!1;e._onShyEventSent=!1;e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}})}else Object(s.n)().unshy()};e._manageEventAttachment=function(){if(e.enabled&&e._contentElement){e._contentElement.removeEventListener("scroll",e._onScroll);e._contentElement.removeEventListener("mousedown",e._onMouseDown);e._contentElement.removeEventListener("mouseup",e._onMouseUp);if(e._callbacks.length){e._contentElement.addEventListener("scroll",e._onScroll);e._contentElement.addEventListener("mousedown",e._onMouseDown);e._contentElement.addEventListener("mouseup",e._onMouseUp);if(!e._enabledEventSent&&e._contentElement.scrollHeight-e._contentElement.clientHeight>e.scrollThresholdDown+e._totalHeightDifference){i.e.logData({name:"ShyConductor.Enabled"});e._enabledEventSent=!0}}}};e._onScroll=function(t){e._queueScrollEvent=!0;if(!e._isMouseDown){window.clearTimeout(e._handleScrollTimeoutId);e._handleScrollTimeoutId=window.setTimeout(e._handleScroll,25)}};e._onMouseDown=function(t){e._isMouseDown=!0};e._onMouseUp=function(t){e._isMouseDown=!1;e._queueScrollEvent&&e._handleScroll()};e._handleScroll=function(){if(e._queueScrollEvent){e._queueScrollEvent=!1;var t=e._contentElement.scrollTop-e._lastScrollPosition;if(t>=0&&!e._isShyMode){e._scrolledAmountConsecutively>=0?e._scrolledAmountConsecutively+=t:e._scrolledAmountConsecutively=t;if(e._scrolledAmountConsecutively>e.scrollThresholdDown&&e._contentElement.scrollTop-e._totalHeightDifference>e.scrollThresholdDown){if(!e._enabledEventSent){e._enabledEventSent=!0;i.e.logData({name:"ShyConductor.DelayedEnabled"})}if(!e._onShyEventSent){e._onShyEventSent=!0;i.e.logData({name:"ShyConductor.OnShy"})}e._isShyMode=!0;e._callbacks.forEach(function(e){try{e.onShy()}catch(e){}});e._contentElement.scrollTop-=e._totalHeightDifference}}else if(t<0&&e._isShyMode){e._scrolledAmountConsecutively<=0?e._scrolledAmountConsecutively+=t:e._scrolledAmountConsecutively=t;if(-e._scrolledAmountConsecutively>e.scrollThresholdUp||e._contentElement.scrollTop<e.scrollThresholdDown){e._isShyMode=!1;e._callbacks.forEach(function(e){try{e.onUnshy()}catch(e){}});e._contentElement.scrollTop+=e._totalHeightDifference}}e._lastScrollPosition=e._contentElement.scrollTop}};e.scrollThresholdDown=300;e.scrollThresholdUp=500;e.enabled=o;e._callbacks=[];e._totalHeightDifference=0;e._isShyMode=!1;e._lastScrollPosition=0;e._scrolledAmountConsecutively=0;e._isMouseDown=!1;e._queueScrollEvent=!1;e._enabledEventSent=!1;e._onShyEventSent=!1;return e})();t.default=u;Object(s.n)()||(window[s.e]=u)},1389:function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(1);function s(e,t,n,s){var o=e.split("{0}");s=Object(r.__assign)({key:"key"},s||{});return[o[0],i.createElement(n,s,t),o[1]]}},1542:function(e,t,n){"use strict";n.r(t);n.d(t,"SiteScriptProgressIndicator",function(){return p});var r=n(0),i=n(1),s=n(1234),o=n(79),u=n(1239),a=n(155),f=n(1506),l=n(3179),c=n(126),h=Object(c.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("dotdot_dotdot_sitescriptprogresspanel_sitescriptprogresspanel")]).then(n.bind(null,3507))];case 1:return[2,e.sent().SiteScriptProgressPanel]}})})}),p=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._onNewDataReceived=function(e){if(e.isSiteDesignPending&&!n._firstRunPanelExperience){a.e.logData({name:"SiteScripts.BarAppeared"});n._firstRunPanelExperience=!0}n.setState({isComplete:n._siteScriptProgressStateManager.isRunComplete(e.displayedRunKey),isVisible:e.isSiteDesignPending})};n._onOpenPanelAction=function(e){a.e.logData({name:"SiteScripts.OpenPanelFromGear.Click"});n.state.isPanelOpen||n.setState({isPanelOpen:!0})};n._onClickOpenPanel=function(e){a.e.logData({name:"SiteScripts.OpenPanelFromBar.Click"});n.setState({isPanelOpen:!0});e.stopPropagation();e.preventDefault()};n._onClickRefreshPage=function(e){a.e.logData({name:"SiteScripts.RefreshFromBar.Click"});window.location.href=n.props.pageContext?n.props.pageContext.webServerRelativeUrl:window.location.href};n._onPanelDismissed=function(){n.setState({isPanelOpen:!1})};n.state={isPanelOpen:!1,isComplete:!1,isVisible:!1};n._siteScriptProgressStateManager=f.SiteScriptProgressStateManager.getInstance({pageContext:t.pageContext});n._panelWasEverOpen=!1;n._firstRunPanelExperience=!1;return n}t.prototype.componentDidMount=function(){this._siteScriptProgressManagerKey="SiteScriptProgressIndicator"+Math.random().toString();this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.newProgressData,this._onNewDataReceived);this._siteScriptProgressStateManager.registerCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.openPanelAction,this._onOpenPanelAction)};t.prototype.componentWillUnmount=function(){this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.newProgressData);this._siteScriptProgressStateManager.unregisterCallback(this._siteScriptProgressManagerKey,f.SiteScriptProgressCallbackType.openPanelAction)};t.prototype.render=function(){this._panelWasEverOpen=this._panelWasEverOpen||this.state.isPanelOpen;var e;if(this.state.isVisible||this._siteScriptProgressStateManager.getState().isSiteDesignPending)if(this.state.isComplete){3!==(a=l.e.SiteScriptProgressIndicatorCompleteText.split(/{[01]}/)).length&&(a=[l.e.SiteScriptProgressIndicatorCompleteText,"",""]);var t=i.createElement(u.e,{onClick:this._onClickOpenPanel,"data-automationid":"SiteScriptProgressOpenPanelLink"},l.e.SiteScriptProgressIndicatorViewLink),n=i.createElement(u.e,{onClick:this._onClickRefreshPage},l.e.SiteScriptProgressIndicatorCompleteLink),r=void 0;r=l.e.SiteScriptProgressIndicatorCompleteText.indexOf("{0}")<=l.e.SiteScriptProgressIndicatorCompleteText.indexOf("{1}")?[t,n]:[n,t];e=i.createElement(s.e,{messageBarType:o.e.warning},a[0],r[0],a[1],r[1],a[2])}else{var a;2!==(a=l.e.SiteScriptProgressIndicatorIncompleteText5.split("{0}")).length&&(a=[l.e.SiteScriptProgressIndicatorIncompleteText5,""]);e=i.createElement(s.e,{messageBarType:o.e.warning},a[0],i.createElement(u.e,{onClick:this._onClickOpenPanel,"data-automationid":"SiteScriptProgressOpenPanelLink"},l.e.SiteScriptProgressIndicatorViewProgressLink5),a[1])}else{if(!this._panelWasEverOpen)return null;e=void 0}return i.createElement("div",null,e,i.createElement(h,{onDismissed:this._onPanelDismissed,siteScriptProgressStateManager:this._siteScriptProgressStateManager,isOpen:this.state.isPanelOpen,firstRunPanelExperience:this._firstRunPanelExperience,responsiveMode:this.props.responsiveMode,imageUrls:this.props.imageUrls,pageContext:this.props.pageContext}))};return t})(i.Component)},1727:function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(39),o=n(801),u=n(1116),a=n(1132),f=n(797),l=n(3749),c=n(2792),h=n(680),p=n(1239),d=n(1152),v="teamsIcon_b5add433",m="infoIcon_b5add433",g="tooltip_b5add433",y="createTeamText_b5add433",b="description_b5add433",w=n(3328),E=n(1389),S=n(155),x=n(3521),T=n(21),N=n(2943),C=n(2944),k=n(1134),L=n(288),A=n(15),O=n(38),M=n(83);n.d(t,"e",function(){return D});var _={ODB:1936},D=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._hideTeamifyKillswitch=!1;n._renderTooltipContent=function(){return O.n.isFeatureEnabled(_)?i.createElement("div",{className:g},w.e.toolTipContent):i.createElement("div",{className:g},w.e.teamsDescription1,i.createElement("br",null),i.createElement("br",null),Object(E.e)(w.e.teamsDescription2,w.e.createTeam,"span",{className:y}))};n._onHideTeamifyBanner=function(){new x.e({pageContext:n.props.pageContext}).hideTeamifyBanner();S.e.logData({name:"TeamifyBanner.Hide",isIntentional:!0});n.setState({hasDismissed:!0});n._onCloseHideTeamifyDialog()};n._onDismissTeamifyBanner=function(){var e=new x.e({pageContext:n.props.pageContext});S.e.logData({name:"TeamifyBanner.DismissPermanently",isIntentional:!0});e.dismissTeamifyBanner().then(function(){n._onCloseHideTeamifyDialog();n.setState({hasDismissed:!0})})};n._onClick=function(){n.setState({hasClickedLink:!0});if(O.n.isFeatureEnabled(_)){n._teamifyQos=new M.e({name:"TeamifyWizardLoader.Load"});n._toggleTeamify()}else{new x.e({pageContext:n.props.pageContext}).teamify().done(function(e){void 0!==e?n.setState({responseHasFailure:!1,responseHasSuccess:!0,teamUrl:e}):n.setState({responseHasFailure:!0})},function(e){n.setState({responseHasFailure:!0})})}S.e.logData({name:"TeamifyBanner.Click",isIntentional:!0})};n._onCloseHideTeamifyDialog=function(){n.setState({hideTeamifyDialogOpen:!1})};n._onOpenHideTeamifyDialog=function(){S.e.logData({name:"TeamifyBanner.OpenHideDialog",isIntentional:!0});n.setState({hideTeamifyDialogOpen:!0})};n._logClick=function(){n.setState({hasClickedLink:!0});S.e.logData({name:"TeamifyBanner.Click",isIntentional:!0})};n._toggleTeamify=function(){n.setState(function(e){return{showTeamifyWizard:!e.showTeamifyWizard}})};n.state={};n._createUrl=t.pageContext.webAbsoluteUrl+"/_layouts/15/groupstatus.aspx?Target=TEAM&Create=TRUE";n._usePostmethod=!A.e.isActivated("67615EE2-7930-41EE-A90D-4D174AB85A58","01/15/2019","Enable Teamify through POST method only.");n._hideTeamifyKillswitch=A.e.isActivated("61F9968C-D778-4963-9A95-573BC29B5CBF","02/03/2019","Enable Hide teamify banner");return n}t.prototype.render=function(){var e;if(!this._hideTeamifyKillswitch){if(this.state.hasDismissed)return null;e=[i.createElement(u.e,{className:"hideTeamifyButton_b5add433",ariaLabel:w.e.hideTeamifyButtonAriaLabel,iconProps:{iconName:"ChromeClose",className:"hideTeamifyIcon_b5add433"},onClick:this._onOpenHideTeamifyDialog}),this._renderHideTeamifyDialog()]}if(O.n.isFeatureEnabled(_)){var t=i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:m,tabIndex:0}));return i.createElement("div",null,i.createElement("div",{className:Object(s.e)(this.props.className,"teamifyBanner_b5add433")},e,i.createElement("div",{className:"titleWrapper_b5add433"},i.createElement(h.e,{className:v,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_b5add433"},w.e.title)),i.createElement("div",{className:b},w.e.teamifyDescription,!this._hideTeamifyKillswitch&&i.createElement("span",{className:"toolTipContainer_b5add433"},t),i.createElement("br",null),i.createElement(p.e,{onClick:this._onClick,className:"createTeamLink_b5add433"},w.e.linkDescription))),this.state.showTeamifyWizard&&i.createElement(N.e,{pageContext:this.props.pageContext,onDismiss:this._toggleTeamify,entryPoint:C.e.TeamifyBanner,strings:this.props.teamifyStrings,qos:this._teamifyQos}))}if(this._usePostmethod){var n="Microsoft Teams",r=(t=i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:m,tabIndex:0,ariaLabel:n+". "+w.e.description})),void 0);this.state.hasClickedLink?this.state.responseHasFailure||this.state.responseHasSuccess?this.state.responseHasFailure?r=i.createElement("div",{className:b},w.e.error):this.state.responseHasSuccess&&(r=i.createElement("div",{className:b},i.createElement(p.e,{href:this.state.teamUrl,target:"_blank"},w.e.visitTeam))):r=i.createElement("div",{className:b},w.e.description,i.createElement("br",null),i.createElement(k.e,{size:L.e.xSmall,className:"teamifySpinner_b5add433 teamifySpinner_b5add433"})," ",w.e.creating):r=i.createElement("div",{className:b},w.e.description,!this._hideTeamifyKillswitch&&i.createElement("span",{className:"toolTipContainer_b5add433"},t),i.createElement("br",null),i.createElement(p.e,{onClick:this._onClick,className:"createTeamLink_b5add433"},w.e.createTeam));return i.createElement("div",{className:Object(s.e)(this.props.className,"teamifyBanner_b5add433")},e,i.createElement("div",{className:"titleWrapper_b5add433"},i.createElement(h.e,{className:v,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_b5add433"},n),this._hideTeamifyKillswitch&&t),r)}if(this.state.hasClickedLink)return null;n="Microsoft Teams";return i.createElement("div",{className:Object(s.e)(this.props.className,"teamifyBanner_b5add433")},e,i.createElement("div",{className:"titleWrapper_b5add433"},i.createElement(h.e,{className:v,iconName:"TeamsLogoInverse"}),i.createElement("span",{className:"teamsName_b5add433"},n),i.createElement(d.e,{tooltipProps:{onRenderContent:this._renderTooltipContent}},i.createElement(h.e,{iconName:"Info",className:m,tabIndex:0,ariaLabel:n+". "+w.e.description}))),i.createElement("div",{className:b},w.e.description,i.createElement("br",null),i.createElement(p.e,{href:this._createUrl,onClick:this._logClick,target:"_blank"},w.e.createTeam)))};t.prototype.componentDidMount=function(){S.e.logData({name:"TeamifyBanner.Render",isIntentional:!1})};t.prototype._renderHideTeamifyDialog=function(){return i.createElement(l.e,{hidden:!this.state.hideTeamifyDialogOpen,type:c.e.close,dialogContentProps:{type:c.e.close,title:w.e.hideTeamifyDialogTitle,subText:T.format(w.e.hideTeamifyDialogDescription,w.e.hideTeamifyDialogPermanentDismissLink),showCloseButton:!0,onDismiss:this._onCloseHideTeamifyDialog},modalProps:{onDismiss:this._onCloseHideTeamifyDialog},isBlocking:!1},i.createElement("div",{className:"hideTeamifyDialogButtonContainer_b5add433"},i.createElement("div",{className:"hideTeamifyDialogButton_b5add433"},i.createElement(a.e,{onClick:this._onHideTeamifyBanner}," ",w.e.hideTeamifyDialogYesButton," ")),i.createElement("div",{className:"hideTeamifyDialogButton_b5add433"},i.createElement(f.e,{onClick:this._onCloseHideTeamifyDialog}," ",w.e.hideTeamifyDialogNoButton," "))),i.createElement("div",{className:"hideTeamifyDialogButtonContainer_b5add433"},i.createElement(p.e,{className:"dismissPermanentlyLink_b5add433",onClick:this._onDismissTeamifyBanner},w.e.hideTeamifyDialogPermanentDismissLink)))};return t})(o.e)},1770:function(e,t,n){"use strict";n.r(t);var r=n(1727);n.d(t,"TeamifyBanner",function(){return r.e});n.d(t,"default",function(){return r.e})},2468:function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});n.d(t,"n",function(){return a});var r=n(0),i=n(1),s=n(381),o={dependencies:s.object.isRequired};function u(e,t){var n=e,s={dependencies:Object(r.__assign)({},t||{})};return(function(e){Object(r.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getChildContext=function(){return s};t.prototype.render=function(){return i.createElement(n,Object(r.__assign)({},this.props))};t.childContextTypes=Object(r.__assign)({},o);return t})(i.Component)}function a(e,t){var n=e.contextTypes,i=void 0===n?{}:n,s=(i.dependencies,Object(r.__rest)(i,["dependencies"])),o=function(n,i){return e(n,Object(r.__assign)(Object(r.__assign)({},i),{dependencies:t}))};o.contextTypes=s;return o}},3776:function(e,t,n){"use strict";n.r(t);var r,i=n(1053),s=n(0),o=n(849),u=n(1),a=n(15),f=n(1133),l=n(235),c=n(39),h=n(314),p=n(801),d=n(38),v=n(539),m=n(96),g=n(833),y=n(376),b=n(680),w=n(151),E=n(248),S=n(380),x=n(429),T=n(1240),N=n(86),C=n(210),k=n(21),L=n(110),A=n(713),O=n(83),M=n(30),_=n(401),D=Object(S.e)();(function(e){e[e.KeyPress=0]="KeyPress";e[e.Hover=1]="Hover";e[e.Click=2]="Click"})(r||(r={}));var P,H={ODB:1532},B="overflow";function j(e){return e.key+e.name+e.url}var F=a.e.isActivated("3F0E3DD3-CE22-4531-9957-5B521CCCBEF0","11/19/2018","Horizontal Nav Contextualmenu use site theme"),I=a.e.isActivated("EA817D4C-4D11-4C1B-AE8F-DB4484CA1067","04/15/2019","Horizontal Nav use split button"),q=a.e.isActivated("8EA122D0-0C71-4CBE-A5C8-457B9CC4F850","05/07/2019","Horizontal Nav Jump Jank Fix"),R=(function(e){Object(s.__extends)(t,e);function t(n,r){var i=e.call(this,n,r)||this;i._horizontalNavItemsRef={};i._boundItemClick={};i._boundMainItemHover={};i._renderShimmer=function(e,n){var r=e&&e.data;i._asyncFetch(r);return i._getDeferredShimmer({customElementsGroup:i._getOneLeveOndemandElements(),width:t.MENU_WIDTH})};i._getOneLeveOndemandElements=function(){var e={type:3,width:t.MENU_ITEM_SIDE_MARGIN,height:t.MENU_ITEM_HEIGHT};return i._getDeferredShimmerElementsGroup({flexWrap:!0,shimmerElements:[e,{type:1,width:t.MENU_WIDTH-2*t.MENU_ITEM_SIDE_MARGIN,height:10},e,e,{type:1,width:t.MENU_WIDTH-2*t.MENU_ITEM_SIDE_MARGIN,height:10},e]})};i._onOverflowClick=function(e){if(i.state.contextMenuItems||i.state.lastTriggeringItem===B){i._onNavMenuDismiss();i.setState({lastTriggeringItem:null})}else i.setState({contextMenuItems:i.state.overflowItems,contextMenuRef:e.currentTarget,lastTriggeringItem:B})};i._onEditClick=function(e){i.props.editLink.onClick(e);i._fixNavEditExperienceKSActivated()?i.setState({isEditMode:!1}):i.setState({isEditMode:!0})};i._onMouseLeave=function(){i._async.clearTimeout(i._navItemHoverTimerId)};i._onMegaMenuMouseLeave=function(e){0!==i.state.lastTriggeringAction&&i._onNavMenuDismiss()};i._onNavMenuDismiss=function(e){if(e&&e.relatedTarget&&i._horizontalNavRegion.contains(e.relatedTarget)){e.stopPropagation();e.preventDefault()}else i.setState({contextMenuItems:null})};i._instanceIdPrefix=Object(x.e)("HorizontalNav");if(i._isAudienceTargeted()){i.state=i._getStateFromProps(Object(s.__assign)(Object(s.__assign)({},i.props),{items:[]}));i._applyInitialAudienceTargeting()}else i.state=i._getStateFromProps(i.props);i._editLinkWidth=-1;i._resolvedElement=function(e){return function(t){return i._horizontalNavItemsRef[e]=t}};Object(w.t)();i._qosEvent=new O.e({name:"HorizontalNav"});return i}t._isHeader=function(e){return!e||e===A.t};t._isMenuHoverDelayKSActivated=function(){return a.e.isActivated("c8868345-c04d-4ef1-81a4-75c0244d57de","09/18/2019","Increase menu hover delay to 500ms")};t.prototype.componentDidMount=function(){if(!this._isAudienceTargeted()||(this.state.items||[]).length>0){this._updateItemMeasurements();this._updateRenderedItems()}this._events.on(window,"resize",this._updateRenderedItems);this.props.onRendered&&this.props.onRendered(!0);this._isMounted=!0;this._qosEvent.end({resultType:M.e.Success})};t.prototype.componentWillUnmount=function(){this._isMounted=!1};t.prototype.UNSAFE_componentWillReceiveProps=function(e){var t=this._hasItemWidthChanged(this.props.items||[],e.items||[]),n=this._hasItemWidthChanged(this.props.overflowItems||[],e.overflowItems||[]);if(t){this._navItemWidths=void 0;this._navItemMargin=void 0}(t||n||!this._fixNavEditExperienceKSActivated()&&this.state.isEditMode&&this.state.isEditMode!==e.isEditMode||this.props.isEditMode!==e.isEditMode)&&this.setState(this._getStateFromProps(e))};t.prototype.componentDidUpdate=function(e,t){var n=this.state.overflowItems,r=t.overflowItems;if(!this._navItemWidths&&!this.state.isEditMode||!this._overflowStateChangedKSActive()&&n&&(!r||r.length!==n.length)||!this._fixNavEditExperienceKSActivated()&&t.isEditMode&&t.isEditMode!==this.state.isEditMode){this._updateItemMeasurements();this._updateRenderedItems()}this.props.onRendered&&this.props.onRendered(!1)};t.prototype.render=function(){var e=this.props,t=e.styles,n=void 0===t?this.props.getStyles:t,r=e.theme;this._classNames=D(n,{theme:r});var i=this.state,s=i.contextMenuItems,o=i.isEditMode,c=this._useMegaMenu&&this.state.lastTriggeringItem!==B;if(this._fixNavEditExperienceKSActivated()&&o)return u.createElement("div",null);var h=void 0;s&&(h=c?this._getDeferredMegaMenu(this._getMegaMenuProps(s)):F?this._getDeferredContextualMenu(this._getContextualMenuProps(s)):u.createElement(T.e,{settings:{theme:Object(C.t)()}},this._getDeferredContextualMenu(this._getContextualMenuProps(s))));var p=this.props.skipRole?void 0:"navigation",d=this._isMegaMenuEnhancementFlightEnabled()?this._onMegaMenuMouseLeave:this._onNavMenuDismiss;return u.createElement("div",{className:this._classNames.root,onMouseLeave:!a.e.isActivated("14829911-0e8d-4963-864d-e5f8d0f35149","11/12/2019","Mega menu hover off close")&&this.state.lastTriggeringItem!==B&&this._useMegaMenu?d:void 0,ref:this._resolveRef("_horizontalNavRegion"),role:p,"aria-label":this.props.ariaLabel},u.createElement(f.e,{direction:l.e.horizontal},u.createElement("div",{className:"ms-HorizontalNavItems",role:"menubar"},this._renderHorizontalNavItems(c&&h),this._renderOverflow(),this._renderEditLink())),!c&&s&&h)};t.prototype._asyncFetch=function(e){var t=this;if(!parent)return Promise.resolve();(this.props.getViewNavDataSource?this.props.getViewNavDataSource():Promise.resolve(new g.e(this.props.pageContext,"GlobalNavigationSwitchableProvider"))).then(function(t){return t.getMenuState({useCache:!0,depth:1,menuNodeKey:e})}).then(function(n){n&&n.links&&t._UpdateRenderedItemsWithSubmenuItems(e,n.links)},function(){t._qosEvent.verbose("HorizontalNav: FetchGlobalNavFailed")})};Object.defineProperty(t.prototype,"_useMegaMenu",{get:function(){var e=!1;this.props.ignoreChromeOptions||void 0===this.props.chromeOptions?e=this.props.useMegaMenu:this.props.chromeOptions&&(e=this.props.chromeOptions.nav.megaMenuEnabled);return e},enumerable:!0,configurable:!0});t.prototype._getDeferredContextualMenu=function(e){var t={modulePath:"office-ui-fabric-react/lib/ContextualMenu",moduleLoader:{load:function(){return n.e("shared-react-contextual-menu").then(n.bind(null,311)).then(function(e){return e.ContextualMenu})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredMegaMenu=function(e){var t={modulePath:"../MegaMenu/MegaMenuCallout",moduleLoader:{load:function(){return n.e("shared-react-mega-menu").then(n.bind(null,1549)).then(function(e){return e.MegaMenuCallout})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredShimmer=function(e){var t={modulePath:"office-ui-fabric-react/lib/Shimmer",moduleLoader:{load:function(){return n.e("fabric-shimmer").then(n.bind(null,1060)).then(function(e){return e.Shimmer})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getDeferredShimmerElementsGroup=function(e){var t={modulePath:"office-ui-fabric-react/lib/Shimmer",moduleLoader:{load:function(){return n.e("fabric-shimmer").then(n.bind(null,1060)).then(function(e){return e.ShimmerElementsGroup})}},props:e};return u.createElement(v.e,Object(s.__assign)({},t))};t.prototype._getContextualMenuProps=function(e){return{className:"ms-HorizontalNav",labelElementId:this._instanceIdPrefix+B,items:this._getContextualItemProps(e),target:this.state.contextMenuRef,onDismiss:this._onNavMenuDismiss,gapSpace:10,isBeakVisible:!1,directionalHint:m.e.bottomLeftEdge,shouldFocusOnMount:!0}};t.prototype._getMegaMenuProps=function(e){var t=this;return{layoutProps:{maxColumnCount:4,showDivider:!0,gridSpacingFromEdge:this._isMegaMenuEnhancementFlightEnabled()?8:void 0,enforceGridWidth:!0},onDismiss:this._onNavMenuDismiss,target:this.state.contextMenuRef,shouldFocusOnMount:0===this.state.lastTriggeringAction,pageContext:this.props.pageContext,theme:Object(C.t)(),sections:e.map(function(e){return{heading:{name:e.name,url:e.url,target:e.target,onClick:e.onClick},items:e.links&&t._getContextualItemProps(e.links),theme:Object(C.t)()}}),navigationSource:this.props.navigationSource}};t.prototype.measureLayout=function(){this._updateItemMeasurements();this._updateRenderedItems()};t.prototype._getContextualItemProps=function(e,n){var r=this;void 0===n&&(n=0);return e.filter(function(e){return!!e&&"1033"!==e.key}).map(function(e){var i,s=U(e),o=(function(e){return L.e.isFeatureEnabled(H)&&!!e&&e.hasChildLinks})(e),u=[];o&&u.push({key:"shimmerItem",text:"shimmer",data:e.key,onRender:r._renderShimmer});var a=g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank";if(I){i={key:j(e),name:e.name,href:s||t._isHeader(e.url)?void 0:e.url,items:s?r._getContextualItemProps(e.links,n+1):void 0};s?i.onMouseDown=t._isHeader(e.url)?e.onClick?function(t,n){return e.onClick(n,e)}:void 0:function(){return location.href=e.url}:i.onClick=e.onClick?function(t){return e.onClick(t,e)}:void 0}else{i={key:j(e),name:e.name,split:s||o,target:a,href:s||o||t._isHeader(e.url)?void 0:e.url,onClick:e.onClick?function(t){return e.onClick(t,e)}:void 0,subMenuProps:s?{items:r._getContextualItemProps(e.links,n+1)}:o?{items:u}:void 0};!s&&!o||t._isHeader(e.url)||(i.onClick=function(){window.open(e.url,a);e.forceAnchor&&e.onClick&&e.onClick()})}return i})};t.prototype._renderHorizontalNavItems=function(e){var t=this,n=this.state.renderedItems,r=this._isMegaMenuEnhancementFlightEnabled()&&this._useMegaMenu;if(n&&0!==n.length)return n.map(function(n){var i=j(n),s=r?t._onMainItemHoverMegaMenu.bind(t,n):t._boundMainItemHover[i]||t._onMainItemHover.bind(t,n),o=r?t._onNavMenuDismiss:t._onMouseLeave,a=k.format(t.props.splitButtonAriaLabel,n.name);return u.createElement("span",{className:"ms-HorizontalNavItem",key:i,ref:t._resolvedElement(i),role:"menuitem"},t._shouldRenderAsAnchor(n)?t._renderAnchorLink(n,i,s,o):t._renderButtonLink(n,i,s,o),U(n)?u.createElement("button",{className:Object(c.e)("ms-HorizontalNavItem-splitbutton",t._classNames.splitButton,{"ms-HorizontalNavItem-splitbutton-width":!t._chevronSpacingHardcodedKSActive()}),onClick:t._onItemClick.bind(t,n),onMouseEnter:s,onMouseLeave:t._onMouseLeave,"aria-label":a,"aria-haspopup":!0,onKeyDown:t._handleKeyPress.bind(t,n)},u.createElement(b.e,{iconName:"ChevronDown",className:Object(c.e)("ms-HorizontalNav-chevronDown",t._classNames.chevron)})):null,t.state.contextMenuItems===n.links&&e&&e)})};t.prototype._renderAnchorLink=function(e,t,n,r){var i=!!this.props.hasSelectedState&&this._isLinkSelected(e);return u.createElement("a",{className:Object(c.e)("ms-HorizontalNavItem-link",{"is-selected":i},{"is-not-selected":!q&&!i},this._classNames.link,i?this._classNames.linkSelected:this._classNames.linkUnselected),href:e.url,title:this._isMegaMenuEnhancementFlightEnabled()?void 0:e.title||e.name,"aria-label":e.ariaLabel,onMouseEnter:n,onMouseLeave:r,onKeyDown:this._handleKeyPress.bind(this,e),onClick:e.onClick?this._boundItemClick[t]:void 0,"aria-haspopup":U(e),role:"menuitem",target:g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank",rel:"noopener","aria-current":i,"data-navigationcomponent":Object(_.t)(this.props.navigationSource)},e.name)};t.prototype._shouldRenderAsAnchor=function(e){return(e.forceAnchor||void 0===e.forceAnchor)&&!t._isHeader(e.url)};t.prototype._renderButtonLink=function(e,n,r,i){var s=!!this.props.hasSelectedState&&this._isLinkSelected(e),o=t._isHeader(e.url);return u.createElement("button",{className:Object(c.e)("ms-HorizontalNavItem-link",{"is-selected":s},{"is-header":o},this._classNames.link,s?this._classNames.linkSelected:this._classNames.linkUnselected),title:this._isMegaMenuEnhancementFlightEnabled()?void 0:e.title||e.name,"aria-label":e.ariaLabel,onClick:this._boundItemClick[n]||this._onItemClick.bind(this,e),onMouseEnter:r,onMouseLeave:i,onKeyDown:this._handleKeyPress.bind(this,e),"aria-haspopup":U(e),disabled:o,"aria-current":s,role:"menuitem","data-navigationcomponent":Object(_.t)(this.props.navigationSource)},e.name)};t.prototype._renderOverflow=function(){var e=this.state.overflowItems;return e&&e.length?u.createElement("div",{className:"ms-HorizontalNavItem",key:B,ref:this._resolveRef("_overflowElementRef"),"data-automationid":"HorizontalNav-overflow"},u.createElement("button",{id:this._instanceIdPrefix+B,"aria-label":this.props.moreOptionsAriaLabel,className:Object(c.e)("ms-HorizontalNavItem-link",this._classNames.link,this._classNames.overflowButton),onClick:this._onOverflowClick,"aria-haspopup":!0,onKeyDown:this._handleKeyPress.bind(this,B),role:"menuitem"},u.createElement(b.e,{iconName:"More",className:"ms-HorizontalNavItem-overflow"}))):null};t.prototype._renderEditLink=function(){var e=this.props,t=e.editLink,n=e.isEditMode,r="portals"===window.teamsCustomAppType;return!t||n||r?null:u.createElement("div",{className:"ms-HorizontalNavItem",ref:this._resolveRef("_editLinkElementRef"),"data-automationid":"HorizontalNav-edit"},u.createElement("button",{id:this._instanceIdPrefix+"EditLink",className:Object(c.e)("ms-HorizontalNavItem-link",this._classNames.link,this._classNames.editButton),onClick:this._onEditClick,"aria-label":t.ariaLabel?t.ariaLabel:t.name},t.name))};t.prototype._updateItemMeasurements=function(){this._currentOverflowWidth=this._overflowElementRef||this.props.overflowItems&&this.props.overflowItems.length?32.67:0;-1===this._editLinkWidth&&this.props.editLink&&this._editLinkElementRef&&(this._editLinkWidth=this._getElementWidth(this._editLinkElementRef,this._getElementMargin(this._editLinkElementRef)));this._navItemWidths||(this._navItemWidths={});for(var e=0,t=this.state.items;e<t.length;e++){var n=j(t[e]),r=this._horizontalNavItemsRef[n];void 0===this._navItemMargin&&(this._navItemMargin=this._getElementMargin(r));this._navItemWidths[n]||(this._navItemWidths[n]=this._getElementWidth(r,this._navItemMargin))}};t.prototype._getElementWidth=function(e,t){return e?e.getBoundingClientRect().width+t:0};t.prototype._getElementMargin=function(e){return parseInt(Object(h.e)()?window.getComputedStyle(e).marginLeft:window.getComputedStyle(e).marginRight,10)};t.prototype._updateRenderedItems=function(){this._horizontalNavRegion&&this._UpdateRenderedItemsCore(this.state.items)};t.prototype._UpdateRenderedItemsCore=function(e){for(var t=Object(s.__spreadArrays)(e),n=this._horizontalNavRegion.clientWidth-this._currentOverflowWidth-this._editLinkWidth,r=this.props.overflowItems||[],i=0,o=!1,u=0;u<t.length;u++){var a=j(t[u]),f=this._navItemWidths[a];if(i+f>=n){u>0&&0===r.length&&n-i<32.67&&u--;r=t.splice(u).concat(r);o=!0;break}i+=f}this._renderReductionEnabled()&&!o||this.setState({renderedItems:t,overflowItems:r})};t.prototype._UpdateRenderedItemsWithSubmenuItems=function(e,t){var n=this.state.items;this._InsertItemsWithSubmenuItems(n,e,t);this._UpdateRenderedItemsCore(n)};t.prototype._InsertItemsWithSubmenuItems=function(e,t,n){if(!e||!parent||!n)return!1;for(var r=!1,i=0;i<e.length;i++){if(e[i].key===t){e[i].links=n;r=!0;break}if(e[i].links&&e[i].links.length>0&&this._InsertItemsWithSubmenuItems(e[i].links,t,n)){r=!0;break}}return r};t.prototype._onAnchorClick=function(e,t){e.onClick&&e.onClick(t,e)};t.prototype._onItemClick=function(e,n){this._navItemHoverTimerId&&this._async.clearTimeout(this._navItemHoverTimerId);n.stopPropagation();n.preventDefault();if(this.state.contextMenuItems||this.state.lastTriggeringItem===e){this.setState({lastTriggeringItem:null});this._onNavMenuDismiss()}else"I"!==n.target.tagName?e.onClick?e.onClick(n,e):t._isHeader(e.url)||window.open(e.url,g.e.shouldLinkOpenInSameWindow(e.url)?"_self":"_blank"):this._openSubMenu(e.links,n.currentTarget,e,2)};t.prototype._onMainItemHover=function(e,n){var r=this;t._isHeader(e.url)||(window.status=e.url);n.stopPropagation();n.preventDefault();var i=n.currentTarget;U(e)&&(this._navItemHoverTimerId=this._async.setTimeout(function(){if(r.state.contextMenuItems!==e.links){r.state.contextMenuItems&&r._onNavMenuDismiss();r._openSubMenu(e.links,i,e,1)}},t._isMenuHoverDelayKSActivated()?250:500))};t.prototype._onMainItemHoverMegaMenu=function(e,n){t._isHeader(e.url)||(window.status=e.url);n.stopPropagation();n.preventDefault();if(U(e)&&this.state.contextMenuItems!==e.links){this.state.contextMenuItems&&this._onNavMenuDismiss();this._openSubMenu(e.links,n.currentTarget,e,1)}else U(e)||this._onNavMenuDismiss()};t.prototype._handleKeyPress=function(e,t){if(32===t.which||40===t.which||13===t.which&&t.target&&-1!==t.target.className.indexOf("ms-HorizontalNavItem-splitbutton")){t.stopPropagation();t.preventDefault();e===B?this._openSubMenu(this.state.overflowItems,t.target,e,0):this._openSubMenu(e.links,t.target,e,0)}};t.prototype._openSubMenu=function(e,n,r,i){a.e.isActivated("84e53a0e-a1a6-48da-ae07-d6ece0ff59a5","09/18/2019","Allow only one mega menu opened")||N.e.raise(window,t.SUBMENU_OPEN_EVENT);if(-1!==n.className.indexOf("ms-HorizontalNavItem-splitbutton")||"i"===n.tagName&&r!==B){for(var s=n;s&&"span"!==s.tagName.toLowerCase();)s=s.parentElement;s&&s.children&&s.children.length>0&&(n=s.children[0])}this.setState({lastTriggeringItem:r,contextMenuItems:e,contextMenuRef:n,lastTriggeringAction:i})};t.prototype._isAudienceTargeted=function(){if(!this.props||!this.props.pageContext)return!1;var e=new y.e(this.props.pageContext);return y.e.isAudienceTargetedNavEnabled()&&this.props.pageContext&&this.props.isAudienceTargeted&&(!y.e.shouldDisplayAudienceTargetingSetting()||e.isAudienceTargetedNavEnabledBasedOnWebProperty())};t.prototype._applyInitialAudienceTargeting=function(){var e=this;new y.e(this.props.pageContext).getCurrentUserMemberships().then(function(t){e._audienceMemberships=t;e._isMounted?e.setState(e._getStateFromProps(e.props)):e.state=e._getStateFromProps(e.props)}).catch(function(){e.setState(e._getStateFromProps(e.props))})};t.prototype._getStateFromProps=function(e){var t=e.overflowItems,n=e.isEditMode,r=this._isAudienceTargeted()?y.e.filterLinksWithMemberships(e.items,this._audienceMemberships):e.items;this._boundItemClick={};this._boundMainItemHover={};for(var i=0,s=r;i<s.length;i++){var o=s[i],u=j(o);this._boundItemClick[u]=this._shouldRenderAsAnchor(o)?this._onAnchorClick.bind(this,o):this._onItemClick.bind(this,o);this._boundMainItemHover[u]=this._onMainItemHover.bind(this,o)}return{renderedItems:r,overflowItems:t||[],contextMenuItems:null,isEditMode:n,selectedKey:void 0,items:r}};t.prototype._isLinkSelected=function(e){if(void 0!==this.props.selectedKey)return e.key===this.props.selectedKey;if(void 0!==this.state.selectedKey&&e.key===this.state.selectedKey)return!0;if("undefined"==typeof window)return!1;if(t._isHeader(e.url))return!1;(P=P||document.createElement("a")).href=e.url||"";var n=this._isLinkComparisonKSActive()?P.href:P.href.toLowerCase(),r=this._isLinkComparisonKSActive()?n+"/SitePages/Home.aspx":(n+"/SitePages/Home.aspx").toLowerCase(),i=this._isLinkComparisonKSActive()?location.href:location.href.toLowerCase();if(i===n||i===r)return!0;var s=this._isLinkComparisonKSActive()?location.protocol+"//"+location.host+location.pathname:(location.protocol+"//"+location.host+location.pathname).toLowerCase();if(s===n||s===r)return!0;if(location.hash){if(location.hash===e.url)return!0;P.href=location.hash.substring(1);return P.href===n}return!1};t.prototype._hasItemWidthChanged=function(e,t){return e.length!==t.length||e.map(function(e,n){var r=t[n];return e.name!==r.name||1==((e.links||[]).length^(r.links||[]).length)}).reduce(function(e,t){return e||t},!1)};t.prototype._fixNavEditExperienceKSActivated=function(){return a.e.isActivated("30b9a746-134f-4465-8f2c-f38c2440159a","03/02/2020","fix nav edit experience")};t.prototype._isMegaMenuEnhancementFlightEnabled=function(){return d.n.isFeatureEnabled({ODB:1811})};t.prototype._chevronSpacingHardcodedKSActive=function(){return a.e.isActivated("9ab54c9f-d74c-4739-82ad-0cc1696009e5","4/10/2020","hardcode the widths of horizontalNav chevron icons")};t.prototype._overflowStateChangedKSActive=function(){return a.e.isActivated("34034F80-F8DD-4FB2-99B2-A2931D4FC65F","4/22/2020","update item measurements when horizontal nav overflow changes")};t.prototype._isLinkComparisonKSActive=function(){return a.e.isActivated("8a8d92e8-6c30-46d8-aa0b-7c6e761cc1ee","5/1/2020","make the selected url logic case insensitive")};t.prototype._renderReductionEnabled=function(){return this.props.pageContext&&1===Object(E.e)(90031,this.props.pageContext)&&d.n.isFeatureEnabled({ODB:653})};t.SUBMENU_OPEN_EVENT="submenu_open";t.MENU_WIDTH=200;t.MENU_ITEM_SIDE_MARGIN=8;t.MENU_ITEM_HEIGHT=32;return t})(p.e);function U(e){return!!(e&&e.links&&e.links.length)}n.d(t,"HorizontalNav",function(){return z});var z=Object(i.e)(R,function(e){var t=e.theme,n=t.palette,r=t.semanticColors;return{root:"ms-HorizontalNav",link:[Object(s.__assign)(Object(s.__assign)({color:r.bodySubtext},t.fonts.small),{selectors:{":hover":{color:n.themePrimary},"&.is-header":{cursor:"auto",color:r.bodySubtext}}})],linkUnselected:{border:"none"},linkSelected:Object(s.__assign)({color:r.bodyText,borderBottom:"2px solid "+n.themePrimary},Object(o.e)(t).semibold),splitButton:{selectors:{":hover":{color:n.themePrimary}}},chevron:{color:r.bodySubtext},editButton:["ms-HorizontalNavItem-Edit",{border:"none",color:n.themePrimary,selectors:{":hover":{color:n.themeDarker,textDecoration:Object(o.t)()&&"underline"}}}],overflowButton:{border:"none"}}})}}]);