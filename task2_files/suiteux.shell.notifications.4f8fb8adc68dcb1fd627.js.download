var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_notifications_start"),(window.suiteux_shell_webpackJsonp_main=window.suiteux_shell_webpackJsonp_main||[]).push([["notifications"],{282:function(e,t,i){"use strict";i.r(t);var n=i(2),a=i(27),o=i(10),s=i(3),c=i(1),r=i(25),l=i(17),d=i(178),f=i(0),p=i(46),u=i(54),b=i(9),m=i(16),h=i(5),g=i(31),S=i(151),I=function(e){function t(t){return e.call(this,t)||this}return Object(f.__extends)(t,e),t.prototype.getUnseenItemsCount=function(){var e=this,t=0;return null!=this.props.notifications&&this.props.notifications.length>0&&this.props.notifications.forEach((function(i){if((e.props.includeUnseenMailInCount||i.providerType!==S.a.NewMailNotification)&&i.providerType!==S.a.ChatNotification)if(i.providerType===S.a.NewAppNotification&&i.payload){var n=i.payload;t+=n.UnseenCount}else 0!==i.toastState&&1!==i.toastState||t++})),t},t.prototype.componentDidMount=function(){this.getUnseenItemsCount()>0&&this.props.setAriaLabelId&&this.props.setAriaLabelId(this.props.bellAriaLabelID)},t.prototype.componentDidUpdate=function(){this.getUnseenItemsCount()>0&&this.props.setAriaLabelId&&this.props.setAriaLabelId(this.props.bellAriaLabelID)},t.prototype.render=function(){var e=this.getUnseenItemsCount(),t=Object(s.H)(h.a.UnreadBadge_Title,e.toString(),h.a.Bell_Title);return n.createElement(s.q,{unseenItemCount:e,isParentHovered:this.props.isParentHovered,badgeStyles:this.props.badgeStyles},n.createElement("label",{htmlFor:this.props.bellAriaID,id:this.props.bellAriaLabelID,className:s.O.visuallyHidden},t))},t}(n.Component),y=Object(o.b)((function(e,t){return{notifications:e.notificationState.notifications,includeUnseenMailInCount:!Object(g.c)(e.shellInitDataState.clientData.WorkloadId),isParentHovered:t.isParentHovered,badgeStyles:t.badgeStyles}}))(I),x=function(e){function t(t){var i=e.call(this,t)||this;return i.setBellAriaLabel=function(e){i.setState({bellAriaLabel:e})},i.state={isHovered:!1,bellAriaLabel:null},i}return Object(f.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isAvailable&&Object(c.e)().perfMarker("BellTimeToInteractive")},t.prototype.render=function(){var e=this,t=!0;this.props.notifications&&this.props.notifications.some((function(e){return 3!==e.toastState}))&&(t=!1);var i=t&&this.props.isActive?h.a.Notification_Title+", "+h.a.NoNewNotifications+", "+h.a.NoNewCheckLaterNote:h.a.Notification_Title,a={controlID:this.props.id,isVisible:this.props.isAvailable,ariaLabel:null==this.state.bellAriaLabel?i:null,ariaLabelledBy:this.state.bellAriaLabel,affordanceMenuItemText:h.a.Notifications,iconID:"Ringer",iconFontSize:b.f.toString(),isActive:this.props.isActive,isDarkModeEnabled:this.props.isDarkModeEnabled,onClick:this.props.onClick,onHoverStateChanged:function(t){e.setState({isHovered:t})},onDimensionsChanged:this.props.controlDimensionsChanged};return 0===this.props.renderContext?n.createElement(p.b,Object(f.__assign)({},a),n.createElement(y,{isParentHovered:this.state&&this.state.isHovered,bellAriaID:l.h,bellAriaLabelID:"BellAriaLabel",setAriaLabelId:this.setBellAriaLabel,badgeStyles:m.headerButtonBadgePosition})):n.createElement(p.a,Object(f.__assign)({},a),n.createElement(y,{isParentHovered:this.state&&this.state.isHovered,bellAriaID:l.h,bellAriaLabelID:"BellAriaLabel",setAriaLabelId:this.setBellAriaLabel,badgeStyles:u.affordanceContextMenuItemBadgePosition}))},t}(n.Component),v=Object(o.b)((function(e,t){return{isAvailable:!!e.notificationState&&e.notificationState.notificationsEnabled,id:t&&t.id,isActive:e.flexPaneState&&"Notifications"===e.flexPaneState.activeProviderKey,notifications:e.notificationState.notifications,controlDimensionsChanged:t.controlDimensionsChanged}}),(function(e){return{onClick:function(t,i){t.stopPropagation(),Object(c.e)().click("Notifications","NotificationsPane",null,null,"Active state: "+i.isActive+", Render context: "+i.renderContext),i.onClick&&i.onClick(t),e(Object(s.db)(t.currentTarget&&t.currentTarget.id)),e(Object(r.f)("Notifications"))}}}),(function(e,t,i){var n=Object(f.__assign)(Object(f.__assign)({},i),e);return Object(f.__assign)(Object(f.__assign)(Object(f.__assign)({},n),t),{onClick:function(e){return t.onClick(e,n)}})}))(x),O=i(158),A=i(466),N=i(297),C=i(541),T=i(13),w=i(299),j=function(e){function t(t){var i=e.call(this,t)||this;return i.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),Object(c.e)().click("Close","NotificationToast",S.a[i.props.notification.providerType]),i.props.isInFlexPane||i.props.onToastClose(i.props.notification.payload.id),i.props.dismiss(i.props.notification.payload.id)},i.onMailClick=function(e){e.preventDefault(),e.stopPropagation();var t=i.props.notification.navigationUrl;null!=t&&""!==t&&(Object(c.e)().click("NotificationClick",i.props.isInFlexPane?"NotificationsPane":"NotificationToast",S.a[i.props.notification.providerType],"Mail"),i.props.notification.isCondensed?Object(g.c)(i.props.notificationConfiguration.workloadID)||null!=i.props.notificationConfiguration&&null!=i.props.notificationConfiguration.owaLaunchUrl&&window.open(i.props.notificationConfiguration.owaLaunchUrl,"Mail","toolbar=0,status=0,width=1000,height=325"):Object(A.a)(t),i.props.dismiss(i.props.notification.payload.id)),i.props.isInFlexPane||i.props.onToastClose(i.props.notification.payload.id)},i.handleKeyDown=function(e){13===e.keyCode&&i.onMailClick(e)},i.setEmailState=function(e,t){if(e.stopPropagation(),e.preventDefault(),i.setState({isHover:t}),!i.props.isInFlexPane){var n=i.props.notification.payload.id;t?i.props.clearTimer(n):i.props.setTimer(n)}},i.handleOnError=function(){Object(c.e)().tag("NewMailNotification_MePhoto_LoadError",4)},i.handleOnFocus=function(){i.setState({isHover:!0})},i.handleOnBlur=function(){i.setState({isHover:!1})},i.handleOnMouseEnter=function(e){i.setEmailState(e,!0)},i.handleOnMouseLeave=function(e){i.setEmailState(e,!1)},i.state={isHover:!1},i}return Object(f.__extends)(t,e),t.prototype.componentDidMount=function(){null!=this.props.setTimer&&this.props.setTimer(this.props.notification.payload.id),null!=this.props.notification&&this.props.alertImpressionLogEnabled&&Object(c.e)().impression(S.a[this.props.notification.providerType],this.props.isInFlexPane?"FlexPane":"NotificationToast")},t.prototype.componentWillUnmount=function(){null!=this.props.clearTimer&&this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){var e,t=this.props.notification.payload,i=null,a="",o=Object(T.a)();if(!this.props.isInFlexPane&&this.props.notification.isCondensed){var c=Object(s.H)(h.a.CondensedNewMailMessage,this.props.notification.condensedCount.toString());a=c,i=n.createElement("div",{className:Object(s.x)(C.condensed)},n.createElement(s.f,{className:Object(s.x)(N.icon,C.condensedIcon),fontIconCss:"ms-Icon--Mail"}),n.createElement("span",{className:Object(s.x)(C.condensedMailText,o.neutral.dark.font)},c))}else{a=t.PreviewText.length<70?t.Sender+" "+t.Subject+" "+t.PreviewText:t.Sender+" "+t.Subject+" "+t.PreviewText.substring(0,70);var r=Object(T.a)();i=n.createElement("div",{className:Object(s.x)(C.itemContent)},n.createElement("div",{className:Object(s.x)(s.O.table,s.O.maxWidth,s.O.maxHeight)},n.createElement("div",{className:Object(s.x)(C.newMailPersonaImage,s.O.tableCellMiddle)},n.createElement(O.a,{photoSize:32,upn:t.SenderSmtpEmailAddress,displayName:t.Sender,onError:this.handleOnError})),n.createElement("div",{className:s.O.tableCellMiddle},n.createElement("span",{className:Object(s.x)(C.mailText,C.sender,N.notificationTitle,r.neutral.dark.font)},t.Sender),n.createElement("div",null,n.createElement("div",{className:C.mailIcon},n.createElement(s.f,{className:Object(s.x)(N.icon,r.neutral.dark.font),fontIconCss:"ms-Icon--Mail",fontSize:"10px",isAriaHidden:!0})),n.createElement("span",{className:Object(s.x)(s.O.maxWidth,C.mailText,C.mailSubject,r.neutral.tertiary.font)},t.Subject)))),n.createElement("span",{className:Object(s.x)(C.mailText,C.bodyPreviewText,r.neutral.secondary.font)},t.PreviewText))}return n.createElement("div",{id:"NewMailItemId",role:"group","aria-label":a,className:Object(s.x)(C.newMailLink),onContextMenu:w.f,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave,tabIndex:0,onClick:this.onMailClick,onKeyDown:this.handleKeyDown},n.createElement("button",{type:"button",onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,className:Object(s.x)((e={},e[s.O.visuallyHidden]=!this.state.isHover&&this.props.isInFlexPane,e),N.closeButton,o.neutral.secondary.font,o.neutral.lightAlt.hover.background),onClick:this.onCloseButtonClick,"aria-label":h.a.DismissNotification,title:h.a.DismissNotification},n.createElement(s.f,{className:N.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),n.createElement("div",{className:Object(s.x)(C.newMailPopupButton)},n.createElement("div",{className:Object(s.x)(C.newMailPopupButtonCell)},i)))},t}(n.Component),E=i(543),D=function(e){function t(t){var i=e.call(this,t)||this;return i.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=i.props.notification.payload.systemAlert,n=t.ActionUrl;if(Object(c.e)().click("NotificationClick",i.props.isInFlexPane?"NotificationsPane":"NotificationToast",S.a[i.props.notification.providerType],null,i.props.notification.subType),t.ActionCallback&&t.ActionCallback(),null!=n&&""!==n){var a=t.ActionTarget||"_self";window.open(n,a)}i.props.onToastClose&&i.props.onToastClose(i.props.notification.payload.id)},i.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),Object(c.e)().click("Close","NotificationToast",S.a[i.props.notification.providerType],null,i.props.notification.subType),i.props.onToastClose&&i.props.onToastClose(i.props.notification.payload.id),i.props.dismiss(i.props.notification.payload.id)},i.handleKeyDown=function(e){13===e.keyCode&&i.onClick(e)},i.setReminderState=function(e,t){e.stopPropagation(),e.preventDefault(),i.setState({isHover:t})},i.handleOnFocus=function(){i.setState({isHover:!0})},i.handleOnBlur=function(){i.setState({isHover:!1})},i.handleOnMouseEnter=function(e){i.setReminderState(e,!0)},i.handleOnMouseLeave=function(e){i.setReminderState(e,!1)},i.state={isHover:!1},i}return Object(f.__extends)(t,e),t.prototype.componentDidMount=function(){if(this.props.isInFlexPane||0!==this.props.notification.toastType||this.props.setTimer(this.props.notification.payload.id),null!=this.props.notification&&this.props.alertImpressionLogEnabled){var e=S.a[this.props.notification.providerType];this.props.notification.subType&&(e=e+":"+this.props.notification.subType),Object(c.e)().impression(e,this.props.isInFlexPane?"FlexPane":"NotificationToast")}},t.prototype.componentWillUnmount=function(){this.props.isInFlexPane||0!==this.props.notification.toastType||this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){var e,t,i,a=this.props.notification.payload.systemAlert,o=Object(T.a)();return n.createElement("div",{id:"SystemAlert"+(this.props.isInFlexPane?"_pane":"")+a.Id,role:"group",tabIndex:0,onClick:this.onClick,onKeyDown:this.handleKeyDown,className:Object(s.x)(E.container,o.neutral.light.border),onContextMenu:w.f,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave,"aria-label":a.Title+" "+a.Message},n.createElement("button",{type:"button",onClick:this.onCloseButtonClick,className:Object(s.x)((e={},e[s.O.visuallyHidden]=!this.state.isHover,e),E.systemClose,N.closeButton,o.neutral.secondary.font,o.neutral.lightAlt.hover.background),"aria-label":h.a.DismissNotification,title:h.a.DismissNotification},n.createElement(s.f,{className:N.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),n.createElement("div",null,n.createElement(s.f,{className:Object(s.x)(s.O.tableCellMiddle,s.O.floatLeft,o.neutral.dark.font,(t={},t[E.alertIcon]=!this.props.isInFlexPane,t),(i={},i[E.alertPaneIcon]=this.props.isInFlexPane,i)),fontIconCss:"ms-Icon--Warning",isAriaHidden:!0}),n.createElement("span",{className:Object(s.x)(E.title,o.neutral.dark.font)}," ",a.Title),n.createElement("span",{className:Object(s.x)(E.message,N.notificationBodyText,o.neutral.secondary.font)},a.Message)),n.createElement("div",{"aria-label":a.ActionText,className:Object(s.x)(N.actionBar,o.neutral.accent.font,o.neutral.light.border)},n.createElement("a",{tabIndex:0,role:"button",onClick:this.onClick,onKeyDown:this.handleKeyDown,"aria-label":a.ActionText,className:Object(s.x)(N.notificationLink,o.neutral.accent.link)},n.createElement("span",{className:N.itemLink,role:"link","aria-label":a.ActionText},a.ActionText),n.createElement(s.f,{className:Object(s.x)(N.icon,N.actionArrow),fontIconCss:"ms-Icon--Forward"}))))},t}(n.Component),_=i(400),M=i(356),R=i(545),P=function(e){function t(t){var i=e.call(this,t)||this;return i.dismiss=function(e){e.preventDefault(),e.stopPropagation(),Object(c.e)().click("Dismiss",i.props.isInFlexPane?"NotificationsPane":"NotificationToast",S.a[S.a.ReminderNotification]),null!=i.props.reminderItem?i.props.onDismiss(i.props.reminderItem.payload.id,i.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId):Object(c.e)().tag("Notifications_DismissReminder_EmptySelectedReminder",6)},i.setStateWhenBlur=function(){i.state.isIconFocus||null!=i.props.snoozeReminderId||window.setTimeout((function(){i.setState({isReminderFocus:!1}),i.props.onSelectedItem(null)}),500)},i.setReminderState=function(e,t){e.preventDefault(),e.stopPropagation(),i.props.snoozeReminderId||i.setState({isHover:t})},i.handleKeyDown=function(e){13===e.keyCode&&i.onClick(e)},i.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=i.props.reminderItem.payload.reminder;i.props.snoozeReminderId===t.ReminderItemDataModel.ItemId?i.props.onSnoozeClose():(i.props.onClick(t.ReminderItemDataModel.ItemId),null!=i.props.config&&null!=i.props.config.workloadID&&(t.OpenItem(i.props.config.workloadID,i.props.config.owaLaunchUrl),i.props.onDismiss(i.props.reminderItem.payload.id,i.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId)))},i.onSnoozeClick=function(e){e.preventDefault(),e.stopPropagation();var t=i.props.reminderItem.payload.reminder.ReminderItemDataModel.ItemId;i.props.snoozeReminderId?i.props.onSnoozeClose():t&&i.props.onSnoozeClick(t,document.activeElement)},i.handleOnSnoozeFocus=function(){i.setState({isIconFocus:!0,isReminderFocus:!0})},i.handleOnReminderFocus=function(){i.setState({isReminderFocus:!0})},i.handleSnoozeButtonOnBlur=function(){i.setState({isIconFocus:!1})},i.handleCloseButtonOnBlur=function(){i.setState({isIconFocus:!1,isReminderFocus:!1})},i.handleOnClick=function(e){i.dismiss(e)},i.handleOnMouseEnter=function(e){i.setReminderState(e,!0)},i.handleOnMouseLeave=function(e){i.setReminderState(e,!1)},i.state={isHover:!1,isIconFocus:!1,isReminderFocus:!1},i}return Object(f.__extends)(t,e),t.prototype.componentDidMount=function(){null!=this.props.reminderItem.payload.reminder&&this.props.alertImpressionLogEnabled&&Object(c.e)().impression(S.a[this.props.reminderItem.providerType],this.props.isInFlexPane?"FlexPane":"NotificationToast")},t.prototype.componentWillReceiveProps=function(e){if(this.props.LastUpdatedTime!==e.LastUpdatedTime){var t=this.props.reminderItem.payload.reminder;t.UpdateReferenceTime(this.props.LastUpdatedTime),M.a.isVisibleReminderOverdue(t.ReminderItemDataModel.EndDate)||this.props.removeReminder(this.props.reminderItem.payload.id)}},t.prototype.render=function(){var e,t,i,a,o=Object(T.a)(),c=this.props.reminderItem.payload.reminder;c.UpdateReferenceTime(this.props.LastUpdatedTime);var r=this.props.order,l=Object(s.x)(R.remindersRemain,s.O.tableCellMiddle,R.remindersRightColumn,((e={})[o.neutral.darkRed.font]=c.IsReminderOverdue,e[o.neutral.dark.font]=!c.IsReminderOverdue,e)),d=n.createElement("div",{id:"rmdcontext"+r,"aria-labelledby":"rmdSubject"+r+" rmdBody"+r,className:Object(s.x)(N.overflowHidden,s.O.table,s.O.maxWidth,s.O.maxHeight)},n.createElement("div",{className:Object(s.x)(s.O.tableCellMiddle)},n.createElement(s.f,{className:Object(s.x)(R.reminderIcon,o.neutral.dark.font),fontIconCss:"ms-Icon--Event",isAriaHidden:!0})),n.createElement("div",{"aria-label":c.ReminderItemDataModel.Subject,className:Object(s.x)(s.O.tableCellMiddle,s.O.maxWidth,N.notificationTitle,o.neutral.dark.font)},n.createElement("span",{className:Object(s.x)(R.remindersTitle)},c.ReminderItemDataModel.Subject)),n.createElement("div",{id:"rmdBody"+r,"aria-label":Object(s.H)("{0} {1} {2}",c.TimeToItemStartValue,c.TimeToItemStartUnit,h.a.ReminderOverDue),className:l},n.createElement("div",{className:Object(s.x)((t={},t[s.O.visuallyHidden]=this.state.isHover||this.state.isReminderFocus||this.state.isIconFocus,t)),"aria-hidden":"true"},n.createElement("span",{className:Object(s.x)(R.toastRemindersTimeToStartValue)},c.TimeToItemStartValue),n.createElement("span",{className:Object(s.x)(R.remindersTimeToStartUnit)},c.TimeToItemStartUnit),n.createElement("span",{className:Object(s.x)(o.neutral.darkRed.font,(i={},i[s.O.visuallyHidden]=!c.IsReminderOverdue,i))},h.a.ReminderOverDue)),n.createElement("div",{className:Object(s.x)((a={},a[s.O.visuallyHidden]=!this.state.isHover&&!this.state.isReminderFocus&&!this.state.isIconFocus,a))},n.createElement("button",{id:"reminderSnoozeButton"+r,tabIndex:0,title:h.a.ReminderSnooze_Title,onFocus:this.handleOnSnoozeFocus,onBlur:this.handleSnoozeButtonOnBlur,"aria-label":h.a.ReminderSnooze_Aria_Text,role:"button",className:Object(s.x)(R.alarmButton,N.notificationLink,o.neutral.accent.font,o.neutral.light.hover.background),onClick:this.onSnoozeClick},n.createElement(s.f,{className:Object(s.x)(N.icon),fontIconCss:"ms-Icon--AlarmClock"})),n.createElement("button",{id:"reminderCloseButton"+r,type:"button",tabIndex:0,onFocus:this.handleOnSnoozeFocus,onBlur:this.handleCloseButtonOnBlur,className:Object(s.x)(N.closeButton,R.reminderCloseButton,o.neutral.secondary.font,o.neutral.light.hover.background),"aria-label":h.a.DismissNotification,role:"button",title:h.a.Dismiss,onClick:this.handleOnClick},n.createElement(s.f,{className:N.icon,fontIconCss:"ms-Icon--ChromeClose"}))))),f=n.createElement("div",{className:Object(s.x)(R.remindersDescription,o.neutral.secondary.font)},n.createElement("div",null,c.TimeLabel),""!==c.ReminderItemDataModel.Location&&n.createElement("div",null,c.ReminderItemDataModel.Location)),p=this.props.selectedReminderId===c.ReminderItemDataModel.ItemId;return n.createElement("div",{id:this.props.id,role:"group",tabIndex:0,className:Object(s.x)(N.toastControl),"aria-labelledby":"rmdRow"+r+" rmdDesc"+r,ref:function(e){p&&e&&e.focus()},onContextMenu:w.f,onClick:this.onClick,onKeyDown:this.handleKeyDown,onFocus:this.handleOnReminderFocus,onBlur:this.setStateWhenBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave},n.createElement("div",{className:Object(s.x)(R.remindersContainer)},n.createElement("div",{id:"rmdRow"+r,"aria-labelledby":"rmdcontext"+r,className:Object(s.x)(R.remindersRow)},d),n.createElement("div",{id:"rmdDesc"+r,"aria-label":c.ReminderItemDataModel.Location,className:Object(s.x)(R.remindersRow)},f)))},t}(n.Component),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.render=function(){var e="";switch(this.props.title){case h.a.Alert_Title:e=h.a.DismissAllAlerts;break;case h.a.Mail:e=h.a.DismissAllMails;break;case h.a.Reminder_Title:e=h.a.DismissAllReminders}var t=Object(T.a)();return n.createElement("div",{className:Object(s.x)(N.dismissContain)},n.createElement("button",{id:"DismissAll",type:"button",onClick:this.props.onDismissAll,className:Object(s.x)(N.dismissAll,N.itemLink,t.neutral.accent.font),"aria-label":e,role:"button",tabIndex:0,title:e},n.createElement("span",null,h.a.DismissAll)))},t}(n.Component),L=function(){function e(){}return e.prototype.getSnoozeOptions=function(){return[-15,-5,0,5,10,15,30,60,120,240,480,720,1440,2880,4320,5760,10080,20160]},e.prototype.getSnoozeDisplayText=function(e){var t="";switch(e){case-15:t=Object(s.H)(h.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"15");break;case-10:t=Object(s.H)(h.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"10");break;case-5:t=Object(s.H)(h.a.ReminderSnoozeOption_MinutesBeforeStart_Text,"5");break;case 0:t=h.a.ReminderSnoozeOption_AtStart_Text;break;case 5:t=Object(s.H)(h.a.ReminderSnoozeOption_Minutes_Text,"5");break;case 10:t=Object(s.H)(h.a.ReminderSnoozeOption_Minutes_Text,"10");break;case 15:t=Object(s.H)(h.a.ReminderSnoozeOption_Minutes_Text,"15");break;case 30:t=Object(s.H)(h.a.ReminderSnoozeOption_Minutes_Text,"30");break;case 60:t=h.a.ReminderSnoozeOption_Hour_Text;break;case 120:t=Object(s.H)(h.a.ReminderSnoozeOption_Hours_Text,"2");break;case 240:t=Object(s.H)(h.a.ReminderSnoozeOption_Hours_Text,"4");break;case 480:t=Object(s.H)(h.a.ReminderSnoozeOption_Hours_Text,"8");break;case 720:t=Object(s.H)(h.a.ReminderSnoozeOption_Day_Text,"0.5");break;case 1440:t=Object(s.H)(h.a.ReminderSnoozeOption_Day_Text,"1");break;case 2880:t=Object(s.H)(h.a.ReminderSnoozeOption_Days_Text,"2");break;case 4320:t=Object(s.H)(h.a.ReminderSnoozeOption_Days_Text,"3");break;case 5760:t=Object(s.H)(h.a.ReminderSnoozeOption_Days_Text,"4");break;case 10080:t=h.a.ReminderSnoozeOption_OneWeek_Text;break;case 20160:t=h.a.ReminderSnoozeOption_TwoWeeks_Text}return t},e}(),U=i(469),F=i(548),z=function(e){function t(t){var i=e.call(this,t)||this;return i.onClick=function(e){i.snoozeOptionChanged(e.currentTarget&&e.currentTarget.id)},i.onShowOrHideMoreItems=function(e){Object(c.e)().click(i.state.ShowMoreRemindersExpanded?"SeeLess":"SeeMore","NotificationsPane",S.a[S.a.ReminderNotification]),i.setState({ShowMoreRemindersExpanded:!i.state.ShowMoreRemindersExpanded})},i.snoozeOptionChanged=function(e){i.onSnoozeClose();var t=Object(w.b)(i.props.notifications,i.state.SnoozeReminderId,!0);if(t.length>0){var n=parseInt(e),a=void 0;a=n<0?t[0].payload.reminder.ReminderItemDataModel.StartDate.addMinutes(n):0===n?t[0].payload.reminder.ReminderItemDataModel.StartDate:_.c.Now.addMinutes(n);var o=_.c.generateISO8601DateTimeMsStringWithOffset(a);i.props.removeReminder(t[0].payload.id),i.props.snoozeReminders(t.map((function(e){return e.payload.reminder.ReminderItemDataModel.ItemId})),o)}},i.dismissAll=function(){Object(c.e)().click("DismissAll","NotificationToast",S.a[S.a.ReminderNotification]);var e=i.props.notifications.map((function(e){return e.payload.reminder.ReminderItemDataModel.ItemId}));i.props.dismissAll(S.a.ReminderNotification,e)},i.onSelectedItem=function(e){i.setState({SelectedReminderId:e})},i.onSnoozeClose=function(){i.setState(Object(f.__assign)(Object(f.__assign)({},i.state),{SnoozeReminderId:null}))},i.onSnoozeClick=function(e,t){Object(c.e)().click("Snooze","NotificationToast",S.a[S.a.ReminderNotification]),i.setState({SnoozeReminderId:e,SnoozeElement:t})},i.onReminderContainerClick=function(e){e.stopPropagation()},i.onReminderItemClick=function(e){Object(c.e)().click("NotificationClick","NotificationToast",S.a[S.a.ReminderNotification]),i.setState(Object(f.__assign)(Object(f.__assign)({},i.state),{SelectedReminderId:e}))},i.handleKeydown=function(e){if(e instanceof KeyboardEvent&&"keydown"===e.type&&[38,40,35,36].indexOf(e.which)>-1){var t={index:i.state.CurrentIndex,selectedReminderId:i.state.SelectedReminderId};if(!Object(w.e)(i.props.notifications,e.which,t))return;null!=t.selectedReminderId&&t.index>-1&&i.setState({SelectedReminderId:t.selectedReminderId,CurrentIndex:t.index})}},i.state={SelectedReminderId:null,CurrentIndex:-1,SnoozeReminderId:null,SnoozeElement:null,ShowMoreRemindersExpanded:!1,LastUpdatedTime:_.c.now},i.aggregatedId=i.props.isInFlexPane?"Flexpane_Reminders_Id":"Aggregated_Reminders_Id",i}return Object(f.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this,t=_.c.Now,i=_.b-1e3*t.second-t.millisecond;setTimeout((function(){e.timeInterval=window.setInterval((function(){return e.setState({LastUpdatedTime:_.c.now})}),6e4)}),i),Object(s.s)([this.aggregatedId],s.e.KEYDOWN,this.handleKeydown);var n=new L,a=n.getSnoozeOptions();this.dropdownItems=a.map((function(e){return{id:e.toString(),text:n.getSnoozeDisplayText(e)}}))},t.prototype.componentWillUnmount=function(){window.clearInterval(this.timeInterval),Object(s.S)([this.aggregatedId],s.e.KEYDOWN,this.handleKeydown)},t.prototype.render=function(){var e,t=this,i=this.props.notifications,a=i.length;this.props.isInFlexPane&&!this.state.ShowMoreRemindersExpanded&&a>3&&(i=i.slice(0,3));var o=Object(T.a)();e=this.props.isInFlexPane?Object(s.x)(N.notificationItem,N.itemContent,o.neutral.foreground.background,o.neutral.lighter.border,o.neutral.foregroundAlt.hover.background):Object(s.x)(U.reminderBox,o.neutral.lighter.border,o.neutral.lighter.hover.background);var c,r,l=0,d=i.map((function(i){var a=i.payload.reminder.ReminderItemDataModel.ItemId===t.state.SelectedReminderId,o=t.aggregatedId+l;return l++,n.createElement("div",{id:"rmdContainer"+l,"aria-labelledby":"rmdcontext"+l,key:o,"aria-selected":a,role:"option",className:e},n.createElement(P,{id:o,order:l,reminderItem:i,isInFlexPane:!1,selectedReminderId:t.state.SelectedReminderId,config:t.props.notificationConfiguration,LastUpdatedTime:t.state.LastUpdatedTime,onClick:t.onReminderItemClick,snoozeReminderId:t.state.SnoozeReminderId,onSnoozeClick:t.onSnoozeClick,onSnoozeClose:t.onSnoozeClose,onSelectedItem:t.onSelectedItem,onDismiss:t.props.dismiss,removeReminder:t.props.dismiss,alertImpressionLogEnabled:t.props.alertImpressionLogEnabled}))}));this.props.isInFlexPane?c=a>0&&n.createElement("div",{className:Object(s.x)(N.header,s.O.maxWidth,s.O.maxHeight,o.neutral.light.border),"aria-hidden":!0},n.createElement("div",{className:Object(s.x)(s.O.tableCellMiddle,N.label)},n.createElement("h3",{className:Object(s.x)(N.headerText,o.neutral.dark.font),"aria-label":h.a.Reminder_Title},h.a.Reminder_Title)),n.createElement("div",{className:s.O.tableCellMiddle},n.createElement(k,{onDismissAll:this.dismissAll,title:h.a.Reminder_Title})),n.createElement("div",{className:N.clearStyle})):r=n.createElement("div",{id:"ReminderHeader",className:Object(s.x)(s.O.maxWidth,s.O.maxHeight,U.header,o.neutral.light.border),"aria-hidden":!0},n.createElement("div",{className:Object(s.x)(s.O.tableCellMiddle,U.label)},n.createElement("span",{"aria-label":h.a.Reminder_Title,className:Object(s.x)(N.headerText,o.neutral.dark.font)},h.a.Reminder_Title)),n.createElement("div",{className:Object(s.x)(s.O.tableCellMiddle,U.label)},n.createElement(k,{onDismissAll:this.dismissAll,title:h.a.Reminder_Title})));var p=this.props.isInFlexPane?Object(s.x)(N.toastControl,N.headingBar):Object(s.x)(s.O.table,s.O.maxWidth,s.O.maxHeight),u=this.state.SnoozeElement?this.state.SnoozeElement.getBoundingClientRect():null,b=u?{left:u.left-147,top:u.top+32}:{margin:0},m=this.props.isInFlexPane?N.notificationContainer:U.toastScrollRegion;return n.createElement("div",{onClick:this.onReminderContainerClick,className:p,role:"group"},c,this.state.SnoozeReminderId&&n.createElement(s.c,{className:F.dropDrown,popupPosition:b,ariaLabel:h.a.ReminderSnooze_Aria_Text,onDismiss:this.onSnoozeClose,isScrollHidden:!0,scrollContainerId:this.props.isInFlexPane?"flexPaneScrollRegion":"Aggregated_Reminders_Id"},this.dropdownItems.map((function(e){return n.createElement(s.d,Object(f.__assign)({className:Object(s.x)(F.snoozeContextMenuItem,o.neutral.dark.font,o.neutral.foreground.background,o.neutral.light.hover.background),displayText:e.text,key:e.id,itemId:e.id,onclick:t.onClick},e,{role:"button"}))}))),r,n.createElement("div",{id:this.aggregatedId,role:"listbox","aria-multiselectable":"true",tabIndex:-1,className:Object(s.x)(m),"aria-label":h.a.Reminder_Title},d),a>3&&this.props.isInFlexPane&&n.createElement("button",{type:"button",onClick:this.onShowOrHideMoreItems,className:Object(s.x)(N.footer,N.itemLink),"aria-label":this.state.ShowMoreRemindersExpanded?h.a.ShowLess:h.a.ShowMore},n.createElement("span",{className:Object(s.x)(N.showMoreLink,o.neutral.accent.font)},this.state.ShowMoreRemindersExpanded?h.a.ShowLess:h.a.ShowMore)))},t}(n.Component),B=i(156),H=i(550),G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onToastActionClick=function(e){switch(e.preventDefault(),e.stopPropagation(),Object(c.e)().click("NotificationClick","NotificationToast",S.a[t.props.notification.providerType],null,t.props.notification.subType),t.props.notificationPayload.type){case B.a.message:case B.a.call:try{t.props.notificationPayload.actionLink.action()}catch(e){Object(c.e)().exception("ChatNotification_AcceptError",6,e)}break;case B.a.summary:t.props.onRecentsOpen(!0)}t.props.onToastClose&&t.props.onToastClose(t.props.notification.payload.id)},t.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),Object(c.e)().click("Close","NotificationToast",S.a[t.props.notification.providerType],null,t.props.notification.subType);try{t.props.notificationPayload.cancelLink.action()}catch(e){Object(c.e)().exception("ChatNotification_CancelError",6,e)}t.props.onToastClose&&t.props.onToastClose(t.props.notification.payload.id)},t.handleOnError=function(){Object(c.e)().tag("ChatNotification_MePhoto_LoadError",4)},t}return Object(f.__extends)(t,e),t.prototype.componentDidMount=function(){null!=this.props.setTimer&&this.props.setTimer(this.props.notification.payload.id)},t.prototype.componentWillUnmount=function(){null!=this.props.clearTimer&&this.props.clearTimer(this.props.notification.payload.id)},t.prototype.render=function(){if(null==this.props.notificationPayload)return null;var e=null,t=Object(T.a)();switch(this.props.notificationPayload.type){case B.a.message:e=n.createElement("div",{className:Object(s.x)(H.chatContent),onClick:this.onToastActionClick,role:"group"},n.createElement("div",{className:Object(s.x)(s.O.table,s.O.maxWidth,s.O.maxHeight)},n.createElement("div",{className:Object(s.x)(H.PersonaImage,s.O.tableCellMiddle)},n.createElement(O.a,{photoSize:32,photoUrl:this.props.notificationPayload.image,upn:this.props.notificationPayload.sender,displayName:this.props.notificationPayload.title,onError:this.handleOnError})),n.createElement("div",{className:s.O.tableCellMiddle},n.createElement("span",{className:Object(s.x)(H.chatTitle,H.chatText,N.notificationTitle,t.neutral.dark.font)},this.props.notificationPayload.title),n.createElement("div",null,n.createElement("div",{className:H.chatIcon},n.createElement(s.f,{className:Object(s.x)(N.icon),fontIconCss:"ms-Icon--OfficeChat",fontSize:"10px"})),n.createElement("span",{className:Object(s.x)(s.O.maxWidth,H.chatText,H.chatPreview,t.neutral.tertiary.font)},this.props.notificationPayload.description)))));break;case B.a.call:e=n.createElement("div",null,n.createElement("div",{className:Object(s.x)(H.chatContent)},n.createElement("div",{className:Object(s.x)(s.O.table,s.O.maxWidth,s.O.maxHeight)},n.createElement("div",{className:Object(s.x)(H.PersonaImage,s.O.tableCellMiddle)},n.createElement(O.a,{photoSize:32,photoUrl:this.props.notificationPayload.image,upn:this.props.notificationPayload.sender,displayName:this.props.notificationPayload.title,onError:this.handleOnError})),n.createElement("div",{className:s.O.tableCellMiddle},n.createElement("span",{className:Object(s.x)(H.chatTitle,H.chatText,N.notificationTitle,t.neutral.dark.font)},this.props.notificationPayload.title),n.createElement("div",null,n.createElement("div",{className:H.chatIcon},n.createElement(s.f,{className:Object(s.x)(N.icon),fontIconCss:"ms-Icon--OfficeChat",fontSize:"10px"})),n.createElement("span",{className:Object(s.x)(s.O.maxWidth,H.chatText,H.chatPreview,t.neutral.tertiary.font)},this.props.notificationPayload.description))))),n.createElement("div",{className:Object(s.x)(N.actionBar,t.neutral.accent.font,t.neutral.light.border)},n.createElement("button",{type:"button",onClick:this.onToastActionClick,className:Object(s.x)(t.neutral.foreground.background,t.neutral.light.border,t.neutral.accent.font,t.neutral.accent.hover.background,t.neutral.foreground.hover.font)},h.a.Accept),n.createElement("button",{type:"button",onClick:this.onCloseButtonClick,className:Object(s.x)(t.neutral.foreground.background,t.neutral.light.border,t.neutral.accent.font,t.neutral.accent.hover.background,t.neutral.foreground.hover.font)},h.a.Ignore)));break;default:e=n.createElement("div",{className:Object(s.x)(H.condensed),onClick:this.onToastActionClick,role:"group"},n.createElement(s.f,{className:Object(s.x)(N.icon,H.condensedIcon),fontIconCss:"ms-Icon--OfficeChat"}),n.createElement("span",{className:Object(s.x)(H.condensedText,t.neutral.dark.font)},this.props.notificationPayload.description))}return n.createElement("div",{onContextMenu:w.f},n.createElement("button",{type:"button",className:Object(s.x)(N.closeButton,t.neutral.secondary.font,t.neutral.lightAlt.hover.background),onClick:this.onCloseButtonClick,"aria-label":h.a.DismissNotification},n.createElement(s.f,{className:N.icon,fontIconCss:"ms-Icon--ChromeClose",fontSize:"10px"})),n.createElement("div",{className:Object(s.x)(H.toastContent),id:this.props.notificationPayload.id},e))},t}(n.Component),W=i(119),K=Object(o.b)(null,(function(e){return{onRecentsOpen:function(t){e(Object(W.c)(t))}}}))(G),Z=i(552),Y=function(e){function t(t){var i=e.call(this,t)||this;return i.clearTimer=function(e){if(null!=i.state.timers[e]){var t=i.state.timers;t[e]=clearTimeout(t[e])}},i.addDocumentListenter=function(){i.props.isNotificationsEnabled&&document.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&M.a.ProcessGetReminderFromServer()}))},i.setTimer=function(e){var t=i.state.timers;t[e]=setTimeout((function(){return i.props.onClose(e)}),4e3),i.setState({timers:t})},i.state={timers:[],top:50},Object(c.b)().subscribe("ShyHeaderActivated",(function(e){i.setState({top:e?8:50})}),!0),i.addDocumentListenter(),i}return Object(f.__extends)(t,e),t.prototype.render=function(){var e,t=this,i=null!=this.props.notifications&&this.props.notifications.filter((function(e){return 0===e.toastState}));if(!i||0===i.length||!this.props.isNotificationsEnabled&&!this.props.chatEnabled)return null;if(this.props.areToastsMuted)return i.forEach((function(e){e&&e.providerType!==S.a.ReminderNotification&&e.providerType!==S.a.SystemAlert&&e.payload&&e.payload.id&&window.setTimeout((function(){return t.props.onClose(e.payload.id)}),0)})),null;if(document.hidden&&i.filter((function(e){return 0===e.toastType})).length>0)return null;var a=i.filter((function(e){return e.providerType===S.a.ReminderNotification})),o=i.filter((function(e){return e.providerType!==S.a.ReminderNotification})).slice(0,w.g),c=this.props,r={dismiss:this.props.dismiss,onToastClose:this.props.onClose,snoozeReminders:this.props.snoozeReminders,setTimer:this.setTimer,clearTimer:this.clearTimer,notificationConfiguration:c,notificationSetting:this.props.notificationPreferencesData,dismissAll:this.props.dismissAll,removeReminder:this.props.removeReminder,alertImpressionLogEnabled:this.props.alertImpressionLogEnabled};return a.length>0&&c.notificationPreferencesData.EnableReminders&&(e=n.createElement(z,Object(f.__assign)({},r,{notifications:a}))),c.notificationPreferencesData&&(o.length>0||a.length>0)&&i.length>0&&n.createElement(s.h,{className:Object(s.x)(Z.popupControl),focusTrapSelector:"a[href],button",noFocusOnRender:!0,isPersistant:!0,popupPosition:this.props.isRtl?{top:this.state.top,left:0}:{top:this.state.top,right:0}},n.createElement("div",{className:Object(s.x)(Z.toastContainer),id:"popupContent","aria-label":i.length>1?h.a.NotificationsPopup:h.a.NotificationPopup,role:"region","aria-live":"polite","aria-relevant":"additions"},a.length>0&&this.getToast(e,a[0],!1),o.length>0&&o.map((function(i){return e=null,i.providerType===S.a.NewMailNotification&&c.notificationPreferencesData&&c.notificationPreferencesData.EnableNewItemNotify?e=n.createElement(j,Object(f.__assign)({notification:i},r,{notificationConfiguration:c})):i.providerType===S.a.SystemAlert?e=n.createElement(D,Object(f.__assign)({notification:i},r)):t.props.chatEnabled&&i.providerType===S.a.ChatNotification&&(c.notificationPreferencesData.EnableChat||c.notificationPreferencesData.EnableCalling)&&(e=n.createElement(K,Object(f.__assign)({notification:i},r,{notificationPayload:i.payload}))),null!=e&&t.getToast(e,i,i.subType===B.a.call)}))))},t.prototype.getToast=function(e,t,i){if(null==e)return null;var a=Object(w.c)(t,this.props),o=Object(T.a)();return n.createElement("div",{key:t.payload.id,className:Object(s.x)(U.toastSlot,N.notificationToast,o.neutral.light.border,o.neutral.foreground.background)},e,""!==a&&n.createElement(s.a,{source:a,id:t.payload.id,loop:i,type:"audio/mpeg"}))},t}(n.Component),V=i(292),Q=Object(o.b)((function(e){return{notifications:e.notificationState.notifications,chatEnabled:e.chatState&&e.chatState.chatEnabled,isRtl:e.userState&&e.userState.isRtl,isNotificationsEnabled:null!=e.notificationState&&null!=e.notificationState.notificationsEnabled&&e.notificationState.notificationsEnabled,areToastsMuted:null!=e.notificationState&&e.notificationState.toastsMuted,isSystemNotificationsDisabled:null!=e.notificationState&&null!=e.notificationState.systemNotificationsDisabled&&e.notificationState.systemNotificationsDisabled,owaLaunchUrl:Object(s.I)(e.appsDataState.apps),mailNotificationAudioUrl:e.shellInitDataState.clientData.MailNotificationAudioUrl,systemNotificationAudioUrl:e.shellInitDataState.clientData.SystemNotificationAudioUrl,calendarNotificationAudioUrl:e.shellInitDataState.clientData.CalendarNotificationAudioUrl,callNotificationAudioUrl:e.shellInitDataState.clientData.CallNotificationAudioUrl,chatNotificationAudioUrl:e.shellInitDataState.clientData.ChatNotificationAudioUrl,workloadID:e.shellInitDataState.clientData.WorkloadId,notificationPreferencesData:e.notificationState.notificationPreferencesData,alertImpressionLogEnabled:e.shellInitDataState.clientData.AlertImpressionLogEnabled,isGallatinLegalAlertEnabled:e.shellInitDataState.clientData.GallatinLegalAlertEnabled}}),(function(e){return{setToastStatus:function(t,i,n,a){e(Object(V.h)(t,i,n,a))},onClose:function(t){e(Object(V.h)([t],1))},dismissAll:function(t,i){void 0===i&&(i=[]),e(Object(V.d)(t,i))},dismiss:function(t,i){e(Object(V.e)(t,i))},removeReminder:function(t){e(Object(V.m)(!0,null,t))},snoozeReminders:function(t,i){e(Object(V.j)(t,i))}}}))(Y),J=i(318),X=i(402),q=i(89),$=i(35),ee=i(554),te=function(e){function t(t){var i=e.call(this,t)||this;return i.handleOnFocus=function(){i.setState({isHover:!0})},i.handleOnBlur=function(){i.setState({isHover:!1})},i.handleOnMouseEnter=function(e){i.setNewAppState(e,!0)},i.handleOnMouseLeave=function(e){i.setNewAppState(e,!1)},i.handleKeyDown=function(e){13===e.keyCode&&i.onClick(e)},i.onClick=function(e){e.preventDefault(),e.stopPropagation();var t=i.props.notification.payload,n=t.LaunchFullUrl;if(null!=n||""!==n){window.open(n,"_blank");var a=$.d(t.ItemID,t.CollectorID);"NewAppNotification"===a&&(a="OfficeDotCom"),Object(c.e)().click("NotificationClick","NotificationsPane",S.a[i.props.notification.providerType],a)}},i.setNewAppState=function(e,t){e.stopPropagation(),e.preventDefault(),i.setState({isHover:t})},i.onCloseButtonClick=function(e){e.preventDefault(),e.stopPropagation(),i.props.dismissAll(e)},i.state={isHover:!1},i}return Object(f.__extends)(t,e),t.prototype.componentDidMount=function(){var e=null!=this.props.notification?this.props.notification.payload:null;null!=e&&e.AllNewAppIDs.length>0&&Object(c.e)().impression(S.a[this.props.notification.providerType],"FlexPane",e.AllAppTileIDs.length,e.AllAppTileIDs)},t.prototype.render=function(){var e,t=this.props.notification.payload,i=Object(T.a)();return n.createElement("div",{id:"NewAppId",tabIndex:0,onContextMenu:w.f,onFocus:this.handleOnFocus,onBlur:this.handleOnBlur,onMouseEnter:this.handleOnMouseEnter,onMouseLeave:this.handleOnMouseLeave,"aria-label":t.Title+" "+t.Message},n.createElement("button",{id:"newAppCloseButton",type:"button",tabIndex:0,className:Object(s.x)((e={},e[s.O.visuallyHidden]=!this.state.isHover,e),N.closeButton,i.neutral.secondary.font,i.neutral.lightAlt.hover.background),"aria-label":h.a.DismissNotification,title:h.a.DismissNotification,onClick:this.onCloseButtonClick},n.createElement(s.f,{className:N.icon,fontIconCss:"ms-Icon--ChromeClose",isAriaHidden:!0})),n.createElement("div",{id:t.ID,className:Object(s.x)(ee.newAppPopupButton),onClick:this.onClick,role:"group"},n.createElement("div",{className:Object(s.x)(ee.newAppPopupButtonCell,i.neutral.light.border)},n.createElement("div",null,n.createElement("span",{className:Object(s.x)(s.G.segoeSemibold,ee.notificationText,N.notificationTitle,i.neutral.dark.font)},t.Title),n.createElement("span",{className:Object(s.x)(s.G.segoeRegular,ee.notificationText,N.notificationBodyText,i.neutral.secondary.font)},t.Message)),n.createElement("div",{className:Object(s.x)(N.actionBar,i.neutral.accent.font,i.neutral.light.border)},n.createElement("a",{tabIndex:0,onClick:this.onClick,onKeyDown:this.handleKeyDown,"aria-label":t.ActionText,className:Object(s.x)(N.notificationLink,i.neutral.accent.link),role:"link"},n.createElement("span",{className:N.itemLink},t.ActionText),n.createElement(s.f,{className:Object(s.x)(N.icon,N.actionArrow),fontIconCss:"ms-Icon--Forward"}))))))},t}(n.Component),ie=i(419),ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismissAll=function(){Object(c.e)().click("DismissAll","NotificationsPane",S.a[S.a.NewAppNotification]);var e=t.props.notification&&t.props.notification.payload;e&&ie.a.dismiss(e.AllNewAppIDs),t.props.dismissAll(S.a.NewAppNotification)},t}return Object(f.__extends)(t,e),t.prototype.render=function(){var e=Object(T.a)();return this.props.notification&&this.props.notification.payload?n.createElement("div",{className:Object(s.x)(N.toastControl,N.headingBar)},n.createElement("div",{className:Object(s.x)(N.header,s.O.maxWidth,e.neutral.light.border),"aria-hidden":!0},n.createElement("div",{className:Object(s.x)(N.label,s.O.floatLeft)},n.createElement("h3",{className:Object(s.x)(N.headerText,e.neutral.dark.font),"aria-label":h.a.NotificationMyAppsTitle},h.a.NotificationMyAppsTitle)),this.props.notification&&n.createElement(k,{onDismissAll:this.onDismissAll,title:h.a.NewAppTitle}),n.createElement("div",{className:N.clearStyle})),n.createElement("div",{className:Object(s.x)(N.content)},n.createElement("div",{className:Object(s.x)(N.notificationItem,N.itemContent,e.neutral.foreground.background,e.neutral.lighter.border,e.neutral.foregroundAlt.hover.background)},n.createElement(te,{dismissAll:this.onDismissAll,notification:this.props.notification})))):null},t}(n.Component),ae=function(e){function t(t){var i=e.call(this,t)||this;return i.setShowMoreMailNotifications=function(){i.state.ShowMoreMailNotifications?Object(c.e)().click("SeeLess","NotificationsPane",S.a[S.a.NewMailNotification]):Object(c.e)().click("SeeMore","NotificationsPane",S.a[S.a.NewMailNotification]),i.setState({ShowMoreMailNotifications:!i.state.ShowMoreMailNotifications})},i.onDismissAll=function(e){Object(c.e)().click("DismissAll","NotificationsPane",S.a[S.a.NewMailNotification]),i.props.dismissAll(S.a.NewMailNotification),i.setState(i.getDefaultState())},i.state=i.getDefaultState(),i}return Object(f.__extends)(t,e),t.prototype.getDefaultState=function(){return{ShowMoreMailNotifications:!1,isLessButtonHovered:!1,isMoreButtonHovered:!1}},t.prototype.render=function(){var e=this,t=this.props.notifications.filter((function(e){return e.providerType===S.a.NewMailNotification})).reverse(),i=t.length;t=!this.state.ShowMoreMailNotifications&&i>3?t.slice(0,3):t;var a=Object(T.a)();return i>0&&n.createElement("div",{className:Object(s.x)(N.toastControl,N.headingBar)},n.createElement("div",{className:Object(s.x)(N.header,s.O.maxWidth,s.O.maxHeight,a.neutral.light.border),"aria-hidden":!0},n.createElement("div",{className:Object(s.x)(N.label,s.O.floatLeft)},n.createElement("h3",{className:Object(s.x)(N.headerText,a.neutral.dark.font),"aria-label":h.a.Mail},h.a.Mail)),i>1&&n.createElement(k,{onDismissAll:this.onDismissAll,title:h.a.Mail}),n.createElement("div",{className:N.clearStyle})),n.createElement("div",{className:Object(s.x)(N.content)},t.map((function(t){return n.createElement("div",{key:t.payload.id,className:Object(s.x)(N.notificationItem,N.itemContent,a.neutral.foreground.background,a.neutral.lighter.border,a.neutral.foregroundAlt.hover.background)},n.createElement(j,{notification:t,dismiss:e.props.dismiss,isInFlexPane:!0,notificationConfiguration:e.props.notificationConfiguration}))})),i>3&&n.createElement("button",{type:"button",onClick:this.setShowMoreMailNotifications,className:Object(s.x)(N.footer,N.itemLink),"aria-label":this.state.ShowMoreMailNotifications?h.a.SeeLessAriaText:h.a.ShowMoreAriaText},n.createElement("span",{className:Object(s.x)(N.showMoreLink,a.neutral.accent.font)},this.state.ShowMoreMailNotifications?h.a.ShowLess:h.a.ShowMore))))},t}(n.Component),oe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onDismissAll=function(e){Object(c.e)().click("DismissAll","NotificationsPane",S.a[S.a.SystemAlert]),t.props.dismissAll&&t.props.dismissAll(S.a.SystemAlert)},t}return Object(f.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.notifications?this.props.notifications.filter((function(e){return e.providerType===S.a.SystemAlert&&(0===e.toastState||1===e.toastState)})):[],i=this.props.notifications?this.props.notifications.filter((function(e){return e.providerType===S.a.SystemAlert&&2===e.toastState})):[],a=i.length+t.length,o=Object(T.a)();return t.length>0||i.length>0?n.createElement("div",{className:Object(s.x)(N.content,N.paddingTop)},n.createElement("div",{className:Object(s.x)(N.header,s.O.maxWidth,s.O.maxHeight,o.neutral.light.border),"aria-hidden":!0},n.createElement("div",{className:Object(s.x)(s.O.tableCellMiddle,N.label)},n.createElement("h3",{className:Object(s.x)(N.headerText,o.neutral.dark.font),"aria-label":h.a.Alert_Title},h.a.Alert_Title)),a>1?n.createElement(k,{onDismissAll:this.onDismissAll,title:h.a.Alert_Title}):null),t.concat(i).map((function(t){return n.createElement("div",{key:t.payload.systemAlert.Id,className:Object(s.x)(N.notificationItem,o.neutral.foreground.background,o.neutral.lighter.border,o.neutral.foregroundAlt.hover.background)},n.createElement(D,{dismiss:e.props.dismiss?e.props.dismiss:null,notification:t,isInFlexPane:!0}))}))):null},t}(n.Component),se=i(556),ce=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.focusRoot=null,t.refocus=!1,t.showSettingsPane=function(){Object(c.e)().click("Notifications_CustomizeSettings","NotificationsPane","NotificationSettings"),t.props.showSettings(!0)},t.backButtonClicked=function(){t.props.showSettings(!1),t.refocus=!0},t.componentDidUpdate=function(i,n){e.prototype.componentDidUpdate.call(t,i,n),t.refocus&&(t.focusRoot.focus(),t.refocus=!1)},t.dismissAll=function(e){t.props.dismissAll(e),t.focusRoot.focus()},t.handleKeyDown=function(e){13!==e.keyCode&&32!==e.keyCode||t.showSettingsPane()},t}return Object(f.__extends)(t,e),t.prototype.onComponentVisible=function(){e.prototype.onComponentVisible.call(this),this.props.setSeenInFlexPane()},t.prototype.render=function(){var e=this,t=null,i=[],a=[],o=[],c=[],l=!0;this.props.notifications.forEach((function(e){if(3!==e.toastState)switch(e.providerType){case S.a.NewMailNotification:o.push(e),l=!1;break;case S.a.ReminderNotification:i.push(e),l=!1;break;case S.a.SystemAlert:a.push(e),l=!1;break;case S.a.NewAppNotification:c.push(e),l=!1}}));var d=c.length>0?c[0]:null,p=a.length>0||c.length>0||Object(q.b)(this.props.chatFeatureEnabled,this.props.notificationPreferencesData),u=Object(T.a)();if(this.props.shouldShowSettings&&this.props.notificationPreferencesData)t=n.createElement("div",{id:"NotificationsPane",className:se.settingsContainer},n.createElement(X.a,{hostId:"NotificationsPane",chatFeatureEnabled:this.props.chatFeatureEnabled,notificationPreferences:this.props.notificationPreferencesData,onToggleNotification:this.props.setNotificationSetting,onToggleAllowNotifications:this.props.toggleAllowNotifications}));else if(!p&&this.props.notificationPreferencesData)t=n.createElement("div",{id:"NotificationsPane",className:Object(s.x)(se.section,se.notificationsDisabled,u.neutral.dark.font)},h.a.NotificationsDisabled);else if(null==this.props||!this.props.isNotificationsEnabled||null==this.props.notifications||0===this.props.notifications.length||l)t=n.createElement("div",{id:"NotificationsPane",className:Object(s.x)(se.section,se.notificationsMessage,se.emptyState,u.neutral.dark.font)},n.createElement("div",{id:"EmptyStateImageId",className:se.imgEmptyState}),n.createElement("span",{className:s.G.segoeSemibold,"aria-label":h.a.NoNewNotifications},h.a.NoNewNotifications),n.createElement("span",{"aria-label":h.a.NoNewCheckLaterNote},h.a.NoNewCheckLaterNote));else{var b={dismissAll:this.dismissAll,dismiss:this.props.dismiss,snoozeReminders:this.props.snoozeReminders,notificationConfiguration:this.props,removeReminder:this.props.removeReminder};t=n.createElement("div",{id:"NotificationsPane"},a.length>0?n.createElement("div",{tabIndex:-1,className:Object(s.x)(se.section),role:"region","aria-label":h.a.Alert_Title},n.createElement(oe,Object(f.__assign)({notifications:a},b))):null,i?n.createElement("div",{tabIndex:-1,className:Object(s.x)(se.section),role:"region","aria-label":h.a.Reminder_Title},n.createElement(z,Object(f.__assign)({notifications:i,isInFlexPane:!0},b))):null,this.props.showNewMailNotificationHistory&&o.length>0?n.createElement("div",{tabIndex:-1,className:Object(s.x)(se.section),role:"region","aria-label":h.a.Mail},n.createElement(ae,Object(f.__assign)({notifications:o},b))):null,d?n.createElement("div",{tabIndex:-1,className:Object(s.x)(se.section),role:"region","aria-label":h.a.NotificationMyAppsTitle},n.createElement(ne,Object(f.__assign)({notification:d},b))):null)}return n.createElement("div",{className:se.mainContainer},n.createElement(r.c,{className:Object(s.x)(se.container,u.neutral.lighterAlt.background),isActive:this.props.isActive,title:h.a.Notifications,flexPaneProviderID:this.props.flexPaneProviderID,showBackButton:this.props.shouldShowSettings,onBackButtonClicked:this.backButtonClicked},t),!this.props.shouldShowSettings&&this.props.notificationPreferencesData&&n.createElement("div",{className:se.customizeLinkContainer},n.createElement("div",{id:"NotificationSettingsLink",role:"button",ref:function(t){return e.focusRoot=t},className:Object(s.x)(se.customizeSettingsLink,u.neutral.accent.font),"aria-label":h.a.NotificationSettings,tabIndex:0,onClick:this.showSettingsPane,onKeyDown:this.handleKeyDown},h.a.NotificationSettings)))},t}(r.a),re=Object(o.b)((function(e,t){return{isActive:t.isActive,shouldShowSettings:e.notificationState.showSettings,notifications:e.notificationState.notifications,setSeenInFlexPane:t.setSeenInFlexPane,showNewMailNotificationHistory:!Object(g.c)(e.shellInitDataState.clientData.WorkloadId),chatFeatureEnabled:e.chatState.chatEnabled,isNotificationsEnabled:e.notificationState.notificationsEnabled,owaLaunchUrl:Object(s.I)(e.appsDataState.apps),workloadID:e.shellInitDataState.clientData.WorkloadId,portalUrl:e.shellInitDataState.clientData.PortalUrl,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,hasEXOLicense:e.shellInitDataState.clientData.HasEXOLicense,isAdmin:null!=e.shellInitDataState.navBarData.AdminLink,isOnPremShell:e.shellInitDataState.clientData.IsOnPremShell,upn:e.userState.upn,myAppsUrl:e.shellInitDataState.clientData.MyAppsUrl,notificationPreferencesData:e.notificationState.notificationPreferencesData}}),(function(e){return{setSeenInFlexPane:function(){e(Object(V.f)())},dismissAll:function(t,i){void 0===i&&(i=[]),e(Object(V.d)(t,i))},dismiss:function(t,i){e(Object(V.e)(t,i))},showSettings:function(t){e(Object(V.i)(t))},onUpdateReminders:function(t){e(Object(V.a)(t))},removeReminder:function(t){e(Object(V.m)(!0,null,t))},toggleAllowNotifications:function(t,i){e(Object(J.g)(t,i))},setNotificationSetting:function(t,i,n){e(Object(J.f)(t,i,n))},snoozeReminders:function(t,i){e(Object(V.j)(t,i))}}}))(ce),le=i(558),de=function(e){function t(t){var i=e.call(this,t)||this;return i.setSimpleBellAriaLabel=function(e){i.setState({simpleBellAriaLabel:e})},i.onMouseChange=function(e){return i.setState({isHovered:e})},i.state={isHovered:!1,simpleBellAriaLabel:null},i}return Object(f.__extends)(t,e),t.prototype.render=function(){var e=Object(T.a)();return this.props.isAvailable&&n.createElement("button",{type:"button",onMouseEnter:this.onMouseChange.bind(this,!0),onMouseLeave:this.onMouseChange.bind(this,!1),onFocus:this.onMouseChange.bind(this,!0),onBlur:this.onMouseChange.bind(this,!1),id:l.h,className:Object(s.x)(m.button,e.headerButton,e.highContrastButton),role:"button","aria-disabled":"false","aria-label":null==this.state.simpleBellAriaLabel?h.a.Notification_Title:null,"aria-labelledby":this.state.simpleBellAriaLabel},n.createElement(s.f,{fontIconCss:"ms-Icon--Ringer",fontSize:b.f.toString(),className:Object(s.x)(le.icon),isAriaHidden:!0}),n.createElement(y,{isParentHovered:this.state.isHovered,bellAriaID:l.h,bellAriaLabelID:"SimpleBellAriaLabel",setAriaLabelId:this.setSimpleBellAriaLabel,badgeStyles:m.headerButtonBadgePosition}))},t.prototype.componentDidMount=function(){this.props.isAvailable&&this.props.registerNotificationsFlexPane()},t.prototype.componentDidUpdate=function(e){e.isAvailable!==this.props.isAvailable&&this.props.isAvailable&&this.props.registerNotificationsFlexPane()},t}(n.Component),fe=Object(o.b)((function(e,t){return{isAvailable:!!e.notificationState&&e.notificationState.notificationsEnabled,registerNotificationsFlexPane:t.registerNotificationsFlexPane}}))(de),pe=i(479),ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(f.__extends)(t,e),t.prototype.componentDidMount=function(){this.props.isNotificationsEnabled&&(this.props.isSubscriptionReady||this.subscribe(this.props))},t.prototype.componentWillReceiveProps=function(e){this.isNotificationSettingUpdate(this.props,e)&&this.props.isSubscriptionReady&&(pe.a.config.notificationPreferencesData=e.notificationPreferencesData)},t.prototype.componentDidUpdate=function(e){this.props.isNotificationsEnabled!==e.isNotificationsEnabled&&this.props.isNotificationsEnabled&&!this.props.isSubscriptionReady&&this.subscribe(this.props)},t.prototype.render=function(){return null},t.prototype.isNotificationSettingUpdate=function(e,t){if(e&&t&&e.notificationPreferencesData&&t.notificationPreferencesData){var i=e.notificationPreferencesData,n=t.notificationPreferencesData;return i.EnableNewItemNotify!==n.EnableNewItemNotify||i.EnableReminders!==n.EnableReminders}return!1},t.prototype.subscribe=function(e){e.isNotificationsEnabled&&e.hasEXOLicense&&this.props.subscribe(e)},t}(n.Component),be=Object(o.b)((function(e){return{isSubscriptionReady:e.notificationState.isSubscriptionReady,isNotificationsEnabled:e.notificationState.notificationsEnabled&&e.notificationState.bellHeaderButtonInLayout,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,notificationPreferencesData:e.notificationState.notificationPreferencesData,owaLaunchUrl:Object(s.I)(e.appsDataState.apps),isSystemNotificationsDisabled:e.notificationState.systemNotificationsDisabled,doNotFetchSystemAlertsFromPortal:e.shellInitDataState.clientData.DoNotFetchSystemAlertsFromPortal,upn:e.userState.upn,workloadID:e.shellInitDataState.clientData.WorkloadId,portalUrl:e.shellInitDataState.clientData.PortalUrl,hasEXOLicense:e.shellInitDataState.clientData.HasEXOLicense,isAdmin:null!=e.shellInitDataState.navBarData.AdminLink,isOnPremShell:e.shellInitDataState.clientData.IsOnPremShell,myAppsUrl:e.shellInitDataState.clientData.MyAppsUrl,isGallatinLegalAlertEnabled:e.shellInitDataState.clientData.GallatinLegalAlertEnabled}}),(function(e){return{updateNotificationPreferences:function(t){e(Object(s.fb)(t))},subscribe:function(t){return e(Object(V.k)(t))}}}))(ue),me=i(468),he=i(44),ge=i(467),Se=[S.a.NewAppNotification];function Ie(e,t,i){var n=e.notificationPreferencesData,a=e.notificationsEnabled,o=e.systemNotificationsDisabled;t&&(a=!!t.NotificationsEnabled&&t.NotificationsEnabled,o=null==t.SystemNotificationsDisabled||t.SystemNotificationsDisabled);var c=e.bellHeaderButtonInLayout;return null!=i&&i.centerCustomizationRegion&&(c=null!=Object(s.D)("NotificationBellIcon",i.centerCustomizationRegion.children)),Object(f.__assign)(Object(f.__assign)({},e),{notificationsEnabled:a,bellHeaderButtonInLayout:c,systemNotificationsDisabled:o,notificationPreferencesData:n})}function ye(e,t){var i=e.notifications.slice(0);return t.providerType===S.a.NewAppNotification&&(i=i.filter((function(e){return Se.indexOf(e.providerType)<0}))),i.push(t),Object(f.__assign)(Object(f.__assign)({},e),{notifications:i})}function xe(e,t,i,n){if(e.providerType===S.a.NewAppNotification){var a=e.payload;null!=a&&(a.UnseenCount=0,e.toastState=t)}e.toastState=t,null!=i&&(e.isCondensed=i),null!=n&&(e.condensedCount=n)}var ve={notificationState:function(e,t){if(!e){var i=t.shellInitData.shellInitDataState;e=Ie(s.P,i.clientData||{},i.layout)}var n=e;switch(t.type){case s.j:return Ie(e,t.shellClientData);case s.k:return Ie(e,void 0,t.shellLayout);case s.p:return function(e,t){return Object(f.__assign)(Object(f.__assign)({},e),{notificationPreferencesData:t.notificationPreferenceData})}(e,t);case me.a:return function(e,t){if(void 0===t.payload)return e;if(void 0!==t.payload.providerType)e=ye(e,t.payload);else if("string"==typeof t.payload&&null!=t.payload){var i=JSON.parse(t.payload);i.providerType===S.a.ReminderNotification&&function(e){var t=e.payload.reminder.ReminderItemDataModel;t.ReminderTime=he.a.parseISO8601DateTime(t.ReminderTime.toString()),t.StartDate=he.a.parseISO8601DateTime(t.StartDate.toString()),t.EndDate=he.a.parseISO8601DateTime(t.EndDate.toString());var i=new ge.a(t);e.payload.reminder=i}(i),e=ye(e,i)}return function(e){var t=e.notifications.slice(0),i=t.filter((function(e){return 0===e.toastState&&e.providerType===S.a.NewMailNotification}));if(i.length>w.g)return t.forEach((function(e){e===i[0]?xe(e,0,!0,i.length):i.slice(1).indexOf(e)>-1&&(e.toastState=1)})),Object(f.__assign)(Object(f.__assign)({},e),{notifications:t});return e}(e)}(e,t);case me.l:return function(e,t){var i=e.notifications.slice(0);if(t.isRemoved)return i=i.filter((function(e){return e.payload.id!==t.id})),Object(f.__assign)(Object(f.__assign)({},e),{notifications:i});if(null!==t.reminder)return i.forEach((function(e){e.payload.id===t.id&&(e.payload.reminder=t.reminder)})),Object(f.__assign)(Object(f.__assign)({},e),{notifications:i});return e}(e,t);case me.h:return function(e,t){for(var i=e.notifications.slice(0),n=0,a=i;n<a.length;n++){var o=a[n];if(t.ids.indexOf(o.payload.id)>-1){xe(o,t.toastStatus,t.isCondensed,t.condensedCount);break}}return Object(f.__assign)(Object(f.__assign)({},e),{notifications:i})}(e,t);case me.f:return function(e,t){for(var i=e.notifications.slice(0),n=0,a=i;n<a.length;n++){var o=a[n];0!==o.toastState&&1!==o.toastState||xe(o,2)}return Object(f.__assign)(Object(f.__assign)({},e),{notifications:i})}(e);case me.d:return function(e,t){for(var i=e.notifications.slice(0),n=0,a=i;n<a.length;n++){var o=a[n];o.providerType===t.providerType&&xe(o,3)}return Object(f.__assign)(Object(f.__assign)({},e),{notifications:i})}(e,t);case me.e:return function(e,t){for(var i=e.notifications.slice(0),n=0,a=i;n<a.length;n++){var o=a[n];t.id===o.payload.id&&xe(o,3)}return Object(f.__assign)(Object(f.__assign)({},e),{notifications:i})}(e,t);case me.b:return function(e,t){if(null===t.notifications)return e;var i=e.notifications.slice(0);return t.notifications.forEach((function(e){i.push(e)})),Object(f.__assign)(Object(f.__assign)({},e),{notifications:i})}(e,t);case me.c:return function(e,t){var i=e.notifications.slice(0);return i.push({providerType:S.a.SystemAlert,payload:{systemAlert:t.alertData,id:t.alertData.Id},toastType:t.alertData.NotificationToastShouldPersist?1:0,toastState:0,navigationUrl:t.alertData.ActionUrl}),Object(f.__assign)(Object(f.__assign)({},e),{notifications:i})}(e,t);case me.i:n=function(e,t){return Object(f.__assign)(Object(f.__assign)({},e),{showSettings:t.shouldShowSettings})}(e,t);break;case me.j:n=function(e,t){return Object(f.__assign)(Object(f.__assign)({},e),{futureReminders:t.futureReminders})}(e,t);break;case me.k:n=function(e,t){return Object(f.__assign)(Object(f.__assign)({},e),{isSubscriptionReady:t.isReady})}(e,t);break;case me.g:n=function(e,t){return Object(f.__assign)(Object(f.__assign)({},e),{toastsMuted:t.muted})}(e,t)}return n}},Oe=i(320),Ae=function(){function e(){}return e.prototype.AddSystemNotification=function(e,t,i,n,a,o,c){null==e||null==t||null==i||null==n||null==o||null===c&&null==a||Object(s.K)().dispatch(Object(V.c)({Title:e,Message:t,ActionUrl:i,ActionText:n,ActionTarget:a,Id:o,ActionCallback:c,NotificationToastShouldPersist:!0}))},e.prototype.AddNotification=function(e){Object(s.K)().dispatch(Object(V.a)(e))},e.prototype.MuteToasts=function(){Object(s.K)().dispatch(Object(V.g)(!0))},e.prototype.UnmuteToasts=function(){Object(s.K)().dispatch(Object(V.g)(!1))},e.prototype.RegisterSystemNotificationsOpenedCallback=function(e){Object(Oe.a)("O365Shell.Notifications.RegisterSystemNotificationsOpenedCallback","This API is no longer supported. Please remove it or reach out for further instruction.")},e}();var Ne,Ce;s.ab.register(ve),Ne=new Ae,Ce=window.O365Shell.Notifications,window.O365Shell.Notifications=Ne,Ce.applyCalls(Ne);var Te=!1,we=!1,je=Object(s.K)(),Ee=Object(c.f)(),De={component:re,key:"Notifications",width:r.b},_e=Object(c.b)();if(_e.subscribe("ShellDataUpdated",(function(){!function(){if(we)return;var e=document.createElement("div");a.render(n.createElement(o.a,{store:je},n.createElement(be,null)),e),we=!0}()}),!0),Ee.layout)Ee.layout.centerCustomizationRegion&&Object(s.D)("NotificationBellIcon",Ee.layout.centerCustomizationRegion.children)&&(Re(),_e.invoke("LazyComponentLoaded",d.b,v),De.nativeControlID="NotificationBellIcon",je.dispatch(Object(r.e)(De)));else{var Me=document.getElementById("O365_MainLink_Bell_Container");if(Me){Re();a.render(n.createElement(o.a,{store:je},n.createElement(fe,{registerNotificationsFlexPane:function(){De.btnId=l.h,je.dispatch(Object(r.e)(De))}})),Me)}}function Re(){var e=Object(c.f)();if(!(Te||e&&e.disableToasts)){var t=document.getElementById(l.e);if(t){var i=document.createElement("div");i.id="NotificationToastContainer",t.appendChild(i),s.r.isMobileClient()||(a.render(n.createElement(o.a,{store:je},n.createElement(Q,null)),i),Te=!0)}}}Object(c.b)().subscribe("ShellDataUpdated",(function(e,t){Re()}),!0)},292:function(e,t,i){"use strict";i.d(t,"a",(function(){return d})),i.d(t,"m",(function(){return f})),i.d(t,"h",(function(){return p})),i.d(t,"f",(function(){return u})),i.d(t,"d",(function(){return b})),i.d(t,"e",(function(){return m})),i.d(t,"b",(function(){return h})),i.d(t,"c",(function(){return g})),i.d(t,"i",(function(){return S})),i.d(t,"l",(function(){return I})),i.d(t,"g",(function(){return y})),i.d(t,"j",(function(){return x})),i.d(t,"k",(function(){return v}));var n=i(4),a=i(44),o=i(419),s=i(316),c=i(151),r=i(479),l=i(468);function d(e){return function(t,i){t({type:l.a,payload:e}),s.a.Add(i().notificationState.notifications)}}function f(e,t,i){return function(n,a){n({type:l.l,isRemoved:e,reminder:t,id:i}),s.a.Add(a().notificationState.notifications)}}function p(e,t,i,n){return function(a,o){a({type:l.h,ids:e,toastStatus:t,isCondensed:i,condensedCount:n}),s.a.Add(o().notificationState.notifications)}}function u(){return function(e,t){e({type:l.f});var i=t().notificationState.notifications,n=t().notificationState.notifications.filter((function(e){return 3!==e.toastState&&e.providerType===c.a.NewAppNotification&&null!=e.payload}));s.a.Add(i),n.length>0&&o.a.setSeen(n[0].payload.AllNewAppIDs)}}function b(e,t){return function(i,o,c){i({type:l.d,providerType:e}),c.then((function(e){s.a.Add(o().notificationState.notifications),e.Calendar.dismissReminders(t,a.a.timeZone).catch((function(e){n.i.genericServiceExceptionLog("Notifications_DismissAllNotificationsForProvider_Failed",6,e)}))}))}}function m(e,t){return function(i,o,c){i({type:l.e,id:e}),c.then((function(e){null!=t&&e.Calendar.dismissReminders([t],a.a.timeZone).catch((function(e){n.i.genericServiceExceptionLog("Notifications_DismissNotification_Failed",6,e)})),s.a.Add(o().notificationState.notifications)}))}}function h(e){return{type:l.b,notifications:e}}function g(e){return function(t,i){t({type:l.c,alertData:e}),s.a.Add(i().notificationState.notifications)}}function S(e){return{type:l.i,shouldShowSettings:e}}function I(e){return{type:l.j,futureReminders:e}}function y(e){return{type:l.g,muted:e}}function x(e,t){return function(i,o,s){s.then((function(i){i.Calendar.snoozeReminders(e,t,a.a.timeZone).catch((function(e){n.i.genericServiceExceptionLog("Notifications_SnoozeReminders_Failed",6,e)}))}))}}function v(e){return function(t,i,n){n.then((function(){r.a.SubscribeAllProviders(e).then((function(){t({type:l.k,isReady:!0})})).catch((function(){}))}))}}},297:function(e,t,i){var n=i(540);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},299:function(e,t,i){"use strict";i.d(t,"g",(function(){return o})),i.d(t,"e",(function(){return s})),i.d(t,"d",(function(){return c})),i.d(t,"c",(function(){return r})),i.d(t,"b",(function(){return l})),i.d(t,"a",(function(){return d})),i.d(t,"f",(function(){return f}));var n=i(151),a=i(156),o=2;function s(e,t,i){if(!e||0===e.length)return!1;switch(t){case 40:i.index++;break;case 38:i.index--;break;case 35:i.index=e.length;break;case 36:i.index=0;break;default:return!1}return i.index=i.index%e.length,i.index=i.index<0?0:i.index,i.selectedReminderId=e[i.index].payload.reminder.ReminderItemDataModel.ItemId,!0}function c(){var e=new Date;return e.getUTCFullYear().toString()+e.getUTCMonth().toString()+e.getUTCDate().toString()+e.getUTCHours().toString()+e.getUTCMinutes().toString()+e.getUTCSeconds().toString()+e.getUTCMilliseconds().toString()}function r(e,t){if(null==t||null==t.notificationPreferencesData||!t.notificationPreferencesData.EnableNewItemSoundNotify&&!t.notificationPreferencesData.EnableReminderSound&&!t.notificationPreferencesData.EnableChatSound&&!t.notificationPreferencesData.EnableCallingSound)return"";switch(e.providerType){case n.a.NewMailNotification:return null!=t.mailNotificationAudioUrl&&t.notificationPreferencesData.EnableNewItemSoundNotify?t.mailNotificationAudioUrl:"";case n.a.SystemAlert:return null!=t.systemNotificationAudioUrl?t.systemNotificationAudioUrl:"";case n.a.ReminderNotification:return null!=t.calendarNotificationAudioUrl&&t.notificationPreferencesData.EnableReminderSound?t.calendarNotificationAudioUrl:"";case n.a.ChatNotification:return e.subType===a.a.call?null!=t.callNotificationAudioUrl&&t.notificationPreferencesData.EnableCallingSound?t.callNotificationAudioUrl:"":null!=t.chatNotificationAudioUrl&&t.notificationPreferencesData.EnableChatSound?t.chatNotificationAudioUrl:"";default:return""}}function l(e,t,i){return e.filter((function(e){return i?e.payload.reminder.ReminderItemDataModel.ItemId===t:e.payload.reminder.ReminderItemDataModel.ItemId!==t}))}function d(e,t){var i=e.filter((function(e){return e.providerType===n.a.ReminderNotification}));return t?i.filter((function(e){return 3===e.toastState})):i.filter((function(e){return 3!==e.toastState}))}function f(e){e.preventDefault()}},304:function(e,t,i){"use strict";i.d(t,"a",(function(){return r}));var n=i(0),a=i(2),o=i(3),s=i(13),c=i(330),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(n.__extends)(t,e),t.prototype.render=function(){var e,t=this,i=Object(s.a)();return a.createElement("button",{id:this.props.id,className:Object(o.x)(c.toggleBackground,this.props.on?c.toggleOn+" "+i.neutral.accent.font+" "+i.neutral.accent.background:c.toggleOff+" "+i.neutral.dark.border+" "+i.neutral.dark.font+" "+i.neutral.lighterAlt.background+" "),tabIndex:0,title:this.props.ariaLabel,"aria-label":this.props.ariaLabel,role:"switch","aria-checked":this.props.on,onClick:function(){return t.props.onToggled(!t.props.on)}},a.createElement(o.f,{fontIconCss:Object(o.x)("ms-Icon--ToggleThumb",(e={},e[i.neutral.lighterAlt.font]=this.props.on,e))}))},t}(a.Component)},316:function(e,t,i){"use strict";i.d(t,"a",(function(){return g}));var n=i(4),a=i(1),o=i(31),s=i(3),c=i(43),r=i(400),l=i(67),d=i(136),f=i(151),p=i(356),u=i(292),b=i(6),m="User",h=n.k.SuiteScope,g=function(){function e(){}return e.LoadItemsFromSessionStorageToState=function(t){var i=[];e.GetNoticationsFromSessionStorage(t).then((function(e){if(null!=e&&e.length>0){var n=e.filter((function(e){return e.providerType!==f.a.ReminderNotification||(p.a.isVisibleReminderOverdue(e.payload.reminder.ReminderItemDataModel.EndDate)&&i.push(e.payload.reminder),!1)}));Object(s.K)().dispatch(Object(u.b)(n))}t.notificationPreferencesData.EnableReminders&&(0===i.length&&p.a.GetRemindersFromServer(),p.a.OnGetRemindersSucceeded(i))})).catch((function(){}))},e.GetNoticationsFromSessionStorage=function(t){return new Promise((function(i,n){var s=new l.d;s.requestRead(e.notificationsStorageKey),Object(a.b)().subscribe("SuiteAPILoaded",(function(){c.b.Instance.Storage.submitStorageRequestToSessionStorage(s).then((function(n){if(null!=n&&null!=n.value&&n.hasKey(e.notificationsStorageKey)){var a=n.value(e.notificationsStorageKey);null!==a&&a.length>0&&(Object(o.c)(t.workloadID)||t.notificationPreferencesData&&t.notificationPreferencesData.EnableNewItemNotify?i(e.loadNonMailNotificationFromStorage(a)):i(a))}i(null)})).catch((function(e){n(e)}))}),!0)}))},e.Add=function(t){var i=new l.d,n=[];t.forEach((function(e){3!==e.toastState&&n.push(e)})),null!=n&&n.length>0&&(i.requestWrite(n,e.notificationsStorageKey),Object(a.b)().subscribe("SuiteAPILoaded",(function(e){e.Storage.submitStorageRequestToSessionStorage(i).catch((function(){}))}),!0))},e.RemoveItems=function(t,i){var n=new l.d;n.requestRead(e.notificationsStorageKey),c.b.Instance.Storage.submitStorageRequestToSessionStorage(n).then((function(t){if(null!=t&&null!=t.value&&t.hasKey(e.notificationsStorageKey)){var a=t.value(e.notificationsStorageKey),o=void 0;null!=a&&(o=a.filter((function(e){return e.subType!==i}))).length>0&&(n.requestWrite(o,e.notificationsStorageKey),c.b.Instance.Storage.submitStorageRequestToSessionStorage(n).catch((function(){})))}})).catch((function(){}))},e.RetrieveSystemAlertsSessionStorage=function(t,i,n){return new Promise((function(o,s){var d=new l.c(h,m,i),p=new l.c(h,m,t),u=new l.d;u.requestRead(d,p),Object(a.b)().subscribe("SuiteAPILoaded",(function(){c.b.Instance.Storage.submitStorageRequestToSessionStorage(u).then((function(t){if(null!=t&&null!=t.value&&t.hasKey(d)){var i=t.value(d);null!=i&&r.c.UTCNow.compare(r.c.parseISO8601DateTime(i))<r.a&&t.hasKey(p)?o(t.value(p)):(e.RemoveItems(f.a.SystemAlert,n),o([]))}else o([])})).catch((function(e){s(e)}))}),!0)}))},e.StoreSystemAlertToCache=function(e,t,i){if(null!=e){var n=new l.c(h,m,i),o=new l.c(h,m,t),s=new l.d;s.requestWrite(r.c.UTCNow.getNativeDateTime(),n),s.requestWrite(e,o),Object(a.b)().subscribe("SuiteAPILoaded",(function(){c.b.Instance.Storage.submitStorageRequestToSessionStorage(s).catch((function(){}))}),!0)}},e.GetSystemAlertsLastViewedTime=function(){var e=this;return new Promise((function(t,i){var o=new l.d,s=new l.c(h,m,"SystemAlertsLastRefreshDate"),r=null;o.requestRead(s),Object(a.b)().subscribe("SuiteAPILoaded",(function(){c.b.Instance.Storage.submitStorageRequestToSessionStorage(o).then((function(i){if(null!=i&&null!=i.value&&i.hasKey(s)){var n=i.value(s);null!=n&&(r=new Date(n))}else e.GetSystemAlertsLastViewedFromStorage().then((function(e){r=e})).catch((function(){}));t(r)})).catch((function(e){n.i.genericServiceRejection("Notifications_GetSystemAlertsLastViewedTime_Failed",4,e,i)}))}),!0)}))},e.SetSystemAlertsLastViewedToSessionStorage=function(e){var t=new l.d,i=new l.c(h,m,"SystemAlertsLastRefreshDate");t.requestWrite(e,i),c.b.Instance.Storage.submitStorageRequestToSessionStorage(t).catch((function(e){n.i.isCallsBlockedException(e)||n.i.genericServiceExceptionLog("Notifications_SetSystemAlertsLastViewedToSessionStorage_Failed",4,e)}))},e.GetSystemAlertsLastViewedFromStorage=function(){return e.GetAlertLastViewedFromStorage("SystemAlertsLastRefreshDate")},e.SetSystemAlertsLastViewedToStorage=function(){var e=this,t=(new Date).getTime();c.b.Instance.WebShellStorage.writeStorage(d.b.User,d.a.SystemMetadata,"SystemAlertsLastRefreshDate",t).then((function(i){e.SetSystemAlertsLastViewedToSessionStorage(t)})).catch((function(e){n.i.genericServiceExceptionLog("Notifications_SetSystemAlertsLastViewedToStorage_Failed",6,e)}))},e.loadNonMailNotificationFromStorage=function(t){return new Promise((function(i,n){var o=new l.d,s=t.filter((function(e){return e.providerType!==f.a.NewMailNotification}));o.requestRemove(e.notificationsStorageKey),Object(a.b)().subscribe("SuiteAPILoaded",(function(){c.b.Instance.Storage.submitStorageRequestToSessionStorage(o).then((function(t){o.requestWrite(s,e.notificationsStorageKey),c.b.Instance.Storage.submitStorageRequestToSessionStorage(o).catch((function(){})),i(s)})).catch((function(e){n(e)}))}),!0)}))},e.GetLegalAlertLastViewedFromLocalStorage=function(){return new Promise((function(e,t){var i=window.localStorage,a=null;try{if(null!=i){var o=i.getItem("GallatinLegalAlertTimestamp"),s=i.getItem("GallatinLegalAlertLastFetchedTimestamp");if(!Object(b.isNullOrEmptyString)(o)&&!Object(b.isNullOrEmptyString)(s))(new Date).getTime()-new Date(parseInt(s)).getTime()<r.a&&e(a=new Date(parseInt(o)))}e(a)}catch(e){n.i.genericServiceRejection("Notifications_Error_ReadingGallatinAlertTimeStamp_FromLocalStorage",6,e,t)}}))},e.SetLegalAlertLastViewedToLocalStorage=function(e){var t=new Date,i=window.localStorage;try{null!=i&&(null!=e&&i.setItem("GallatinLegalAlertTimestamp",e.getTime().toString()),i.setItem("GallatinLegalAlertLastFetchedTimestamp",t.getTime().toString()))}catch(e){n.i.genericServiceExceptionLog("Notifications_Error_WritingGallatinAlertTimeStamp_ToLocalStorage",6,e)}},e.GetLegalAlertLastViewedFromStorage=function(){return e.GetAlertLastViewedFromStorage("GallatinLegalAlertTimestamp")},e.SetLegalAlertLastViewedToStorage=function(){var e=this,t=new Date;c.b.Instance.WebShellStorage.writeStorage(d.b.User,d.a.SystemMetadata,"GallatinLegalAlertTimestamp",t.getTime()).then((function(i){e.SetLegalAlertLastViewedToLocalStorage(t)})).catch((function(e){n.i.genericServiceExceptionLog("Notifications_SetLegalAlertsLastViewedToStorage_Failed",6,e)}))},e.GetAlertLastViewedFromStorage=function(e){return new Promise((function(t,i){Object(a.b)().subscribe("SuiteAPILoaded",(function(){c.b.Instance.WebShellStorage.readStorage(d.b.User,d.a.SystemMetadata,e).then((function(e){var i=null;null!=e.value&&(i=new Date(e.value)),t(i)})).catch((function(t){n.i.genericServiceRejection("Notifications_GetAlertLastViewedFromStorage_"+e+"_Failed",6,t,i)}))}),!0)}))},e.notificationsStorageKey=new l.c(h,m,"NotificationsHistory"),e}()},318:function(e,t,i){"use strict";var n=i(3),a=i(1),o=i(89),s=i(4),c="Chat Settings Instance not available",r=function(){function e(){}return e.getNotificationForChatSetting=function(e){return new Promise((function(t,i){if(o.a){var n=null;o.a.getChatNotificationSettings().then((function(i){n=Object(o.e)(i,e),t(n)})).catch((function(e){Object(a.e)().exception("Settings_GetNotificationPreferencesForChatFromChatApi_Failed",6,e),i(e)}))}else i(new s.a(c))}))},e.getNotificationForCallingSetting=function(e){return new Promise((function(t,i){if(o.a){var n=null;o.a.getCallNotificationSettings().then((function(i){n=Object(o.d)(i,e),t(n)})).catch((function(e){Object(a.e)().exception("Settings_GetNotificationPreferencesForCallingFromChatApi_Failed",6,e),i(e)}))}else i(new s.a(c))}))},e.setChatNotificationPreferences=function(e){var t={Enabled:e.EnableChat,SoundEnabled:e.EnableChatSound};return o.a?o.a.setChatNotificationSettings(t):Promise.reject(new s.a(c))},e.setCallingNotificationPreferences=function(e){var t={Enabled:e.EnableCalling,SoundEnabled:e.EnableCallingSound};return o.a?o.a.setCallNotificationSettings(t):Promise.reject(new s.a(c))},e}(),l=function(){function e(){}return e.setNotificationSetting=function(e,t,i,n){"newItemNotification"!==t&&"newItemSoundNotification"!==t&&"reminderNotification"!==t&&"reminderSoundNotification"!==t||e.Settings.setNotificationPreferences(n).catch((function(e){Object(a.e)().exception("Settings_setNotificationPreferences_Failed",6,e)})),!0===i&&("chatNotification"!==t&&"chatSoundNotification"!==t||r.setChatNotificationPreferences(n).catch((function(e){Object(a.e)().exception("Settings_setChatNotificationPreferences_Failed",6,e)})),"callingNotification"!==t&&"callingSoundNotification"!==t||r.setCallingNotificationPreferences(n).catch((function(e){Object(a.e)().exception("Settings_setCallingNotificationPreferences_Failed",6,e)})))},e.setToggleAllowNotifications=function(e,t,i){e.Settings.setNotificationPreferences(i).catch((function(e){Object(a.e)().exception("Settings_setNotificationPreferences_Failed",6,e)})),t&&(r.setChatNotificationPreferences(i).catch((function(e){Object(a.e)().exception("Settings_setChatNotificationPreferences_Failed",6,e)})),r.setCallingNotificationPreferences(i).catch((function(e){Object(a.e)().exception("Settings_setCallingNotificationPreferences_Failed",6,e)})))},e}(),d=i(113);function f(e){return function(t,i,n){n.then((function(i){i.Settings.getLanguageChoices().then((function(i){t(Object(d.g)(i)),t(function(e){return function(t,i,n){n.then((function(i){i.Settings.getLanguageAndTimeZone().then((function(n){if(t(Object(d.f)(n.CurrentCultureName)),e)i.Settings.getTimeZoneChoices().then((function(e){t(Object(d.r)(e)),t(Object(d.q)(n.CurrentTimeZone,n.CurrentDateFormat,n.CurrentTimeFormat));var i={locale:n.CurrentCultureName,timezone:n.CurrentTimeZone,dateformat:n.CurrentDateFormat,timeformat:n.CurrentTimeFormat};Object(a.e)().impression("LanguageAndRegionCard_InitialValues","SettingsCard",0,void 0,JSON.stringify(i))})).catch((function(e){return Object(a.e)().exception("Settings_getTimeZoneChoices_Failed",6,e)}));else{var o={locale:n.CurrentCultureName};Object(a.e)().impression("LanguageAndRegionCard_InitialValues","SettingsCard",0,void 0,JSON.stringify(o))}})).catch((function(e){Object(a.e)().exception("Settings_getLanguageAndTimeZone_Failed",6,e)}))}))}}(e))})).catch((function(e){return Object(a.e)().exception("Settings_getLanguageChoices_Failed",6,e)}))}))}}function p(e){return function(t,i,n){return new Promise((function(i,a){n.then((function(n){n.Settings.setLanguageAndTimeZone(e).then((function(){t(Object(d.j)()),i()})).catch(a)}))}))}}function u(e,t,i){return function(n,o,s){s.then((function(o){o.Settings.getDateTimeFormats(e).then((function(e){n(Object(d.c)(e.DateFormats)),n(Object(d.p)(e.TimeFormats));var a=e.DateFormats.some((function(e){return e===t})),o=e.TimeFormats.some((function(e){return e===i}));a||""===t||n(Object(d.k)(e.DateFormats[0])),o||""===i||n(Object(d.m)(e.TimeFormats[0]))})).catch((function(e){Object(a.e)().exception("Settings_getDateTimeFormats_Failed",6,e)}))}))}}function b(){return function(e,t,i){i.then((function(t){t.Settings.loadUserThemeChoices().then((function(t){e(Object(n.cb)(t))})).catch((function(e){Object(a.e)().exception("Settings_loadUserThemeChoices_Failed",6,e)}))}))}}function m(e,t){return function(i,o,s){s.then((function(o){o.Settings.getNotificationPreferences(e).then((function(e){t?r.getNotificationForChatSetting(e).then((function(e){r.getNotificationForCallingSetting(e).then((function(e){Object(a.e)().impression("NotificationsCard_InitialValue","SettingsCard",0,void 0,JSON.stringify(e)),i(Object(n.fb)(e))}))})):i(Object(n.fb)(e))}))}))}}function h(e,t){return function(i,a,o){o.then((function(a){i(Object(n.fb)(t)),l.setToggleAllowNotifications(a,e,t)}))}}function g(e,t,i){return function(a,o,s){s.then((function(o){a(Object(n.fb)(i)),l.setNotificationSetting(o,e,t,i)}))}}i.d(t,"a",(function(){return f})),i.d(t,"e",(function(){return p})),i.d(t,"b",(function(){return u})),i.d(t,"d",(function(){return b})),i.d(t,"c",(function(){return m})),i.d(t,"g",(function(){return h})),i.d(t,"f",(function(){return g}))},320:function(e,t,i){"use strict";function n(e,t,i){var n="Warning: Deprecated Shell API ("+e+") usage detected.  "+t;i&&(n+="More info: "+i),console;try{throw new Error(n)}catch(e){}}i.d(t,"a",(function(){return n}))},330:function(e,t,i){var n=i(331);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},331:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,".o365cs-base .dd813cdc4a5971812c4132e29e8bd695\\.scss{min-width:0;position:relative;font-size:20px;width:44px;height:20px;display:flex;cursor:pointer;padding:0 5px 2px;border-radius:20px;border:1px solid transparent;line-height:12px;float:right;opacity:.8}.o365cs-base .dd813cdc4a5971812c4132e29e8bd695\\.scss:focus,.o365cs-base .dd813cdc4a5971812c4132e29e8bd695\\.scss:hover{opacity:1}.o365cs-base ._493d75fb9b28bd7f1eb4f57d96a993b4\\.scss{justify-content:flex-end}.o365cs-base ._493d75fb9b28bd7f1eb4f57d96a993b4\\.scss div{padding-top:3px;line-height:14px;font-size:12px}.o365cs-base ._8dc69f6e59c154c607c347ec523e1640\\.scss{justify-content:flex-start;border:1px solid}.o365cs-base ._8dc69f6e59c154c607c347ec523e1640\\.scss div{padding-top:3px;line-height:12px;font-size:12px}",""]),t.locals={toggleBackground:"dd813cdc4a5971812c4132e29e8bd695.scss",toggleOn:"_493d75fb9b28bd7f1eb4f57d96a993b4.scss",toggleOff:"_8dc69f6e59c154c607c347ec523e1640.scss"}},356:function(e,t,i){"use strict";i.d(t,"a",(function(){return I}));var n,a,o,s=i(4),c=i(1),r=i(3),l=i(62),d=i(44),f=i(105),p=i(467),u=i(292),b=i(299),m=i(151),h=8*l.b,g=1*l.c,S=!1,I=function(){function e(){}return e.handleNotification=function(e,t){if(null!==e){e&&e.shouldGetReminders&&this.GetRemindersFromServer()}},e.GetReminderNotificationItem=function(e){var t=null;if(e&&e.length>0){var i=e.filter((function(e){return e.providerType===m.a.ReminderNotification}));null!=i&&i.length>0&&(t=i[0])}return t},e.GetRemindersFromServer=function(){document.hidden||n?S=!0:(o&&window.clearInterval(o),Object(c.b)().subscribe("SuiteAPILoaded",(function(){f.a.Instance.Calendar.getReminders(null,d.a.UTCNow.addDays(10).getNativeDateTime(),!0,d.a.timeZone).then((function(t){e.OnGetRemindersFromServerSucceeded(t)})).catch((function(e){!1===s.i.isCallsBlockedException(e)&&Object(c.e)().exception("Notifications_GetRemindersFromServer_Failed",6,e)}))}),!0))},e.ProcessGetReminderFromServer=function(){S&&(S=!1,this.GetRemindersFromServer())},e.OnGetRemindersFromServerSucceeded=function(t){var i=this,a=Object(r.K)(),s=a.getState().notificationState.notifications.slice(0);if("ErrorTooManyObjectsOpened"===t.ResponseCode)S=!0,n=window.setTimeout((function(){window.clearInterval(n),n=null,i.GetRemindersFromServer()}),g);else{var c=Object(b.a)(s,!0);if(c.length>0)return void a.dispatch(Object(u.m)(!0,null,c[0].payload.id));if(null!=t.Reminders){var l,d=[];t.Reminders.forEach((function(t){i.isVisibleReminderOverdue(t.EndDate)&&(l=e.CreateReminderItem(t,0),d.push(l))})),e.OnGetRemindersSucceeded(d)}o=window.setTimeout((function(){i.GetRemindersFromServer()}),h)}},e.CreateReminderItem=function(e,t){var i={Subject:e.Subject,Location:e.Location,ReminderTime:d.a.parseISO8601DateTime(e.ReminderTime),StartDate:d.a.parseISO8601DateTime(e.StartDate),EndDate:d.a.parseISO8601DateTime(e.EndDate),ItemId:e.ItemId,RecurringMasterItemId:e.RecurringMasterItemId,ReminderGroup:e.ReminderGroup||0,ReminderGroups:e.ReminderGroupTypes,JoinOnlineMeetingUrl:e.JoinOnlineMeetingUrl,displayState:t};return new p.a(i)},e.initalReminderNotification=function(e){return{providerType:m.a.ReminderNotification,payload:{id:m.a[m.a.ReminderNotification]+Object(b.d)()+Math.floor(1e3*Math.random()),reminder:e},toastState:0,toastType:1,navigationUrl:null}},e.OnGetRemindersSucceeded=function(t){var i=this,n=Object(r.K)(),a=Object(b.a)(n.getState().notificationState.notifications.slice(0),!1),o=[],s=t.sort((function(e,t){return e.ReminderItemDataModel.StartDate.compare(t.ReminderItemDataModel.StartDate)})).map((function(e){return i.initalReminderNotification(e)})),c=d.a.UTCNow,l=0;if(s.forEach((function(e){e.payload.reminder.ReminderItemDataModel.ReminderTime.toUTC().compare(c)>0?o.push(e.payload.reminder):(a.length>l?n.dispatch(Object(u.m)(!1,e.payload.reminder,a[l].payload.id)):n.dispatch(Object(u.a)(e)),l++)})),a.length>l)for(var f=l;f<a.length;f++)n.dispatch(Object(u.m)(!0,null,a[f].payload.id));n.dispatch(Object(u.l)(o)),e.RefreshNextReminderTimer(n,c,o)},e.RefreshNextReminderTimer=function(e,t,i){var n=this;window.clearInterval(a),i.sort((function(e,t){return e.ReminderItemDataModel.ReminderTime.compare(t.ReminderItemDataModel.ReminderTime)}));var o=i.length>0?i[0]:null;o&&(a=window.setTimeout((function(){n.ActivateReminders(e,d.a.UTCNow,i)}),o.ReminderItemDataModel.ReminderTime.toUTC().Subtract(t)))},e.ActivateReminders=function(t,i,n){var a,o=this;n=n.filter((function(e){return!(e.ReminderItemDataModel.ReminderTime.toUTC().compare(i)<=0)||(a=o.initalReminderNotification(e),t.dispatch(Object(u.a)(a)),!1)})),null!=a&&t.dispatch(Object(u.l)(n)),e.RefreshNextReminderTimer(t,i,n)},e.isVisibleReminderOverdue=function(e){return("string"==typeof e?d.a.parseISO8601DateTime(e):e).toUTC().addMinutes(15).compare(d.a.UTCNow)>=0},e}()},400:function(e,t,i){"use strict";var n=i(44);i.d(t,"c",(function(){return n.a}));i(401);var a=i(62);i.d(t,"a",(function(){return a.a})),i.d(t,"b",(function(){return a.c}))},401:function(e,t,i){"use strict";i.d(t,"b",(function(){return c})),i.d(t,"a",(function(){return l}));var n,a=i(62),o=i(73),s=i(180),c=7*a.a,r=((n={}).default=!0,n.en=!0,n["am-ET"]=!0,n["bg-BG"]=!0,n["bn-IN"]=!0,n["ca-ES"]=!0,n["cz-CZ"]=!0,n["cy-GB"]=!0,n["da-DK"]=!0,n["de-DE"]=!0,n["el-GR"]=!0,n["en-029"]=!0,n["en-AU"]=!0,n["en-BZ"]=!0,n["en-CA"]=!0,n["en-GB"]=!0,n["en-IE"]=!0,n["en-IN"]=!0,n["en-JM"]=!0,n["en-MY"]=!0,n["en-NZ"]=!0,n["en-PH"]=!0,n["en-SG"]=!0,n["en-TT"]=!0,n["en-US"]=!0,n["en-ZA"]=!0,n["en-ZW"]=!0,n["es-ES"]=!0,n["es-MX"]=!0,n["et-EE"]=!0,n["eu-ES"]=!0,n["fi-FI"]=!0,n["fr-BE"]=!0,n["fr-CA"]=!0,n["fr-CH"]=!0,n["fr-FR"]=!0,n["fr-LU"]=!0,n["fr-MC"]=!0,n["gl-ES"]=!0,n["gu-IN"]=!0,n["hi-IN"]=!0,n["hr-HR"]=!0,n["hu-HU"]=!0,n["id-ID"]=!0,n["is-IS"]=!0,n["it-IT"]=!0,n["kk-KZ"]=!0,n["kn-IN"]=!0,n["lt-LT"]=!0,n["lv-LV"]=!0,n["ms-MY"]=!0,n["nb-NO"]=!0,n["nl-NL"]=!0,n["pl-PL"]=!0,n["pt-BR"]=!0,n["pt-PT"]=!0,n["ro-RO"]=!0,n["ru-RU"]=!0,n["sk-SK"]=!0,n["sl-SI"]=!0,n["sv-SE"]=!0,n["ta-IN"]=!0,n["te-IN"]=!0,n["tr-TR"]=!0,n["uk-UA"]=!0,n["vi-VN"]=!0,n),l=function(){function e(){}return e.ConvertToDateTime=function(e){var t=new Date(e.year,e.month,e.date,e.hour).getTimezoneOffset()*a.c,i=e.GetMilliseconds()+t;return new Date(i)},e.GetShortTime=function(t){var i=null,n=null;o.a.Instance.is24HourFormat?n="H":(n="h",i=r[o.a.Instance.userCulture]?"t":"tt",i="t");var a=o.a.Instance.timeFormat,c=e.ConvertToDateTime(t),l=s(c,n);l=l+e.GetTimeSeparator(a)+s(c,"MM");var d=null==i?"":s(c,i);return 0===a.indexOf("tt")?d+l:l+d},e.GetTimeSeparator=function(e){var t=null;if(-1!==e.indexOf("'h'"))return"'h'".replace("/'+/g","");if(-1!==e.indexOf("' h '"))return"' h '".replace("/'+/g","");var i=e.split(new RegExp("[hH]+"));return null!=i&&i.forEach((function(e){e.length>1&&(t=e.substring(0,1))})),t},e}()},402:function(e,t,i){"use strict";i.d(t,"a",(function(){return p}));var n=i(0),a=i(2),o=i(3),s=i(1),c=i(304),r=i(5),l=i(89),d=i(403),f=i(13),p=function(e){function t(t){var i=e.call(this,t)||this;return Object(s.e)().impression("NotificationSettings","NotificationsSettingsPane"),i.state={allowNotifications:Object(l.b)(i.props.chatFeatureEnabled,i.props.notificationPreferences)},i}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){var e=document.getElementById("FlexpaneBackButton");e||(e=document.getElementById("O365fp_firstFocusable")),window.setTimeout((function(){return e.focus()}),100)},t.prototype.toggleNotification=function(e){if("allowNotifications"!==e){var t=this.props.notificationPreferences;this.mapKeyToPreferenceKey(e,t,!0),this.setState({allowNotifications:Object(l.b)(this.props.chatFeatureEnabled,t)}),this.logNotificationChange(e,t),this.props.onToggleNotification(e,this.props.chatFeatureEnabled,t)}else this.toggleAllowNotifications()},t.prototype.toggleAllowNotifications=function(){var e=!this.state.allowNotifications,t=Object(n.__assign)(Object(n.__assign)({},this.props.notificationPreferences),{EnableNewItemNotify:e,EnableNewItemSoundNotify:e,EnableReminders:e,EnableReminderSound:e});this.props.chatFeatureEnabled&&(t=Object(n.__assign)(Object(n.__assign)({},t),{EnableChat:e,EnableChatSound:e,EnableCalling:e,EnableCallingSound:e})),this.setState({allowNotifications:e}),this.logNotificationChange("allowNotifications",t),this.props.onToggleAllowNotifications(this.props.chatFeatureEnabled,t)},t.prototype.render=function(){var e=this.state.allowNotifications?null:d.hidden,t=this.props.notificationPreferences,i=Object(f.a)();return t&&a.createElement("div",{id:"NotificationsPreferencePanel",className:d.notificationsSubPanel},a.createElement("div",{className:Object(o.x)(d.settingHeader,i.neutral.dark.font)},r.a.NotificationSettings),this.buildNotificationSettingControl(Object(o.x)(d.notification),r.a.AllowNotifications,"allowNotifications",this.state.allowNotifications),a.createElement("div",{className:Object(o.x)(d.horizRule,i.neutral.light.background)}),this.props.chatFeatureEnabled&&a.createElement("div",null,this.buildNotificationSettingControl(Object(o.x)(e,t.EnableChat?null:d.lastNotificationSetting),r.a.ChatNotificationSetting,"chatNotification",t.EnableChat,r.a.ChatNotificationSettingLabel),this.buildNotificationSettingControl(Object(o.x)(e,d.lastNotificationSetting,t.EnableChat?null:d.hidden),r.a.ChatSoundNotificationSetting,"chatSoundNotification",t.EnableChatSound),this.buildNotificationSettingControl(Object(o.x)(e,t.EnableCalling?null:d.lastNotificationSetting),r.a.CallingNotificationSetting,"callingNotification",t.EnableCalling),this.buildNotificationSettingControl(Object(o.x)(e,d.lastNotificationSetting,t.EnableCalling?null:d.hidden),r.a.CallingSoundNotificationSetting,"callingSoundNotification",t.EnableCallingSound)),this.buildNotificationSettingControl(Object(o.x)(e,t.EnableNewItemNotify?null:d.lastNotificationSetting),r.a.NewMailNotificationSetting,"newItemNotification",t.EnableNewItemNotify,r.a.NewMailNotificationSettingLabel),this.buildNotificationSettingControl(Object(o.x)(e,d.lastNotificationSetting,t.EnableNewItemNotify?null:d.hidden),r.a.NewMailSoundNotificationSetting,"newItemSoundNotification",t.EnableNewItemSoundNotify),this.buildNotificationSettingControl(e,r.a.RemindersNotificationSetting,"reminderNotification",t.EnableReminders),this.buildNotificationSettingControl(Object(o.x)(e,d.lastNotificationSetting,t.EnableReminders?null:d.hidden),r.a.RemindersSoundNotificationSetting,"reminderSoundNotification",t.EnableReminderSound))},t.prototype.buildNotificationSettingControl=function(e,t,i,n,s){var r=this,l=Object(f.a)();return a.createElement("div",{className:Object(o.x)(d.notification,e),tabIndex:-1},a.createElement("div",{"aria-hidden":"true",className:Object(o.x)(d.notificationName,l.neutral.dark.font)},t),a.createElement(c.a,{id:i,ariaLabel:s||t,on:n,onToggled:function(){return r.toggleNotification(i)}}))},t.prototype.logNotificationChange=function(e,t){var i=this.mapKeyToPreferenceKey(e,t,!1);Object(s.e)().click(e,this.props.hostId,"NotificationSettings",null,i.toString())},t.prototype.mapKeyToPreferenceKey=function(e,t,i){var n={status:!1};switch(e){case"allowNotifications":case"newItemNotification":t.EnableNewItemNotify=this.changedItem(i,t.EnableNewItemNotify,n);break;case"newItemSoundNotification":t.EnableNewItemSoundNotify=this.changedItem(i,t.EnableNewItemSoundNotify,n);break;case"reminderNotification":t.EnableReminders=this.changedItem(i,t.EnableReminders,n);break;case"reminderSoundNotification":t.EnableReminderSound=this.changedItem(i,t.EnableReminderSound,n);break;case"chatNotification":t.EnableChat=this.changedItem(i,t.EnableChat,n);break;case"chatSoundNotification":t.EnableChatSound=this.changedItem(i,t.EnableChatSound,n);break;case"callingNotification":t.EnableCalling=this.changedItem(i,t.EnableCalling,n);break;case"callingSoundNotification":t.EnableCallingSound=this.changedItem(i,t.EnableCallingSound,n)}return n.status},t.prototype.changedItem=function(e,t,i){return i.status=e?!t:t,i.status},t}(a.Component)},403:function(e,t,i){var n=i(404);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},404:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,'.o365cs-base ._085fcf3b3bfc767849666fd4160c9966\\.scss{font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:16px;font-weight:600;margin-bottom:8px}.o365cs-base .c044723e7c1ec1846a47adb33fb91630\\.scss{margin-bottom:8px}.o365cs-base ._225b4c9f1a7ec5357b88d233a6fa3cb4\\.scss{display:flex;margin-bottom:12px}.o365cs-base .ac84fa023047f1c6c1371f74b8fccc79\\.scss{margin-bottom:36px}.o365cs-base ._3766845620e32bf84adb42e31864048e\\.scss{font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;line-height:20px;width:100%}.o365cs-base ._98ee386da7682850abafd6f8d45b3566\\.scss{display:none!important}.o365cs-base ._43e893868ec332ea8f021ee0a4309b5a\\.scss{height:2px;margin-top:24px;margin-bottom:24px}',""]),t.locals={settingHeader:"_085fcf3b3bfc767849666fd4160c9966.scss",notificationsSubPanel:"c044723e7c1ec1846a47adb33fb91630.scss",notification:"_225b4c9f1a7ec5357b88d233a6fa3cb4.scss",lastNotificationSetting:"ac84fa023047f1c6c1371f74b8fccc79.scss",notificationName:"_3766845620e32bf84adb42e31864048e.scss",hidden:"_98ee386da7682850abafd6f8d45b3566.scss",horizRule:"_43e893868ec332ea8f021ee0a4309b5a.scss"}},419:function(e,t,i){"use strict";var n,a=i(0),o=i(3),s=i(1),c=i(292),r=i(35),l=i(4);!function(e){e.New="New",e.Seen="Seen",e.Dismissed="Dismissed"}(n||(n={}));var d=i(151),f=i(5);i.d(t,"a",(function(){return p}));var p=function(){function e(){}return e.getNewAppNotification=function(){Object(o.K)().dispatch(u(l.b.GET))},e.dismiss=function(e){Object(o.K)().dispatch(u(l.b.POST,e,n.Dismissed))},e.setSeen=function(e){Object(o.K)().dispatch(u(l.b.POST,e,n.Seen))},e.myAppsUrl="",e}();function u(e,t,i){return function(u,b,m){var h=t?{Status:i,IDs:t}:"";m.then((function(t){(function(e,t,i){return new Promise((function(n,a){e.Service.callWebClientShellServiceFunction("/api/notifications",t,null,i).then((function(e){n(e)})).catch((function(e){l.i.isCallsBlockedException(e)||Object(s.e)().exception("NewAppProvider_CallNewAppNotificationAPI_Failed",6,e),a(e)}))}))})(t,e,h).then((function(e){var t=function(e,t){if(!e)return null;var i=e.Notifications,s=null;if(i&&i.length>0){var c=i.filter((function(e){return"NewApp"===e.Type}));c.length>0&&(s=function(e,t){var i=null,s=null,c=null,l=null,u=0;if(e.length>0&&null!=t&&t.length>0){var b,m=[];e.forEach((function(e){(b=function(e,t){if(t){var i=e.filter((function(e){return!!e.Id&&e.Id.substring(e.Id.indexOf("Shell")<0?0:5)===t.Payload}));if(i.length>0)return Object(a.__assign)(Object(a.__assign)({},t),{LaunchFullUrl:i[0].LaunchFullUrl,Title:i[0].Title,CollectorID:i[0].CollectorId})}return null}(t,e))&&(m.push(b),e.Status===n.New&&u++)}));var h=m.length;if(0===h)return null;1===h?(i=Object(o.H)(f.a.SingleNewAppTitle,m[0].Title),s=Object(o.H)(f.a.SingleNewAllMessage,m[0].Title),c=f.a.SingleNewAppAction,l=m[0].LaunchFullUrl?m[0].LaunchFullUrl:""):(i=f.a.MultipleNewAppTitle,m[0].Title&&m[1].Title&&(s=h<=3?Object(o.H)(2===h?f.a.MultipleTwoNewAppsMessage:f.a.MultipleThreeNewAppsMessage,m[0].Title,m[1].Title):Object(o.H)(f.a.MultipleFourNewAppsMessage,m[0].Title,m[1].Title,(h-2).toString())),c=f.a.MultipleNewAppAction,l=p.myAppsUrl);var g={ID:"NewAppNotification",Title:i,Message:s,Type:d.a.NewAppNotification,LaunchFullUrl:l,ActionText:c,UnseenCount:u,AllNewAppIDs:m.map((function(e){return e.ID})),ItemID:1===h?m[0].ID:"NewAppNotification",CollectorID:1===h?m[0].CollectorID:"",AllAppTileIDs:m.map((function(e){return r.c(e.ID,e.CollectorID)}))};return{providerType:d.a.NewAppNotification,payload:g,toastState:0,toastType:3,navigationUrl:l}}return null}(c,t))}return s}(e,b().appsDataState.apps);null!=t&&u(Object(c.a)(t))})).catch((function(){}))}))}}},466:function(e,t,i){"use strict";function n(e){window.open(e,"_blank","width=1000,height=600,top=150,left=150,menubar=no,resizable=yes,status=no,scrollbars=yes,titlebar=no,toolbar=no")}i.d(t,"a",(function(){return n}))},467:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var n=i(31),a=i(62),o=i(44),s=i(401),c=i(43),r=i(1),l=i(11),d=i(151),f=i(466),p=i(5),u=function(){function e(t){this.reminderItemDataModel=null,this.isReminderOverdue=!1,this.reminderItemDataModel=t,this.referenceDateTime=e.GetReferenceTimeFromNow(),this.UpdateTimeToStartFromReferenceTime(),0!==this.reminderItemDataModel.ReminderGroup&&1!==this.reminderItemDataModel.ReminderGroup&&Object(c.a)(Object(l.b)("Invalid value {0} for reminder group",this.reminderItemDataModel.ReminderGroup))}return Object.defineProperty(e.prototype,"ReminderItemDataModel",{get:function(){return this.reminderItemDataModel},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"IsReminderOverdue",{get:function(){return this.isReminderOverdue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeToItemStartValue",{get:function(){return this.timeToStartValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeToItemStartUnit",{get:function(){return this.timeToStartUnit},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TimeLabel",{get:function(){var t="";return 0===this.reminderItemDataModel.ReminderGroup?t=o.a.areDatePartsEqual(this.reminderItemDataModel.StartDate,this.referenceDateTime)&&o.a.areDatePartsEqual(this.reminderItemDataModel.StartDate,this.reminderItemDataModel.EndDate)?Object(l.b)("{0} - {1}",s.a.GetShortTime(this.reminderItemDataModel.StartDate),s.a.GetShortTime(this.reminderItemDataModel.EndDate)):e.GetLongDateTimeString(this.reminderItemDataModel.StartDate):1===this.reminderItemDataModel.ReminderGroup&&(t=s.a.GetShortTime(this.reminderItemDataModel.ReminderTime)),t},enumerable:!0,configurable:!0}),e.prototype.UpdateReferenceTimeFromNow=function(){this.referenceDateTime=e.GetReferenceTimeFromNow(),this.UpdateTimeToStartFromReferenceTime()},e.prototype.UpdateReferenceTime=function(t){this.referenceDateTime=e.GetReferenceTime(t),this.UpdateTimeToStartFromReferenceTime()},e.GetLongDateTimeString=function(t){var i=s.a.GetShortTime(t),n=e.daysOfTheWeek[s.a.ConvertToDateTime(t).getDay()],a=e.monthsOfTheYear[t.month],o=t.date.toString(),c=t.year.toString();return Object(l.b)("{0} {1}, {2} {3}, {4}",i,n,a,o,c)},e.prototype.UpdateTimeToStartFromReferenceTime=function(){var e=this.GetTimeToStartInMillis(),t=this.GetDurationInfo(Math.abs(e));this.isReminderOverdue=Math.floor(e/a.c)<0,this.timeToStartValue=t[0],this.timeToStartUnit=t[1]},e.prototype.GetTimeToStartInMillis=function(){var e=null;return 0===this.reminderItemDataModel.ReminderGroup?e=this.reminderItemDataModel.StartDate:1===this.reminderItemDataModel.ReminderGroup&&(e=this.reminderItemDataModel.ReminderTime),e.Subtract(this.referenceDateTime)},e.prototype.GetTimeToEndInMillis=function(){var e=null;if(0===this.reminderItemDataModel.ReminderGroup)e=this.reminderItemDataModel.EndDate;else{if(1!==this.reminderItemDataModel.ReminderGroup)return 0;e=this.reminderItemDataModel.ReminderTime}return e.Subtract(this.referenceDateTime)},e.prototype.OpenItem=function(e,t){Object(r.e)().click("NotificationClick","NotificationToast",d.a[d.a.ReminderNotification]);var i="",a=null,o=t.indexOf("?")>-1?"&":"?",s=this.reminderItemDataModel.ReminderGroups;1==(1&s)?a=4==(4&s)?"IBirthdayFactory":"ICalendarItemDetailsViewModelFactory":2==(2&s)&&(a="TaskReadingPaneViewModelPopOutFactory");i=Object(n.c)(e)?Object(l.b)("{0}{1}path=/owa&viewmodel={2}&ispopout=1&ItemID={3}",t,o,a,encodeURIComponent(this.reminderItemDataModel.ItemId.Id)):Object(l.b)("{0}{1}path=/owa&ItemID={2}",t,o,encodeURIComponent(this.reminderItemDataModel.ItemId.Id)),Object(f.a)(i)},e.prototype.GetDurationInfo=function(e){var t=0,i=p.a.Now_Title;return e>=s.b?i=1===(t=Math.floor(e/s.b))?p.a.Week_Title:p.a.Weeks_Title:e>=a.a?i=1===(t=Math.floor(e/a.a))?p.a.Day_Title:p.a.Days_Title:e>=a.b?i=1===(t=Math.floor(e/a.b))?p.a.Hour_Title:p.a.Hours_Title:e>=a.c&&(i=1===(t=Math.floor(e/a.c))?p.a.Min_Title:p.a.Mins_Title),[t>0?t.toString():"",i]},e.GetReferenceTimeFromNow=function(){var t=o.a.Now;return e.GetReferenceTime(t)},e.GetReferenceTime=function(e){return new o.a(e.year,e.month,e.date,e.hour,e.minute,0,0,0)},e.daysOfTheWeek=[p.a.Sunday_Title,p.a.Monday_Title,p.a.Tuesday_Title,p.a.Wednesday_Title,p.a.Thursday_Title,p.a.Friday_Title,p.a.Saturday_Title],e.monthsOfTheYear=[p.a.January_Title,p.a.February_Title,p.a.March_Title,p.a.April_Title,p.a.May_Title,p.a.June_Title,p.a.July_Title,p.a.August_Title,p.a.September_Title,p.a.October_Title,p.a.November_Title,p.a.December_Title],e}()},468:function(e,t,i){"use strict";i.d(t,"a",(function(){return n})),i.d(t,"l",(function(){return a})),i.d(t,"h",(function(){return o})),i.d(t,"f",(function(){return s})),i.d(t,"d",(function(){return c})),i.d(t,"e",(function(){return r})),i.d(t,"b",(function(){return l})),i.d(t,"c",(function(){return d})),i.d(t,"i",(function(){return f})),i.d(t,"j",(function(){return p})),i.d(t,"k",(function(){return u})),i.d(t,"g",(function(){return b}));var n="suiteux-notification.ADD_NOTIFICATION",a="suiteux-notification.UPDATE_NOTIFICATION",o="suiteux-notification.SET_TOAST_STATUS",s="suiteux-notifications.SET_SEEN_IN_FLEXPANE",c="suiteux-notifications.DISMISS_ALL_NOTIFICATIONS_FOR_PROVIDER",r="suiteux-notifications.DISMISS_NOTIFICATION_FOR_PROVIDER",l="suiteux-notification.ADD_NOTIFICATIONS_FROM_SESSIONSTORAGE",d="suiteux-notification.ADD_SYSTEM_NOTIFICATION",f="suiteux-notification.SHOW_SETTINGS_ACTION",p="suiteux-notification.UPDATE_FUTUREREMINDERS_ACTION",u="suiteux-notification.UPDATE_IS_SUBSCRIPTION_READY_ACTION",b="suiteux-notification.SET_TOASTMUTEDSTATE_ACTION"},469:function(e,t,i){var n=i(547);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},479:function(e,t,i){"use strict";var n=i(31),a=i(3),o=i(89),s=i(1),c=i(43),r=i(400),l=i(316),d=function(){function e(){this.OnGetSystemAlertsSucceeded=function(e){l.a.SetSystemAlertsLastViewedToStorage()}}return e.prototype.GetSystemAlerts=function(){var e=this;c.b.Instance.Calendar.IsInitialized&&l.a.GetSystemAlertsLastViewedTime().then((function(t){var i=new Date;(null==t||i.getTime()-t.getTime()>r.a)&&c.b.Instance.Notification.getSystemAlertsFromAdmin().then(e.OnGetSystemAlertsSucceeded).catch((function(){}))})).catch((function(t){c.b.Instance.Notification.getSystemAlertsFromAdmin().then(e.OnGetSystemAlertsSucceeded).catch((function(){}))}))},e}(),f=i(4),p=i(35),u=i(5),b=i(292),m=i(151),h=function(){function e(e){var t=this;this.launchFullUrl=e,this.retryCount=0,this.OnGetOofAlertSucceeded=function(e){var i=t.CreateOofSystemAlertArray(e);null!=i&&(l.a.StoreSystemAlertToCache(i,"OofAlert","OofAlertFetchTime"),Object(a.K)().dispatch(Object(b.a)(i)))},this.OnGetOofAlertFailed=function(e){!1===f.i.isCallsBlockedException(e)&&(e.message=p.g(e.message),Object(s.e)().exception("Notifications_Error_GettingOOFAlerts",6,e),t.retryCount<2&&(t.retryCount++,t.GetOofAlert()))}}return e.prototype.GetOofAlert=function(){var e=this;c.b.Instance.Calendar.IsInitialized&&l.a.RetrieveSystemAlertsSessionStorage("OofAlert","OofAlertFetchTime","OofAlert").then((function(t){null!=t&&0!==t.length||c.b.Instance.User.getOwaUserOofSettings().then(e.OnGetOofAlertSucceeded).catch(e.OnGetOofAlertFailed)})).catch((function(t){!1===f.i.isCallsBlockedException(t)&&Object(s.e)().exception("Notifications_Error_ReadingOOFAlertFromStorage",4,t),c.b.Instance.User.getOwaUserOofSettings().then(e.OnGetOofAlertSucceeded).catch(e.OnGetOofAlertFailed)}))},e.prototype.CreateOofSystemAlertArray=function(e){var t=null;if(null!=e&&e.IsOofOn){var i=this.launchFullUrl.indexOf("/mail/"),n=this.launchFullUrl.indexOf("/owa/"),a="";if(-1!==i)a=this.launchFullUrl.substring(0,i)+"?#path=/options/automaticreplies";else{if(-1===n)return null;a=this.launchFullUrl.substring(0,n)+"?#path=/options/automaticreplies"}var o={Title:u.a.AutomaticReplies_Title,Message:u.a.AutomaticRepliesOn_Text,ActionText:u.a.AutomaticRepliesOff_Text,ActionTarget:"_self",Id:"OofAlert",ActionUrl:a};t={providerType:m.a.SystemAlert,subType:"OofAlert",payload:{systemAlert:o,id:o.Id},toastType:1,toastState:0,navigationUrl:a}}return t},e}(),g=function(){function e(){}return e.CreateAlert=function(){var e=null,t=Object(a.K)().getState(),i=Object(a.I)(t.appsDataState.apps);if("AdminPortal"!==t.shellInitDataState.clientData.WorkloadId){var n={Title:u.a.TimeZoneAlertTitle,Message:u.a.TimeZoneAlertText,ActionText:u.a.TimeZoneAlertActionText,ActionTarget:"_self",Id:"TimeZoneAlert",ActionUrl:i||""};e={providerType:m.a.SystemAlert,subType:"TimeZoneAlert",payload:{systemAlert:n,id:n.Id},toastType:1,toastState:0,navigationUrl:n.ActionUrl},Object(a.K)().dispatch(Object(b.a)(e))}},e}(),S=i(299),I=function(){function e(){}return e.handle=function(e,t,i,n){if(null!==e){var o=e;if("Reload"!==o.EventType){var s=Object(a.K)(),c=(null===o.SenderSmtpEmailAddress?"":o.SenderSmtpEmailAddress.trim().toLowerCase())!==(null!=n?n.trim().toLowerCase():""),r=t.UserOptions.IsFocusedInboxEnabled||"Other"!==o.InferenceClassification;if(c&&r){var l={providerType:m.a.NewMailNotification,payload:o,toastType:0,toastState:0,navigationUrl:Object(a.H)("{0}?path=/owa&ispopout=1&ItemID={1}",i,encodeURIComponent(o.ItemId))},d=Object(S.d)();l.payload.id=m.a[m.a.NewMailNotification]+d,s.dispatch(Object(b.a)(l))}}}},e}(),y=i(419),x=i(356),v=function(){function e(){var e=this;this.retryCount=0,this.OnGetPasswordExpiryAlertSucceeded=function(t){var i=e.CreatePasswordExpirySystemAlert(t);null!=i&&(l.a.StoreSystemAlertToCache(i,"PasswordExpiryAlert","PasswordExpiryAlertFetchTime"),Object(a.K)().dispatch(Object(b.a)(i)))},this.OnGetPasswordExpiryAlertFailedFromOWA=function(t){!1===f.i.isCallsBlockedException(t)&&(Object(s.e)().exception("Notifications_GetPasswordExpiryAlertFromOWA",4,t),e.retryCount<2&&(e.retryCount++,e.GetPasswordExpiryAlertFromOWA(e.actionUrl,e.isConsumerShell)))},this.OnGetPasswordExpiryAlertFailedFromWCSS=function(t,i){!1===f.i.isCallsBlockedException(t)&&(Object(s.e)().exception("Notifications_GetPasswordExpiryAlertFromWCSS",4,t),e.retryCount<2&&(e.retryCount++,e.GetPasswordExpiryAlertFromWCSS(i)))}}return e.prototype.GetPasswordExpiryAlertFromOWA=function(e,t){var i=this;this.actionUrl=e,this.isConsumerShell=t,c.b.Instance.Calendar.IsInitialized&&l.a.RetrieveSystemAlertsSessionStorage("PasswordExpiryAlert","PasswordExpiryAlertFetchTime","PasswordExpiryAlert").then((function(e){null!==e&&0!==e.length||c.b.Instance.User.getDaysUntilPasswordExpiration().then(i.OnGetPasswordExpiryAlertSucceeded).catch(i.OnGetPasswordExpiryAlertFailedFromOWA)})).catch((function(e){!1===f.i.isCallsBlockedException(e)&&Object(s.e)().exception("Notifications_GetPasswordExpiryAlertFromOWA",4,e),c.b.Instance.User.getDaysUntilPasswordExpiration().then(i.OnGetPasswordExpiryAlertSucceeded).catch(i.OnGetPasswordExpiryAlertFailedFromOWA)}))},e.prototype.GetPasswordExpiryAlertFromWCSS=function(e){var t=this;this.actionUrl=e,l.a.RetrieveSystemAlertsSessionStorage("PasswordExpiryAlert","PasswordExpiryAlertFetchTime","PasswordExpiryAlert").then((function(i){null!=i&&0!==i.length||c.b.Instance.Service.callWebClientShellServiceFunction("/api/alerts/iw/passwordexpiry","GET",null,null).then(t.OnGetPasswordExpiryAlertSucceeded).catch((function(i){return t.OnGetPasswordExpiryAlertFailedFromWCSS(i,e)}))})).catch((function(i){c.b.Instance.Service.callWebClientShellServiceFunction("/api/alerts/iw/passwordexpiry","GET",null,null).then(t.OnGetPasswordExpiryAlertSucceeded).catch((function(i){return t.OnGetPasswordExpiryAlertFailedFromWCSS(i,e)}))}))},e.prototype.CreatePasswordExpirySystemAlert=function(e){var t=null;if(0<=e&&e<100){var i="";1<e?i=Object(a.H)(u.a.PasswordExpiration_Text,e.toString()):1===e?i=Object(a.H)(u.a.PasswordExpiration_IsOne_Text,e.toString()):0===e&&(i=u.a.PasswordExpirationZero_Text);var n="",o={ActionTarget:"_self",ActionUrl:n=this.isConsumerShell?"https://account.live.com/password/Change":this.actionUrl+"/ChangePassword.aspx",ActionText:u.a.ChangePassword_Link,Title:u.a.ChangePassword_Title,Id:"PasswordExpiryAlert",Message:i};t={providerType:m.a.SystemAlert,subType:"PasswordExpiryAlert",payload:{systemAlert:o,id:o.Id},toastType:1,toastState:0,navigationUrl:n}}return t},e}(),O=function(){function e(){}return e.prototype.GetGallatinLegalAlert=function(){var e=this;l.a.GetLegalAlertLastViewedFromLocalStorage().then((function(t){null!==t?e.OnGetAlertLastViewedSucceeded(t):l.a.GetLegalAlertLastViewedFromStorage().then((function(t){e.OnGetAlertLastViewedSucceeded(t)}))}))},e.prototype.OnGetAlertLastViewedSucceeded=function(t){var i=new Date;(null==t||e.ShouldShowTheAlert(i,t))&&this.CreateLegalAlert(),l.a.SetLegalAlertLastViewedToLocalStorage(t)},e.ShouldShowTheAlert=function(e,t){var i=new Date(Date.UTC(e.getFullYear(),0,1,0,0,0,1)),n=new Date(Date.UTC(e.getFullYear(),6,1,0,0,0,1)),a=i.getTime()-e.getTime(),o=n.getTime()-e.getTime();return(o>0?a:Math.max(o,a))>t.getTime()-e.getTime()},e.prototype.CreateLegalAlert=function(){var e={Id:"GallatinLegalAlert",Title:u.a.GallatinLegalAlert_Title,Message:u.a.GallatinLegalAlert_Text,ActionText:u.a.GallatinLegalAlertAction_Text,ActionUrl:"https://www.21vbluecloud.com/office365/O365-VAT/",ActionTarget:"_blank",ActionCallback:function(){l.a.SetLegalAlertLastViewedToStorage()}},t={providerType:m.a.SystemAlert,subType:"GallatinLegalAlert",payload:{systemAlert:e,id:e.Id},toastType:1,toastState:0,navigationUrl:e.ActionUrl};Object(a.K)().dispatch(Object(b.a)(t))},e}();i.d(t,"a",(function(){return A}));var A=function(){function e(){}return e.SubscribeAllProviders=function(t){e.config=t;var i=e.config;return i.isSystemNotificationsDisabled||e.subscribeSystemNotification(),i.isConsumerShell||(y.a.myAppsUrl=i.myAppsUrl,y.a.getNewAppNotification()),new Promise((function(t,n){c.b.Instance.User.getOwaUserConfiguration().then((function(n){if(null!=n){e.owaUserConfiguration=n;var c=Object(o.f)(n,i.notificationPreferencesData);if(i.notificationPreferencesData=c,e.subscribeNewMailNotification(),e.subscribeReminderNotification(),l.a.LoadItemsFromSessionStorageToState(i),c)Object(a.K)().dispatch(Object(a.fb)(c));Object(s.e)().perfMarker("NotificationSubscriptionComplete"),t(!0)}})).catch((function(e){e&&e.message&&e.message.indexOf&&e.message.indexOf("OwaInvalidUserLanguageException")>-1?(g.CreateAlert(),t(!0)):(Object(s.e)().exception("Notifications_GetOwaUserConfiguration_Failed",6,e),n(e))}))}))},e.subscribeNewMailNotification=function(){var t=e.config,i={subscriptionId:m.a[m.a.NewMailNotification],requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:m.a[m.a.NewMailNotification]}};c.b.Instance.Notification.subscribe(i,(function(i){t.isNotificationsEnabled&&t.notificationPreferencesData&&t.notificationPreferencesData.EnableNewItemNotify&&null!==i&&I.handle(i,e.owaUserConfiguration,t.owaLaunchUrl,t.upn)}))},e.subscribeReminderNotification=function(){var t=e.config,i={subscriptionId:m.a[m.a.ReminderNotification],requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:m.a[m.a.ReminderNotification]}};c.b.Instance.Notification.subscribe(i,(function(i){t.isNotificationsEnabled&&t.notificationPreferencesData&&t.notificationPreferencesData.EnableReminders&&null!==i&&x.a.handleNotification(i,e.owaUserConfiguration)}))},e.subscribeSystemNotification=function(){var t=e.config;t.isConsumerShell||t.isOnPremShell||t.doNotFetchSystemAlertsFromPortal||(new d).GetSystemAlerts();c.b.Instance.Calendar.IsInitialized&&Object(n.c)(t.workloadID)&&new h(t.owaLaunchUrl).GetOofAlert();var i=new v;(t.isConsumerShell||t.isOnPremShell?i.GetPasswordExpiryAlertFromOWA(t.portalUrl,t.isConsumerShell):i.GetPasswordExpiryAlertFromWCSS(t.portalUrl),t.isGallatinLegalAlertEnabled)&&(new O).GetGallatinLegalAlert()},e.owaUserConfiguration=null,e}()},540:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,'.o365cs-base .bf04ae42e3404adc6a98e88ccfae3b07\\.scss{border-width:1px;border-style:solid;box-shadow:0 2px 4px -.8px rgba(0,0,0,.08);-webkit-box-shadow:0 2px 4px -.8px rgba(0,0,0,.08);margin:0 16px 10px;display:block}.o365cs-base .bf04ae42e3404adc6a98e88ccfae3b07\\.scss:hover{box-shadow:0 8px 10px -2px rgba(0,0,0,.08);-webkit-box-shadow:0 8px 10px -2px rgba(0,0,0,.08);transition:border-color .1s linear,box-shadow .1s linear}.o365cs-base ._09519765d753ebb591106cd2630eab03\\.scss{box-shadow:0 16px 18px -4px rgba(0,0,0,.08);-webkit-box-shadow:0 16px 18px -4px rgba(0,0,0,.08);transition:border-color .1s linear,box-shadow .1s linear;border-width:1px;border-style:solid}.o365cs-base ._6a5d1d8330a9a6a10a853573d0c13875\\.scss{display:block}.o365cs-base ._452f4caa2e355add4994246da83c9e58\\.scss{display:table-cell;height:auto;padding:8px 16px;line-height:16px;text-align:center;vertical-align:middle;opacity:1%;border-radius:2px;font:400 14px;border-width:1px;border-style:solid}.o365cs-base .ca1833f6786aba065fda0eca50497aa7\\.scss{font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .ebe41e9be2a4c4e75b563ec14d573c5d\\.scss{display:table-cell}.o365cs-base .ebe41e9be2a4c4e75b563ec14d573c5d\\.scss,.o365cs-base .ebe41e9be2a4c4e75b563ec14d573c5d\\.scss div,.o365cs-base .ebe41e9be2a4c4e75b563ec14d573c5d\\.scss span{font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .ebe41e9be2a4c4e75b563ec14d573c5d\\.scss div,.o365cs-base .ebe41e9be2a4c4e75b563ec14d573c5d\\.scss span{display:inline-block}.o365cs-base ._34b0d9012fa37850a48288796911e89c\\.scss{margin:0 auto 1px;display:inline-block;font-size:12px}.o365cs-base ._554c96742484b0453f8f36eec9e9252f\\.scss{min-width:0;position:absolute;right:14px;border-width:0;background-color:transparent;cursor:pointer;z-index:999;width:32px;height:32px;margin:4px 8px 0 0;box-sizing:border-box;text-align:center}.o365cs-base ._554c96742484b0453f8f36eec9e9252f\\.scss span{font-size:12px}.o365cs-base .c8a533020ca1a5ccd5e7f2d2d2856e12\\.scss{background-color:transparent;border-width:0;height:22px;display:inline-block;white-space:nowrap;min-width:0;font-size:12px;line-height:16px;padding:0 16px 0 0}.o365cs-base .c8a533020ca1a5ccd5e7f2d2d2856e12\\.scss span{cursor:pointer;font:600 12px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .dda7dc8cd5f0bdf29e430e474a1a28ff\\.scss{width:100%;text-align:right;display:block}.o365cs-base .dda7dc8cd5f0bdf29e430e474a1a28ff\\.scss button,.o365cs-base .dda7dc8cd5f0bdf29e430e474a1a28ff\\.scss div,.o365cs-base .dda7dc8cd5f0bdf29e430e474a1a28ff\\.scss span{text-align:right}.o365cs-base ._999b3a45e1422260a4583c14df215a28\\.scss{line-height:19px;padding-left:0;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._999b3a45e1422260a4583c14df215a28\\.scss div{display:inline-block}.o365cs-base .b4f07b9d79e343284e0af69c1974bede\\.scss{display:none}.o365cs-base ._33575fe82dd8644daa57aeac78d7589d\\.scss{border-top-width:1px;border-top-style:solid;padding-top:8px;margin-top:16px;display:block;width:100%}.o365cs-base ._33575fe82dd8644daa57aeac78d7589d\\.scss a{line-height:20px;padding:0 0 10px}.o365cs-base ._33575fe82dd8644daa57aeac78d7589d\\.scss button{width:72px;height:32px;border-radius:2px;border-style:solid;border-width:1px;margin-right:10px}.o365cs-base .cba11e09abd8f4e84ced1562347c4d6b\\.scss{padding-left:5px;vertical-align:middle;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}.o365cs-base ._2ea83da962c92f2ee64043b06a6c3e07\\.scss{padding-right:8px}.o365cs-base ._279e3640e6338f272f7b58ca4eb5b75d\\.scss{display:block}.o365cs-base .a8e061cd58f6996392a269ed589424c2\\.scss{clear:"both"}.o365cs-base ._01bd026ad8adfdd6b5d3206c4b313b7b\\.scss{line-height:21px;display:table-cell;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;padding:0 0 0 16px;max-height:40px}.o365cs-base ._88e0c6c5a40b525f5f91dcb153731eb2\\.scss{overflow:hidden}.o365cs-base .e6f69e03d97702dcb99b5376c26cccee\\.scss{text-decoration:none}.o365cs-base .e6f69e03d97702dcb99b5376c26cccee\\.scss:hover{text-decoration:underline}.o365cs-base ._0794be65971217ac4ba335907d181acc\\.scss{font-size:10px}.o365cs-base .e607d31f8b1739683e7efa77e9e52667\\.scss{text-align:left;overflow:hidden;box-sizing:content-box;width:100%;padding:0}.o365cs-base ._895348155fc11cd43c6edc9871e856da\\.scss{display:table;padding:0;height:auto;background-color:transparent;margin-bottom:12px;border:none}.o365cs-base ._1e3b74da2fc46d2c37ac20dc0a998584\\.scss{display:table-cell}.o365cs-base ._1ccba9dffc8ea3e29c8a421229efecfa\\.scss{margin-top:10px;box-sizing:content-box;width:100%;padding-bottom:16px}.o365cs-base ._775fe875d2803458d1f413107ac8ab9a\\.scss{display:block;height:100%;min-height:64px}.o365cs-base ._89f7107a2ffb98971e104676cfdef6e2\\.scss:hover{text-decoration:underline}.o365cs-base ._5a31b676b9d6ac85de2e55dc8b8aeb95\\.scss{padding:0 10px 0 16px;text-align:left;width:100%;height:auto;border-width:0;background:transparent}.o365cs-base ._5a31b676b9d6ac85de2e55dc8b8aeb95\\.scss span{cursor:pointer;font:400 14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .e9aa41313aa98911baa3fba12603f15c\\.scss{padding-top:10px}',""]),t.locals={notificationItem:"bf04ae42e3404adc6a98e88ccfae3b07.scss",notificationToast:"_09519765d753ebb591106cd2630eab03.scss",notificationContainer:"_6a5d1d8330a9a6a10a853573d0c13875.scss",notificationButton:"_452f4caa2e355add4994246da83c9e58.scss",notificationBodyText:"ca1833f6786aba065fda0eca50497aa7.scss",notificationLink:"ebe41e9be2a4c4e75b563ec14d573c5d.scss",icon:"_34b0d9012fa37850a48288796911e89c.scss",closeButton:"_554c96742484b0453f8f36eec9e9252f.scss",dismissAll:"c8a533020ca1a5ccd5e7f2d2d2856e12.scss",dismissContain:"dda7dc8cd5f0bdf29e430e474a1a28ff.scss",notificationTitle:"_999b3a45e1422260a4583c14df215a28.scss",hidden:"b4f07b9d79e343284e0af69c1974bede.scss",actionBar:"_33575fe82dd8644daa57aeac78d7589d.scss",actionArrow:"cba11e09abd8f4e84ced1562347c4d6b.scss",paddingRight:"_2ea83da962c92f2ee64043b06a6c3e07.scss",displayBlock:"_279e3640e6338f272f7b58ca4eb5b75d.scss",clearStyle:"a8e061cd58f6996392a269ed589424c2.scss",headerText:"_01bd026ad8adfdd6b5d3206c4b313b7b.scss",overflowHidden:"_88e0c6c5a40b525f5f91dcb153731eb2.scss",itemLink:"e6f69e03d97702dcb99b5376c26cccee.scss",headingBar:"_0794be65971217ac4ba335907d181acc.scss",toastControl:"e607d31f8b1739683e7efa77e9e52667.scss",header:"_895348155fc11cd43c6edc9871e856da.scss",label:"_1e3b74da2fc46d2c37ac20dc0a998584.scss",content:"_1ccba9dffc8ea3e29c8a421229efecfa.scss",itemContent:"_775fe875d2803458d1f413107ac8ab9a.scss",showMoreLink:"_89f7107a2ffb98971e104676cfdef6e2.scss",footer:"_5a31b676b9d6ac85de2e55dc8b8aeb95.scss",paddingTop:"e9aa41313aa98911baa3fba12603f15c.scss"}},541:function(e,t,i){var n=i(542);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},542:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,'.o365cs-base ._595bc62902e1364773ca90f4c053dbf4\\.scss{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.o365cs-base ._3e52aec0f6a61ed65bfa69bf23c59301\\.scss{padding-left:10px;max-width:198px;width:198px;font-size:14px}.o365cs-base .e56809753f5c1a5795c5bf3420f04a8e\\.scss{line-height:16px;max-width:180px;width:180px;font-size:14px;padding-top:2px;display:table-cell;vertical-align:bottom}.o365cs-base ._12c11950d3df9a4b5028cb62f29188da\\.scss{font-size:14px;padding:0 8px 0 10px;display:table-cell;line-height:12px;vertical-align:bottom}.o365cs-base ._3944766bb4a6690ea0596674b035f275\\.scss{line-height:18px;padding:4px 0 0;width:250px;font-size:14px}.o365cs-base .a02a6364b2f6f7fa4d1094a615e18cab\\.scss{text-align:left;overflow:hidden;padding:14px;margin:0;cursor:pointer;display:block;height:auto;box-sizing:border-box}.o365cs-base ._83fb95f6494dedc55dc342ed578d583a\\.scss{display:table-cell;vertical-align:middle}.o365cs-base .b61dfd0ac1224b061f64e5bbf7ec7ab6\\.scss{width:auto;font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._64081b6b370f0dbe9adfb878cd8b88d4\\.scss{margin-top:5px;top:auto}.o365cs-base .e794578f34d2f974fce23570d86b5fd3\\.scss{margin-top:20px}.o365cs-base .c9d40f93329be7c12e74691c4730bf3e\\.scss a{min-height:64px;position:relative;text-decoration:none}.o365cs-base ._837bd17668c41f9d5d74fcbc3fe92694\\.scss{font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;height:19px;padding:6px 0;min-height:34px}.o365cs-base ._837bd17668c41f9d5d74fcbc3fe92694\\.scss div,.o365cs-base ._837bd17668c41f9d5d74fcbc3fe92694\\.scss span{display:table-cell;vertical-align:top}.o365cs-base ._201067303b5c509ee5bf6217a31bd6c3\\.scss{font-size:24px;padding:0 16px 0 6px;margin-top:-2px}.o365cs-base ._406c465851534fa0f6e01a093be10364\\.scss{width:155px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;padding-top:0;margin-top:-2px}',""]),t.locals={mailText:"_595bc62902e1364773ca90f4c053dbf4.scss",sender:"_3e52aec0f6a61ed65bfa69bf23c59301.scss",mailSubject:"e56809753f5c1a5795c5bf3420f04a8e.scss",mailIcon:"_12c11950d3df9a4b5028cb62f29188da.scss",bodyPreviewText:"_3944766bb4a6690ea0596674b035f275.scss",newMailPopupButton:"a02a6364b2f6f7fa4d1094a615e18cab.scss",newMailPopupButtonCell:"_83fb95f6494dedc55dc342ed578d583a.scss",itemContent:"b61dfd0ac1224b061f64e5bbf7ec7ab6.scss",newMailPersonaImage:"_64081b6b370f0dbe9adfb878cd8b88d4.scss",newFlexPaneNewMailNotification:"e794578f34d2f974fce23570d86b5fd3.scss",newMailLink:"c9d40f93329be7c12e74691c4730bf3e.scss",condensed:"_837bd17668c41f9d5d74fcbc3fe92694.scss",condensedIcon:"_201067303b5c509ee5bf6217a31bd6c3.scss",condensedMailText:"_406c465851534fa0f6e01a093be10364.scss"}},543:function(e,t,i){var n=i(544);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},544:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,'.o365cs-base .b76edb032ee40ca812efe8978653a6b4\\.scss{border-left:0;border-right:0;max-height:none;height:auto!important;display:block;text-align:left;min-height:auto;padding:12px 14px 0;cursor:pointer;text-decoration:none!important;white-space:normal;font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._4ce9e860162809e60a9b18e86e88dfef\\.scss{margin:6px 18px 0 6px;font-size:24px}.o365cs-base ._1512462f849605b0afca837097e0d921\\.scss{margin:3px 8px 0 0;font-size:14px}.o365cs-base ._07b303c99b1ee4806e5cf23105916751\\.scss{display:block;font-size:14px}.o365cs-base ._10a6cf940f16b41ab31d4843e800d25d\\.scss{padding-right:0;padding-top:2px;display:block;box-sizing:content-box;white-space:normal}.o365cs-base ._10a6cf940f16b41ab31d4843e800d25d\\.scss span{font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .f96a20609564646c613fafe1ef70e919\\.scss{box-sizing:content-box;white-space:normal;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .ffd47143a965a6317edbf4246c2bfcce\\.scss{padding-right:5px;padding-bottom:24px;font-size:11px;box-sizing:content-box;white-space:normal}.o365cs-base ._01009301acfc0b408bf98a9796169d58\\.scss{margin-top:-9px}',""]),t.locals={container:"b76edb032ee40ca812efe8978653a6b4.scss",alertIcon:"_4ce9e860162809e60a9b18e86e88dfef.scss",alertPaneIcon:"_1512462f849605b0afca837097e0d921.scss",text:"_07b303c99b1ee4806e5cf23105916751.scss",message:"_10a6cf940f16b41ab31d4843e800d25d.scss",title:"f96a20609564646c613fafe1ef70e919.scss",actionText:"ffd47143a965a6317edbf4246c2bfcce.scss",systemClose:"_01009301acfc0b408bf98a9796169d58.scss"}},545:function(e,t,i){var n=i(546);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},546:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,'.o365cs-base ._7238bf84ab91281b4028978804ddf4ca\\.scss{position:relative;height:auto;padding:12px 14px;-webkit-user-select:none;-moz-user-select:none;user-select:none;cursor:pointer;font:12px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;touch-action:pan-x pan-y pinch-zoom manipulation;-ms-touch-action:pan-x pan-y pinch-zoom manipulation}.o365cs-base ._7238bf84ab91281b4028978804ddf4ca\\.scss:first-child{border-top:none}.o365cs-base ._6dcb999cdf903feffce10727cbe4947d\\.scss{width:245px}.o365cs-base ._1b7c1f33820e8435193200af8cb627cc\\.scss{width:140px}.o365cs-base ._95e5dcf7339ea54f72b272f39ce2361e\\.scss,.o365cs-base ._1b7c1f33820e8435193200af8cb627cc\\.scss{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:inline-block;height:19px;text-align:left}.o365cs-base ._95e5dcf7339ea54f72b272f39ce2361e\\.scss{width:125px}.o365cs-base ._95e5dcf7339ea54f72b272f39ce2361e\\.scss span{line-height:19px;height:19px}.o365cs-base ._9e40c0c83098921933ee74d5eb0125f8\\.scss{text-align:right;display:block;width:100%}.o365cs-base ._0718c657aa0e9b61bdd49db634dcc6e1\\.scss{display:inline-block;padding-right:1px}.o365cs-base ._588cd9eba80f433e51a6e5a239c78de8\\.scss{display:inline-block;line-height:19px;padding:0 3px}.o365cs-base ._55e39f813e40bb672a58ce48d2734c0e\\.scss{height:50%;width:100%;display:block}.o365cs-base ._697b5730bda265e7100cea6c51db74bb\\.scss{max-width:210px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}.o365cs-base ._697b5730bda265e7100cea6c51db74bb\\.scss div{font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;height:19px}.o365cs-base ._77b406ac8a4919e447033f21d4cbbdb6\\.scss{margin:1px 8px 0 0}.o365cs-base .ec0f97613573c8ba1d8537701c9975f7\\.scss{min-width:0;position:absolute;right:36px;border-width:0;margin-top:-8px;padding-top:8px;background-color:transparent;cursor:pointer;z-index:999;width:32px;height:32px;line-height:12px;box-sizing:border-box}.o365cs-base .ec0f97613573c8ba1d8537701c9975f7\\.scss span{font-size:14px}.o365cs-base .ec0f97613573c8ba1d8537701c9975f7\\.scss:hover{text-decoration:none}.o365cs-base .ae1a0d18e456fbaa3e5e15b00bfa2952\\.scss{margin:-8px 0 0;right:4px;padding-top:10px}',""]),t.locals={remindersContainer:"_7238bf84ab91281b4028978804ddf4ca.scss",remindersLeftColumn:"_6dcb999cdf903feffce10727cbe4947d.scss",remindersTitle:"_1b7c1f33820e8435193200af8cb627cc.scss",remindersRemain:"_95e5dcf7339ea54f72b272f39ce2361e.scss",remindersRightColumn:"_9e40c0c83098921933ee74d5eb0125f8.scss",toastRemindersTimeToStartValue:"_0718c657aa0e9b61bdd49db634dcc6e1.scss",remindersTimeToStartUnit:"_588cd9eba80f433e51a6e5a239c78de8.scss",remindersRow:"_55e39f813e40bb672a58ce48d2734c0e.scss",remindersDescription:"_697b5730bda265e7100cea6c51db74bb.scss",reminderIcon:"_77b406ac8a4919e447033f21d4cbbdb6.scss",alarmButton:"ec0f97613573c8ba1d8537701c9975f7.scss",reminderCloseButton:"ae1a0d18e456fbaa3e5e15b00bfa2952.scss"}},547:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,".o365cs-base ._372fa777ebbe00409c4383f6d558b5c4\\.scss a:active,.o365cs-base ._372fa777ebbe00409c4383f6d558b5c4\\.scss a:hover,.o365cs-base ._372fa777ebbe00409c4383f6d558b5c4\\.scss a:link,.o365cs-base ._372fa777ebbe00409c4383f6d558b5c4\\.scss a:visited{text-decoration:none}.o365cs-base ._372fa777ebbe00409c4383f6d558b5c4\\.scss .systemNotification *{white-space:normal}.o365cs-base .fe8dab0d294014d32786fd6a821c8251\\.scss{overflow:hidden;margin-bottom:10px;line-height:normal}.o365cs-base .e689a51b91eff4678c11735f13f1bf39\\.scss{display:table;height:40px;box-sizing:content-box;margin:0;border-bottom-width:1px;border-bottom-style:solid}.o365cs-base .ab135c3cb061a3dc31ce4e8fcfdc2784\\.scss{display:inline-block;width:20px}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss{-ms-flex:1;flex:1;overflow-x:hidden;overflow-y:auto;-webkit-overflow-scrolling:touch;min-width:125px;max-height:230px}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar{width:6px}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-button,.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-corner,.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-track{background-color:transparent}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-button{background-repeat:no-repeat;cursor:pointer}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-button:vertical{background-position:50%;width:18px;height:18px}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-button:vertical:increment{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAUUlEQVQ4T6XLMQ6AMAwEwfz/bXRIfOeQCxckK8iKYgqvfCPJLxgNjAZGA6OB0VjCcV55M/8/jkbDMv+VJbSdccHYvsYFo4HRwGhgNDAaGPdl3LNlBnofQ4+bAAAAAElFTkSuQmCC)}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-button:vertical:increment:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAUklEQVQ4T6XLsQ2AMAwF0ey/A1swAnt95MIFyQlyoniFT/4jyS8YDYwGRgOjgdFYwnFeeTP/P45GwzL/lSW0nXHB2L7GBaOB0cBoYDQwGhj3Zdx8sf7rjOGQqwAAAABJRU5ErkJggg==)}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-button:vertical:decrement{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAVUlEQVQ4T6XMMQoAIQxEUe9/NrsFrzOSIqDxgzu7xSv8ZGySfsHowOjA6MDowOjAmPozFGpfYQw5vn2CsY5TvQtHoOGq3m+PLzA6MDowOjA6ML6nNgFW+wZ6kTk6FAAAAABJRU5ErkJggg==)}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-button:vertical:decrement:hover{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAAAVklEQVQ4T6XMwQ3AIAwEQfrvgS5SAn0d8sMSmJXIJY95sPLRJP2C0YHRgdGB0YHRgTH1ZyjUvsIYcnz7BGMdp3oXjkDDVb3fHl9gdGB0YHRgdGB8T20CB+X+675uLU0AAAAASUVORK5CYII=)}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-thumb{border-radius:9px;border:none;background-color:#ccd3d6}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-thumb:vertical{min-height:50px}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss::-webkit-scrollbar-thumb:hover{background-color:#9db4c4}.o365cs-base ._381608142081e1db835b890eab695ffd\\.scss:not(:-webkit-any-link){box-sizing:border-box}.o365cs-base .d1af7b3373c7dbc2437113962fb85581\\.scss{padding-top:5px;padding-left:10px;text-align:left;height:25px;width:100%}.o365cs-base .bad13b62658cc55a769a3afe2d5ff101\\.scss{margin-top:10px}.o365cs-base .d276fa135ea92bf021dd2940c37f2860\\.scss{display:table-cell}.o365cs-base ._2e6c7c91847ac9ae45f24047e96402e5\\.scss{border-bottom-width:1px;border-bottom-style:solid}.o365cs-base ._7a5c3f150b1a4da149d41bc6d8e2cc00\\.scss{position:relative;right:5px;margin:0;padding-top:5px}",""]),t.locals={o365cs:"_372fa777ebbe00409c4383f6d558b5c4.scss",toastSlot:"fe8dab0d294014d32786fd6a821c8251.scss",header:"e689a51b91eff4678c11735f13f1bf39.scss",chevronDiv:"ab135c3cb061a3dc31ce4e8fcfdc2784.scss",toastScrollRegion:"_381608142081e1db835b890eab695ffd.scss",footer:"d1af7b3373c7dbc2437113962fb85581.scss",notificationsContent:"bad13b62658cc55a769a3afe2d5ff101.scss",label:"d276fa135ea92bf021dd2940c37f2860.scss",reminderBox:"_2e6c7c91847ac9ae45f24047e96402e5.scss",headerCloseButton:"_7a5c3f150b1a4da149d41bc6d8e2cc00.scss"}},548:function(e,t,i){var n=i(549);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},549:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,'._6a141462984481497717cdaa14a8b02f\\.scss{width:170px;height:335px;display:block;position:fixed;overflow:hidden;box-sizing:border-box;z-index:1000101}.o365cs-base .af8022af68826c6a2c40b8592975327e\\.scss{width:190px;padding:7px 0 0 18px;line-height:0;height:35px;font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-weight:400;position:relative}',""]),t.locals={dropDrown:"_6a141462984481497717cdaa14a8b02f.scss",snoozeContextMenuItem:"af8022af68826c6a2c40b8592975327e.scss"}},550:function(e,t,i){var n=i(551);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},551:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,'.o365cs-base .c91fa4bfaae87b1441f09ccdc0665152\\.scss{font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;min-height:34px}.o365cs-base .c91fa4bfaae87b1441f09ccdc0665152\\.scss div,.o365cs-base .c91fa4bfaae87b1441f09ccdc0665152\\.scss span{display:table-cell}.o365cs-base .fb2b1b3ee3450aa3e521f6bd2aabfe00\\.scss{font-size:24px;padding:6px 16px 0 6px}.o365cs-base .ec12c980061e1164a506cd44ba3a31bd\\.scss{width:180px;text-overflow:ellipsis;overflow:hidden;vertical-align:middle}.o365cs-base ._2fdb6ffcac1d3d3d08f254aa04ea9c4c\\.scss{text-align:left;overflow:hidden;padding:14px;margin:0;cursor:pointer;display:block;height:auto;box-sizing:border-box}.o365cs-base .a1b8b618033b7517d930616f0acb83bb\\.scss{width:auto;font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base ._5d94e6a3bcc71b96855e3f135ebe1f58\\.scss{margin-top:5px;top:auto}.o365cs-base .e803c7cf4539fa1e6caabe26ea0438e8\\.scss{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block}.o365cs-base ._67c4c07865f3354b6320c5180ae84f29\\.scss{padding-left:10px;max-width:198px;width:198px;font-size:14px}.o365cs-base .f2803449cdc5ff3eb481f6bfe98dfcc7\\.scss{font-size:14px;padding:0 8px 0 10px;display:table-cell;line-height:15px;vertical-align:bottom}.o365cs-base .c86d298663226113dafa11ee682b38f8\\.scss{max-width:180px;width:180px;font-size:14px;padding-top:2px;display:table-cell;vertical-align:bottom}',""]),t.locals={condensed:"c91fa4bfaae87b1441f09ccdc0665152.scss",condensedIcon:"fb2b1b3ee3450aa3e521f6bd2aabfe00.scss",condensedText:"ec12c980061e1164a506cd44ba3a31bd.scss",toastContent:"_2fdb6ffcac1d3d3d08f254aa04ea9c4c.scss",chatContent:"a1b8b618033b7517d930616f0acb83bb.scss",PersonaImage:"_5d94e6a3bcc71b96855e3f135ebe1f58.scss",chatText:"e803c7cf4539fa1e6caabe26ea0438e8.scss",chatTitle:"_67c4c07865f3354b6320c5180ae84f29.scss",chatIcon:"f2803449cdc5ff3eb481f6bfe98dfcc7.scss",chatPreview:"c86d298663226113dafa11ee682b38f8.scss"}},552:function(e,t,i){var n=i(553);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},553:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,".de24987f5907a43a0f3be9f5b623af10\\.scss{position:absolute;z-index:1000000;background-color:#fff;width:320px;box-sizing:border-box;outline:none;overflow-y:auto;visibility:visible;pointer-events:auto;background:transparent;min-width:320px;max-width:320px;width:324px;height:auto;outline:0;display:block;overflow-y:hidden;z-index:1000100;box-shadow:none}.de24987f5907a43a0f3be9f5b623af10\\.scss:focus{box-shadow:none!important}.o365cs-base .ec20123f5767325389db40efc4d61a8e\\.scss{margin:12px 16px 16px}.o365cs-base .fc69b12b23a10ab0a0de64951bef5197\\.scss{min-height:800px}",""]),t.locals={popupControl:"de24987f5907a43a0f3be9f5b623af10.scss",toastContainer:"ec20123f5767325389db40efc4d61a8e.scss",toastContainerHeight:"fc69b12b23a10ab0a0de64951bef5197.scss"}},554:function(e,t,i){var n=i(555);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},555:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,".o365cs-base ._561b0fc31f393a8e1c10f40f6e3b08a1\\.scss{text-overflow:ellipsis;white-space:nowrap;overflow:hidden;display:block;max-width:260px;line-height:19px;padding-top:2px}.o365cs-base .b257ad41543081cbe1d0dbaf86d8e2a4\\.scss{text-align:left;overflow:hidden;padding:12px 14px 0;cursor:pointer;display:block;min-height:96px;height:100%}.o365cs-base ._4240301f432e70ddfac2ec9b90f12c7c\\.scss{vertical-align:middle;font-size:14px}",""]),t.locals={notificationText:"_561b0fc31f393a8e1c10f40f6e3b08a1.scss",newAppPopupButton:"b257ad41543081cbe1d0dbaf86d8e2a4.scss",newAppPopupButtonCell:"_4240301f432e70ddfac2ec9b90f12c7c.scss"}},556:function(e,t,i){var n=i(557);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},557:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,'.o365cs-base .fcf455aad462c3f680e9c173563cd5c8\\.scss{display:flex;flex-direction:column;height:100%}.o365cs-base .a386d3a00122ed78e2c58ba1a785a6b0\\.scss{margin-left:-16px;margin-right:-16px;text-overflow:ellipsis}.o365cs-base .a386d3a00122ed78e2c58ba1a785a6b0\\.scss a,.o365cs-base .a386d3a00122ed78e2c58ba1a785a6b0\\.scss button{font:600 12px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .abd139ab7747df715bbd224bc9fe7f19\\.scss{flex:1;position:relative;display:inline-block;margin-left:16px;margin-bottom:12px}.o365cs-base .cc3432c4c67522cc95b7443b6d5b77fa\\.scss{font:600 12px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;position:absolute;bottom:0;cursor:pointer}.o365cs-base .cc3432c4c67522cc95b7443b6d5b77fa\\.scss:hover{text-decoration:underline}.o365cs-base .f21834d060a31bf3cd28393afee42f8b\\.scss{margin:0 16px}.o365cs-base ._656f37654481d55ac1fe1456975c256a\\.scss{font-size:medium;margin-top:36px}.o365cs-base ._72e37fdda7ba537e145675e1baf129b3\\.scss{text-overflow:ellipsis;border-width:0;margin:18px 0}.o365cs-base .f70835739e2f8703fb163f491be4cde3\\.scss{width:auto;line-height:21px;font:600 14px SegoeUI-SemiBold-final,Segoe UI Semibold,SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:14px;white-space:normal;padding-bottom:8pt;padding-left:16px}.o365cs-base ._66790d8e1d6b500d259c7c4c0edadee5\\.scss{font:600 16px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;margin-left:16px}.o365cs-base ._5bb15f24ee39619fc0d37b99d5561c74\\.scss{padding-left:2px}.o365cs-base .c3423b9265c11f9c3cc23b6c9beeebcb\\.scss{text-align:center;display:block;padding-top:16px;font:14px SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif}.o365cs-base .c3423b9265c11f9c3cc23b6c9beeebcb\\.scss span{padding-bottom:6px;display:block}.o365cs-base ._9dcc8790b075dabcc295d99609f0bd4a\\.scss{display:inline-block;margin-bottom:30px;width:85px;height:85px;background:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iODAiIGhlaWdodD0iODAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPjxkZWZzPjxjaXJjbGUgaWQ9ImEiIGN4PSI0NC41NTciIGN5PSI0NC41NTciIHI9IjMuMDM4Ii8+PC9kZWZzPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKC01LjA2MyAtNS4wNjMpIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDc2IDcuMDg5KSI+PHBhdGggZD0iTTM5Ljk5MSAwQzE5LjA0NCAwIDIuMDI1IDE3LjAyIDIuMDI1IDM3Ljk3YzAgMjAuOTQyIDE3LjAyIDM3Ljk4IDM3Ljk2NiAzNy45OCAyMC45NDggMCAzNy45ODQtMTcuMDM4IDM3Ljk4NC0zNy45OEM3Ny45NzUgMTcuMDIgNjAuOTM5IDAgMzkuOTkgMG0wIDY1LjIxOWMtMTcuMDE5IDAtMzAuODI0LTEzLjc5LTMwLjgyNC0zMC44MjFDOS4xNjcgMTcuMzYgMjIuOTcyIDMuNTcgMzkuOTkxIDMuNTdjMTcuMDM3IDAgMzAuODI1IDEzLjc5IDMwLjgyNSAzMC44MjcgMCAxNy4wMzItMTMuNzg4IDMwLjgyLTMwLjgyNSAzMC44MiIgZmlsbD0iI0E2QTZBNiIvPjxjaXJjbGUgZmlsbD0iI0ZGRiIgY3g9IjM3LjQ2OCIgY3k9IjM2LjQ1NiIgcj0iMzMuNDE4Ii8+PGNpcmNsZSBmaWxsPSIjRkZGIiBjeD0iMzMuNDE4IiBjeT0iMzYuNDU2IiByPSIzMy40MTgiLz48cGF0aCBkPSJNMTUuMTkgMTMuNzA2YzUuODA3LTUuMzU2IDEzLjY1OC04LjY0MyAyMi4zLTguNjQzIDE3Ljg4NSAwIDMyLjM4MyAxNC4wNzYgMzIuMzgzIDMxLjQ0IDAgOC42ODItMy42MjQgMTYuNTQyLTkuNDg0IDIyLjIzMSIgZmlsbD0iI0Y4RjhGOCIvPjwvZz48cmVjdCBzdHJva2U9IiM5Nzk3OTciIHRyYW5zZm9ybT0icm90YXRlKC0yMSA0MC44NzMgMzQuMTM1KSIgeD0iNDAuMzY3IiB5PSIyMy40NTEiIHdpZHRoPSIxIiBoZWlnaHQ9IjIxLjM2NyIgcng9Ii41Ii8+PHJlY3Qgc3Ryb2tlPSIjOTc5Nzk3IiB0cmFuc2Zvcm09InJvdGF0ZSg5MCA1Mi40NjYgNDQuMTA2KSIgeD0iNTEuOTU5IiB5PSIzNS45NTQiIHdpZHRoPSIxIiBoZWlnaHQ9IjE2LjMwNCIgcng9Ii41Ii8+PGcgc3Ryb2tlPSIjOTc5Nzk3Ij48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMi4xNTIgMTIuMTUyKSI+PHJlY3QgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgNjMuNzk3IDApIiB4PSIzMS44OTIiIHk9Ii41IiB3aWR0aD0iMSIgaGVpZ2h0PSI2LjA4OSIgcng9Ii41Ii8+PHJlY3QgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgNjMuNzk3IDApIiB4PSIzMS44OTIiIHk9IjU3LjIwOSIgd2lkdGg9IjEiIGhlaWdodD0iNi4wODkiIHJ4PSIuNSIvPjxnIHRyYW5zZm9ybT0icm90YXRlKDkwIDE2LjIwMyA0Ny41OTUpIj48cmVjdCB0cmFuc2Zvcm09Im1hdHJpeCgtMSAwIDAgMSAxLjAxMyAwKSIgeD0iLjUiIHk9Ii41IiB3aWR0aD0iMSIgaGVpZ2h0PSI2LjA4OSIgcng9Ii41Ii8+PHJlY3QgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgMS4wMTMgMCkiIHg9Ii41IiB5PSI1Ny4yMDkiIHdpZHRoPSIxIiBoZWlnaHQ9IjYuMDg5IiByeD0iLjUiLz48L2c+PC9nPjxnIHRyYW5zZm9ybT0icm90YXRlKC0zMCA2MC42NSAxNS4yOTkpIj48cmVjdCB0cmFuc2Zvcm09Im1hdHJpeCgtMSAwIDAgMSA2My43OTcgMCkiIHg9IjMxLjg5MiIgeT0iLjUiIHdpZHRoPSIxIiBoZWlnaHQ9IjYuMDg5IiByeD0iLjUiLz48cmVjdCB0cmFuc2Zvcm09Im1hdHJpeCgtMSAwIDAgMSA2My43OTcgMCkiIHg9IjMxLjg5MiIgeT0iNTcuMjA5IiB3aWR0aD0iMSIgaGVpZ2h0PSI2LjA4OSIgcng9Ii41Ii8+PGcgdHJhbnNmb3JtPSJyb3RhdGUoOTAgMTYuMjAzIDQ3LjU5NSkiPjxyZWN0IHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDEuMDEzIDApIiB4PSIuNSIgeT0iLjUiIHdpZHRoPSIxIiBoZWlnaHQ9IjYuMDg5IiByeD0iLjUiLz48cmVjdCB0cmFuc2Zvcm09Im1hdHJpeCgtMSAwIDAgMSAxLjAxMyAwKSIgeD0iLjUiIHk9IjU3LjIwOSIgd2lkdGg9IjEiIGhlaWdodD0iNi4wODkiIHJ4PSIuNSIvPjwvZz48L2c+PGcgdHJhbnNmb3JtPSJyb3RhdGUoLTYwIDQ4LjQ5OSAyNy40NSkiPjxyZWN0IHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDYzLjc5NyAwKSIgeD0iMzEuODkyIiB5PSIuNSIgd2lkdGg9IjEiIGhlaWdodD0iNi4wODkiIHJ4PSIuNSIvPjxyZWN0IHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDYzLjc5NyAwKSIgeD0iMzEuODkyIiB5PSI1Ny4yMDkiIHdpZHRoPSIxIiBoZWlnaHQ9IjYuMDg5IiByeD0iLjUiLz48ZyB0cmFuc2Zvcm09InJvdGF0ZSg5MCAxNi4yMDMgNDcuNTk1KSI+PHJlY3QgdHJhbnNmb3JtPSJtYXRyaXgoLTEgMCAwIDEgMS4wMTMgMCkiIHg9Ii41IiB5PSIuNSIgd2lkdGg9IjEiIGhlaWdodD0iNi4wODkiIHJ4PSIuNSIvPjxyZWN0IHRyYW5zZm9ybT0ibWF0cml4KC0xIDAgMCAxIDEuMDEzIDApIiB4PSIuNSIgeT0iNTcuMjA5IiB3aWR0aD0iMSIgaGVpZ2h0PSI2LjA4OSIgcng9Ii41Ii8+PC9nPjwvZz48L2c+PHBhdGggZD0iTTQ0LjA0MiA2LjA3NmMtMjAuOTQ3IDAtMzcuOTY2IDE3LjAzNC0zNy45NjYgMzcuOTc4IDAgMjAuOTM4IDE3LjAxOSAzNy45NzEgMzcuOTY2IDM3Ljk3MSAyMC45NDcgMCAzNy45ODMtMTcuMDMzIDM3Ljk4My0zNy45NzEgMC0yMC45NDQtMTcuMDM2LTM3Ljk3OC0zNy45ODMtMzcuOTc4bTAgNjguNzkyYy0xNy4wMiAwLTMwLjgyNC0xMy43ODYtMzAuODI0LTMwLjgxNCAwLTE3LjAzNCAxMy44MDUtMzAuODIgMzAuODI0LTMwLjgyIDE3LjAzNyAwIDMwLjgyNCAxMy43ODYgMzAuODI0IDMwLjgyIDAgMTcuMDI4LTEzLjc4NyAzMC44MTQtMzAuODI0IDMwLjgxNCIgZmlsbD0iI0M4QzhDOCIvPjx1c2UgZmlsbD0iI0E2QTZBNiIgeGxpbms6aHJlZj0iI2EiLz48Y2lyY2xlIHN0cm9rZT0iI0E2QTZBNiIgY3g9IjQ0LjU1NyIgY3k9IjQ0LjU1NyIgcj0iMi41MzgiLz48cmVjdCBzdHJva2U9IiM3RjdGN0YiIHRyYW5zZm9ybT0icm90YXRlKC0xMzEgMzUuOTUgNTEuNjQ2KSIgeD0iMzUuOTQzIiB5PSIzNS45NDMiIHdpZHRoPSIxIiBoZWlnaHQ9IjMxLjQwNSIgcng9Ii41Ii8+PC9nPjwvc3ZnPg==");background-repeat:no-repeat;background-size:cover}',""]),t.locals={mainContainer:"fcf455aad462c3f680e9c173563cd5c8.scss",container:"a386d3a00122ed78e2c58ba1a785a6b0.scss",customizeLinkContainer:"abd139ab7747df715bbd224bc9fe7f19.scss",customizeSettingsLink:"cc3432c4c67522cc95b7443b6d5b77fa.scss",settingsContainer:"f21834d060a31bf3cd28393afee42f8b.scss",notificationTitle:"_656f37654481d55ac1fe1456975c256a.scss",section:"_72e37fdda7ba537e145675e1baf129b3.scss",notificationsMessage:"f70835739e2f8703fb163f491be4cde3.scss",notificationsDisabled:"_66790d8e1d6b500d259c7c4c0edadee5.scss",countLabel:"_5bb15f24ee39619fc0d37b99d5561c74.scss",emptyState:"c3423b9265c11f9c3cc23b6c9beeebcb.scss",imgEmptyState:"_9dcc8790b075dabcc295d99609f0bd4a.scss"}},558:function(e,t,i){var n=i(559);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},559:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,'.o365cs-base ._1bf589311473fc2b638a6d17c012078e\\.scss{display:inline-block;font-size:19px;vertical-align:middle}.o365cs-base .c3a5dc66640e6159533b5dfb06bbece8\\.scss{color:inherit}.o365cs-base .dce339cf0c71954f6e25290e7670487e\\.scss{position:absolute;bottom:43px;left:22px}.o365cs-base ._3fa0742d64ca104f2b3781ef1f7d6797\\.scss{font-family:SegoeUI-Regular-final,Segoe UI,"Segoe UI Web (West European)",Segoe,-apple-system,BlinkMacSystemFont,Roboto,Helvetica Neue,Tahoma,Helvetica,Arial,sans-serif;font-size:10px;position:absolute;width:18px;height:18px;line-height:16px!important;border-radius:.8em;box-sizing:border-box}.o365cs-base .fadafc56d94bb348872b5c4d6b31889b\\.scss{border:1px solid}.o365cs-base ._31af759099b192c0632149747fceb0f9\\.scss{width:26px!important}',""]),t.locals={icon:"_1bf589311473fc2b638a6d17c012078e.scss",button:"c3a5dc66640e6159533b5dfb06bbece8.scss",unseenitems:"dce339cf0c71954f6e25290e7670487e.scss",unseenCount:"_3fa0742d64ca104f2b3781ef1f7d6797.scss",unseenCountBorder:"fadafc56d94bb348872b5c4d6b31889b.scss",unseenCountOval:"_31af759099b192c0632149747fceb0f9.scss"}},582:function(e,t,i){var n=i(583);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},583:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,"._38ba8319d12725aeffa64c029daf3891\\.scss{bottom:0;right:0;padding-right:20px;position:absolute;display:flex;z-index:1000001;align-items:flex-end;max-width:calc(100% - 320px);-webkit-box-align:end}._38ba8319d12725aeffa64c029daf3891\\.scss .conversation{display:initial}._38ba8319d12725aeffa64c029daf3891\\.scss iframe{margin-right:10px}",""]),t.locals={wrapperStyle:"_38ba8319d12725aeffa64c029daf3891.scss"}},584:function(e,t,i){var n=i(585);"string"==typeof n&&(n=[[e.i,n,""]]);i(24)(n,{});n.locals&&(e.exports=n.locals)},585:function(e,t,i){(t=e.exports=i(23)(!1)).push([e.i,"._9e5b2da123280b4a26d99979b1ce8cfd\\.scss{position:absolute;z-index:1000000;background-color:#fff;width:320px;box-sizing:border-box;outline:none;overflow-y:auto;visibility:visible;pointer-events:auto;box-shadow:0 2px 4px 0 rgba(0,0,0,.22);overflow-y:hidden;min-width:320px;max-width:320px;top:50px;height:450px;outline:0;display:block;visibility:hidden;z-index:1000001;-webkit-transform-origin:top;-ms-transform-origin:top;transform-origin:top;-webkit-animation-duration:.18s;animation-duration:.18s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-timing-function:ease;animation-timing-function:ease}.aaacde578e2058eced752eeac7d55a81\\.scss{-webkit-animation-name:slideInFrames;animation-name:slideInFrames;visibility:visible}@-webkit-keyframes slideInFrames{0%{opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}@keyframes slideInFrames{0%{opacity:0;-webkit-transform:scale(.95);-ms-transform:scale(.95);transform:scale(.95)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}._71fe43662af8ce4cdb09e74df1489a96\\.scss{box-shadow:0 2px 4px 0 rgba(0,0,0,.22);overflow-y:hidden}._73f9278ceacbea1584755f411d9a621a\\.scss{height:450px;width:320px}",""]),t.locals={chatWindowWidth:"320",chatPopup:"_9e5b2da123280b4a26d99979b1ce8cfd.scss",popupSlideIn:"aaacde578e2058eced752eeac7d55a81.scss",callout:"_71fe43662af8ce4cdb09e74df1489a96.scss",recentsWrapper:"_73f9278ceacbea1584755f411d9a621a.scss"}},662:function(e,t,i){"use strict";i.r(t);var n=i(10),a=i(3),o=i(33),s=i(292),c=i(0),r=i(2),l=i(135),d=i(1),f=i(17),p=i(182),u=i(192),b=i(9),m=i(51),h=i(582);var g,S,I,y,x,v=function(){var e=Object(b.b)(Object(a.x)(m.a.ChatWrapper,h.wrapperStyle),"chat_wrapper_pane");return document.body.appendChild(e),e},O=i(13),A=i(5),N=i(71),C=i(584),T=function(e){function t(t){var i=e.call(this,t)||this;return i.populateRecentsContent=function(e){e&&(i.props.isChatRecentsPaneInitialized?Object(N.g)(e,i.props.isTeamsChatActivated):i.initializeRecents(e))},i.initializeRecents=function(e){i.props.isChatAPIInitialized?Object(N.a)(e,i.props.onRecentsReady,i.props.isTeamsChatActivated):window.addEventListener(m.b.ChatAPIReady,(function(){i.onChatAPIReady(e)}))},i.onChatAPIReady=function(e){window.removeEventListener(m.b.ChatAPIReady,(function(){i.onChatAPIReady(e)})),Object(N.a)(e,i.props.onRecentsReady,i.props.isTeamsChatActivated)},i.onAnimationEnd=function(){i.chatPopUp&&i.chatPopUp.focus()},i.handleKeydown=function(e){switch(e.keyCode){case 27:e.stopPropagation(),e.preventDefault(),i.props.onDismiss(e),i.chatHeaderButton.focus()}},i.state={popupPosition:null},i}return Object(c.__extends)(t,e),t.prototype.calculatePopupPosition=function(){var e,t=parseInt(C.chatWindowWidth),i=this.chatHeaderButton&&this.chatHeaderButton.getBoundingClientRect();if(i&&0!==i.x||(this.chatHeaderButton=document.getElementById(f.a),i=this.chatHeaderButton&&this.chatHeaderButton.getBoundingClientRect()),i&&i.x>0){var n=i.left+.5*i.width-t/2;e=n+t>this.chatHeaderButton.offsetParent.clientWidth+this.chatHeaderButton.offsetWidth?{right:10}:n<0?{left:10}:{left:n}}else e=this.props.isRtl?{left:10}:{right:10};this.props.isThinHeader&&(e=Object(c.__assign)(Object(c.__assign)({},e),{top:this.props.isThinHeader?48:50})),this.setState({popupPosition:e})},t.prototype.render=function(){var e,t=Object(O.a)();return r.createElement(a.h,{onDismiss:this.props.onDismiss,ariaLabel:A.a.ChatOpened,role:"region",className:Object(a.x)(C.chatPopup,(e={},e[C.popupSlideIn]=this.props.isChatRecentsPaneOpen,e)),popupPosition:this.state.popupPosition,id:"chat_popup",onAnimationEnd:this.onAnimationEnd,isVisible:this.props.isChatRecentsPaneOpen,isPersistant:!0},r.createElement("div",{"data-style":"o365shell",className:Object(a.x)(m.a.ChatRecents,C.recentsWrapper,t.neutral.lighterAlt.background),ref:this.populateRecentsContent,id:"chat_recent_pane"}))},t.prototype.componentDidUpdate=function(e){!e.isChatRecentsPaneOpen&&this.props.isChatRecentsPaneOpen&&this.calculatePopupPosition()},t.prototype.componentDidMount=function(){window.addEventListener(a.e.RESIZE,this.props.onDismiss),window.addEventListener(a.e.SCROLL,this.props.onDismiss),this.chatPopUp||(this.chatPopUp=document.getElementById("chat_popup"),this.chatPopUp.addEventListener(a.e.KEYDOWN,this.handleKeydown))},t.prototype.componentWillUnmount=function(){window.removeEventListener(a.e.RESIZE,this.props.onDismiss),window.removeEventListener(a.e.SCROLL,this.props.onDismiss),this.chatPopUp.removeEventListener(a.e.KEYDOWN,this.handleKeydown)},t}(r.Component),w=i(119),j=Object(n.b)((function(e){return{isChatAPIInitialized:e.chatState.isChatAPIInitialized,isChatRecentsPaneInitialized:e.chatState.isChatRecentsPaneInitialized,isChatRecentsPaneOpen:e.chatState.isChatRecentsPaneOpen,isThinHeader:Object(d.f)().isThinHeader,isTeamsChatActivated:e.chatState.isTeamsChatActivated,isRtl:e.userState&&e.userState.isRtl}}),(function(e){return{onRecentsReady:function(){e(Object(w.b)(!0))},onDismiss:function(t){var i=document.getElementById(f.a);t instanceof MouseEvent&&t.target&&i&&i.contains(t.target)||e(Object(w.c)(!1))}}}))(T),E=i(191),D=document.getElementById(f.b),_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.myPresenceStatusUpdate=function(e){if(t.props.userPresenceStatusItems){var i=Object(l.b)(e,t.props.userPresenceStatusItems);t.props.userPresenceStatusUpdate(i)}t.presenceStatusKey=e},t.onPresenceStatusChanged=function(e){var i=t.props.presenceStatus,n=Object(l.b)(e,t.props.userPresenceStatusItems);Object(N.j)(n,(function(){Object(d.e)().exception("Chat API setUserPresenceStatus failed",6,null),t.props.userPresenceStatusUpdate(i)}))},t.onChatClickHandler=function(e){var i=e instanceof MouseEvent;if(e instanceof KeyboardEvent)switch(e.which){case 40:i=e.altKey;break;case 13:case 32:e.preventDefault(),i=!0}i&&t.chatClicked(e)},t.onNotificationReceived=function(e){var i=e;if(i){var n=t.props.chatNotificationsEnabled&&(i.type===p.a.message||i.type===p.a.summary);if(t.props.callingNotificationsEnabled&&i.type===p.a.call||n){var a={type:i.type,title:i.title,description:i.description,actionLink:i.actions.length>0?i.actions[0]:null,cancelLink:i.actions.length>1?i.actions[1]:null,image:i.avatarUrl,sender:i.sender,id:i.id},o={providerType:p.b.ChatNotification,subType:i.type,payload:a,toastType:i.type===p.a.call?1:0,toastState:0};t.props.onNotificationReceived(o),Object(d.e)().impression(i.type,"Chat")}}},t.onStartChat=function(){t.props.onRecentsOpen(!1,f.a),Object(d.e)().impression("ChatWindowOpened","Chat")},t.onChatNotificationSettingsUpdated=function(e){var i=e;if(i){var n=Object(N.e)(i.value);switch(i.name){case m.e.NewMessage:t.updateChatSettings(n);break;case m.e.IncomingCall:t.updateCallSettings(n)}}},t}return Object(c.__extends)(t,e),t.prototype.render=function(){return this.props.chatEnabled&&this.props.isChatAPIInitialized?r.createElement(j,null):null},t.prototype.componentDidMount=function(){this.props.chatEnabled&&!this.props.isChatAPIInitialized&&this.beginChatInitialization()},t.prototype.componentDidUpdate=function(){this.props.chatEnabled&&!this.props.isChatAPIInitialized&&this.beginChatInitialization()},t.prototype.beginChatInitialization=function(){var e=this;this.props.isConsumerShell?(g=function(){e.onChatCoreReady()},window.addEventListener(m.b.ChatCoreReady,g),S=function(){e.onChatAPIReady()},window.addEventListener(m.b.ChatAPIReady,S),this.appendChatAPIDownloadScript()):(I=function(){e.props.onTeamsChatActivated(!0),e.onChatCoreReady(),window.removeEventListener(E.b.TeamsChatAPIReady,I)},window.addEventListener(E.b.TeamsChatAPIReady,I),this.appendTeamsChatDownloadScript())},t.prototype.onChatCoreReady=function(){var e=this,t=this.getInitParams();!this.props.isTeamsChatActivated&&swc&&t?(window.removeEventListener(m.b.ChatCoreReady,g),swc.init(null,t).catch((function(t){window.removeEventListener(m.b.ChatAPIReady,S),e.handleAPIInitializationError(t)}))):TeamsClient?TeamsClient.SDK.create({chatsParentElement:v(),hostCtx:this.props.workloadId}).then((function(t){TeamsClient.client=t,t.notifications.get().then((function(t){t.subscribe((function(t){t.type===E.a.UnreadCounterUpdate&&e.props.onUnreadConversationUpdate(t.data)}))})),e.onChatAPIInitialized(!0)})).catch((function(t){e.handleAPIInitializationError(t)})):(window.removeEventListener(m.b.ChatAPIReady,S),this.handleAPIInitializationError())},t.prototype.onChatAPIReady=function(){window.removeEventListener(m.b.ChatAPIReady,S),this.initializeChat()},t.prototype.initializeChat=function(){var e=this;try{this.props.disableToasts||(swc.API.registerEvent(m.b.ApiReceivedNotification,this.onNotificationReceived),swc.API.registerEvent(m.b.ApiHideNotification,this.props.onNotificationDismissed)),swc.API.registerEvent(m.b.ApiUnreadConversationUpdate,this.props.onUnreadConversationUpdate),swc.API.registerEvent(m.b.ApiStartChat,this.onStartChat),swc.API.registerEvent(m.b.ApiOnCallStart,(function(){Object(d.e)().impression("CallStart","Chat")})),swc.API.registerEvent(m.b.ApiOnRecentItemSelected,(function(){Object(d.e)().click("ChatRecentItem","Chat")})),swc.API.registerEvent(m.b.ApiRecentsShown,this.startChatLoadingTime),swc.API.registerEvent(m.b.ApiRecentItemsLoaded,this.logChatLoadingTime),swc.API.registerEvent(m.b.ApiSettingsChanged,this.onChatNotificationSettingsUpdated),swc.create(m.c.Messaging,N.f,v()),swc.getPresence().then((function(t){t.subscribeToMyStatus(e.myPresenceStatusUpdate),t.getStatusList().then((function(t){Object(a.gb)(t)?(e.props.onUserPresenceStatusListUpdate(t),e.presenceStatusKey&&(e.myPresenceStatusUpdate(e.presenceStatusKey),e.presenceStatusKey=void 0)):Object(d.e)().tag("Presence_API_getStatusList_Invalid",6)})).catch((function(e){Object(d.e)().exception("Presence_API_getStatusList_Failed",6,e)}))})).catch((function(e){Object(d.e)().exception("Presence_API_Initialization_Failed",6,e)})),swc.getKeyboard&&swc.getKeyboard().then((function(t){t.onKeyDown((function(t){"Escape"===t.key&&e.props.isChatRecentsPaneOpen&&e.dismissChatRecentsPane()}))})).catch((function(e){Object(d.e)().exception("get_keyboard_API_Failed",6,e)})),Object(d.e)().impression("Chat_Button","Chat",0,void 0,"successful"),this.onChatAPIInitialized(!0)}catch(e){this.handleAPIInitializationError(e)}},t.prototype.handleAPIInitializationError=function(e){Object(d.e)().exception("Chat_API_Initialization_Failed",6,e),this.onChatAPIInitialized(!1),this.props.responsiveEnabled||D&&this.props.isConsumerShell&&(D.style.display="block")},t.prototype.getInitParams=function(){return{toLoadUnreadConversationsCount:!0,locale:this.props.locale,correlationId:this.props.correlationId,loginHint:this.props.upn}},t.prototype.onChatAPIInitialized=function(e){var t=this;if(this.props.onChatAPIInitialized(e),e&&!this.props.responsiveEnabled){var i=document.getElementById(f.a);i&&(Object(a.S)(i,a.e.CLICK+" "+a.e.KEYDOWN,u.b),Object(a.s)(i,a.e.CLICK+" "+a.e.KEYDOWN,this.onChatClickHandler),D.style.display="block")}var n=Object(d.b)();n.subscribe("ThemeChanged",(function(){var e=Object(d.g)().state.isDarkMode?"dark":Object(d.g)().getCurrentThemeId();t.props.isTeamsChatActivated||swc.setTheme(e)}),!0),n.subscribe("PresenceStatusChanged",this.onPresenceStatusChanged,!1),this.updateNotificationSettings(),this.showCurrentPresence()},t.prototype.showCurrentPresence=function(){var e=this;!this.props.isTeamsChatActivated&&swc&&swc.getPresence().then((function(t){t.getMyStatus().then((function(t){t?e.myPresenceStatusUpdate(t):Object(d.e)().tag("Presence_API_getMyStatus_Undefined",6)})).catch((function(e){Object(d.e)().exception("Presence_API_getMyStatus_Failed",6,e)}))})).catch((function(e){Object(d.e)().exception("Presence_API_Initialization_Failed",6,e)}))},t.prototype.chatClicked=function(e){e.preventDefault(),Object(d.e)().click("ChatButton","Chat",null,null,"Chat recents list open "+!this.props.isChatRecentsPaneOpen),this.props.onRecentsOpen(!this.props.isChatRecentsPaneOpen,f.a)},t.prototype.dismissChatRecentsPane=function(){this.props.onRecentsOpen(!1,f.a);var e=document.getElementById(f.a);e&&e.focus()},t.prototype.appendChatAPIDownloadScript=function(){var e=this;y=function(){e.onChatAPIDownloadScriptFailed()};var t=document.createElement("script");t.type="text/javascript",t.setAttribute("data-style","o365shell"),t.setAttribute("data-disable-autostart","true"),t.setAttribute("data-platform-id",this.props.workloadId),t.setAttribute("data-auth-type",this.props.isConsumerShell?"msa":"aad"),t.src=this.props.chatSDKUrl,t.onerror=y,document.head.appendChild(t)},t.prototype.appendTeamsChatDownloadScript=function(){var e=document.createElement("script"),t=null;window.URLSearchParams&&(t=new URLSearchParams(window.location.search)),e.src=t&&t.has("teams-embed-sdk-url")?t.get("teams-embed-sdk-url"):"https://teams.microsoft.com/embed-client/loader.js",document.body.appendChild(e)},t.prototype.onChatAPIDownloadScriptFailed=function(){Object(d.e)().exception("Chat API download script failed",6,null),this.props.onChatAPIInitialized(!1),this.props.responsiveEnabled||this.props.isConsumerShell&&(D.style.display="block")},t.prototype.startChatLoadingTime=function(){x=Date.now()},t.prototype.logChatLoadingTime=function(){x&&(Object(d.e)().timer("Chat_FirstTimeChatListShown",Date.now()-x),swc.API.unregisterEvent(m.b.ApiRecentItemsLoaded,this.logChatLoadingTime),swc.API.unregisterEvent(m.b.ApiRecentsShown,this.startChatLoadingTime))},t.prototype.updateNotificationSettings=function(){var e=this;Object(N.d)().then((function(t){e.updateChatSettings(t)})).catch((function(){})),Object(N.c)().then((function(t){e.updateCallSettings(t)})).catch((function(){}))},t.prototype.updateChatSettings=function(e){var t=Object(c.__assign)(Object(c.__assign)({},this.props.notificationPreferences),{EnableChat:e.Enabled,EnableChatSound:e.SoundEnabled});this.props.onNotificationPreferencesUpdated(t)},t.prototype.updateCallSettings=function(e){var t=Object(c.__assign)(Object(c.__assign)({},this.props.notificationPreferences),{EnableCalling:e.Enabled,EnableCallingSound:e.SoundEnabled});this.props.onNotificationPreferencesUpdated(t)},t}(r.Component);i.d(t,"mapStateToProps",(function(){return M})),i.d(t,"ChatBaseControlConnector",(function(){return R}));var M=function(e){var t=e.shellInitDataState;return{disableToasts:t.renderSettings.disableToasts,locale:e.shellInitDataState.navBarData.CultureName,notificationsEnabled:e.shellInitDataState.clientData.NotificationsEnabled,isConsumerShell:e.shellInitDataState.clientData.IsConsumerShell,correlationId:e.shellInitDataState.clientData.SHSID,responsiveEnabled:null!=e.shellInitDataState.layout,chatEnabled:e.chatState.chatEnabled,chatSDKUrl:e.chatState.webChatSDKUrl,isChatAPIInitialized:e.chatState.isChatAPIInitialized,isChatRecentsPaneOpen:e.chatState.isChatRecentsPaneOpen,isTeamsChatActivated:e.chatState.isTeamsChatActivated,chatNotificationsEnabled:!(!e.notificationState||!e.notificationState.notificationPreferencesData)&&e.notificationState.notificationPreferencesData.EnableChat,callingNotificationsEnabled:!(!e.notificationState||!e.notificationState.notificationPreferencesData)&&e.notificationState.notificationPreferencesData.EnableCalling,workloadId:t.clientData.WorkloadId,presenceStatus:e.meControlState.userPresenceStatus,userPresenceStatusItems:e.meControlState.userPresenceStatusItems,notificationPreferences:e.notificationState&&e.notificationState.notificationPreferencesData||null,upn:e.userState&&e.userState.upn}},R=Object(n.b)(M,(function(e){return{onChatAPIInitialized:function(t){e(Object(w.a)(t))},onRecentsOpen:function(t,i){e(Object(w.c)(t)),e(Object(a.db)(i))},onNotificationDismissed:function(t){e(Object(s.e)(t))},onNotificationReceived:function(t){e(Object(s.a)(t))},onUnreadConversationUpdate:function(t){e(Object(w.e)(t))},userPresenceStatusUpdate:function(t){e(Object(o.h)(t))},onUserPresenceStatusListUpdate:function(t){e(Object(o.i)(t))},onNotificationPreferencesUpdated:function(t){e(Object(a.fb)(t))},onTeamsChatActivated:function(t){e(Object(w.d)(t))}}}))(_)}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_notifications_end"),shellPerformance.measure("shell_notifications","shell_notifications_start","shell_notifications_end"));
//# sourceMappingURL=https://oneshellprcorp.blob.core.windows.net/oneshellpr/20200615.1/notifications.map