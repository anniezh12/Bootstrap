(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["dotdot_odb_showversionhistoryaction"],{1301:function(e,t,n){"use strict";var r=n(1403),i=n(1258),s=n(1260),o=n(30),u=n(1253),a=n(51),f=n(17),l=n(677),c=n(1319),h=n(479),p=n(15),d=new RegExp("^Templates$","i"),v=(function(){function e(){}e.isFolder=function(e,t){return t?e&&(e.type===u.e.Folder||e.type===u.e.OneNote):e&&e.type===u.e.Folder};e.isCheckedOut=function(e){return l.e(e)};e.isCheckedOutByUser=function(e,t){return l.n(e,t)};e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)};e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:r.e.FileCheckedoutOrLockedWarningTitle,component:{name:c.e.tagName,params:{text:r.e.FileCheckedoutOrLockedWarning}},actions:[{name:i.e.cancelActionText,execute:function(){return f.n.wrap(2)},icon:new s.e("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:o.e.Success}})};e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major};e.needsPublishingReminder=function(t,n){return!e.isPublished(t,n)&&(!(e.isPendingApproval(t,n)||!p.e.isActivated("20638368-710f-41c5-b78b-464db07fb707","04/27/2020","No publishing banner for page templates")&&e.isPageTemplate(t))&&(!(Object(h.isFeatureEnabled)(h.WexSitePagesScheduling)&&t.properties&&t.properties._ScheduledVersion&&t.properties.owshiddenversion===t.properties._ScheduledVersion)&&(a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0))))};e.isPublishingRelevant=function(t,n){return a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)};e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)};e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var r=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:r}}return{major:0,minor:0}};e.isPendingApproval=function(t,n){return!!n.isModerated&&(t&&t.properties&&t.properties[e.PublishProperty]&&"2"===t.properties[e.PublishProperty])};e.isPageTemplate=function(e){if(!e.id)return!1;var t=e.id.split("/"),n=t.length;return d.test(t[n-2])};e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&a.e.hasItemPermission(t,a.e.editListItems)&&a.e.hasItemPermission(t,a.e.approveItems)};e.FileTypeProperty="FSObjType";e.PublishProperty="_ModerationStatus.";e.VersionProperty="_UIVersion";return e})();t.e=v},1407:function(e,t,n){"use strict";var r=n(8),i=n(10),s=new r.t({name:"IFrameDialog.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("dot_iframedialog")]).then(n.bind(null,1690)).then(function(e){return e.resourceKey.local})})});t.e=s},1641:function(e,t,n){"use strict";n.d(t,"e",function(){return d});var r=n(0),i=n(1113),s=n(89),o=n(1295),u=n(1269),a=n(1323),f=n(1287),l=n(1279),c=n(1114),h=n(10),p=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._itemProvider=n.itemProvider;r._dataSource=n.versionControlDataSource;r._store=n.itemsStore;r._operationProvider=n.operationProvider;return r}t.prototype.checkOutItem=function(e){var t,n=this,r=e.item,i=this._store.getItem(e.parentKey),s=this._operationProvider.register({name:r.name,type:u.e.checkOutItem,payloads:{checkOutItem:{parent:i.peek(),item:r}},iconName:r.iconName});s.progress.maximum(1);s.progress.current(0);t=this._dataSource.checkOutItem(e);s.state(f.e.started);return t.then(function(){n._itemProvider.invalidateItem(e.parentKey);s.progress.current(1);s.state(f.e.completed)},function(){s.state(f.e.failed)})};t.prototype.undoCheckOutItem=function(e){var t,n=this,r=e.item,i=this._store.getItem(e.parentKey),s=this._operationProvider.register({name:r.name,type:u.e.undoCheckOutItem,payloads:{undoCheckOutItem:{parent:i.peek(),item:r}},iconName:r.iconName});s.progress.maximum(1);s.progress.current(0);t=this._dataSource.undoCheckOutItem(e);s.state(f.e.started);return t.then(function(){n._itemProvider.invalidateItem(e.parentKey);s.progress.current(1);s.state(f.e.completed)},function(){s.state(f.e.failed)})};t.prototype.checkInItem=function(e){var t,n=this,r=e.item,i=this._store.getItem(e.parentKey),s=this._operationProvider.register({name:r.name,type:u.e.checkInItem,payloads:{checkInItem:{parent:i.peek(),item:r}},iconName:r.iconName});s.progress.maximum(1);s.progress.current(0);t=this._dataSource.checkInItem(e);s.state(f.e.started);return t.then(function(){n._itemProvider.invalidateItem(e.parentKey);s.progress.current(1);s.state(f.e.completed)},function(e){s.state(f.e.failed);try{s.error(new a.e({message:e.message.value}))}catch(e){}})};t.prototype.getVersionHistoryUrl=function(e,t,n){return this._dataSource.getVersionHistoryUrl(e,t,n)};t.prototype.supportsDocSetVersioning=function(){return this._dataSource.supportsDocSetVersioning()};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.default.dependencies),{itemProvider:c.resourceKey,versionControlDataSource:s.Ee,itemsStore:l.t,operationProvider:o.e});return t})(i.default),d=Object(h.s)("VersionControlProvider",p)},2104:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1301),s=n(1250),o=n(67),u=n(89),a=n(1407),f=n(1249),l=n(30),c=n(106),h=n(51),p=n(17),d=n(1264),v=n(1641),m=n(141),g=n(1114),y=n(1285),b=n(1544),w=n(1259),E=n(1261),S=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="VersionHistory";r._urlDataSource=r.resources.consume(u.me);r._itemUrlHelper=r.resources.consume(m.n);r._itemCommandHelper=r.resources.consume(y.t);r._itemParentHelper=r.resources.consume(E.e);r._itemSelectionHelper=new(r.child(w.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();if(e){var t=this.observables.unwrap(this._itemParentHelper.getFacetedAncestorOrSelf(e,"list"));return this._urlDataSource.getPageType()!==c.e.TextFileEditor&&!!t&&!!t.list&&this._itemCommandHelper.isCommandSupported(e,b.i)&&!this._isRemoteWeb(t)&&!this._isFolder(e)&&!(!t.list.enableVersions&&!t.list.isModerated)&&3!==e.itemStatus&&4!==e.itemStatus&&h.e.hasItemPermission(e,h.e.viewVersions)}return!1};t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,p.n,function(){var e,t,n,i,s,u,c,h,m;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e=this.resources.consume(d.e);t=this.resources.consume(g.resourceKey);n=this.resources.consume(v.e);i=this._itemSelectionHelper.currentItem();return[4,this._itemSelectionHelper.resolveFirst()];case 1:if(!(s=r.sent()))return[2,p.n.resolve({resultCode:"EmptySelection",resultType:l.e.Failure})];if(!(u=this.observables.peekUnwrap(this._itemParentHelper.getFacetedAncestorOrSelf(s,"list"))).list)return[2,p.n.resolve({resultCode:"InvalidExecution",resultType:l.e.Failure})];c=n.supportsDocSetVersioning()&&s.isDocSet;h=u.list.isDocumentLibrary&&!c?"":u.list.id;m=c?this._getServerId(s):s.id;return[2,e.requestDialog({title:o.e.ShowVersionHistory,size:"XLarge",control:Object(f.r)(a.e,{componentUrl:n.getVersionHistoryUrl(m,h,c),showInDialog:!0,heightOffset:.5,forceSharePointScrollbar:!0}),actions:[]}).wait().then(function(){t.invalidateItem(i.key);return{resultType:l.e.Success}})]}})})};t.prototype._isRemoteWeb=function(e){return this._itemUrlHelper.getItemUrlParts(e.key).isCrossDomain};t.prototype._isFolder=function(e){return(!(this.resources.consume(v.e).supportsDocSetVersioning()&&!!this._getServerId(e))||!e.isDocSet)&&i.e.isFolder(e,!0)};t.prototype._getServerId=function(e){return e&&e.properties&&e.properties.ID||""};return t})(s.e);t.default=S}}]);