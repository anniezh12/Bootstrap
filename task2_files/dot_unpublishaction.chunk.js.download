(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["dot_unpublishaction"],{1301:function(e,t,n){"use strict";var r=n(1403),i=n(1258),s=n(1260),o=n(30),u=n(1253),a=n(51),f=n(17),l=n(677),c=n(1319),h=n(479),p=n(15),d=new RegExp("^Templates$","i"),v=(function(){function e(){}e.isFolder=function(e,t){return t?e&&(e.type===u.e.Folder||e.type===u.e.OneNote):e&&e.type===u.e.Folder};e.isCheckedOut=function(e){return l.e(e)};e.isCheckedOutByUser=function(e,t){return l.n(e,t)};e.isCheckedOutByOther=function(t,n){return e.isCheckedOut(t)&&!e.isCheckedOutByUser(t,n)};e.showCheckedOutByOtherDialog=function(e){return e.requestDialog({title:r.e.FileCheckedoutOrLockedWarningTitle,component:{name:c.e.tagName,params:{text:r.e.FileCheckedoutOrLockedWarning}},actions:[{name:i.e.cancelActionText,execute:function(){return f.n.wrap(2)},icon:new s.e("Cancel"),isDefault:!0}]}).wait().then(function(){return{resultType:o.e.Success}})};e.isPublished=function(t,n){return n.isModerated?t.properties[e.PublishProperty]&&"3"!==t.properties[e.PublishProperty]&&"1"!==t.properties[e.PublishProperty]:0===e.getVersionNoModeration(t,n).minor&&0!==e.getVersionNoModeration(t,n).major};e.needsPublishingReminder=function(t,n){return!e.isPublished(t,n)&&(!(e.isPendingApproval(t,n)||!p.e.isActivated("20638368-710f-41c5-b78b-464db07fb707","04/27/2020","No publishing banner for page templates")&&e.isPageTemplate(t))&&(!(Object(h.isFeatureEnabled)(h.WexSitePagesScheduling)&&t.properties&&t.properties._ScheduledVersion&&t.properties.owshiddenversion===t.properties._ScheduledVersion)&&(a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isFolder(t,!0))))};e.isPublishingRelevant=function(t,n){return a.e.hasItemPermission(t,a.e.editListItems)&&n.enableMinorVersions&&!e.isCheckedOut(t)&&!e.isFolder(t,!0)};e.getVersionNoModeration=function(e,t){return t.isModerated?{major:0,minor:0}:this.getVersion(e,t)};e.getVersion=function(t,n){if(t&&t.properties&&t.properties[e.VersionProperty]){var r=Number(t.properties[e.VersionProperty])%512;return{major:Math.floor(Number(t.properties[e.VersionProperty])/512),minor:r}}return{major:0,minor:0}};e.isPendingApproval=function(t,n){return!!n.isModerated&&(t&&t.properties&&t.properties[e.PublishProperty]&&"2"===t.properties[e.PublishProperty])};e.isPageTemplate=function(e){if(!e.id)return!1;var t=e.id.split("/"),n=t.length;return d.test(t[n-2])};e.isApprovalRelevant=function(t,n){return n&&n.isModerated&&!e.isCheckedOut(t)&&a.e.hasItemPermission(t,a.e.editListItems)&&a.e.hasItemPermission(t,a.e.approveItems)};e.FileTypeProperty="FSObjType";e.PublishProperty="_ModerationStatus.";e.VersionProperty="_UIVersion";return e})();t.e=v},2661:function(e,t,n){"use strict";n.r(t);n.d(t,"UnPublishAction",function(){return c});var r=n(0),i=n(17),s=n(30),o=n(1301),u=n(34),a=n(1250),f=n(163),l=n(1259),c=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.isSingleSelectAction=!0;r.name=0===r._unPublishType?"UnPublish":"CancelApproval";r._unPublishType=t.unPublishType;r._listContext=r.resources.consume(u.o);r._itemSelectionHelper=new(r.child(l.e))({allowMultiSelect:!1,canFallback:!1,overrideItem:t.item});return r}t.prototype.onIsAvailable=function(){var e=this._itemSelectionHelper.firstItem();return!!(e&&o.e.isPublishingRelevant(e,this._listContext)&&o.e.isPublished(e,this._listContext))&&(this._listContext.isModerated&&"0"!==e.properties[o.e.PublishProperty]?1===this._unPublishType:0===this._unPublishType)};t.prototype.onExecute=function(e,t){return Object(r.__awaiter)(this,void 0,i.n,function(){var e,t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:e=this.resources.consume(f.v);t=this._itemSelectionHelper.currentItem.peek();return[4,this._itemSelectionHelper.resolveFirst()];case 1:return(n=r.sent())?[2,e.unPublishItem({parentKey:t.key,item:n}).then(function(){return{resultType:s.e.Success}},function(){return{resultType:s.e.Failure}})]:[2,i.n.resolve({resultCode:"EmptySelection",resultType:s.e.Failure})]}})})};return t})(a.e);t.default=c}}]);